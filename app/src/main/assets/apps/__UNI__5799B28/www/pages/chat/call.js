"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var J=Object.create;var O=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var q=Object.getOwnPropertyNames;var Y=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var Q=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var X=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of q(o))!K.call(e,n)&&n!==t&&O(e,n,{get:()=>o[n],enumerable:!(r=G(o,n))||r.enumerable});return e};var N=(e,o,t)=>(t=e!=null?J(Y(e)):{},X(o||!e||!e.__esModule?O(t,"default",{value:e,enumerable:!0}):t,e));var R=(e,o,t)=>new Promise((r,n)=>{var i=f=>{try{g(t.next(f))}catch(h){n(h)}},s=f=>{try{g(t.throw(f))}catch(h){n(h)}},g=f=>f.done?r(f.value):Promise.resolve(f.value).then(i,s);g((t=t.apply(e,o)).next())});var P=Q((we,L)=>{L.exports=Vue});var De=N(P());var $=(e,o)=>{let t=e.__vccOpts||e;for(let[r,n]of o)t[r]=n;return t};function k(e){return weex.requireModule(e)}function y(e,o,...t){uni.__log__?uni.__log__(e,o,...t):console[e].apply(console,[...t,o])}var Z="dev",V,U,j,B;V="https://bts.267girl.com",U="https://pic3.candychat.link/",B="https://pic2.candychat.link/",j="1b28c2eac0672761";var S={wv:"1.0.0",ENV:Z,apiHost:V,isAndroid:plus.os.name=="Android",zT:2,ossPicPath:U,ossPath:B,key:j,PHOTO:1,VIDEO:2,appV:parseInt(plus.runtime.version.split(".").join("")),M_TXT:1,M_IMG:3,M_VIDEO:4,M_VOICE:2};function x(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(o){return"%"+o.charCodeAt(0).toString(16).toUpperCase()})}function ee(){return Math.random().toString(36).substr(2)}function H(e){return e==null||e==""||typeof e=="undefined"}function I(e,o="none",t="center"){uni.showToast({title:e,duration:2e3,icon:o,position:t})}var te=new Promise(()=>{});var _=0;function re(e){return ie(ne(oe(e)))}function ne(e){return ae(le(se(e),e.length*8))}function ie(e){try{}catch(i){_=0}for(var o=_?"0123456789ABCDEF":"0123456789abcdef",t="",r,n=0;n<e.length;n++)r=e.charCodeAt(n),t+=o.charAt(r>>>4&15)+o.charAt(r&15);return t}function oe(e){for(var o="",t=-1,r,n;++t<e.length;)r=e.charCodeAt(t),n=t+1<e.length?e.charCodeAt(t+1):0,55296<=r&&r<=56319&&56320<=n&&n<=57343&&(r=65536+((r&1023)<<10)+(n&1023),t++),r<=127?o+=String.fromCharCode(r):r<=2047?o+=String.fromCharCode(192|r>>>6&31,128|r&63):r<=65535?o+=String.fromCharCode(224|r>>>12&15,128|r>>>6&63,128|r&63):r<=2097151&&(o+=String.fromCharCode(240|r>>>18&7,128|r>>>12&63,128|r>>>6&63,128|r&63));return o}function se(e){for(var o=Array(e.length>>2),t=0;t<o.length;t++)o[t]=0;for(var t=0;t<e.length*8;t+=8)o[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32;return o}function ae(e){for(var o="",t=0;t<e.length*32;t+=8)o+=String.fromCharCode(e[t>>5]>>>t%32&255);return o}function le(e,o){e[o>>5]|=128<<o%32,e[(o+64>>>9<<4)+14]=o;for(var t=1732584193,r=-271733879,n=-1732584194,i=271733878,s=0;s<e.length;s+=16){var g=t,f=r,h=n,C=i;t=l(t,r,n,i,e[s+0],7,-680876936),i=l(i,t,r,n,e[s+1],12,-389564586),n=l(n,i,t,r,e[s+2],17,606105819),r=l(r,n,i,t,e[s+3],22,-1044525330),t=l(t,r,n,i,e[s+4],7,-176418897),i=l(i,t,r,n,e[s+5],12,1200080426),n=l(n,i,t,r,e[s+6],17,-1473231341),r=l(r,n,i,t,e[s+7],22,-45705983),t=l(t,r,n,i,e[s+8],7,1770035416),i=l(i,t,r,n,e[s+9],12,-1958414417),n=l(n,i,t,r,e[s+10],17,-42063),r=l(r,n,i,t,e[s+11],22,-1990404162),t=l(t,r,n,i,e[s+12],7,1804603682),i=l(i,t,r,n,e[s+13],12,-40341101),n=l(n,i,t,r,e[s+14],17,-1502002290),r=l(r,n,i,t,e[s+15],22,1236535329),t=u(t,r,n,i,e[s+1],5,-165796510),i=u(i,t,r,n,e[s+6],9,-1069501632),n=u(n,i,t,r,e[s+11],14,643717713),r=u(r,n,i,t,e[s+0],20,-373897302),t=u(t,r,n,i,e[s+5],5,-701558691),i=u(i,t,r,n,e[s+10],9,38016083),n=u(n,i,t,r,e[s+15],14,-660478335),r=u(r,n,i,t,e[s+4],20,-405537848),t=u(t,r,n,i,e[s+9],5,568446438),i=u(i,t,r,n,e[s+14],9,-1019803690),n=u(n,i,t,r,e[s+3],14,-187363961),r=u(r,n,i,t,e[s+8],20,1163531501),t=u(t,r,n,i,e[s+13],5,-1444681467),i=u(i,t,r,n,e[s+2],9,-51403784),n=u(n,i,t,r,e[s+7],14,1735328473),r=u(r,n,i,t,e[s+12],20,-1926607734),t=c(t,r,n,i,e[s+5],4,-378558),i=c(i,t,r,n,e[s+8],11,-2022574463),n=c(n,i,t,r,e[s+11],16,1839030562),r=c(r,n,i,t,e[s+14],23,-35309556),t=c(t,r,n,i,e[s+1],4,-1530992060),i=c(i,t,r,n,e[s+4],11,1272893353),n=c(n,i,t,r,e[s+7],16,-155497632),r=c(r,n,i,t,e[s+10],23,-1094730640),t=c(t,r,n,i,e[s+13],4,681279174),i=c(i,t,r,n,e[s+0],11,-358537222),n=c(n,i,t,r,e[s+3],16,-722521979),r=c(r,n,i,t,e[s+6],23,76029189),t=c(t,r,n,i,e[s+9],4,-640364487),i=c(i,t,r,n,e[s+12],11,-421815835),n=c(n,i,t,r,e[s+15],16,530742520),r=c(r,n,i,t,e[s+2],23,-995338651),t=p(t,r,n,i,e[s+0],6,-198630844),i=p(i,t,r,n,e[s+7],10,1126891415),n=p(n,i,t,r,e[s+14],15,-1416354905),r=p(r,n,i,t,e[s+5],21,-57434055),t=p(t,r,n,i,e[s+12],6,1700485571),i=p(i,t,r,n,e[s+3],10,-1894986606),n=p(n,i,t,r,e[s+10],15,-1051523),r=p(r,n,i,t,e[s+1],21,-2054922799),t=p(t,r,n,i,e[s+8],6,1873313359),i=p(i,t,r,n,e[s+15],10,-30611744),n=p(n,i,t,r,e[s+6],15,-1560198380),r=p(r,n,i,t,e[s+13],21,1309151649),t=p(t,r,n,i,e[s+4],6,-145523070),i=p(i,t,r,n,e[s+11],10,-1120210379),n=p(n,i,t,r,e[s+2],15,718787259),r=p(r,n,i,t,e[s+9],21,-343485551),t=d(t,g),r=d(r,f),n=d(n,h),i=d(i,C)}return Array(t,r,n,i)}function w(e,o,t,r,n,i){return d(ue(d(d(o,e),d(r,i)),n),t)}function l(e,o,t,r,n,i,s){return w(o&t|~o&r,e,o,n,i,s)}function u(e,o,t,r,n,i,s){return w(o&r|t&~r,e,o,n,i,s)}function c(e,o,t,r,n,i,s){return w(o^t^r,e,o,n,i,s)}function p(e,o,t,r,n,i,s){return w(t^(o|~r),e,o,n,i,s)}function d(e,o){var t=(e&65535)+(o&65535),r=(e>>16)+(o>>16)+(t>>16);return r<<16|t&65535}function ue(e,o){return e<<o|e>>>32-o}var b={md5:function(e){return re(e)}},E={request(e,o,t,r,n=!1){return new Promise((i,s)=>{let g=!1;g=getApp().globalData.token;let f={"content-type":"application/json",ua:getApp().globalData.ua};g&&(f.Authorization=`Bearer ${g}`);let h=getApp().globalData.apiHost;o.nonce=b.md5(ee()+new Date().getTime());let C=ce(o);uni.request({url:h+e,method:"POST",header:f,data:C,dataType:"json",timeout:1e4,complete(v){return R(this,null,function*(){if(y("log","at common/api.js:28","response000000=======response=======",v),t&&uni.hideLoading(),y("log","at common/api.js:30",`request ${e} obj ${JSON.stringify(o)}`),v.statusCode==200){let A=v.data;if(H(A.msg)||I(A.msg),A.ok===99){yield getApp().createUser();let z=yield E.request(e,o,t,r,n);i(z);return}if(A.ok>0){i(A);return}r&&s(A)}else if(r)s(v);else return te})},fail(v){y("error","at common/api.js:54","api fail ",v)}})})}};function ce(e){try{H(e)&&(e={}),e.times=new Date().getTime();let o=Object.keys(e).sort(),t={};for(let n=0,i=o.length;n<i;n++)t[o[n]]=e[o[n]];let r=W(t).substr(1);return t.sign=b.md5(`${b.md5(r)}${S.key}`),t}catch(o){return e}}function W(e,o){if(e==null)return"";try{let t="",r=typeof e;if(r=="string"||r=="number")t+="&"+o+"="+x(e);else if(r=="boolean")t+="&"+o+"="+(e?1:0);else for(let n in e){let i=o==null?n:o+pe(n);t+=W(e[n],i)}return t}catch(t){return""}}function pe(e){return`${encodeURIComponent("[")}${e}${encodeURIComponent("]")}`}var a=N(P());function fe(e){let t={path:"",repeat:!0,isOut:!!e};getApp().globalData.audioModule.startRing(t,r=>{})}function me(){return typeof getApp().globalData.toolModule.playSoundEffect=="function"}function ge(){getApp().globalData.toolModule.checkAudioBluetoothMode({})}function de(e){getApp().globalData.audioModule.stopRing({isConnectCall:e?1:0})}var m,M=getApp().globalData.window,F=null;S.isAndroid&&(F=k("ToolModule"));var he={computed:{whStyle(){return{width:`${this.sW}px`,height:`${this.sH}px`}}},data(){return{sW:M.width,sH:M.height,statusBarH:M.statusBarHeight,user:{},isClose:!1,engine:void 0,ringTime:0,timer:void 0,actionType:1}},methods:{clickHangup(e){this.isClose=!0,this.ringStop(),this.getHangReply(),uni.navigateBack()},getHangReply(e){E.request("/call")},playIosRing(e,o){let t=e.replace("/private","file://");if(o)m||(m=uni.createInnerAudioContext()),m.src=t,m.loop=!0,m.onError(r=>{y("error","at pages/chat/call.mixin.js:56","---> ll play ring error ",JSON.stringify(r))}),m.play();else{if(!m)return;m.stop(),m.destroy(),m=null}},ringPlay(){if(!this.isClose){if(S.isAndroid){me()&&ge(),F.ringPlay();return}fe(!0)}},ringStop(){if(y("error","at pages/chat/call.mixin.js:78","------> ring stop"),S.isAndroid){F.ringStop();return}de(!0)}},onLoad(){setTimeout(()=>{this.ringPlay(),this.ringTime=new Date().getTime(),setInterval(()=>{let e=new Date().getTime();e-this.ringTime>5*1e3&&I("customer service is busy"),e-this.ringTime>10*1e3&&this.clickHangup(2)},2e3)},1e3),this.user={avatar:"https://img0.baidu.com/it/u=367268319,3445943231&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"}},onBackPress(e){e.from=="backbutton"&&(this.isClose=!0,this.ringStop())}},ve={pos:{"":{position:"absolute",top:0,left:0}},center:{"":{flexDirection:"row",alignItems:"center"}},"center-align":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"center-content":{"":{alignItems:"center",justifyContent:"center"}},"view-loading":{"":{flex:1}},"view-video-content":{".view-loading ":{flex:1,alignItems:"center",justifyContent:"center"}},"video-view":{".view-loading .view-video-content ":{backgroundColor:"rgba(0,0,0,0)"}},"view-avatar-content":{".view-loading ":{flex:1,alignItems:"center",justifyContent:"center"}},bg:{".view-loading .view-avatar-content ":{backgroundColor:"#000000",opacity:.5}},"text-tip":{"":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"8rpx",paddingTop:"12rpx",paddingRight:"12rpx",paddingBottom:"12rpx",paddingLeft:"12rpx",textAlign:"center",fontSize:"24rpx",color:"#FFFFFF"}},"view-chat":{"":{flex:1,backgroundColor:"rgba(0,0,0,0)"}},"text-connecting":{"":{fontSize:"28rpx",fontWeight:"600",color:"#FFFFFF",textAlign:"center"}},text:{"":{fontSize:"24rpx",marginTop:"8rpx",color:"#FFFFFF"}}},Ae={mixins:[he]};function ye(e,o,t,r,n,i){return(0,a.openBlock)(),(0,a.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,a.createElementVNode)("view",{class:"chat-view",style:(0,a.normalizeStyle)([e.whStyle,{background:"#000000"}])},[(0,a.createElementVNode)("view",{class:"view-loading"},[(0,a.createElementVNode)("view",{class:"view-video-content"},[(0,a.createElementVNode)("view",{class:"view-avatar-content"},[e.user.avatar?((0,a.openBlock)(),(0,a.createElementBlock)("u-image",{key:0,mode:"aspectFill",src:e.user.avatar,style:(0,a.normalizeStyle)({width:`${e.sW}px`,height:`${e.sH}px`})},null,12,["src"])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("view",{class:"bg pos",style:(0,a.normalizeStyle)(e.whStyle)},null,4)])]),(0,a.createElementVNode)("view",{style:(0,a.normalizeStyle)([{position:"absolute","justify-content":"center","align-items":"center"},{top:`${e.statusBarH+120}px`,width:`${e.sW}px`}])},[(0,a.createElementVNode)("view",null,[e.user.avatar?((0,a.openBlock)(),(0,a.createElementBlock)("u-image",{key:0,src:e.user.avatar,style:{width:"264rpx",height:"264rpx","border-radius":"132rpx",border:"1px solid #FFFFFF"}},null,8,["src"])):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("view",{style:{"margin-top":"40rpx",width:"520rpx"},class:"text-tip"},[(0,a.createElementVNode)("u-text",{style:{"font-size":"28rpx",color:"#FFFFFF"}},"\u26A0\uFE0F This call may be recorded\uFF0CPlease chat in a civilized way.")])],4)]),(0,a.createElementVNode)("view",{class:"center-align",style:(0,a.normalizeStyle)([{position:"absolute",bottom:"100rpx",left:"0rpx"},{width:`${e.sW}px`}])},[(0,a.createElementVNode)("view",null,[(0,a.createElementVNode)("view",{class:"center-align"},[(0,a.createElementVNode)("u-image",{onClick:o[0]||(o[0]=(...s)=>e.clickHangup&&e.clickHangup(...s)),src:"/static/hang_up_1.png",style:{width:"144rpx",height:"144rpx"}})])])],4)],4)])}var D=$(Ae,[["render",ye],["styles",[ve]]]);var T=plus.webview.currentWebview();if(T){let e=parseInt(T.id),o="pages/chat/call",t={};try{t=JSON.parse(T.__query__)}catch(n){}D.mpType="page";let r=Vue.createPageApp(D,{$store:getApp({allowDefault:!0}).$store,__pageId:e,__pagePath:o,__pageQuery:t});r.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...D.styles||[]])),r.mount("#root")}})();
