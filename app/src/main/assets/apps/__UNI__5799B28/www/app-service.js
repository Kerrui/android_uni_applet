if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then(o=>t.resolve(e()).then(()=>o),o=>t.resolve(e()).then(()=>{throw o}))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e){return weex.requireModule(e)}function o(e,t,...o){uni.__log__?uni.__log__(e,t,...o):console[e].apply(console,[...o,t])}let n,i,r,a;n="https://bts.267girl.com",i="https://pic3.candychat.link/",a="https://pic2.candychat.link/",r="1b28c2eac0672761";let s="1.0.0",l="https://bts.267girl.com",u="Android"==plus.os.name,c=2,p="https://pic3.candychat.link/",m="https://pic2.candychat.link/",d="1b28c2eac0672761";parseInt(plus.runtime.version.split(".").join(""));const f="__UNI__3932C1F",h="__UNI__9C66D76";function g(){try{let e;if(u){e=plus.android.importClass("java.util.TimeZone").getDefault().getID()}else e=Intl.DateTimeFormat().resolvedOptions().timeZone;return e}catch(e){return"0"}}function A(e){let t=plus.runtime.appid,o="Android"==plus.os.name;switch(t){case f:case h:return e?o?"com.ig.chat.match":"com.kuxin.matchi":o?"com.ig.chat.match.a":"com.ig.chat.match"}return""}const y=1,v=2,b=3,P=4,w=101,C=1,I=0,D=-1;function F(e,t=!0,n=!0){return new Promise(t=>{let i=function(i){o("log","at common/permission.js:33","then",i),i==C?t(!0):i==I?t(!1):i==D?(n&&function(e,t){let o,n="Session Chat";e==y&&(o=`Turn on the read and write permissions for ${n} in the application management to use the album function normally`);uni.showModal({title:"Tips",content:o,showCancel:!0,cancelText:"Cancel",confirmText:"To turn on",complete(o){o.confirm?(!function(e){if(u){!function(e){if(M(e))return void function(){var e=plus.android.importClass("android.content.Intent"),t=plus.android.importClass("android.provider.Settings"),o=plus.android.importClass("android.net.Uri"),n=plus.android.runtimeMainActivity(),i=new e;i.setAction(t.ACTION_APPLICATION_DETAILS_SETTINGS);var r=o.fromParts("package",n.getPackageName(),null);i.setData(r),n.startActivity(i)}();getApp().globalData.toolModule.permissionOpenActivity({permission:e})}(j(e))}else t=plus.ios.import("UIApplication").sharedApplication(),o=plus.ios.import("NSURL"),n=o.URLWithString("app-settings:"),t.openURL(n),plus.ios.deleteObject(n),plus.ios.deleteObject(o),plus.ios.deleteObject(t);var t,o,n}(e),"function"==typeof t&&t(!0)):o.cancel&&"function"==typeof t&&t(!1)}})}(e),t(!1)):t(!1)};if(u){let t=j(e);o("log","at common/permission.js:47","permissionList",t),function(e){return new Promise(t=>{getApp().globalData.toolModule.permission({permission:e},e=>{t(e)})})}(t).then(i)}else{(function(e){switch(e){case y:case b:return S;case P:return O;case v:return _}})(e)(!0).then(i)}})}function j(e){switch(e){case y:case b:return["android.permission.READ_MEDIA_IMAGES","android.permission.READ_MEDIA_VIDEO"];case P:return["android.permission.RECORD_AUDIO"];case v:return["android.permission.CAMERA"]}}function S(){return new Promise(e=>{let t=plus.ios.import("PHPhotoLibrary"),o=t.authorizationStatus();3==o||4==o?(plus.ios.deleteObject(t),e(C)):0==o?plus.ios.invoke("PHPhotoLibrary","requestAuthorization:",(function(){plus.ios.deleteObject(t),e(I)})):(plus.ios.deleteObject(t),e(D))})}function O(e){return new Promise(t=>{let o=plus.ios.importClass("AVCaptureDevice"),n=o.authorizationStatusForMediaType("soun");3==n?(plus.ios.deleteObject(o),t(C)):0==n?plus.ios.invoke("AVCaptureDevice","requestAccessForMediaType:completionHandler:","soun",(function(){if(e){let e=o.authorizationStatusForMediaType("soun");plus.ios.deleteObject(o),t(3==e?C:I)}else plus.ios.deleteObject(o),t(I)})):(plus.ios.deleteObject(o),t(D))})}function _(e){return new Promise(t=>{let o=plus.ios.importClass("AVCaptureDevice"),n=o.authorizationStatusForMediaType("vide");3==n?(plus.ios.deleteObject(o),t(C)):0==n?plus.ios.invoke("AVCaptureDevice","requestAccessForMediaType:completionHandler:","vide",(function(){if(e){let e=o.authorizationStatusForMediaType("vide");plus.ios.deleteObject(o),t(3==e?C:I)}else plus.ios.deleteObject(o),t(I)})):(plus.ios.deleteObject(o),t(D))})}function T(e){if(M(e))return"";let t=e.split("/");if(M(t))return"";let o=t[t.length-1];if(M(o))return"";let n=o.split(".");if(M(n))return"";let i=n[n.length-1];return M(i)?"":i.toLowerCase()}function U(e,t,n){return new Promise(i=>{let r=e;r.startsWith("_doc")&&(r=plus.io.convertLocalFileSystemURL(r)),getApp().globalData.previewModule.getVideoCover({url:r,width:t,height:n},e=>{var t;o("error","at comExtend/preview-media.js:94","preview media "+("getVideoCover "+e),t),i(e)})})}function M(e){return null==e||""==e||void 0===e}function V(e,t="none",o="center"){uni.showToast({title:e,duration:2e3,icon:t,position:o})}const k=new Promise(()=>{});function N(e){e&&(getApp().globalData.token=e)}function L(e){e&&(getApp().globalData.uid=e)}function x(e,t){uni.showToast({title:e,duration:t,icon:"none",position:"center"})}function R(e){let t=uni.getSystemInfoSync().uniRuntimeVersion;if(!e)return t;let o=t.split("."),n=o[o.length-1];n.length<=1&&(o[o.length-1]=n+"0");let i=o.join("");return Number(i)}function B(e){return new Promise(t=>{plus.io.getVideoInfo({filePath:e,success(e){t(e)},fail(e){t("getVideoInfo "+JSON.stringify(e))}})})}const q=Object.freeze(Object.defineProperty({__proto__:null,choosePhotos:function(e,t=1){return new Promise((n,i)=>{let r,a=["album","camera"],s=["compressed"];1==e?(a=["album"],r=y):2==e?(a=["camera"],r=v):0==e&&(r=w),o("log","at common/common.js:41","888888"),F(r).then(r=>{if(!r)return i(),void o("error","at common/common.js:45","choose image permission fail");uni.chooseImage({count:t,sourceType:a,sizeType:s,crop:{},success:function(t){let o=[];for(let e=0,n=t.tempFilePaths.length;e<n;e++){let n=T(t.tempFilePaths[e]);-1!=["gif","heic"].indexOf(n)&&o.push(e)}if(o.length>0&&(t.tempFilePaths=t.tempFilePaths.filter((e,t)=>-1==o.indexOf(t)),t.tempFiles&&(t.tempFiles=t.tempFiles.filter((e,t)=>-1!=o.indexOf(t)))),1!=e)for(let e=0,n=t.tempFilePaths.length;e<n;e++)t.tempFilePaths[e]=plus.io.convertLocalFileSystemURL(t.tempFilePaths[e]);n(t)},fail:function(e){i(),o("error","at common/common.js:84","choose image error ---\x3e"+JSON.stringify(e))}})})})},chooseVideo:function(e,t,n=!1,i=15){return new Promise((r,a)=>{let s,l,c=["album","camera"];1==e?(c=["album"],l=b):2==e&&(c=["camera"],l=v),F(l).then(e=>e?uni.chooseVideo({sourceType:c,compressed:!1,maxDuration:i,camera:n?"front":"back"}):(a(),void o("error","at common/common.js:107","choose video permission fail"))).then(e=>{if(o("error","at common/common.js:117","----\x3e uni.chooseVideo "+JSON.stringify(e)),s=JSON.parse(JSON.stringify(e)),s&&s.duration&&parseInt(s.duration)>i){let e=setTimeout(()=>{clearTimeout(e),x(`Video duration cannot exceed ${i} seconds`,3e3)},500);return a(null),k}return s.tempFilePath=s.tempFilePath.replace("file://",""),u&&R(!0)<3617?B(s.tempFilePath):new Promise(e=>{e(null)})}).then(e=>{if(e&&("right"==e.orientation||"left"==e.orientation)){o("error","at common/common.js:138","----\x3e uni.chooseVideo videoInfo "+JSON.stringify(e));let t=s.height,n=s.width;s.width=t,s.height=n}return t?U(s.tempFilePath,s.width,s.height):new Promise(e=>{e(null)})}).then(e=>(o("error","at common/common.js:152","----\x3e uni.chooseVideo coverUrl "+e),s.coverPath=e,r(s))).catch(e=>{o("error","at common/common.js:156","-----\x3e chooseVideo error "+JSON.stringify(e)),a()})})},downloadFile:function(e){return new Promise((t,n)=>{uni.downloadFile({url:e}).then(e=>e&&200==e.statusCode&&e.tempFilePath?uni.saveFile({tempFilePath:e.tempFilePath}):(n(),new Promise(()=>{}))).then(e=>{e&&e.savedFilePath?t(e.savedFilePath):n()}).catch(e=>{o("error","at common/common.js:193","downloadFile error "+JSON.stringify(e))})})},empty:M,getFileInfo:function(e,t="md5"){return new Promise(o=>{uni.getFileInfo({filePath:e,digestAlgorithm:t,success(e){o(e)},fail(){o(null)}})})},getOssPicPath:function(e){return p+e},getUniAppVersion:R,getVideoInfo:B,pendingPromise:k,setGlobalToken:N,setGlobalUid:L,showToast:V,showToastDuration:x,videoCompress:function(e,t){return new Promise((n,i)=>{uni.compressVideo({src:e,quality:t,success(e){o("log","at common/common.js:239","videoCompress res "+JSON.stringify(e)),n(e)},fail(e){o("log","at common/common.js:243","videoCompress error "+JSON.stringify(e)),i("videoCompress "+JSON.stringify(e))}})})}},Symbol.toStringTag,{value:"Module"})),H={parseData(){let e=uni.getWindowInfo();getApp().globalData.window={width:e.screenWidth,height:e.screenHeight,statusBarHeight:e.statusBarHeight,navBarHeight:44,safeTop:e.safeAreaInsets.top,safeBottom:e.safeAreaInsets.bottom};let t=uni.getDeviceInfo(),n=[u?"a":"i",t.system||"0",plus.runtime.version,s,"function"==typeof getApp().globalData.toolModule.getDeviceId?getApp().globalData.toolModule.getDeviceId():uni.getDeviceInfo().deviceId,g(),A(),u?plus.runtime.channel||"www":"appstore","en,"+E,e.screenWidth||"0",e.screenHeight||"0",t.brand||"0",t.deviceModel||"0",c];getApp().globalData.ua=n.join("|"),o("error","at comApp/init.js:35","---- api ua = "+getApp().globalData.ua)}};function E(e){let t=uni.getAppBaseInfo().language;return M(t)?e?"en-US":"en":e?t:t.split("-")[0]}var J=0;function $(e){return function(e){for(var t,o=J?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<e.length;i++)t=e.charCodeAt(i),n+=o.charAt(t>>>4&15)+o.charAt(15&t);return n}(function(e){return function(e){for(var t="",o=0;o<32*e.length;o+=8)t+=String.fromCharCode(e[o>>5]>>>o%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var o=1732584193,n=-271733879,i=-1732584194,r=271733878,a=0;a<e.length;a+=16){var s=o,l=n,u=i,c=r;o=G(o,n,i,r,e[a+0],7,-680876936),r=G(r,o,n,i,e[a+1],12,-389564586),i=G(i,r,o,n,e[a+2],17,606105819),n=G(n,i,r,o,e[a+3],22,-1044525330),o=G(o,n,i,r,e[a+4],7,-176418897),r=G(r,o,n,i,e[a+5],12,1200080426),i=G(i,r,o,n,e[a+6],17,-1473231341),n=G(n,i,r,o,e[a+7],22,-45705983),o=G(o,n,i,r,e[a+8],7,1770035416),r=G(r,o,n,i,e[a+9],12,-1958414417),i=G(i,r,o,n,e[a+10],17,-42063),n=G(n,i,r,o,e[a+11],22,-1990404162),o=G(o,n,i,r,e[a+12],7,1804603682),r=G(r,o,n,i,e[a+13],12,-40341101),i=G(i,r,o,n,e[a+14],17,-1502002290),o=W(o,n=G(n,i,r,o,e[a+15],22,1236535329),i,r,e[a+1],5,-165796510),r=W(r,o,n,i,e[a+6],9,-1069501632),i=W(i,r,o,n,e[a+11],14,643717713),n=W(n,i,r,o,e[a+0],20,-373897302),o=W(o,n,i,r,e[a+5],5,-701558691),r=W(r,o,n,i,e[a+10],9,38016083),i=W(i,r,o,n,e[a+15],14,-660478335),n=W(n,i,r,o,e[a+4],20,-405537848),o=W(o,n,i,r,e[a+9],5,568446438),r=W(r,o,n,i,e[a+14],9,-1019803690),i=W(i,r,o,n,e[a+3],14,-187363961),n=W(n,i,r,o,e[a+8],20,1163531501),o=W(o,n,i,r,e[a+13],5,-1444681467),r=W(r,o,n,i,e[a+2],9,-51403784),i=W(i,r,o,n,e[a+7],14,1735328473),o=Z(o,n=W(n,i,r,o,e[a+12],20,-1926607734),i,r,e[a+5],4,-378558),r=Z(r,o,n,i,e[a+8],11,-2022574463),i=Z(i,r,o,n,e[a+11],16,1839030562),n=Z(n,i,r,o,e[a+14],23,-35309556),o=Z(o,n,i,r,e[a+1],4,-1530992060),r=Z(r,o,n,i,e[a+4],11,1272893353),i=Z(i,r,o,n,e[a+7],16,-155497632),n=Z(n,i,r,o,e[a+10],23,-1094730640),o=Z(o,n,i,r,e[a+13],4,681279174),r=Z(r,o,n,i,e[a+0],11,-358537222),i=Z(i,r,o,n,e[a+3],16,-722521979),n=Z(n,i,r,o,e[a+6],23,76029189),o=Z(o,n,i,r,e[a+9],4,-640364487),r=Z(r,o,n,i,e[a+12],11,-421815835),i=Z(i,r,o,n,e[a+15],16,530742520),o=K(o,n=Z(n,i,r,o,e[a+2],23,-995338651),i,r,e[a+0],6,-198630844),r=K(r,o,n,i,e[a+7],10,1126891415),i=K(i,r,o,n,e[a+14],15,-1416354905),n=K(n,i,r,o,e[a+5],21,-57434055),o=K(o,n,i,r,e[a+12],6,1700485571),r=K(r,o,n,i,e[a+3],10,-1894986606),i=K(i,r,o,n,e[a+10],15,-1051523),n=K(n,i,r,o,e[a+1],21,-2054922799),o=K(o,n,i,r,e[a+8],6,1873313359),r=K(r,o,n,i,e[a+15],10,-30611744),i=K(i,r,o,n,e[a+6],15,-1560198380),n=K(n,i,r,o,e[a+13],21,1309151649),o=K(o,n,i,r,e[a+4],6,-145523070),r=K(r,o,n,i,e[a+11],10,-1120210379),i=K(i,r,o,n,e[a+2],15,718787259),n=K(n,i,r,o,e[a+9],21,-343485551),o=Q(o,s),n=Q(n,l),i=Q(i,u),r=Q(r,c)}return Array(o,n,i,r)}(function(e){for(var t=Array(e.length>>2),o=0;o<t.length;o++)t[o]=0;for(o=0;o<8*e.length;o+=8)t[o>>5]|=(255&e.charCodeAt(o/8))<<o%32;return t}(e),8*e.length))}(function(e){var t,o,n="",i=-1;for(;++i<e.length;)t=e.charCodeAt(i),o=i+1<e.length?e.charCodeAt(i+1):0,55296<=t&&t<=56319&&56320<=o&&o<=57343&&(t=65536+((1023&t)<<10)+(1023&o),i++),t<=127?n+=String.fromCharCode(t):t<=2047?n+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n}(e)))}function z(e,t,o,n,i,r){return Q((a=Q(Q(t,e),Q(n,r)))<<(s=i)|a>>>32-s,o);var a,s}function G(e,t,o,n,i,r,a){return z(t&o|~t&n,e,t,i,r,a)}function W(e,t,o,n,i,r,a){return z(t&n|o&~n,e,t,i,r,a)}function Z(e,t,o,n,i,r,a){return z(t^o^n,e,t,i,r,a)}function K(e,t,o,n,i,r,a){return z(o^(t|~n),e,t,i,r,a)}function Q(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o}const X=function(e){return $(e)},Y={request:(e,t,n,i,r=!1)=>new Promise((a,s)=>{let l=!1;l=getApp().globalData.token;let u={"content-type":"application/json",ua:getApp().globalData.ua};l&&(u.Authorization="Bearer "+l);let c=getApp().globalData.apiHost;t.nonce=X(Math.random().toString(36).substr(2)+(new Date).getTime());let p=function(e){try{M(e)&&(e={}),e.times=(new Date).getTime();let t=Object.keys(e).sort(),o={};for(let i=0,r=t.length;i<r;i++)o[t[i]]=e[t[i]];let n=function e(t,o){if(null==t)return"";try{let n="",i=typeof t;if("string"==i||"number"==i)n+="&"+o+"="+encodeURIComponent(t).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}));else if("boolean"==i)n+="&"+o+"="+(t?1:0);else for(let r in t){let i=null==o?r:o+ee(r);n+=e(t[r],i)}return n}catch(n){return""}}(o).substr(1);return o.sign=X(`${X(n)}${d}`),o}catch(t){return e}}(t);uni.request({url:c+e,method:"POST",header:u,data:p,dataType:"json",timeout:1e4,async complete(l){if(o("log","at common/api.js:28","response000000=======response=======",l),n&&uni.hideLoading(),o("log","at common/api.js:30",`request ${e} obj ${JSON.stringify(t)}`),200==l.statusCode){let o=l.data;if(M(o.msg)||V(o.msg),99===o.ok){await getApp().createUser();let o=await Y.request(e,t,n,i,r);return void a(o)}if(o.ok>0)return void a(o);i&&s(o)}else{if(!i)return k;s(l)}},fail(e){o("error","at common/api.js:54","api fail ",e)}})})};function ee(e){return`${encodeURIComponent("[")}${e}${encodeURIComponent("]")}`}let te=t("ToolModule"),oe=t("ImageBrowserModule"),ne=t("AudioModule");const ie={globalData:{uid:"",token:"",apiHost:"",window:"",ua:"",toolModule:te,ossPicPath:p,ossPath:m,previewModule:oe,audioModule:ne,picCacheObj:{}},methods:{getAppFilePath:(e,t)=>"function"!=typeof te.getFilePath?"":te.getFilePath({is_vue:t,file_name:e,doc:plus.io.convertLocalFileSystemURL("_doc")}),createUser:()=>new Promise((e,t)=>{Y.request("/user/create",{uniq_uid:"",avatar:""}).then(o=>{o.data.token||t(!1),N(o.data.token),L(o.data.user_info.uid),e(!0)})})},onLaunch:function(){o("log","at App.vue:49","App Launch begin"),this.globalData.toolModule=te,this.globalData.apiHost=l,H.parseData(),o("log","at App.vue:53","App Launch end")},onShow:function(){},onHide:function(){}};const{app:re,Vuex:ae,Pinia:se}=function(){const t=e.createVueApp(ie);return t.config.globalProperties.$api=Y,t.config.globalProperties.$com=q,{app:t}}();uni.Vuex=ae,uni.Pinia=se,re.provide("__globalStyles",__uniConfig.styles),re._component.mpType="app",re._component.render=()=>{},re.mount("#app")}(Vue);
