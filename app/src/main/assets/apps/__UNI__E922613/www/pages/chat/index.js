"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var et=Object.create;var Q=Object.defineProperty,tt=Object.defineProperties,it=Object.getOwnPropertyDescriptor,st=Object.getOwnPropertyDescriptors,nt=Object.getOwnPropertyNames,Ae=Object.getOwnPropertySymbols,rt=Object.getPrototypeOf,ke=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var xe=(e,t,i)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,X=(e,t)=>{for(var i in t||(t={}))ke.call(t,i)&&xe(e,i,t[i]);if(Ae)for(var i of Ae(t))ot.call(t,i)&&xe(e,i,t[i]);return e},_e=(e,t)=>tt(e,st(t));var at=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var lt=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of nt(t))!ke.call(e,s)&&s!==i&&Q(e,s,{get:()=>t[s],enumerable:!(n=it(t,s))||n.enumerable});return e};var Ce=(e,t,i)=>(i=e!=null?et(rt(e)):{},lt(t||!e||!e.__esModule?Q(i,"default",{value:e,enumerable:!0}):i,e));var P=(e,t,i)=>new Promise((n,s)=>{var o=l=>{try{c(i.next(l))}catch(d){s(d)}},a=l=>{try{c(i.throw(l))}catch(d){s(d)}},c=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,a);c((i=i.apply(e,t)).next())});var q=at((Cs,ve)=>{ve.exports=Vue});var r=Ce(q());var y=Ce(q());var k=(e,t)=>{let i=e.__vccOpts||e;for(let[n,s]of t)i[n]=s;return i},ct=e=>typeof e=="string";function R(e){return weex.requireModule(e)}function x(e,t,...i){uni.__log__?uni.__log__(e,t,...i):console[e].apply(console,[...i,t])}function V(e,t){return ct(e)?t:e}function w(e){return e==null||e==""||typeof e=="undefined"}function ut(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function W(e,t){let i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,RegExp.$1.length==1?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t}function dt(e){return e=parseInt(e),e.toString().length==16?e=Math.round(e/1e3):e<1e10&&(e=e*1e3),e}function Se(e,t=!0,i=!1){if(w(e))return"";e=dt(e);let n=new Date,s=new Date(e),o=n.getFullYear(),a=n.getMonth()+1,c=n.getDate(),l=s.getFullYear(),d=s.getMonth()+1,u=s.getDate(),p="",f=t?" "+W(s,"hh:mm"):"";if(o==l){let T=n.getTime()-e;if(a==d&&c==u)T<60*1e3&&!t?p="Just":p=`Today ${W(s,"hh:mm")}`;else{let M=new Date;M.setDate(M.getDate()-1);let we=new Date;if(we.setDate(we.getDate()-2),d==M.getMonth()+1&&u==M.getDate())p=`Yesterday ${f}`;else{var g=T/36e5;if(g<=7*24){let E=new Array(7),B=i?"Short":"";E[0]=`Sunday ${B}`,E[1]=`Monday ${B}`,E[2]=`Tuesday ${B}`,E[3]=`Wednesday ${B}`,E[4]=`Thursday ${B}`,E[5]=`Friday ${B}`,E[6]=`Saturday ${B}`;var L=E[s.getDay()];p=L+" "+f}else p=W(s,"M/d")+f}}}else p=W(s,"M/d")+f;return p}function ht(e){if(w(e))return"";let t=e.split("/");if(w(t))return"";let i=t[t.length-1];if(w(i))return"";let n=i.split(".");if(w(n))return"";let s=n[n.length-1];return w(s)?"":s.toLowerCase()}function ne(e,t,i=1e4){return e<=0||t<=0?[108,192]:(t>e?(t=t*108/e,t>i&&(t=i),e=108):(t=t*148/e,e=148),[e,t])}var ee={};function re(e,t=500,i="throttle"){let n=e.name;w(n)&&(n=i),!ee[n]&&(ee[n]=!0,e(),setTimeout(function(){ee[n]=""},t))}function oe(){return Math.random().toString(36).substr(2)}function ae(e,t,i){return Math.abs(e-t)>i*60*1e3}function le(e){if(!e)return"";let t=JSON.stringify(e);return(typeof t!="string"||t=="{}")&&(t=e.toString()),t}function H(e,t=!1){if(w(e)||e<0||isNaN(e))return t?"00:00:00":"00:00";var i=0,n=0;e>0&&e<10?e="0"+parseInt(e):e<=0?e="00":e>60&&(i=parseInt(e/60)<10?"0"+parseInt(e/60):parseInt(e/60),e=parseInt(e%60)<10?"0"+parseInt(e%60):parseInt(e%60),i>60&&(n=parseInt(i/60)<10?"0"+parseInt(i/60):parseInt(i/60),i=parseInt(i%60)<10?"0"+parseInt(i%60):parseInt(i%60)));var s;return n>0?s=n+":"+i+":"+e:i>0?(s=i+":"+e,t&&(s="00:"+s)):(s="00:"+e,t&&(s="00:"+s)),s}var pt="dev",Te,Ie,Le,De;Te="https://bts.267girl.com",Ie="https://pic3.candychat.link/",De="https://pic2.candychat.link/",Le="1b28c2eac0672761";var m={wv:"1.0.2",ENV:pt,apiHost:Te,isAndroid:plus.os.name=="Android",ossPicPath:Ie,ossPath:De,key:Le,PHOTO:1,VIDEO:2,appV:parseInt(plus.runtime.version.split(".").join("")),M_TXT:1,M_IMG:3,M_VIDEO:4,M_VOICE:2,M_HUNG_UP:5};function mt(e){getApp().globalData.toolModule.permissionOpenSetting({permission:e})}function gt(e){return getApp().globalData.toolModule.permissionStatusSync({permission:e})}function ft(e){return new Promise(t=>{getApp().globalData.toolModule.permissionRequest({permission:e},i=>{t(i)})})}var A={ALBUM:1,CAMERA:2,VIDEO:3,MICROPHONE:4,ALBUM_AND_CAMERA:101},S={GRANTED:1,DENIED:0,DENIED_ALWAYS:-1};function yt(e){switch(e){case A.ALBUM:case A.VIDEO:return bt;case A.MICROPHONE:return St;case A.CAMERA:return It}}function U(e,t=!0,i=!0){return new Promise(n=>{let s=function(o){o==S.GRANTED?n(!0):(o==S.DENIED||o==S.DENIED_ALWAYS&&i&&xt(e),n(!1))};if(m.isAndroid){let o=ce(e);ft(o).then(s)}else yt(e)(!0).then(s)})}function Pe(e){return e==A.MICROPHONE?m.isAndroid?Ct(e):Tt():!0}function ce(e){switch(e){case A.ALBUM:case A.VIDEO:return["android.permission.READ_MEDIA_IMAGES","android.permission.READ_MEDIA_VIDEO"];case A.MICROPHONE:return["android.permission.RECORD_AUDIO"];case A.CAMERA:return["android.permission.CAMERA"]}}function wt(e){if(w(e)){_t();return}mt(e)}function At(e){if(m.isAndroid){let t=ce(e);wt(t)}else vt()}function xt(e,t){uni.showModal({title:"Tips",content:kt(e),showCancel:!0,cancelText:"Cancel",confirmText:"To turn on",complete(i){i.confirm?(At(e),typeof t=="function"&&t(!0)):i.cancel&&typeof t=="function"&&t(!1)}})}function kt(e){let t="App";switch(e){case A.ALBUM:case A.VIDEO:return`Turn on the read and write permissions for ${t} in the application management to use the album function normally`;case A.MICROPHONE:return`In the application management, enable the microphone permission for ${t} to use the voice function normally`;case A.CAMERA:return`In the application management, enable the camera permission for ${t} to use the camera function normally`}}function _t(){var e=plus.android.importClass("android.content.Intent"),t=plus.android.importClass("android.provider.Settings"),i=plus.android.importClass("android.net.Uri"),n=plus.android.runtimeMainActivity(),s=new e;s.setAction(t.ACTION_APPLICATION_DETAILS_SETTINGS);var o=i.fromParts("package",n.getPackageName(),null);s.setData(o),n.startActivity(s)}function Ct(e){let t=ce(e);return gt(t)}function vt(){var e=plus.ios.import("UIApplication"),t=e.sharedApplication(),i=plus.ios.import("NSURL"),n=i.URLWithString("app-settings:");t.openURL(n),plus.ios.deleteObject(n),plus.ios.deleteObject(i),plus.ios.deleteObject(t)}function bt(){return new Promise(e=>{let t=plus.ios.import("PHPhotoLibrary"),i=t.authorizationStatus();i==3||i==4?(plus.ios.deleteObject(t),e(S.GRANTED)):i==0?plus.ios.invoke("PHPhotoLibrary","requestAuthorization:",function(){plus.ios.deleteObject(t),e(S.DENIED)}):(plus.ios.deleteObject(t),e(S.DENIED_ALWAYS))})}function St(e){return new Promise(t=>{let i=plus.ios.importClass("AVCaptureDevice"),n=i.authorizationStatusForMediaType("soun");n==3?(plus.ios.deleteObject(i),t(S.GRANTED)):n==0?plus.ios.invoke("AVCaptureDevice","requestAccessForMediaType:completionHandler:","soun",function(){if(e){let s=i.authorizationStatusForMediaType("soun");plus.ios.deleteObject(i),t(s==3?S.GRANTED:S.DENIED)}else plus.ios.deleteObject(i),t(S.DENIED)}):(plus.ios.deleteObject(i),t(S.DENIED_ALWAYS))})}function Tt(){let e=plus.ios.importClass("AVCaptureDevice"),t=e.authorizationStatusForMediaType("soun");return plus.ios.deleteObject(e),t==3}function It(e){return new Promise(t=>{let i=plus.ios.importClass("AVCaptureDevice"),n=i.authorizationStatusForMediaType("vide");n==3?(plus.ios.deleteObject(i),t(S.GRANTED)):n==0?plus.ios.invoke("AVCaptureDevice","requestAccessForMediaType:completionHandler:","vide",function(){if(e){let s=i.authorizationStatusForMediaType("vide");plus.ios.deleteObject(i),t(s==3?S.GRANTED:S.DENIED)}else plus.ios.deleteObject(i),t(S.DENIED)}):(plus.ios.deleteObject(i),t(S.DENIED_ALWAYS))})}function te(e,t=!0){return e.startsWith("http")?e:e.startsWith("file://")?t?e:e.replace("file://",""):e.startsWith("/storage/")||e.startsWith("/var/mobile/")?t?`file://${e}`:e:e.startsWith("_doc/uniapp")?t?e:plus.io.convertLocalFileSystemURL(e):e.indexOf("apps/__UNI")!=-1?e:!1}function Me(e,t,i=1){getApp().globalData.filterAppHide=!0,re(function(){let n=JSON.parse(JSON.stringify(e));getApp().globalData.previewModule.openBrowser({info:n,index:t,show_report:i},s=>{})},500,"previewImage")}function Ee(e,t){let i=e.msg_type==m.M_VIDEO,n;if(i){let s=t.small_url||t.cover_url||t.cover,o=t.cover_url||t.cover,a=t.url;a.startsWith("_doc")&&(a=plus.io.convertLocalFileSystemURL(a)),n=be(!0,s,a,o)}else{let s=t.small_url||t.image_url;n=be(!1,s,t.image_url)}return n}function be(e,t,i,n="1",s=0,o=0){let a,c=te(t,!1);c?a=c:a=m.ossPicPath+t;let l=te(i,!1)||`${getApp().globalData.ossPath}${i}`,d=e?te(n,!1)||`${getApp().globalData.ossPicPath}${n}`:n;return{isVideo:e,thumbnailUrl:a||"",url:l,coverUrl:d,width:s,height:o}}function ue(e,t,i){return new Promise(n=>{let s=e;s.startsWith("_doc")&&(s=plus.io.convertLocalFileSystemURL(s)),getApp().globalData.previewModule.getVideoCover({url:s,width:t,height:i},o=>{Lt(`getVideoCover ${o}`),n(o)})})}function Lt(e,t){x("error","at comExtend/preview-media.js:74",`preview media ${e}`,t)}function Dt(e,t="none",i="center"){uni.showToast({title:e,duration:2e3,icon:t,position:i})}var Fe=new Promise(()=>{});function Oe(e,t=1){return new Promise((i,n)=>{let s=["album","camera"],o,a=["compressed"];e==1?(s=["album"],o=A.ALBUM):e==2?(s=["camera"],o=A.CAMERA):e==0&&(o=A.ALBUM_AND_CAMERA),U(o).then(c=>{if(!c){n();return}getApp().globalData.filterAppHide=!0,uni.chooseImage({count:t,sourceType:s,sizeType:a,crop:{},success:function(l){let d=[];for(let u=0,p=l.tempFilePaths.length;u<p;u++){let f=l.tempFilePaths[u],g=ht(f);["gif","heic"].indexOf(g)!=-1&&d.push(u)}if(d.length>0&&(l.tempFilePaths=l.tempFilePaths.filter((u,p)=>d.indexOf(p)==-1),l.tempFiles&&(l.tempFiles=l.tempFiles.filter((u,p)=>d.indexOf(p)!=-1))),e!=1)for(let u=0,p=l.tempFilePaths.length;u<p;u++)l.tempFilePaths[u]=plus.io.convertLocalFileSystemURL(l.tempFilePaths[u]);i(l)},fail:function(l){n()}})})})}function Be(e,t,i=!1,n=15){return new Promise((s,o)=>{let a,c=["album","camera"],l;e==1?(c=["album"],l=A.VIDEO):e==2&&(c=["camera"],l=A.CAMERA),U(l).then(d=>{if(!d){o();return}return getApp().globalData.filterAppHide=!0,uni.chooseVideo({sourceType:c,compressed:!1,maxDuration:n,camera:i?"front":"back"})}).then(d=>{if(x("error","at common/common.js:121","----> uni.chooseVideo "+JSON.stringify(d)),a=JSON.parse(JSON.stringify(d)),a&&a.duration&&parseInt(a.duration)>n){let u=setTimeout(()=>{clearTimeout(u),Pt(`Video duration cannot exceed ${n} seconds`,3e3)},500);return o(null),Fe}return a.tempFilePath=a.tempFilePath.replace("file://",""),m.isAndroid&&Mt(!0)<3617?he(a.tempFilePath):new Promise(u=>{u(null)})}).then(d=>{if(d&&(d.orientation=="right"||d.orientation=="left")){x("error","at common/common.js:142","----> uni.chooseVideo videoInfo "+JSON.stringify(d));let u=a.height,p=a.width;a.width=u,a.height=p}return t?ue(a.tempFilePath,a.width,a.height):new Promise(u=>{u(null)})}).then(d=>(x("error","at common/common.js:156","----> uni.chooseVideo coverUrl "+d),a.coverPath=d,s(a))).catch(d=>{x("error","at common/common.js:160","-----> chooseVideo error "+le(d)),o()})})}function de(e,t="md5"){return new Promise(i=>{uni.getFileInfo({filePath:e,digestAlgorithm:t,success(n){i(n)},fail(){i(null)}})})}function Pt(e,t){uni.showToast({title:e,duration:t,icon:"none",position:"center"})}function Mt(e){let t=uni.getSystemInfoSync().uniRuntimeVersion;if(!e)return t;let i=t.split("."),n=i[i.length-1];n.length<=1&&(i[i.length-1]=n+"0");let s=i.join("");return Number(s)}function he(e){return new Promise(t=>{plus.io.getVideoInfo({filePath:e,success(i){t(i)},fail(i){t(`getVideoInfo ${JSON.stringify(i)}`)}})})}function Re(e,t){return new Promise((i,n)=>{uni.compressVideo({src:e,quality:t,success(s){x("log","at common/common.js:239","videoCompress res "+JSON.stringify(s)),i(s)},fail(s){x("log","at common/common.js:243","videoCompress error "+JSON.stringify(s)),n(`videoCompress ${JSON.stringify(s)}`)}})})}var ie=0;function Et(e){return Ot(Ft(Bt(e)))}function Ft(e){return Nt(Vt(Rt(e),e.length*8))}function Ot(e){try{}catch(o){ie=0}for(var t=ie?"0123456789ABCDEF":"0123456789abcdef",i="",n,s=0;s<e.length;s++)n=e.charCodeAt(s),i+=t.charAt(n>>>4&15)+t.charAt(n&15);return i}function Bt(e){for(var t="",i=-1,n,s;++i<e.length;)n=e.charCodeAt(i),s=i+1<e.length?e.charCodeAt(i+1):0,55296<=n&&n<=56319&&56320<=s&&s<=57343&&(n=65536+((n&1023)<<10)+(s&1023),i++),n<=127?t+=String.fromCharCode(n):n<=2047?t+=String.fromCharCode(192|n>>>6&31,128|n&63):n<=65535?t+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|n&63):n<=2097151&&(t+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|n&63));return t}function Rt(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(var i=0;i<e.length*8;i+=8)t[i>>5]|=(e.charCodeAt(i/8)&255)<<i%32;return t}function Nt(e){for(var t="",i=0;i<e.length*32;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function Vt(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var i=1732584193,n=-271733879,s=-1732584194,o=271733878,a=0;a<e.length;a+=16){var c=i,l=n,d=s,u=o;i=_(i,n,s,o,e[a+0],7,-680876936),o=_(o,i,n,s,e[a+1],12,-389564586),s=_(s,o,i,n,e[a+2],17,606105819),n=_(n,s,o,i,e[a+3],22,-1044525330),i=_(i,n,s,o,e[a+4],7,-176418897),o=_(o,i,n,s,e[a+5],12,1200080426),s=_(s,o,i,n,e[a+6],17,-1473231341),n=_(n,s,o,i,e[a+7],22,-45705983),i=_(i,n,s,o,e[a+8],7,1770035416),o=_(o,i,n,s,e[a+9],12,-1958414417),s=_(s,o,i,n,e[a+10],17,-42063),n=_(n,s,o,i,e[a+11],22,-1990404162),i=_(i,n,s,o,e[a+12],7,1804603682),o=_(o,i,n,s,e[a+13],12,-40341101),s=_(s,o,i,n,e[a+14],17,-1502002290),n=_(n,s,o,i,e[a+15],22,1236535329),i=C(i,n,s,o,e[a+1],5,-165796510),o=C(o,i,n,s,e[a+6],9,-1069501632),s=C(s,o,i,n,e[a+11],14,643717713),n=C(n,s,o,i,e[a+0],20,-373897302),i=C(i,n,s,o,e[a+5],5,-701558691),o=C(o,i,n,s,e[a+10],9,38016083),s=C(s,o,i,n,e[a+15],14,-660478335),n=C(n,s,o,i,e[a+4],20,-405537848),i=C(i,n,s,o,e[a+9],5,568446438),o=C(o,i,n,s,e[a+14],9,-1019803690),s=C(s,o,i,n,e[a+3],14,-187363961),n=C(n,s,o,i,e[a+8],20,1163531501),i=C(i,n,s,o,e[a+13],5,-1444681467),o=C(o,i,n,s,e[a+2],9,-51403784),s=C(s,o,i,n,e[a+7],14,1735328473),n=C(n,s,o,i,e[a+12],20,-1926607734),i=v(i,n,s,o,e[a+5],4,-378558),o=v(o,i,n,s,e[a+8],11,-2022574463),s=v(s,o,i,n,e[a+11],16,1839030562),n=v(n,s,o,i,e[a+14],23,-35309556),i=v(i,n,s,o,e[a+1],4,-1530992060),o=v(o,i,n,s,e[a+4],11,1272893353),s=v(s,o,i,n,e[a+7],16,-155497632),n=v(n,s,o,i,e[a+10],23,-1094730640),i=v(i,n,s,o,e[a+13],4,681279174),o=v(o,i,n,s,e[a+0],11,-358537222),s=v(s,o,i,n,e[a+3],16,-722521979),n=v(n,s,o,i,e[a+6],23,76029189),i=v(i,n,s,o,e[a+9],4,-640364487),o=v(o,i,n,s,e[a+12],11,-421815835),s=v(s,o,i,n,e[a+15],16,530742520),n=v(n,s,o,i,e[a+2],23,-995338651),i=b(i,n,s,o,e[a+0],6,-198630844),o=b(o,i,n,s,e[a+7],10,1126891415),s=b(s,o,i,n,e[a+14],15,-1416354905),n=b(n,s,o,i,e[a+5],21,-57434055),i=b(i,n,s,o,e[a+12],6,1700485571),o=b(o,i,n,s,e[a+3],10,-1894986606),s=b(s,o,i,n,e[a+10],15,-1051523),n=b(n,s,o,i,e[a+1],21,-2054922799),i=b(i,n,s,o,e[a+8],6,1873313359),o=b(o,i,n,s,e[a+15],10,-30611744),s=b(s,o,i,n,e[a+6],15,-1560198380),n=b(n,s,o,i,e[a+13],21,1309151649),i=b(i,n,s,o,e[a+4],6,-145523070),o=b(o,i,n,s,e[a+11],10,-1120210379),s=b(s,o,i,n,e[a+2],15,718787259),n=b(n,s,o,i,e[a+9],21,-343485551),i=F(i,c),n=F(n,l),s=F(s,d),o=F(o,u)}return Array(i,n,s,o)}function G(e,t,i,n,s,o){return F(Ht(F(F(t,e),F(n,o)),s),i)}function _(e,t,i,n,s,o,a){return G(t&i|~t&n,e,t,s,o,a)}function C(e,t,i,n,s,o,a){return G(t&n|i&~n,e,t,s,o,a)}function v(e,t,i,n,s,o,a){return G(t^i^n,e,t,s,o,a)}function b(e,t,i,n,s,o,a){return G(i^(t|~n),e,t,s,o,a)}function F(e,t){var i=(e&65535)+(t&65535),n=(e>>16)+(t>>16)+(i>>16);return n<<16|i&65535}function Ht(e,t){return e<<t|e>>>32-t}var se={md5:function(e){return Et(e)}},O={request(e,t,i,n,s=!1){return new Promise((o,a)=>{let c=!1;c=getApp().globalData.token;let l={"content-type":"application/json",ua:getApp().globalData.ua};c&&(l.Authorization=`Bearer ${c}`);let d=getApp().globalData.apiHost;t.nonce=se.md5(oe()+new Date().getTime());let u=jt(t);uni.request({url:d+e,method:"POST",header:l,data:u,dataType:"json",timeout:1e4,complete(f){return P(this,null,function*(){if(i&&uni.hideLoading(),f.statusCode==200){let g=f.data;if(w(g.msg)||Dt(g.msg),g.ok===99){yield getApp().createUser();let L=yield O.request(e,t,i,n,s);o(L);return}if(g.ok>0){o(g);return}n&&a(g)}else if(n)a(f);else return Fe})},fail(f){}})})}};function jt(e){try{w(e)&&(e={}),e.times=new Date().getTime();let t=Object.keys(e).sort(),i={};for(let s=0,o=t.length;s<o;s++)i[t[s]]=e[t[s]];let n=Ne(i).substr(1);return i.sign=se.md5(`${se.md5(n)}${m.key}`),i}catch(t){return e}}function Ne(e,t){if(e==null)return"";try{let i="",n=typeof e;if(n=="string"||n=="number")i+="&"+t+"="+ut(e);else if(n=="boolean")i+="&"+t+"="+(e?1:0);else for(let s in e){let o=t==null?s:t+zt(s);i+=Ne(e[s],o)}return i}catch(i){return""}}function zt(e){return`${encodeURIComponent("[")}${e}${encodeURIComponent("]")}`}var Ve={SUCCESS:0,FAIL:1,USER_DEL:4};var Wt={"l-img":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"place-img":{"":{position:"absolute",top:0,left:0}},"text-place":{"":{color:"#ffffff",position:"absolute",bottom:"0rpx",textAlign:"center"}}},Ut={name:"LImg",props:{src:{type:String,default:""},mode:{type:String,default:"aspectFill"},w:{type:String,default:"0"},h:{type:String,default:"0"},placeW:{type:String,default:"0"},placeFontSize:{type:[String,Boolean],default:""},radius:{type:String,default:"0"},lazyLoad:{type:Boolean,default:!1},fade:{type:Boolean,default:!0},border:{type:String,default:""},otherStyle:{type:Object,default(){return{}}},click:{type:Boolean,default:!0},useNativePic:{type:Boolean,default:!0}},data(){return{isLoad:!1,placeSrc:"/static/img_load_s.png",path:""}},watch:{src(){this.isLoad=!1,this.path=this.parse()}},computed:{viewStyle(){let e={width:this.w,height:this.h};return this.setRadius(e)},imgStyle(){let e={width:this.w,height:this.h};return e=Object.assign(e,this.otherStyle),this.setRadius(e)},borderStyle(){return this.border?{border:this.border}:{}},placeViewStyle(){return{width:this.placeW,height:this.placeW,position:"relative"}},placeFontSizeVal(){return this.placeFontSize===!1?"":this.placeFontSize?this.placeFontSize:"16rpx"}},methods:{clickImg(e){this.$emit("click",e)},setRadius(e){let t=this.radius.split(" ");return t.length<=1?e.borderRadius=this.radius:(e.borderTopLeftRadius=t[0],e.borderTopRightRadius=t[1],e.borderBottomRightRadius=t[2],e.borderBottomLeftRadius=t[3]),e},onLoad(){this.path&&(this.isLoad=!0,this.$emit("onLoad"))},parse(){return this.src?this.useNativePic?this.src:this.src.startsWith("file://")?this.src:this.src.startsWith("/var/mobile/")?"file://"+this.src:this.src.startsWith("/storage/")?this.src:this.src.startsWith("https")?this.src:this.useNativePic?this.src:m.ossPicPath+this.src:""}},created(){this.path=this.parse()}};function Gt(e,t,i,n,s,o){return(0,y.openBlock)(),(0,y.createElementBlock)("view",{class:"l-img",onClick:t[1]||(t[1]=(...a)=>o.clickImg&&o.clickImg(...a)),style:(0,y.normalizeStyle)([o.viewStyle,o.borderStyle]),renderWhole:!0},[(0,y.createElementVNode)("view",{class:"l-img",style:(0,y.normalizeStyle)([{position:"relative"},o.viewStyle])},[s.isLoad?(0,y.createCommentVNode)("",!0):((0,y.openBlock)(),(0,y.createElementBlock)("view",{key:0,style:(0,y.normalizeStyle)(o.placeViewStyle)},[(0,y.createElementVNode)("u-image",{src:s.placeSrc,style:(0,y.normalizeStyle)({width:i.placeW,height:i.placeW})},null,12,["src"]),o.placeFontSizeVal?((0,y.openBlock)(),(0,y.createElementBlock)("u-text",{key:0,class:"text-place",style:(0,y.normalizeStyle)({fontSize:o.placeFontSizeVal,width:i.placeW})},"Loading...",4)):(0,y.createCommentVNode)("",!0)],4)),(0,y.createElementVNode)("u-image",{onLoad:t[0]||(t[0]=(...a)=>o.onLoad&&o.onLoad(...a)),src:s.path,mode:i.mode,lazyLoad:i.lazyLoad,fadeShow:i.fade,style:(0,y.normalizeStyle)([o.imgStyle,o.borderStyle]),class:"place-img"},null,44,["src","mode","lazyLoad","fadeShow"])],4)],4)}var D=k(Ut,[["render",Gt],["styles",[Wt]]]);var Jt=e=>e!==null&&typeof e=="object",Yt=["{","}"],ge=class{constructor(){this._caches=Object.create(null)}interpolate(t,i,n=Yt){if(!i)return[t];let s=this._caches[t];return s||(s=Kt(t,n),this._caches[t]=s),Qt(s,i)}},Zt=/^(?:\d)+/,$t=/^(?:\w)+/;function Kt(e,[t,i]){let n=[],s=0,o="";for(;s<e.length;){let a=e[s++];if(a===t){o&&n.push({type:"text",value:o}),o="";let c="";for(a=e[s++];a!==void 0&&a!==i;)c+=a,a=e[s++];let l=a===i,d=Zt.test(c)?"list":l&&$t.test(c)?"named":"unknown";n.push({value:c,type:d})}else o+=a}return o&&n.push({type:"text",value:o}),n}function Qt(e,t){let i=[],n=0,s=Array.isArray(t)?"list":Jt(t)?"named":"unknown";if(s==="unknown")return i;for(;n<e.length;){let o=e[n];switch(o.type){case"text":i.push(o.value);break;case"list":i.push(t[parseInt(o.value,10)]);break;case"named":s==="named"&&i.push(t[o.value]);break}n++}return i}var pe="zh-Hans",He="zh-Hant",N="en",Xt="fr",qt="es",ei=Object.prototype.hasOwnProperty,je=(e,t)=>ei.call(e,t),ti=new ge;function ii(e,t){return!!t.find(i=>e.indexOf(i)!==-1)}function si(e,t){return t.find(i=>e.indexOf(i)===0)}function ze(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if(e=e.toLowerCase(),e==="chinese")return pe;if(e.indexOf("zh")===0)return e.indexOf("-hans")>-1?pe:e.indexOf("-hant")>-1||ii(e,["-tw","-hk","-mo","-cht"])?He:pe;let i=[N,Xt,qt];t&&Object.keys(t).length>0&&(i=Object.keys(t));let n=si(e,i);if(n)return n}var fe=class{constructor({locale:t,fallbackLocale:i,messages:n,watcher:s,formater:o}){this.locale=N,this.fallbackLocale=N,this.message={},this.messages={},this.watchers=[],i&&(this.fallbackLocale=i),this.formater=o||ti,this.messages=n||{},this.setLocale(t||N),s&&this.watchLocale(s)}setLocale(t){let i=this.locale;this.locale=ze(t,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],i!==this.locale&&this.watchers.forEach(n=>{n(this.locale,i)})}getLocale(){return this.locale}watchLocale(t){let i=this.watchers.push(t)-1;return()=>{this.watchers.splice(i,1)}}add(t,i,n=!0){let s=this.messages[t];s?n?Object.assign(s,i):Object.keys(i).forEach(o=>{je(s,o)||(s[o]=i[o])}):this.messages[t]=i}f(t,i,n){return this.formater.interpolate(t,i,n).join("")}t(t,i,n){let s=this.message;return typeof i=="string"?(i=ze(i,this.messages),i&&(s=this.messages[i])):n=i,je(s,t)?this.formater.interpolate(s[t],n).join(""):(console.warn(`Cannot translate the value of keypath ${t}. Use the value of keypath as default.`),t)}};function ni(e,t){e.$watchLocale?e.$watchLocale(i=>{t.setLocale(i)}):e.$watch(()=>e.$locale,i=>{t.setLocale(i)})}function ri(){return typeof uni!="undefined"&&uni.getLocale?uni.getLocale():typeof global!="undefined"&&global.getLocale?global.getLocale():N}function oi(e,t={},i,n){typeof e!="string"&&([e,t]=[t,e]),typeof e!="string"&&(e=ri()),typeof i!="string"&&(i=typeof __uniConfig!="undefined"&&__uniConfig.fallbackLocale||N);let s=new fe({locale:e,fallbackLocale:i,messages:t,watcher:n}),o=(a,c)=>{if(typeof getApp!="function")o=function(l,d){return s.t(l,d)};else{let l=!1;o=function(d,u){let p=getApp().$vm;return p&&(p.$locale,l||(l=!0,ni(p,s))),s.t(d,u)}}return o(a,c)};return{i18n:s,f(a,c,l){return s.f(a,c,l)},t(a,c){return o(a,c)},add(a,c,l=!0){return s.add(a,c,l)},watch(a){return s.watchLocale(a)},getLocale(){return s.getLocale()},setLocale(a){return s.setLocale(a)}}}var ai={"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"},li={"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"Loading...","uni-load-more.contentnomore":"No more data"},ci={"uni-load-more.contentdown":"\u4E0A\u62C9\u986F\u793A\u66F4\u591A","uni-load-more.contentrefresh":"\u6B63\u5728\u52A0\u8F09...","uni-load-more.contentnomore":"\u6C92\u6709\u66F4\u591A\u6578\u64DA\u4E86"},ui={"uni-load-more.contentdown":"Tire hacia arriba para mostrar m\xE1s","uni-load-more.contentrefresh":"cargando...","uni-load-more.contentnomore":"No m\xE1s datos"},di={"uni-load-more.contentdown":"\u0627\u0633\u062D\u0628 \u0644\u0623\u0639\u0644\u0649 \u0644\u0625\u0638\u0647\u0627\u0631 \u0627\u0644\u0645\u0632\u064A\u062F","uni-load-more.contentrefresh":"\u062C\u0627\u0631 \u0627\u0644\u062A\u062D\u0645\u064A\u0644...","uni-load-more.contentnomore":"\u0644\u0627 \u0645\u0632\u064A\u062F \u0645\u0646 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"},hi={"uni-load-more.contentdown":"K\xE9o l\xEAn \u0111\u1EC3 hi\u1EC3n th\u1ECB th\xEAm","uni-load-more.contentrefresh":"\u0111ang t\u1EA3i...","uni-load-more.contentnomore":"Kh\xF4ng c\xF2n d\u1EEF li\u1EC7u"},pi={en:ai,"zh-Hans":li,"zh-Hant":ci,es:ui,ar:di,vi:hi},mi={"uni-load-more":{"":{flexDirection:"row",height:40,alignItems:"center",justifyContent:"center"}},"uni-load-more__text":{"":{fontSize:14,marginLeft:8}},"uni-load-more__img":{"":{width:24,height:24}},"uni-load-more__img--nvue":{"":{color:"#666666"}},"uni-load-more__img--android":{"":{width:24,height:24,transform:"rotate(0deg)"}},"uni-load-more__img--ios":{"":{width:24,height:24,transform:"rotate(0deg)"}}},Ye;setTimeout(()=>{Ye=uni.getSystemInfoSync().platform},16);var{t:me}=oi(pi),gi={name:"UniLoadMore",emits:["clickLoadMore"],props:{status:{type:String,default:"more"},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"auto"},iconSize:{type:Number,default:24},color:{type:String,default:"#777777"},contentText:{type:Object,default(){return{contentdown:"",contentrefresh:"",contentnomore:""}}},showText:{type:Boolean,default:!1}},data(){return{webviewHide:!1,platform:Ye,imgBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzlBMzU3OTlEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzlBMzU3OUFEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDOUEzNTc5N0Q5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDOUEzNTc5OEQ5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt+ALSwAAA6CSURBVHja1FsLkFZV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"}},computed:{iconSnowWidth(){return(Math.floor(this.iconSize/24)||1)*2},contentdownText(){return this.contentText.contentdown||me("uni-load-more.contentdown")},contentrefreshText(){return this.contentText.contentrefresh||me("uni-load-more.contentrefresh")},contentnomoreText(){return this.contentText.contentnomore||me("uni-load-more.contentnomore")}},mounted(){var e=getCurrentPages(),t=e[e.length-1],i=t.$getAppWebview();i.addEventListener("hide",()=>{this.webviewHide=!0}),i.addEventListener("show",()=>{this.webviewHide=!1})},methods:{onClick(){this.$emit("clickLoadMore",{detail:{status:this.status}})}}};function fi(e,t,i,n,s,o){return(0,r.openBlock)(),(0,r.createElementBlock)("view",{class:"uni-load-more",onClick:t[0]||(t[0]=(...a)=>o.onClick&&o.onClick(...a)),renderWhole:!0},[!s.webviewHide&&i.status==="loading"&&i.showIcon?((0,r.openBlock)(),(0,r.createElementBlock)("loading-indicator",{key:0,style:(0,r.normalizeStyle)({color:i.color,width:i.iconSize+"px",height:i.iconSize+"px"}),animating:!0,class:"uni-load-more__img uni-load-more__img--nvue"},null,4)):(0,r.createCommentVNode)("",!0),i.showText?((0,r.openBlock)(),(0,r.createElementBlock)("u-text",{key:1,class:"uni-load-more__text",style:(0,r.normalizeStyle)({color:i.color})},(0,r.toDisplayString)(i.status==="more"?o.contentdownText:i.status==="loading"?o.contentrefreshText:o.contentnomoreText),5)):(0,r.createCommentVNode)("",!0)])}var Ze=k(gi,[["render",fi],["styles",[mi]]]),J=0,Y=0,I={titleTimeCheck:5,parseSendData(e,t,i){let n={for_uid:e,isSend:!0,msg_type:i,mtime:new Date().getTime(),msg_content:{}};switch(i){case m.M_TXT:n.msg_content={content:t};break;case m.M_IMG:n.msg_content={image_url:t.path,image_width:t.width,image_height:t.height,small_url:t.path};break;case m.M_VIDEO:n.msg_content={url:t.path,cover:t.coverPath,width:t.width,height:t.height,duration:t.duration};break;case m.M_VOICE:n.msg_content={voice_url:t.path,voice_duration:t.duration};break;case m.M_HUNG_UP:n.msg_content={end_type:t}}return n},parseMsgTime(e){return{msg_type:1e3,ctime:e,showTime:Se(e)}},checkTimeDiff(e,t,i){return Math.abs(e-t)>i*60*1e3},getHistoryTitleTime(e,t=I.titleTimeCheck){String(e).length==16&&(e=e/1e3);let i=-1;if(J==0)return J=e,null;i=J;let n=null;return ae(i,e,t)&&(n=I.parseMsgTime(i)),J=e,n},getAddTitleTime(e,t=I.titleTimeCheck){if(String(e).length==16&&(e=e/1e3),Y==0)return Y=e,null;let i=null;return ae(Y,e,t)&&(i=I.parseMsgTime(e),Y=e),i}},We=R("UploadModule"),$e="/upload/params";function Ke(e){w(e)||O.request("/upload/success",{id:e,uid:getApp().globalData.uid},!1,!0).then(t=>{},t=>{})}function Ue(e,t,i,n,s=null,o=null){return new Promise((a,c)=>P(this,null,function*(){let l=e.replace("file://",""),d={flag:t,type:i};s&&(d.width=s.width,d.height=s.height);try{if(n){let p=yield de(l),f="";p&&(f=p.digest),w(f)||(d.md5=f),d.uid=getApp().globalData.uid}let u=yield O.request($e,d,!1,!0);if(u.ok==1&&u.data.is_upload)x("log","at common/api-upload.js:45","upload media is_upload true"),a({path:u.data.dir,smallPath:u.data.small_url,uploadId:u.data.upload_id||0});else{let p=u.data.upload_id,f=yield Qe(l,"",u.data);p&&Ke([p]),f.uploadId=p||0,a(f)}}catch(u){let p=le(u);x("error","at common/api-upload.js:60","upload media fail "+p),c(u)}}))}function yi(e,t,i,n,s,o=!0,a=null,c=!0){return P(this,null,function*(){let l={};try{t.startsWith("_doc")&&(t=plus.io.convertLocalFileSystemURL(t));let d={},u=m.isAndroid?t:`file://${t}`,p=t,f=i;if(l={flag:e,type:m.VIDEO},a&&(l.width=a.width,l.height=a.height),c){let h=yield de(p),T="";h&&(T=h.digest),w(T)||(l.md5=T)}let g=yield O.request($e,l,!1,!0),L;if(g.ok==1&&g.data.is_upload)return{url:g.data.dir,coverUrl:g.data.cover_url,smallUrl:g.data.small_url,uploadId:g.data.upload_id||0};{g.data&&(L=g.data.upload_id);let h=yield he(u);if(o&&h?h.size>8*1024*1024:!1){let M=yield Re(u,"medium");p=plus.io.convertLocalFileSystemURL(M.tempFilePath),f=yield ue(p,n,s)}return p=p.replace("file://",""),f=f.replace("file://",""),d={url:g.data.dir.path,coverUrl:g.data.dir.cover_path,smallUrl:g.data.dir.small_url,uploadId:g.data.upload_id||0},yield Qe(p,f,g.data),L&&Ke([L]),d}}catch(d){throw x("error","at common/api-upload.js:120","upload video error",d),d}})}function Qe(e,t,i,n=0,s=0){return new Promise((o,a)=>{We?We.singleUpS3({filePath:e,isBase64:n,coverFilePath:t,coverIsBase64:s,ossInfo:i},c=>{x("log","at common/api-upload.js:137","upload plugin s3 result",c),(typeof c=="object"?c.success:c)?o({path:i.dir.path,smallPath:i.dir.small_url}):a(`_upModuleS3 ${JSON.stringify(c)}`)}):a("UploadModule null")})}function wi(e){return plus.io.convertLocalFileSystemURL(e)}var Ai=R("dom"),xi={data(){return{lastTitleTime:0,messageNone:1,statusBarHeight:getApp().globalData.window.statusBarHeight,viewHeight:getApp().globalData.window.height-getApp().globalData.window.statusBarHeight-44,sw:getApp().globalData.window.width,msgBarHeight:getApp().globalData.window.safeBottom+uni.upx2px(104),historyList:[],addList:[],previewList:[],previewKeyList:[],scrollable:!0,itemHeightLast:20,itemHeightFirst:20,changeHBottom:0,userId:"",syncMtime:0,lastMtime:0,userInfos:{},sendStatusSrc:!1,msgHasMore:!1,barSlotHeight:uni.upx2px(84),isAddTitleClick:!1,keyboradHeight:0,showVideoCall:getApp().globalData.showVideoCall}},computed:{classRotate(){return this.messageNone?"":"list-rotate"},navBarFontColor(){return"#000000"},navBarBgColor(){return"#FFFFFF"}},methods:{clickMsgList(e){e&&e.stopPropagation(),this.$refs.msgBar&&this.$refs.msgBar.hide()},clickBarVideo(){uni.navigateTo({url:"/pages/chat/call"})},clickBack(){m.isAndroid?plus.runtime.quit():typeof getApp().globalData.appLetModule.close=="function"&&getApp().globalData.appLetModule.close()},clickPicture(e){let t=this.previewKeyList.indexOf(e.pKey);t!=-1&&Me(this.previewList,t,0)},addPreviewInfo(e,t){if([m.M_IMG,m.M_VIDEO].indexOf(Number(e.msg_type))==-1)return null;try{let i=oe(),n=e.msg_content,s=Ee(e,n);return t==1?(this.previewList.unshift(s),this.previewKeyList.unshift(i)):(this.previewList.push(s),this.previewKeyList.push(i)),i}catch(i){return null}},parseMsgItem(e,t,i,n){if(i==1){let o=I.getHistoryTitleTime(t.mtime);o!=null&&n!=0&&e.push(o)}else{let o=I.getAddTitleTime(t.mtime);o!=null&&e.push(o)}t.isSend=t.for_uid==getApp().globalData.uid;let s=this.addPreviewInfo(t,i);s&&(t.pKey=s),e.push(t)},onLoadMore(){if(this.messageNone||this.loading)return;this.loading=!0,this.msgHasMore=!0,this.lastMtime=this.historyList[this.historyList.length-1].mtime;let e={uid:this.userId,sync_mtime:this.syncMtime,last_mtime:this.lastMtime};O.request("/msg/service",e).then(t=>{this.msgHasMore=!1,this.loading=!1;let i=t.data.list.length?t.data.list:[];if(w(i))return;let n=[];for(let s in i)this.parseMsgItem(n,i[s],2,s);this.historyList=[...this.historyList,...n]})},onSendAudio(e){!e||!e.path||!e.duration||this.sendVoice(e.path,e.duration)},onInputLineChange(){this.messageNone&&this.scrollBottom()},scrollList(e,t=!0){Ai.scrollToElement(e,{animated:t})},scrollBottom(e=!1){let t=this.messageNone?"cellNew":"cellLast";this.scrollList(this.$refs[t],e)},addMsg(e,t){this.addMsgTimeByLast(e.mtime);let i=this.messageNone?1:2,n=this.addPreviewInfo(e,i);n&&(e.pKey=n),this.addList.push(JSON.parse(JSON.stringify(e))),this.$nextTick(()=>{this.scrollBottom(),typeof t=="function"&&t()})},sendVoice(e,t){return P(this,null,function*(){let i=I.parseSendData(this.userId,{path:e,duration:t},m.M_VOICE);this.addMsg(i,()=>{this.$refs[`msg${i.mtime}`][0].loadingShow()});let n=e.startsWith("_doc")?wi(e):e,s=yield Ue(n,"message",3,!1);this.checkSendStatus(i),this.sendMsg(i,s,()=>{this.$refs[`msg${i.mtime}`][0].loadingHide()})})},onChoosePicture(e,t){return P(this,null,function*(){let i;if(e==0){i=I.parseSendData(this.userId,t,m.M_IMG),this.addMsg(i,()=>{this.$refs[`msg${i.mtime}`][0].loadingShow()});let n=i.msg_content,s=yield Ue(n.image_url,"message",1,!0,{width:n.image_width,height:n.image_height});this.checkSendStatus(i),this.sendMsg(i,s,()=>{this.$refs[`msg${i.mtime}`][0].loadingHide()})}if(e==1){i=I.parseSendData(this.userId,t,m.M_VIDEO),this.addMsg(i,()=>{this.$refs[`msg${i.mtime}`][0].loadingShow()});let n=i.msg_content,s=yield yi("message",n.url,n.cover,n.width,n.height,!0,{width:n.width,height:n.height});this.checkSendStatus(i),this.sendMsg(i,s,()=>{this.$refs[`msg${i.mtime}`][0].loadingHide()})}})},sendMsg(e,t=null,i){if(e.msg_type!=m.M_TXT&&(delete e.for_uid,delete e.isSend,delete e.pKey),!w(t)&&e.msg_type==m.M_IMG){let n=e.msg_content;n.small_url=t.smallPath,n.image_url=t.path,n.upload_id=t.uploadId}if(!w(t)&&e.msg_type==m.M_VIDEO){let n=e.msg_content;n.url=t.url,n.cover=t.coverUrl,n.upload_id=t.uploadId}if(!w(t)&&e.msg_type==m.M_VOICE){let n=e.msg_content;n.voice_url=t.path}O.request("/msg/send",e).then(n=>{typeof i=="function"&&i()})},onSend(e){let t=I.parseSendData(this.userId,e,m.M_TXT);this.addMsgTimeByLast(t.mtime),this.addMsg(t,()=>{this.$refs[`msg${t.mtime}`][0].loadingShow()});let i={msg_type:1,msg_content:{content:e}};this.checkSendStatus(t),this.sendMsg(i,"",()=>{this.$refs[`msg${t.mtime}`][0].loadingHide()})},checkSendStatus(e){setTimeout(()=>{this.$refs[`msg${e.mtime}`][0].getLoadingStatus()&&this.$refs[`msg${e.mtime}`][0].setErrorStatus()},1e4)},addMsgTimeByLast(e,t=5){if(this.lastTitleTime==0){let i=this.addList.length>0?this.addList[this.addList.length-1]:this.historyList[0];!w(i)&&i.ctime&&(this.lastTitleTime=i.ctime)}I.checkTimeDiff(this.lastTitleTime,e,t)&&(this.addList.push(I.parseMsgTime(e)),this.lastTitleTime=e)},keyboradChange(e){this.keyboradHeight=e,this.$nextTick(()=>{setTimeout(()=>{this.messageNone&&this.scrollBottom()},20)})},initMsgList(){return P(this,null,function*(){let e={sync_mtime:this.syncMtime,last_mtime:this.lastMtime},t=yield O.request("/msg/service",e);this.messageNone=t.data.has_more?0:1;let i=t.data.list.length?t.data.list:[];if(w(i))return;let n=[];if(this.messageNone){for(let s=i.length-1,o=0;s>=o;s--)this.parseMsgItem(n,i[s],1,s);this.addList=n}else{for(let s in i)this.parseMsgItem(n,i[s],2,s);this.historyList=n}this.$nextTick(()=>{this.messageNone&&this.scrollBottom()})})}},onLoad(){return P(this,null,function*(){yield getApp().initApp(),this.initMsgList(),uni.$on("event_socket_message",e=>{e.isSend=!1,this.addList.push(e),this.$nextTick(()=>{this.scrollBottom()})}),uni.$on("event_hung_up_notice",e=>{let t=I.parseSendData(this.userId,e,m.M_HUNG_UP);this.addMsg(t,"")})})},onUnload(){uni.$off("event_socket_message"),uni.$off("event_hung_up_notice")}},ki={center:{"":{alignItems:"center",flexDirection:"row"}},"flex-start":{"":{justifyContent:"flex-start"}},"flex-end":{"":{justifyContent:"flex-end"}},container:{"":{paddingTop:0,paddingRight:10,paddingBottom:0,paddingLeft:10,alignItems:"flex-end",flexDirection:"row"}},"admin-del-str":{"":{color:"#FF0000",fontSize:"24rpx"}},"center-align":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"view-send":{"":{paddingLeft:"26rpx"}},content:{".view-send ":{borderTopLeftRadius:"16rpx",borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx",overflow:"hidden"},".view-receive ":{borderTopLeftRadius:"16rpx",borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx",overflow:"hidden"}},"view-receive":{"":{paddingRight:"26rpx"}},"view-tran-end":{".view-receive ":{justifyContent:"flex-end",marginBottom:"12rpx",marginTop:"8rpx"},"":{paddingTop:0,paddingRight:"20rpx",paddingBottom:0,paddingLeft:"18rpx",flexDirection:"row",alignItems:"center",marginBottom:"12rpx",marginTop:"8rpx"}},"text-tran":{"":{fontSize:"18rpx",marginLeft:"4rpx"}}},_i={components:{LImg:D},props:{data:{type:Object,default(){return{}}}},data(){return{maxWidth:getApp().globalData.window.width-20-6-uni.upx2px(32),showLoading:!1,msgState:0,customerAvatar:getApp().globalData.customerAvatar,userAvatar:getApp().globalData.userAvatar}},computed:{viewBg(){return this.data.isSend?"#B6CBFF":"#FFFFFF"},sendStatusSrc(){return this.msgState==Ve.FAIL?"/static/i-error.png":""}},methods:{loadingShow(){this.showLoading=!0},loadingHide(){this.showLoading=!1},getLoadingStatus(){return this.showLoading},setErrorStatus(){this.showLoading=!1,this.msgState=1}}};function Ci(e,t,i,n,s,o){let a=V((0,r.resolveDynamicComponent)("uni-load-more"),Ze),c=(0,r.resolveComponent)("l-img");return(0,r.openBlock)(),(0,r.createElementBlock)("view",{style:{position:"relative"},renderWhole:!0},[i.data.isSend?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,class:"container flex-end"},[(0,r.createElementVNode)("view",{class:"center",style:{"margin-right":"8px","justify-content":"flex-end"}},[(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)({maxWidth:s.maxWidth+"px"}),class:"center flex-end"},[(0,r.createElementVNode)("view",null,[s.showLoading?((0,r.openBlock)(),(0,r.createBlock)(a,{key:0,style:{height:"30px","margin-right":"10rpx"},status:"loading",iconSize:17})):(0,r.createCommentVNode)("",!0),o.sendStatusSrc?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:1,style:{padding:"10rpx"}},[(0,r.createVNode)(c,{src:o.sendStatusSrc,w:"32rpx",h:"32rpx"},null,8,["src"])])):(0,r.createCommentVNode)("",!0)]),(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)([i.data.isSend?"view-send":"view-receive"]),style:{flex:"1"}},[(0,r.createElementVNode)("view",{class:"content",style:(0,r.normalizeStyle)({background:o.viewBg})},[(0,r.renderSlot)(e.$slots,"default",{style:"flex:1"})],4)],2)],4)]),(0,r.createVNode)(c,{src:s.userAvatar,w:"80rpx",h:"80rpx",radius:"40rpx",useNativePic:!1},null,8,["src"])])):((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:1,class:"container flex-start"},[(0,r.createVNode)(c,{w:"80rpx",h:"80rpx",radius:"40rpx",src:s.customerAvatar,useNativePic:!1},null,8,["src"]),(0,r.createElementVNode)("view",{class:"center",style:{"margin-left":"8px"}},[(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)({maxWidth:s.maxWidth+"px"}),class:"center flex-start"},[(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)([i.data.isSend?"view-send":"view-receive"])},[(0,r.createElementVNode)("view",{class:"content",style:(0,r.normalizeStyle)({background:o.viewBg})},[(0,r.renderSlot)(e.$slots,"default")],4)],2)],4)])]))])}var z=k(_i,[["render",Ci],["styles",[ki]]]),$={methods:{loadingShow(){this.$refs.msgBase.loadingShow()},loadingHide(){this.$refs.msgBase.loadingHide()},getLoadingStatus(){return this.$refs.msgBase.getLoadingStatus()},setErrorStatus(){this.$refs.msgBase.setErrorStatus()},checkStopClick(e){return this.$refs.msgBase.isStopClick==1?(this.$refs.msgBase.isStopClick=0,e.stopPropagation(),!0):!1}}},vi={components:{MsgBase:z},mixins:[$],props:{data:{type:Object,default(){return{}}}},data(){return{maxWidthContent:getApp().globalData.window.width-130}},methods:{}};function bi(e,t,i,n,s,o){let a=(0,r.resolveComponent)("msg-base");return(0,r.openBlock)(),(0,r.createBlock)(a,{ref:"msgBase",data:i.data},{default:(0,r.withCtx)(()=>[i.data.msg_content&&i.data.msg_content.content?((0,r.openBlock)(),(0,r.createElementBlock)("u-text",{key:0,style:(0,r.normalizeStyle)([{"font-size":"32rpx","line-height":"38rpx",padding:"20rpx 24rpx"},{"max-width":s.maxWidthContent+"px"}])},(0,r.toDisplayString)(i.data.msg_content.content),5)):(0,r.createCommentVNode)("",!0)]),_:1},8,["data"])}var Si=k(vi,[["render",bi]]),Ti=R("animation"),Z=class{constructor(t,i){this.options=t,this.animation=uni.createAnimation(t),this.currentStepAnimates={},this.next=0,this.$=i}_nvuePushAnimates(t,i){let n=this.currentStepAnimates[this.next],s={};if(n?s=n:s={styles:{},config:{}},Xe.includes(t)){s.styles.transform||(s.styles.transform="");let o="";t==="rotate"&&(o="deg"),s.styles.transform+=`${t}(${i+o}) `}else s.styles[t]=`${i}`;this.currentStepAnimates[this.next]=s}_animateRun(t={},i={}){let n=this.$.$refs.ani.ref;if(n)return new Promise((s,o)=>{Ti.transition(n,X({styles:t},i),a=>{s()})})}_nvueNextAnimate(t,i=0,n){let s=t[i];if(s){let{styles:o,config:a}=s;this._animateRun(o,a).then(()=>{i+=1,this._nvueNextAnimate(t,i,n)})}else this.currentStepAnimates={},typeof n=="function"&&n(),this.isEnd=!0}step(t={}){return this.currentStepAnimates[this.next].config=Object.assign({},this.options,t),this.currentStepAnimates[this.next].styles.transformOrigin=this.currentStepAnimates[this.next].config.transformOrigin,this.next++,this}run(t){this.isEnd=!1,this.$.$refs.ani&&this.$.$refs.ani.ref&&(this._nvueNextAnimate(this.currentStepAnimates,0,t),this.next=0)}},Xe=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"],Ii=["opacity","backgroundColor"],Li=["width","height","left","right","top","bottom"];Xe.concat(Ii,Li).forEach(e=>{Z.prototype[e]=function(...t){return this._nvuePushAnimates(e,t),this}});function Ge(e,t){if(t)return clearTimeout(t.timer),new Z(e,t)}var Di={name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default(){return"fade"}},duration:{type:Number,default:300},styles:{type:Object,default(){return{}}},customClass:{type:String,default:""}},data(){return{isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}},watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e=_e(X({},this.styles),{"transition-duration":this.duration/1e3+"s"}),t="";for(let i in e){let n=this.toLine(i);t+=n+":"+e[i]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=Ge(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){if(this.animation){for(let i in e)try{typeof e[i]=="object"?this.animation[i](...e[i]):this.animation[i](e[i])}catch(n){x("error","at uni_modules/uni-transition/components/uni-transition/uni-transition.vue:139",`\u65B9\u6CD5 ${i} \u4E0D\u5B58\u5728`)}return this.animation.step(t),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);typeof e!="undefined"&&(this.opacity=e),this.transform=t,this.$nextTick(()=>{this.timer=setTimeout(()=>{this.animation=Ge(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})},20)})},close(e){this.animation&&this.tranfromInit(!0).step().run(()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:t,transform:i}=this.styleInit(!1);this.opacity=t||1,this.transform=i,this.$emit("change",{detail:this.isShow})})},styleInit(e){let t={transform:""},i=(n,s)=>{s==="fade"?t.opacity=this.animationType(n)[s]:t.transform+=this.animationType(n)[s]+" "};return typeof this.modeClass=="string"?i(e,this.modeClass):this.modeClass.forEach(n=>{i(e,n)}),t},tranfromInit(e){let t=(i,n)=>{let s=null;n==="fade"?s=i?0:1:(s=i?"-100%":"0",n==="zoom-in"&&(s=i?.8:1),n==="zoom-out"&&(s=i?1.2:1),n==="slide-right"&&(s=i?"100%":"0"),n==="slide-bottom"&&(s=i?"100%":"0")),this.animation[this.animationMode()[n]](s)};return typeof this.modeClass=="string"?t(e,this.modeClass):this.modeClass.forEach(i=>{t(e,i)}),this.animation},animationType(e){return{fade:e?1:0,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}},animationMode(){return{fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}},toLine(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}}};function Pi(e,t,i,n,s,o){return s.isShow?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,ref:"ani",animation:s.animationData,class:(0,r.normalizeClass)(i.customClass),style:(0,r.normalizeStyle)(o.transformStyles),onClick:t[0]||(t[0]=(...a)=>o.onClick&&o.onClick(...a)),renderWhole:!0},[(0,r.renderSlot)(e.$slots,"default")],14,["animation"])):(0,r.createCommentVNode)("",!0)}var Mi=k(Di,[["render",Pi]]),Ei={"uni-popup":{"":{position:"fixed"},".top":{top:0},".left":{top:0},".right":{top:0}},"uni-popup__wrapper":{".uni-popup ":{position:"relative"},".uni-popup .left":{paddingTop:0,flex:1},".uni-popup .right":{paddingTop:0,flex:1}},"fixforpc-top":{"":{top:0}}},Fi={name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},maskClick:{type:Boolean,default:!0},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBgColor:{type:String,default:"rgba(0, 0, 0, 0.4)"}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},transClass:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:this.isDesktop?"fixforpc-top":"top"}},computed:{maskClass(){return{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:this.maskBgColor}},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return this.backgroundColor===""||this.backgroundColor==="none"?"transparent":this.backgroundColor}},mounted(){(()=>{let{windowWidth:t,windowHeight:i,windowTop:n,safeAreaInsets:s}=uni.getSystemInfoSync();this.popupWidth=t,this.popupHeight=i+n,this.safeArea?this.safeAreaInsets=s:this.safeAreaInsets=0})()},created(){this.mkclick=this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1},methods:{closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){this.clearPropagation=!0},open(e,t=!0){if(e&&["top","center","bottom","left","right","message","dialog","share"].indexOf(e)!==-1||(e=this.type),this.maskShow=t,!this.config[e]){x("error","at uni_modules/uni-popup/components/uni-popup/uni-popup.vue:218","\u7F3A\u5C11\u7C7B\u578B\uFF1A",e);return}this[this.config[e]](),this.$emit("change",{show:!0,type:e})},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout(()=>{this.showPopup=!1},300)},touchstart(){this.clearPropagation=!1},onTap(){if(this.clearPropagation){this.clearPropagation=!1;return}this.$emit("maskClick"),this.mkclick&&this.close()},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0,this.$nextTick(()=>{this.messageChild&&this.type==="message"&&this.messageChild.timerClose()}))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets&&this.safeAreaInsets.bottom||0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},!e&&(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0)}}};function Oi(e,t,i,n,s,o){let a=V((0,r.resolveDynamicComponent)("uni-transition"),Mi);return s.showPopup?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,class:(0,r.normalizeClass)(["uni-popup",[s.popupstyle,o.isDesktop?"fixforpc-z-index":""]]),onTouchmove:t[2]||(t[2]=(0,r.withModifiers)((...c)=>o.clear&&o.clear(...c),["stop","prevent"])),renderWhole:!0},[(0,r.createElementVNode)("view",{onTouchstart:t[1]||(t[1]=(...c)=>o.touchstart&&o.touchstart(...c))},[s.maskShow?((0,r.openBlock)(),(0,r.createBlock)(a,{key:"1",name:"mask","mode-class":"fade",styles:o.maskClass,duration:s.duration,show:s.showTrans,onClick:o.onTap},null,8,["styles","duration","show","onClick"])):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(a,{key:"2","mode-class":s.ani,name:"content",styles:s.transClass,duration:s.duration,show:s.showTrans,onClick:o.onTap},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)(["uni-popup__wrapper",[s.popupstyle]]),style:(0,r.normalizeStyle)({backgroundColor:o.bg}),onClick:t[0]||(t[0]=(...c)=>o.clear&&o.clear(...c))},[(0,r.renderSlot)(e.$slots,"default")],6)]),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],34)):(0,r.createCommentVNode)("",!0)}var Bi=k(Fi,[["render",Oi],["styles",[Ei]]]),Ri={"level-center":{"":{alignItems:"center",flexDirection:"row"}},"center-between":{"":{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},"column-center":{"":{flexDirection:"column",alignItems:"center"}},"action-wrap":{"":{borderRadius:"26rpx",marginTop:"12rpx",marginRight:"16rpx",marginBottom:0,marginLeft:"16rpx"}},"title-item":{".action-wrap ":{paddingTop:"28rpx",paddingRight:"28rpx",paddingBottom:"28rpx",paddingLeft:"28rpx"}},"action-item":{".action-wrap ":{height:"106rpx",paddingTop:0,paddingRight:"40rpx",paddingBottom:0,paddingLeft:"40rpx"}},title:{".action-wrap .action-item ":{marginLeft:"50rpx"}},"item-text":{".action-wrap .action-item ":{textAlign:"center",lineHeight:"106rpx"}},line:{"":{height:"2rpx",backgroundColor:"rgba(230,230,230,0.5)",transform:"scaleY(0.5)",transformOrigin:"50% 100%"}}},Ni={components:{LImg:D},emits:["onClickActionItem","onChange","onMaskClick"],props:{actions:{type:[Array,Object],default:[]}},data(){return{textSize:"38rpx",itemTextColor:"#333333"}},methods:{clickThis(e){e&&e.stopPropagation()},clickItem(e){this.$refs.popup.close(),this.$nextTick(()=>{let t=e!=-1?this.actions[e]:{key:"cancel"};this.$emit("onClickActionItem",t)})},onMaskClick(){this.$emit("onMaskClick")},onChange(e){this.$emit("onChange",e)},open(){this.$refs.popup.open()}}};function Vi(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=V((0,r.resolveDynamicComponent)("uni-popup"),Bi);return(0,r.openBlock)(),(0,r.createBlock)(c,{onClick:(0,r.withModifiers)(o.clickThis,["stop"]),ref:"popup",type:"bottom",maskBgColor:"rgba(0, 0, 0, 0.4)",onChange:o.onChange,onMaskClick:o.onMaskClick,style:{"z-index":"99999"}},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("view",{class:"action-wrap",style:{"background-color":"#FFFFFF"}},[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(i.actions,(l,d,u)=>((0,r.openBlock)(),(0,r.createElementBlock)("view",{index:"a"+d},[l.icon?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,class:"action-item level-center",onClick:p=>o.clickItem(d)},[(0,r.createVNode)(a,{src:l.icon,w:"46rpx",h:"46rpx",style:{"margin-right":"50rpx"},"use-native-pic":!1,useNativePic:!0},null,8,["src"]),(0,r.createElementVNode)("u-text",{style:(0,r.normalizeStyle)({fontSize:s.textSize,color:s.itemTextColor})},(0,r.toDisplayString)(l.title),5)],8,["onClick"])):((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:1,class:"action-item",onClick:p=>o.clickItem(d)},[(0,r.createElementVNode)("u-text",{style:(0,r.normalizeStyle)({fontSize:s.textSize,color:"#333333"}),class:"item-text"},(0,r.toDisplayString)(l.title),5)],8,["onClick"])),(0,r.createElementVNode)("view",{class:"line"})],8,["index"]))),256))]),(0,r.createElementVNode)("view",{class:"action-wrap action-bottom",style:{marginBottom:"10px",backgroundColor:"#FFFFFF"}},[(0,r.createElementVNode)("view",{class:"action-item level-center",onClick:t[0]||(t[0]=l=>o.clickItem(-1)),style:{"justify-content":"center"}},[(0,r.createElementVNode)("u-text",{style:(0,r.normalizeStyle)({color:"#333333",fontSize:s.textSize})},"Cancel",4)])])]),_:1},8,["onClick","onChange","onMaskClick"])}var Hi=k(Ni,[["render",Vi],["styles",[Ri]]]),ji={center:{"":{alignItems:"center",flexDirection:"row"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"flex-wrap":{"":{flexWrap:"wrap",flexDirection:"row"}},"msg-bar-express":{"":{position:"relative",backgroundColor:"#FFFFFF",height:0}},"expression-bar":{"":{alignItems:"center",flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",paddingTop:"14rpx",paddingRight:"36rpx",paddingBottom:"14rpx",paddingLeft:"36rpx"}},line:{".expression-bar ":{height:1,backgroundColor:"#CCCCCC",transform:"scaleY(0.5)",transformOrigin:"50% 100%",opacity:.5}},"emoji-wrap":{"":{paddingTop:"20rpx",paddingRight:10,paddingBottom:0,paddingLeft:10}},"pig-wrap":{"":{paddingTop:0,paddingRight:5,paddingBottom:"10rpx",paddingLeft:5}}},zi=R("animation"),Wi={name:"MsgBarAction",emits:["onOpen","onClickEmoji"],data(){return{defHeight:Math.round(240*getApp().globalData.window.scaleH),originalHeight:0,isAndroid:m.isAndroid,height:0,emojiList:[],screenW:getApp().globalData.window.width,emojiW:0,safeAreaBottom:getApp().globalData.window.safeBottom,swiperCurrent:0,barStyle:{}}},watch:{height(e){this.$emit("onOpen",e>0,e)}},methods:{clickEmoji(e){this.$emit("onClickEmoji",e)},isShow(){return this.height>0},setHeight(e){this.originalHeight=e,this.isShow()&&this.height!=this.defHeight&&this.open(!0)},parseExpressions(){this.emojiList=["\u{1F600}","\u{1F603}","\u{1F604}","\u{1F601}","\u{1F606}","\u{1F605}","\u{1F602}","\u{1F923}","\uFE0F\u{1F60A}","\u{1F607}","\u{1F642}","\u{1F643}","\u{1F609}","\u{1F60C}","\u{1F60D}","\u{1F970}","\u{1F618}","\u{1F617}","\u{1F619}","\u{1F61A}","\u{1F60B}","\u{1F61B}","\u{1F61D}","\u{1F61C}","\u{1F92A}","\u{1F928}","\u{1F9D0}","\u{1F913}","\u{1F60E}","\u{1F929}","\u{1F973}","\u{1F60F}","\u{1F612}","\u{1F61E}","\u{1F614}","\u{1F61F}","\u{1F615}","\u{1F641}","\uFE0F\u{1F616}","\u{1F62B}","\u{1F629}","\u{1F97A}","\u{1F622}","\u{1F62D}","\u{1F624}","\u{1F620}","\u{1F621}","\u{1F92C}","\u{1F92F}","\u{1F633}","\u{1F975}","\u{1F976}","\u{1F631}","\u{1F628}","\u{1F630}","\u{1F625}","\u{1F613}","\u{1F917}","\u{1F914}","\u{1F92D}","\u{1F92B}","\u{1F925}","\u{1F636}","\u{1F610}"]},open(e,t){this.height=e?this.originalHeight:0,this.isAndroid?this.barStyle={height:`${this.height}px`}:zi.transition(this.$refs.refBarAction,{styles:{height:`${e?this.originalHeight:0}px`},duration:t?1:this.isAndroid?100:300,timingFunction:"ease",needLayout:!0,delay:0})}},created(){this.parseExpressions(),this.originalHeight=getApp().globalData.keyboardH,this.originalHeight||(this.originalHeight=this.defHeight),this.emojiW=parseInt((this.screenW-20)/8)}};function Ui(e,t,i,n,s,o){return(0,r.openBlock)(),(0,r.createElementBlock)("view",{ref:"refBarAction",class:"msg-bar-express",style:(0,r.normalizeStyle)(s.barStyle),renderWhole:!0},[(0,r.createElementVNode)("scroll-view",{scrollY:"true",class:"emoji-wrap",showScrollbar:!1,style:(0,r.normalizeStyle)({height:s.originalHeight+"px"})},[(0,r.createElementVNode)("view",{class:"flex-wrap"},[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(s.emojiList,(a,c)=>((0,r.openBlock)(),(0,r.createElementBlock)("view",{class:"center-align",onClick:l=>o.clickEmoji(a),key:"e"+c,style:(0,r.normalizeStyle)({width:s.emojiW+"px",height:s.emojiW+"px"})},[(0,r.createElementVNode)("u-text",{style:{"font-size":"60rpx"}},(0,r.toDisplayString)(a),1)],12,["onClick"]))),128))])],4),(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)({height:s.safeAreaBottom+"px",background:"#FFFFFF"})},null,4)],4)}var Gi=k(Wi,[["render",Ui],["styles",[ji]]]),Ji={center:{"":{alignItems:"center",flexDirection:"row"}}},Yi={components:{LImg:D},props:{images:{type:Array,default(){return[]}},w:{type:String,default(){return"0rpx"}},h:{type:String,default(){return"0rpx"}},pauseSrc:{type:String,default(){return""}}},data(){return{audioActionImg:"",timer:"",pauseAudioAction:!1,imageList:[]}},methods:{play(){if(this.timer)return;let e=setInterval(()=>{let t;this.pauseAudioAction?(t=JSON.parse(JSON.stringify(this.images)),this.pauseAudioAction=!1):t=JSON.parse(JSON.stringify(this.imageList));let i=t[t.length-1];for(let n=t.length-1;n>=0;n--)n!=0?t[n]=t[n-1]:t[n]=i;this.imageList=t},200);this.timer=e},close(){this.timer&&clearInterval(this.timer),this.timer=null,this.pauseAudioAction=!0;let e=[];for(let t=0;t<this.imageList.length;++t)e[t]=this.pauseSrc;this.imageList=e}},created(){this.imageList=JSON.parse(JSON.stringify(this.images))}};function Zi(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img");return(0,r.openBlock)(),(0,r.createElementBlock)("view",{class:"center",renderWhole:!0},[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(s.imageList,(c,l)=>((0,r.openBlock)(),(0,r.createBlock)(a,{key:l,style:(0,r.normalizeStyle)({marginLeft:l>0?"10rpx":"0rpx"}),src:s.imageList[l],w:i.w,h:i.h},null,8,["style","src","w","h"]))),128))])}var qe=k(Yi,[["render",Zi],["styles",[Ji]]]),$i={center:{"":{alignItems:"center",flexDirection:"row"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"center-between":{"":{alignItems:"center",flexDirection:"row",justifyContent:"space-between"}}},j=uni.getRecorderManager(),Ki={components:{LImg:D,AudioPlayAni:qe},computed:{durationStr(){return this.recordDuration<=0?"00:00":H(this.recordDuration)},playDurationStr(){return this.audioDurationPlay<=0?"00:00":H(this.audioDurationPlay)}},props:{maxDuration:{type:Number,default:300}},data(){return{widthContent:getApp().globalData.window.width,recordTimer:!1,recordDuration:0,mAudioInner:uni.createInnerAudioContext(),isCancel:!1,audioPath:"",audioDuration:0,playStatus:"taking",audioPlayerIcon:"/static/audio_taking.png",audioDurationPlay:0,defHeight:Math.round(240*getApp().globalData.window.scaleH),statusBarHeight:uni.upx2px(96),images:["/static/audio_bar_ani_1.png","/static/audio_bar_ani_2.png","/static/audio_bar_ani_3.png","/static/audio_bar_ani_4.png","/static/audio_bar_ani_5.png"]}},methods:{clickAudio(e){e.stopPropagation()},clickDel(){this.$emit("onAudioCancel")},clickSend(){this.$emit("onAudioFinish",{path:this.audioPath,duration:this.audioDuration})},clickPlay(){this.playStatus!="taking"&&(this.mAudioInner.paused?(this.mAudioInner.play(),this.handlePlayerInterval()):(this.mAudioInner.pause(),this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer)))},handlePlayerInterval(){this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer),this.audioPlayerTimer=setInterval(()=>{let e=this.mAudioInner.currentTime,t=parseInt(e*100);isNaN(t)||(this.audioDurationPlay=parseInt(e))},100)},startRecordTimer(){this.recordTimer||(this.recordTimer=setInterval(()=>{if(this.recordDuration>=this.maxDuration){this.stopRecord();return}this.recordDuration+=1},1e3))},stopRecord(){this.recordTimer&&clearInterval(this.recordTimer),this.recordTimer=!1,this.$refs.audioAnim.close(),j.stop()},startRecord(){this.$nextTick(()=>{this.startRecordTimer(),j.start({duration:this.maxDuration*1e3,format:"aac"}),this.$refs.audioAnim.play()})},initAudioPreview(){this.mAudioInner.src=this.audioPath,this.audioDurationPlay=this.audioDuration},audioOnEndedListener(e){this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer),this.audioDurationPlay=this.audioDuration,this.$refs.audioAnim.close(),this.audioPlayerIcon="/static/audio_preview_pause.png"},audioOnPlayListener(){this.$refs.audioAnim.play(),this.audioPlayerIcon="/static/audio_preview_play.png"},audioOnPauseListener(){this.$refs.audioAnim.close(),this.audioPlayerIcon="/static/audio_preview_pause.png"}},created(){this.playStatus="taking",j.onStop(e=>{if(this.isCancel)return;x("info","at pages/chat/coms/msg-bar-audio.vue:150","----> record finish "+JSON.stringify(e));let t=uni.createInnerAudioContext(),i=e.tempFilePath,n=setTimeout(()=>{clearTimeout(n),t.destroy()},2e3);t.src=i,this.playStatus="pause",this.audioPlayerIcon="/static/audio_preview_pause.png",t.onCanplay(()=>{let s=t.duration;clearTimeout(n),x("info","at pages/chat/coms/msg-bar-audio.vue:168","-----> \u5B8C\u6210\u5F55\u5236 \u65F6\u957F = "+s),t.destroy(),this.audioPath=i,this.audioDuration=Math.round(s),this.initAudioPreview()})}),j.onError(e=>{x("error","at pages/chat/coms/msg-bar-audio.vue:177","----> MsgBarAudio mRecordManager onError "+JSON.stringify(e))}),this.mAudioInner.onEnded(this.audioOnEndedListener),this.mAudioInner.onPlay(this.audioOnPlayListener),this.mAudioInner.onPause(this.audioOnPauseListener)},beforeUnmount(){this.mAudioInner.destroy(),this.recordTimer&&(clearInterval(this.recordTimer),this.isCancel=!0,j.stop()),this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer)}};function Qi(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=(0,r.resolveComponent)("AudioPlayAni");return(0,r.openBlock)(),(0,r.createElementBlock)("view",{onClick:t[3]||(t[3]=(...l)=>o.clickAudio&&o.clickAudio(...l)),style:(0,r.normalizeStyle)([{width:s.widthContent},{height:"100rpx","background-color":"#FFFFFF"}]),renderWhole:!0},[(0,r.createElementVNode)("view",{class:"center-between",style:{padding:"20rpx 24rpx 0rpx 24rpx"}},[(0,r.createElementVNode)("view",{onClick:t[0]||(t[0]=(...l)=>o.clickDel&&o.clickDel(...l)),class:"center-align",style:{width:"60rpx",height:"60rpx"}},[(0,r.createVNode)(a,{w:"60rpx",h:"60rpx",src:"/static/cancel_audio.png"})]),(0,r.createElementVNode)("view",{class:"center-between",style:{flex:"1",margin:"0rpx 32rpx 0rpx 24rpx","background-color":"#356FFF","border-radius":"16rpx",height:"72rpx",padding:"0rpx 8rpx"}},[(0,r.createElementVNode)("view",{onClick:t[1]||(t[1]=(...l)=>o.clickPlay&&o.clickPlay(...l)),class:"center-align",style:{width:"60rpx",height:"60rpx"}},[(0,r.createVNode)(a,{w:"60rpx",h:"60rpx",src:s.audioPlayerIcon},null,8,["src"])]),(0,r.createElementVNode)("view",{style:{"padding-left":"20rpx",flex:"1"}},[(0,r.createVNode)(c,{ref:"audioAnim",pauseSrc:"/static/audio_bar_ani_pause.png",images:s.images,w:"52rpx",h:"32rpx"},null,8,["images"])]),(0,r.createElementVNode)("u-text",{style:{color:"#FFFFFF","font-size":"24rpx","margin-right":"20rpx"}},(0,r.toDisplayString)(s.playStatus=="taking"?o.durationStr:o.playDurationStr),1)]),(0,r.createElementVNode)("view",{onClick:t[2]||(t[2]=(...l)=>o.clickSend&&o.clickSend(...l)),class:"center-align",style:{width:"60rpx",height:"60rpx"}},[(0,r.createVNode)(a,{w:"60rpx",h:"60rpx",src:"/static/send_active.png"})])])],4)}var Xi=k(Ki,[["render",Qi],["styles",[$i]]]),qi={"msg-bar":{"":{position:"relative"}},center:{"":{alignItems:"center",flexDirection:"row"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"msg-bar-view":{"":{flexDirection:"row",paddingTop:"20rpx",paddingRight:"24rpx",paddingBottom:"0rpx",paddingLeft:"24rpx"}},"msg-bar-middle":{"":{flex:1,position:"relative",borderRadius:"16rpx",paddingTop:"18rpx",paddingRight:"82rpx",paddingBottom:"10rpx",paddingLeft:"26rpx"}},"input-bar":{".msg-bar-middle ":{fontSize:14,flex:1}},voice:{".msg-bar-middle ":{position:"absolute",right:"20rpx",top:"10rpx"}},"audio-tip":{"":{borderRadius:"8rpx",lineHeight:"28rpx",paddingTop:"14rpx",paddingRight:"10rpx",paddingBottom:"14rpx",paddingLeft:"16rpx"}},tip:{".audio-tip ":{color:"#FFFFFF",fontSize:"20rpx",marginRight:"10rpx"}}};R("dom");var Je=getApp().globalData.window,es={emits:["onSend","onChoosePicture","onInputLineChange","onSendAudio","keyboradChange"],components:{MsgBarAudio:Xi,LImg:D,ActionSheet:Hi,MsgBarAction:Gi},props:{hideVoice:{type:Boolean,default:!1}},data(){return{isAndroid:m.isAndroid,width:getApp().globalData.window.width,safeBottom:0,cursorSpacing:uni.upx2px(96),text:"",inputColor:"#333333",isKeyboardOpen:!1,inputAdjustPosition:!1,placeholderStyle:"color: rgba(153,153,153,0.5)",msgBarActionHeight:0,showSend:!1,audioShow:!1,audioLockShow:!1,audioLockBottom:uni.upx2px(104)+Je.safeBottom,isAudioLock:!1,audioTouchTime:0,audioTipSize:{},audioBarShowTimer:!1,expressionAct:!1,audioRecordShow:!1,emojiList:[],cameraActions:[{icon:"/static/i_camera_photo.png",title:"Take photo",key:"take_photo"},{icon:"/static/i_camera_video.png",title:"Take video",key:"take_video"}]}},computed:{viewBarBg(){return"#F9FAFD"},viewBarMiddleStyle(){let e={},t=1,i="#EEEEEE";return e.background="rgba(255, 255, 255, "+t+")",e.border="2rpx solid "+i,e},sendAct(){return!!this.text}},methods:{clickBarCamera(){this.expressionAct&&(this.expressionAct=!1),this.isKeyboardOpen&&uni.hideKeyboard(),this.$refs.popCamera.open()},clickSend(e){e&&e.stopPropagation(),this.handleSend()},clickExpression(){this.expressionAct||(this.expressionAct=!0,this.$refs.msgBarAction.open(!0,!0),this.isKeyboardOpen&&uni.hideKeyboard())},clickPic(){this.isKeyboardOpen&&uni.hideKeyboard(),this.expressionAct&&(this.expressionAct=!1),this.chooseImage(1,9)},clickVideo(){this.isKeyboardOpen&&uni.hideKeyboard(),this.expressionAct&&(this.expressionAct=!1),this.chooseVideo(1)},onAudioCancel(){this.audioRecordShow=!1},onAudioFinish(e){this.$emit("onSendAudio",e),this.audioRecordShow=!1},onAudioTouch(){if(this.$emit("keyboradChange",0),this.expressionAct&&(this.expressionAct=!1),this.isKeyboardOpen||this.$refs.msgBarAction.isShow()){uni.hideKeyboard(),this.$refs.msgBarAction.open(!1);return}this.audioTouchTime=new Date().getTime()},onAudioTouchEnd(){new Date().getTime()-this.audioTouchTime<600||this.$nextTick(()=>{this.$refs.msgBarAudio.stopRecord()})},onAudioLongTouch(){if(!Pe(A.MICROPHONE)){U(A.MICROPHONE);return}this.audioRecordShow=!0,this.$nextTick(()=>{this.$refs.msgBarAudio.startRecord()})},onClickActionItem(e){switch(this.expressionAct&&(this.expressionAct=!1),e.key){case"take_photo":this.chooseImage(2,1);break;case"take_video":this.chooseVideo(2);break}},hide(){this.isKeyboardOpen&&uni.hideKeyboard(),this.expressionAct&&(this.expressionAct=!1),this.$refs.msgBarAction.open(!1)},onLineChange(e){e&&e.detail&&e.detail.height&&this.$emit("onInputLineChange",e.detail.height,e.detail.lineCount)},onFocusChange(){this.expressionAct&&(this.expressionAct=!1),this.$refs.msgBarAction.open(!1),this.$nextTick(()=>{this.$emit("keyboradChange",getApp().globalData.keyboardH)})},onActionOpen(e,t){},onClickEmoji(e){this.text=this.text+e},chooseImage(e,t){Oe(e,t).then(i=>{let n=i.tempFilePaths;for(let s=0,o=n.length;s<o;s++){let a=n[s];uni.getImageInfo({src:a,success:c=>{let l={path:c.path,width:c.width,height:c.height};this.$emit("onChoosePicture",0,l)}})}})},chooseVideo(e){Be(e,!0).then(t=>{let i={path:t.tempFilePath,coverPath:t.coverPath,cover:t.coverPath,width:t.width,height:t.height,duration:parseInt(t.duration)||0};this.$emit("onChoosePicture",1,i)})},handleSend(){if(this.text==null||this.text=="")return;this.text.trim()==""&&uni.showModal({title:"Tips",content:"Unable to send blank message.",showCancel:!1,cancelText:"",confirmText:"Got it",editable:!1,success(t){t.confirm}}),this.$emit("onSend",this.text),this.text=""},onKeyboardChange(e){e.height>0?(this.isKeyboardOpen=!0,this.$refs.msgBarAction.setHeight(e.height),getApp().globalData.keyboardH=e.height):(this.isKeyboardOpen=!1,this.$refs.input.blur(),this.$emit("keyboradChange",0))}},created(){this.safeBottom=Je.safeBottom,uni.onKeyboardHeightChange(this.onKeyboardChange)},unmounted(){uni.offKeyboardHeightChange(this.onKeyboardChange)}};function ts(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=(0,r.resolveComponent)("msg-bar-audio"),l=(0,r.resolveComponent)("msg-bar-action"),d=(0,r.resolveComponent)("action-sheet");return(0,r.openBlock)(),(0,r.createElementBlock)("view",{class:"msg-bar",style:(0,r.normalizeStyle)({width:`${s.width}px`}),renderWhole:!0},[(0,r.renderSlot)(e.$slots,"default"),(0,r.createElementVNode)("view",{class:"msg-bar-view",style:(0,r.normalizeStyle)([{background:o.viewBarBg},{position:"relative"}])},[(0,r.createElementVNode)("view",{class:"msg-bar-middle",style:(0,r.normalizeStyle)(o.viewBarMiddleStyle)},[(0,r.createElementVNode)("u-textarea",{ref:"input",modelValue:s.text,onInput:t[0]||(t[0]=u=>s.text=u.detail.value),adjustPosition:s.inputAdjustPosition,cursorSpacing:s.cursorSpacing,autoHeight:!0,maxlength:-1,showConfirmBar:!1,disableDefaultPadding:!0,onLinechange:t[1]||(t[1]=(...u)=>o.onLineChange&&o.onLineChange(...u)),onFocus:t[2]||(t[2]=(0,r.withModifiers)((...u)=>o.onFocusChange&&o.onFocusChange(...u),["stop"])),style:(0,r.normalizeStyle)({color:this.inputColor}),placeholderStyle:s.placeholderStyle,class:"input-bar"},null,44,["modelValue","adjustPosition","cursorSpacing","placeholderStyle"]),(0,r.createElementVNode)("view",{class:"voice",onTouchstart:t[3]||(t[3]=(...u)=>o.onAudioTouch&&o.onAudioTouch(...u)),onLongpress:t[4]||(t[4]=(...u)=>o.onAudioLongTouch&&o.onAudioLongTouch(...u)),onTouchend:t[5]||(t[5]=(...u)=>o.onAudioTouchEnd&&o.onAudioTouchEnd(...u))},[(0,r.createVNode)(a,{src:"/static/s_audio_m.png",w:"60rpx",h:"60rpx"})],32)],4),(0,r.createElementVNode)("view",{style:{margin:"12rpx 0rpx 6rpx 32rpx"}},[o.sendAct?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,onClick:t[6]||(t[6]=(...u)=>o.clickSend&&o.clickSend(...u))},[(0,r.createVNode)(a,{onClick:o.clickSend,src:"/static/send_active.png",w:"60rpx",h:"60rpx"},null,8,["onClick"])])):((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:1},[(0,r.createVNode)(a,{src:"/static/send_default.png",w:"60rpx",h:"60rpx"})]))]),s.audioRecordShow?((0,r.openBlock)(),(0,r.createBlock)(c,{key:0,ref:"msgBarAudio",onOnAudioCancel:o.onAudioCancel,onOnAudioFinish:o.onAudioFinish,style:{position:"absolute",bottom:"0",left:"0"}},null,8,["onOnAudioCancel","onOnAudioFinish"])):(0,r.createCommentVNode)("",!0)],4),(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)([{background:o.viewBarBg},{height:"96rpx",padding:"20rpx 74rpx 16rpx 54rpx"}])},[(0,r.createElementVNode)("view",{class:"center",style:{"justify-content":"space-between"}},[(0,r.createElementVNode)("view",{class:"center-align",style:{width:"60rpx",height:"60rpx"},onClick:t[7]||(t[7]=(...u)=>o.clickExpression&&o.clickExpression(...u))},[s.expressionAct?((0,r.openBlock)(),(0,r.createBlock)(a,{key:1,w:"60rpx",h:"60rpx",src:"/static/choose_expression_active.png"})):((0,r.openBlock)(),(0,r.createBlock)(a,{key:0,w:"60rpx",h:"60rpx",src:"/static/choose_expression.png"}))]),(0,r.createElementVNode)("view",{class:"center-align",style:{width:"60rpx",height:"60rpx"},onClick:t[8]||(t[8]=(...u)=>o.clickPic&&o.clickPic(...u))},[(0,r.createVNode)(a,{w:"60rpx",h:"60rpx",src:"/static/choose_pic.png"})]),(0,r.createElementVNode)("view",{class:"center-align",style:{width:"60rpx",height:"60rpx"},onClick:t[9]||(t[9]=(...u)=>o.clickBarCamera&&o.clickBarCamera(...u))},[(0,r.createVNode)(a,{w:"60rpx",h:"60rpx",src:"/static/take_photo.png"})]),(0,r.createElementVNode)("view",{class:"center-align",style:{width:"60rpx",height:"60rpx"},onClick:t[10]||(t[10]=(...u)=>o.clickVideo&&o.clickVideo(...u))},[(0,r.createVNode)(a,{w:"60rpx",h:"60rpx",src:"/static/choose_video.png"})])])],4),(0,r.createVNode)(l,{ref:"msgBarAction",onOnOpen:o.onActionOpen,onOnClickEmoji:o.onClickEmoji},null,8,["onOnOpen","onOnClickEmoji"]),(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)({height:s.safeBottom+"px",background:o.viewBarBg})},null,4),(0,r.createVNode)(d,{ref:"popCamera",onOnClickActionItem:o.onClickActionItem,actions:s.cameraActions},null,8,["onOnClickActionItem","actions"])],4)}var is=k(es,[["render",ts],["styles",[qi]]]),ss={components:{MsgBase:z,LImg:D},mixins:[$],props:{data:{type:Object,default(){return{}}}},computed:{getWH(){let e=this.data.msg_content;return ne(e.image_width,e.image_height,200)},border(){return"1px solid #EEEEEE"}},data(){return{src:""}},methods:{clickPicture(e){this.checkStopClick(e)||this.$emit("clickPicture",this.data)}},created(){this.src=this.data.msg_content&&this.data.msg_content.small_url}};function ns(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=(0,r.resolveComponent)("msg-base");return(0,r.openBlock)(),(0,r.createBlock)(c,{ref:"msgBase",data:i.data},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(a,{mode:"aspectFill",onClick:o.clickPicture,src:s.src,placeW:"200rpx",w:o.getWH[0]+"px",h:o.getWH[1]+"px",radius:"16rpx","use-native-pic":!1},null,8,["onClick","src","w","h"])]),_:1},8,["data"])}var rs=k(ss,[["render",ns]]),os={"msg-video":{"":{position:"relative",alignItems:"center",justifyContent:"center"}},"video-duration":{"":{color:"#FFFFFF",position:"absolute",bottom:0,right:0,paddingTop:"10rpx",paddingRight:"10rpx",paddingBottom:"10rpx",paddingLeft:"10rpx",fontSize:"24rpx"}}},as={components:{LImg:D,MsgBase:z},mixins:[$],emits:["clickVideo"],props:{data:{type:Object,default(){return{}}}},data(){return{}},computed:{getWH(){let e=this.data.msg_content;return ne(e.width,e.height,200)},getDuration(){return H(Math.round(this.data.msg_content.duration))}},methods:{clickVideo(e){this.checkStopClick(e)||(e.stopPropagation(),this.$emit("clickVideo",this.data))}}};function ls(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=(0,r.resolveComponent)("msg-base");return(0,r.openBlock)(),(0,r.createBlock)(c,{ref:"msgBase",data:i.data},{default:(0,r.withCtx)(()=>[i.data.msg_content&&i.data.msg_content.cover?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,onClick:t[0]||(t[0]=(...l)=>o.clickVideo&&o.clickVideo(...l)),class:"msg-video",style:(0,r.normalizeStyle)({width:o.getWH[0]+"px",height:o.getWH[1]+"px"})},[(0,r.createVNode)(a,{onClick:o.clickVideo,src:i.data.msg_content.cover,w:o.getWH[0]+"px",h:o.getWH[1]+"px",radius:"16rpx",border:"1px solid #EEEEEE","use-native-pic":!1,placeW:"200rpx"},null,8,["onClick","src","w","h"]),(0,r.createVNode)(a,{onClick:o.clickVideo,src:"/static/play_video.png",w:"56rpx",h:"56rpx",style:{position:"absolute"},"use-native-pic":!1,placeW:"200rpx",useNativePic:!0},null,8,["onClick"]),(0,r.createElementVNode)("u-text",{class:"video-duration"},(0,r.toDisplayString)(o.getDuration),1)],4)):(0,r.createCommentVNode)("",!0)]),_:1},8,["data"])}var cs=k(as,[["render",ls],["styles",[os]]]),us={"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"view-voice":{"":{alignItems:"center",flexDirection:"row",width:"380rpx",paddingTop:"10rpx",paddingRight:"10rpx",paddingBottom:"10rpx",paddingLeft:"10rpx"}},"text-duration":{"":{paddingTop:0,paddingRight:"24rpx",paddingBottom:0,paddingLeft:"26rpx",textAlign:"center",fontSize:"28rpx",lineHeight:"40rpx"}}},ds={mixins:[$],components:{AudioPlayAni:qe,LImg:D,MsgBase:z},emits:["clickMsgVoice","onMsgVoiceChange"],props:{data:{type:Object,default(){return{}}}},data(){return{iconPlay:"/static/audio_msg_pause.png",sliderValue:0,curDuration:this.data.msg_content.voice_duration,sliderH:uni.upx2px(24),images:["/static/audio_msg_ani_1.png","/static/audio_msg_ani_2.png","/static/audio_msg_ani_3.png"]}},computed:{durationStr(){return this.curDuration<=0?"00:00":H(this.curDuration)},sliderActColor(){return"#333333"},sliderBgColor(){return"rgba(0, 0, 0, 0.1)"},viewBg(){return this.data.isSend?"#B6CBFF":"#FFFFFF"}},methods:{clickVoice(e){e&&e.stopPropagation(),re(()=>{if(this.checkStopClick(e))return;x("log","at pages/chat/coms/msg-voice.vue:66","\u70B9\u51FB\u64AD\u653E\u8BED\u97F3 clickVoice \u6267\u884C ----> ");let t=this.data.msg_content;this.$emit("clickMsgVoice",this.data,this.curDuration==t.voice_duration?0:this.curDuration)},500,"msg-voice-click")},changeDuration(e,t){let i=this.data.msg_content;e==-1&&(e=i.voice_duration),this.curDuration=e,this.sliderValue=parseInt(t/i.voice_duration)},changeIcon(e){this.iconPlay=`/static/audio_msg_${e?"play":"pause"}.png`},pauseAnim(){this.$refs.audioAnim.close()},playAnim(){this.$refs.audioAnim.play()}},mounted(){this.$refs.audioAnim.close()}};function hs(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=(0,r.resolveComponent)("AudioPlayAni"),l=(0,r.resolveComponent)("msg-base");return(0,r.openBlock)(),(0,r.createBlock)(l,{ref:"msgBase",data:i.data},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("view",{class:"view-voice",onClick:t[1]||(t[1]=(...d)=>o.clickVoice&&o.clickVoice(...d))},[(0,r.createElementVNode)("view",{onClick:t[0]||(t[0]=(...d)=>o.clickVoice&&o.clickVoice(...d)),class:"center-align",style:{width:"60rpx",height:"60rpx"}},[(0,r.createVNode)(a,{onClick:o.clickVoice,w:"60rpx",h:"60rpx",src:s.iconPlay},null,8,["onClick","src"])]),(0,r.createVNode)(c,{ref:"audioAnim",pauseSrc:"/static/audio_msg_ani_pause.png",images:s.images,w:"52rpx",h:"32rpx"},null,8,["images"]),(0,r.createElementVNode)("u-text",{style:{padding:"0 26rpx 0 26rpx","text-align":"center","font-size":"28rpx","line-height":"40rpx"}},(0,r.toDisplayString)(o.durationStr),1)])]),_:1},8,["data"])}var ps=k(ds,[["render",hs],["styles",[us]]]),ms={center:{"":{display:"flex",alignItems:"center",flexDirection:"row"}}},gs={components:{LImg:D,MsgBase:z},props:{data:{type:Object,default(){return{}}}},data(){return{maxWidthContent:getApp().globalData.window.width-130}},computed:{notice(){return(this.data.msg_content&&this.data.msg_content.end_type)==1?"Declined by you":"Canceled"}},methods:{}};function fs(e,t,i,n,s,o){let a=(0,r.resolveComponent)("l-img"),c=(0,r.resolveComponent)("msg-base");return(0,r.openBlock)(),(0,r.createBlock)(c,{ref:"msgBase",data:i.data},{default:(0,r.withCtx)(()=>[o.notice?((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:0,class:"center",style:(0,r.normalizeStyle)({height:"60rpx",maxWidth:s.maxWidthContent+"px"})},[(0,r.createElementVNode)("view",{class:"center",style:{width:"60rpx",height:"60rpx","justify-content":"center"}},[(0,r.createVNode)(a,{src:"/static/call_video_fail.png",w:"40rpx",h:"40rpx"})]),(0,r.createElementVNode)("u-text",{style:{"font-size":"28rpx","font-weight":"500"}},"Video chat"),(0,r.createElementVNode)("u-text",{style:{padding:"18rpx 20rpx","line-height":"28rpx","font-size":"24rpx"}},(0,r.toDisplayString)(o.notice),1)],4)):(0,r.createCommentVNode)("",!0)]),_:1},8,["data"])}var ys=k(gs,[["render",fs],["styles",[ms]]]),ws={data(){return{playTimer:!1,isPlayingByTouch:!1,mAudioInner:uni.createInnerAudioContext(),mLastPlayCTime:0}},methods:{clickMsgVoice(e,t){let i=this.$refs[`msg${e.mtime}`][0],n=e.msg_content;if(!i)return;if(typeof this.mAudioInner.paused!="undefined"&&!this.mAudioInner.paused&&(this.mAudioInner.stop(),this.playTimer&&clearInterval(this.playTimer),this.$refs[`msg${this.mLastPlayCTime}`][0].changeIcon(!1),this.$refs[`msg${this.mLastPlayCTime}`][0].pauseAnim(),this.mLastPlayCTime==e.mtime)){this.mLastPlayCTime=0;return}this.mAudioInner.src=this.parseVoiceUrl(n.voice_url),this.mAudioInner.startTime=t,this.mLastPlayCTime=e.mtime,this.mAudioInner.play(),this.handlePlayTimer(e.mtime),i.changeIcon(!0),this.$refs[`msg${this.mLastPlayCTime}`][0].playAnim()},onMsgVoiceChange(e,t,i){if(!e){this.scrollable=!1,!this.mAudioInner.paused&&i.mtime==this.mLastPlayCTime?(this.isPlayingByTouch=!0,this.mAudioInner.pause(),this.playTimer&&clearInterval(this.playTimer)):this.isPlayingByTouch=!1;return}this.scrollable=!0,this.isPlayingByTouch&&(this.mAudioInner.seek(t),this.mAudioInner.play(),this.handlePlayTimer(i.mtime))},handlePlayTimer(e){let t=this.$refs[`msg${e}`][0];this.playTimer&&clearInterval(this.playTimer),this.playTimer=setInterval(()=>{if(this.mAudioInner.paused)return;let i=this.mAudioInner.currentTime,n=Math.round(i*100);isNaN(n)||t.changeDuration(Math.round(i),n)},100)},parseVoiceUrl(e){return w(e)?"":e.substr(0,5)==="_doc/"||e.substr(0,4)==="http"?e:getApp().globalData.ossPath+e},initAudio(){this.mAudioInner.onEnded(()=>{this.playTimer&&clearInterval(this.playTimer),this.$refs[`msg${this.mLastPlayCTime}`][0].changeIcon(!1),this.$refs[`msg${this.mLastPlayCTime}`][0].changeDuration(-1,0),this.$refs[`msg${this.mLastPlayCTime}`][0].pauseAnim(),this.mLastPlayCTime=0}),this.mAudioInner.onError(e=>{this.playTimer&&clearInterval(this.playTimer),this.$refs[`msg${this.mLastPlayCTime}`][0].changeIcon(!1),this.$refs[`msg${this.mLastPlayCTime}`][0].playAnim(),this.mLastPlayCTime=0})}},onLoad(){this.initAudio()},onUnload(){this.mAudioInner.destroy(),this.playTimer&&clearInterval(this.playTimer)}},As={"list-rotate":{"":{transform:"rotate(180deg)"}},"msg-def":{"":{opacity:1,transitionProperty:"opacity",transitionDuration:500,transitionTimingFunction:"ease-out"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"loading-more":{"":{flex:1,height:40,alignItems:"center",flexDirection:"row",justifyContent:"center"}},"nav-bar":{"":{backgroundColor:"#FFFFFF",height:44,paddingTop:0,paddingRight:20,paddingBottom:0,paddingLeft:20,alignItems:"center",flexDirection:"row",justifyContent:"space-between",zIndex:99999}},"status-bar":{"":{position:"fixed",top:0,left:0,right:0,backgroundColor:"#FFFFFF",zIndex:99999}},"@TRANSITION":{"msg-def":{property:"opacity",duration:500,timingFunction:"ease-out"}}},xs={mixins:[xi,ws],components:{MsgText:Si,MsgBar:is,MsgPicture:rs,MsgVideo:cs,MsgVoice:ps,MsgCall:ys,LImg:D}};function ks(e,t,i,n,s,o){let a=(0,r.resolveComponent)("msg-text"),c=(0,r.resolveComponent)("msg-picture"),l=(0,r.resolveComponent)("msg-video"),d=(0,r.resolveComponent)("msg-voice"),u=(0,r.resolveComponent)("msg-call"),p=V((0,r.resolveDynamicComponent)("uni-load-more"),Ze),f=(0,r.resolveComponent)("msg-bar"),g=(0,r.resolveComponent)("l-img"),L=(0,r.resolveComponent)("nav-blur");return(0,r.openBlock)(),(0,r.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,r.createElementVNode)("view",null,[(0,r.createElementVNode)("view",{class:"status-bar",style:(0,r.normalizeStyle)({height:e.statusBarHeight+"px"})},null,4),(0,r.createElementVNode)("view",{class:"nav-bar",style:(0,r.normalizeStyle)({position:"fixed",top:e.statusBarHeight+"px",left:0,right:0})},[(0,r.createElementVNode)("u-image",{onClick:t[0]||(t[0]=(...h)=>e.clickBack&&e.clickBack(...h)),src:"/static/back.png",style:{width:"20px",height:"20px"}}),(0,r.createElementVNode)("u-text",{style:{"font-size":"17px","font-weight":"500"}},"Customer service"),e.showVideoCall?((0,r.openBlock)(),(0,r.createElementBlock)("u-image",{key:0,onClick:t[1]||(t[1]=(...h)=>e.clickBarVideo&&e.clickBarVideo(...h)),src:"/static/video_call.png",style:{width:"20px",height:"20px"}})):((0,r.openBlock)(),(0,r.createElementBlock)("view",{key:1,style:{width:"20px",height:"20px","background-color":"transparent"}}))],4),(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)({height:e.statusBarHeight+44+"px"})},null,4),(0,r.createElementVNode)("view",{style:(0,r.normalizeStyle)([{height:`${e.viewHeight}px`,paddingBottom:e.keyboradHeight+"px"},{"background-color":"#F1F3F6"}])},[(0,r.createElementVNode)("list",{onClick:t[3]||(t[3]=(...h)=>e.clickMsgList&&e.clickMsgList(...h)),ref:"msgList",class:(0,r.normalizeClass)(["msg-list",[e.classRotate]]),showScrollbar:!1,loadmoreoffset:20,offsetAccuracy:10,onLoadmore:t[4]||(t[4]=(...h)=>e.onLoadMore&&e.onLoadMore(...h))},[(0,r.createElementVNode)("cell",{ref:"cellLast",style:(0,r.normalizeStyle)({width:`${e.sw}px`,height:`${e.itemHeightFirst}px`})},null,4),(0,r.createElementVNode)("cell",null,[(0,r.createElementVNode)("list",{showScrollbar:!1,scrollable:!1,class:(0,r.normalizeClass)([e.classRotate])},[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.addList,(h,T)=>((0,r.openBlock)(),(0,r.createElementBlock)("cell",{key:`key${T}`,ref_for:!0,ref:`cell${h.mtime}`,class:"msg-def",style:{"padding-bottom":"28rpx"},onClick:t[2]||(t[2]=(...M)=>e.clickMsgList&&e.clickMsgList(...M))},[h.msg_type==1e3?((0,r.openBlock)(),(0,r.createElementBlock)("u-text",{key:0,style:{"font-size":"24rpx","text-align":"center"}},(0,r.toDisplayString)(h.showTime),1)):h.msg_type==1?((0,r.openBlock)(),(0,r.createBlock)(a,{key:1,ref_for:!0,ref:"msg"+h.mtime,data:h},null,8,["data"])):h.msg_type==3?((0,r.openBlock)(),(0,r.createBlock)(c,{key:2,ref_for:!0,ref:"msg"+h.mtime,data:h,onClickPicture:e.clickPicture},null,8,["data","onClickPicture"])):h.msg_type==4?((0,r.openBlock)(),(0,r.createBlock)(l,{key:3,ref_for:!0,ref:"msg"+h.mtime,data:h,index:T,onClickVideo:e.clickPicture},null,8,["data","index","onClickVideo"])):h.msg_type==2?((0,r.openBlock)(),(0,r.createBlock)(d,{key:4,ref_for:!0,ref:"msg"+h.mtime,data:h,index:T,onClickMsgVoice:e.clickMsgVoice,onOnMsgVoiceChange:e.onMsgVoiceChange},null,8,["data","index","onClickMsgVoice","onOnMsgVoiceChange"])):h.msg_type==5?((0,r.openBlock)(),(0,r.createBlock)(u,{key:5,ref_for:!0,ref:"msg"+h.mtime,data:h},null,8,["data"])):(0,r.createCommentVNode)("",!0)]))),128))],2)]),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.historyList,(h,T)=>((0,r.openBlock)(),(0,r.createElementBlock)("cell",{key:"cell"+h.ctime,ref_for:!0,ref:"cell"+h.mtime,style:{"padding-bottom":"28rpx"},class:(0,r.normalizeClass)(["msg-def",[e.classRotate]])},[h.msg_type==1e3?((0,r.openBlock)(),(0,r.createElementBlock)("u-text",{key:0,style:{"font-size":"24rpx","text-align":"center"}},(0,r.toDisplayString)(h.showTime),1)):h.msg_type==1?((0,r.openBlock)(),(0,r.createBlock)(a,{key:1,ref_for:!0,ref:"msg"+h.mtime,data:h},null,8,["data"])):h.msg_type==3?((0,r.openBlock)(),(0,r.createBlock)(c,{key:2,ref_for:!0,ref:"msg"+h.mtime,data:h,index:T,onClickPicture:e.clickPicture},null,8,["data","index","onClickPicture"])):h.msg_type==4?((0,r.openBlock)(),(0,r.createBlock)(l,{key:3,ref_for:!0,ref:"msg"+h.mtime,data:h,index:T,onClickVideo:e.clickPicture},null,8,["data","index","onClickVideo"])):h.msg_type==2?((0,r.openBlock)(),(0,r.createBlock)(d,{key:4,ref_for:!0,ref:"msg"+h.mtime,data:h,index:T,onClickMsgVoice:e.clickMsgVoice,onOnMsgVoiceChange:e.onMsgVoiceChange},null,8,["data","index","onClickMsgVoice","onOnMsgVoiceChange"])):h.msg_type==5?((0,r.openBlock)(),(0,r.createBlock)(u,{key:5,ref_for:!0,ref:"msg"+h.mtime,data:h},null,8,["data"])):(0,r.createCommentVNode)("",!0)],2))),128)),(0,r.createElementVNode)("cell",{ref:"cellNew",style:(0,r.normalizeStyle)({width:`${e.sw}px`,height:`${e.itemHeightLast}px`})},null,4),e.msgHasMore?((0,r.openBlock)(),(0,r.createElementBlock)("cell",{key:0},[(0,r.createElementVNode)("view",{class:(0,r.normalizeClass)(["center-align loading-more",[e.classRotate]])},[(0,r.createVNode)(p,{style:{height:"30px"},showText:!1,status:"loading",iconSize:14,color:"#333333"})],2)])):(0,r.createCommentVNode)("",!0)],34),(0,r.createVNode)(f,{ref:"msgBar",onOnSend:e.onSend,onOnChoosePicture:e.onChoosePicture,onOnSendAudio:e.onSendAudio,onOnInputLineChange:e.onInputLineChange,onKeyboradChange:e.keyboradChange},null,8,["onOnSend","onOnChoosePicture","onOnSendAudio","onOnInputLineChange","onKeyboradChange"]),(0,r.createElementVNode)("view",{style:{position:"absolute",width:"100px",height:"100px",top:"100px",left:"0"}},[(0,r.createVNode)(g,{src:"/static/aa.jpg",w:"100px",h:"100px",style:{position:"absolute"}}),(0,r.createVNode)(L,{radius:20,color:"#80FFFFFF",style:{position:"absolute",width:"100px",height:"100px",top:"0",left:"0"}})]),(0,r.createElementVNode)("view",{style:{position:"absolute",width:"100px",height:"100px",top:"240px",left:"0"}},[(0,r.createVNode)(g,{src:"/static/aa.jpg",w:"100px",h:"100px",style:{position:"absolute"}}),(0,r.createVNode)(L,{radius:20,color:"#F2FFFFFF",cornerRadius:10,style:{position:"absolute",width:"100px",height:"100px",top:"0",left:"0"}})])],4)])])}var K=k(xs,[["render",ks],["styles",[As]]]);var ye=plus.webview.currentWebview();if(ye){let e=parseInt(ye.id),t="pages/chat/index",i={};try{i=JSON.parse(ye.__query__)}catch(s){}K.mpType="page";let n=Vue.createPageApp(K,{$store:getApp({allowDefault:!0}).$store,__pageId:e,__pagePath:t,__pageQuery:i});n.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...K.styles||[]])),n.mount("#root")}})();
