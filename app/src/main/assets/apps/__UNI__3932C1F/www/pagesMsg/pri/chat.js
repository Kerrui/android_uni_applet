"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var Sl=Object.create;var zn=Object.defineProperty,kl=Object.defineProperties,Al=Object.getOwnPropertyDescriptor,Tl=Object.getOwnPropertyDescriptors,vl=Object.getOwnPropertyNames,ia=Object.getOwnPropertySymbols,Dl=Object.getPrototypeOf,sa=Object.prototype.hasOwnProperty,Ll=Object.prototype.propertyIsEnumerable;var na=(e,t,i)=>t in e?zn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,$n=(e,t)=>{for(var i in t||(t={}))sa.call(t,i)&&na(e,i,t[i]);if(ia)for(var i of ia(t))Ll.call(t,i)&&na(e,i,t[i]);return e},aa=(e,t)=>kl(e,Tl(t));var ra=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var El=(e,t,i,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of vl(t))!sa.call(e,n)&&n!==i&&zn(e,n,{get:()=>t[n],enumerable:!(a=Al(t,n))||a.enumerable});return e};var ee=(e,t,i)=>(i=e!=null?Sl(Dl(e)):{},El(t||!e||!e.__esModule?zn(i,"default",{value:e,enumerable:!0}):i,e));var Ge=(e,t,i)=>new Promise((a,n)=>{var s=c=>{try{l(i.next(c))}catch(p){n(p)}},r=c=>{try{l(i.throw(c))}catch(p){n(p)}},l=c=>c.done?a(c.value):Promise.resolve(c.value).then(s,r);l((i=i.apply(e,t)).next())});var ie=ra((ef,oa)=>{oa.exports=Vue});var Kn=ra((tf,la)=>{la.exports=uni.Vuex});var Se=ee(ie());var V=ee(ie()),Fa=ee(Kn());var Il=e=>typeof e=="string",Rl="onResize";function xe(e){return weex.requireModule(e)}function M(e,t,...i){uni.__log__?uni.__log__(e,t,...i):console[e].apply(console,[...i,t])}function A(e,t){return Il(e)?t:e}var Ml=e=>(t,i=(0,V.getCurrentInstance)())=>{!V.isInSSRComponentSetup&&(0,V.injectHook)(e,t,i)},Na=Ml(Rl),Ol="dev",Ba,Pa,Ha,Ua,Ga;Ba="https://ztest1.candychat.link",Ua="https://mtest2.candychat.link",Ga="https://atest3.267girl.com",Pa="https://pic2.candychat.link/",Ha="https://pic3.candychat.link/";var Fl={wv:"13.2.0",ENV:Ol,apiHost:Ba,ossPath:Pa,pApiHost:Ua,oApiHost:Ga,ossPicPath:Ha,zT:3,appId:plus.runtime.appid,appV:parseInt(plus.runtime.version.split(".").join("")),OSS_PATH_V:1,OSS_PIC_PATH_V:1,API_HOST_V:1,isAndroid:plus.os.name=="Android",PHOTO:1,VIDEO:2,VOICE:3,TXT:4,SYSTEM_ID:1e7,M_TEXT:1,M_VOICE:2,M_IMG:3,M_GIFT:5,M_NOTICE:6,M_CALL:8,M_RECOMMEND_USER:11,M_RECOMMEND_CLUB:12,M_VIDEO:18,M_GIFT_ASK:21,M_NOTICE_SYS:22,M_EXPRESSION:23,M_LETTER:24,M_PAID_PHOTO:25,M_PAID_VIDEO:26,M_MATCH_SUCCESS:27,M_N_DEF:100,M_N_AUDIT:103,M_N_VIP:104,M_N_RECHARGE:105,M_N_CLUB_AUDIT_REJECT:106,M_N_CLUB_AUDIT:107,M_N_GREETING_AUDIT:115,M_N_SYS_NOTICE:116,M_N_CALL:117,M_N_COOPERATE:118,M_N_WITHDRAW:119,M_N_REPORT_AUDIT:120,M_N_IMG:121,M_N_PRIVACY_CALL:122,M_N_WITHDRAW_NOTICE:123,M_N_WITH_MEDIA:124,M_N_MONITOR:202,M_C_RECHARGE:1001,M_C_CALL_TEXT_AUDIO:1002,M_CHAT_PRI:1,M_CHAT_CLUB:2,M_CHAT_ASS:3,M_CHAT_NOTICE:4,M_CHAT_NOTIFY:5,M_CHAT_CLUB_NOTICE:6,PAY_TYPE_SUCCESS:0,PAY_TYPE_FAIL:1,PAY_TYPE_CANCEL:2,PAY_TYPE_NOT_EXIST:3,PAY_TYPE_NOT_ALLOW:4,PAY_TYPE_ERROR:5,MATCH_PRICE:10},f=Fl,Nl={LEVEL_33:33,LEVEL_29:29},ti={FIND:0,USER:1,MSG:2,MY:3},Ti={FIND:"/pages/user/index",MSG:"/pages/msg/index",CALL:"/pages/call-history/index",USER:"/pages/user/index",MY:"/pages/my/index"},Bl=["gif","heic"],ni={AGORA:"agora",DB:"db",MESSAGE:"message",AVATAR:"avatar",REPORT:"report",FEEDBACK:"feedback",WITHDRAW:"withdraw",CLUB:"club",BANNED:"banned",WARNING:"warning",ALBUM:"album",AUTH:"auth",LOG:"log"},ae={CREATE:1,JOIN:2,EDIT_NAME:3,MUTE_ALL_MEMBER:4,REMOVE:5,QUIT:6,DISSOLUTION:7,MUTE_MEMBER:8,MUTE_SEND_FAIL:9,INVITE_JOIN:10,SET_FOUNDER:11,SET_MANAGER:12,YOUR_GIFT_RETURN:13,GIFT_HAS_SIGNED:14,SIGN_GIFT:15,SIGN_GIFT_FAIL:16,YOUR_GIFT_SIGNED:17,ACTION_GIFT:18,GIFT_NO_REPLY_RETURN:19,GIFT_NO_ROB_RETURN:20,YOU_GIFT_ROB_OVER:21,GIFT_NO_SIGN_RETURN:22,FIRST_MSG_FEE:23,INVITE_FAILED:24,SIGNED_FOR:25},si={NOT_REPLY:1,NOT_CHEAT_USER:2},Pl={en:{title:"English",language:"en",code:"en-US"},es:{title:"espa\xF1ol",language:"es",code:"es-ES"},ar:{title:"\u0639\u0631\u0628\u064A",language:"ar",code:"ar-SA"},vi:{title:"Ti\u1EBFng Vi\u1EC7t",language:"vi",code:"vi-VN"},tr:{title:"T\xFCrk\xE7e",language:"tr",code:"tr-TR"},pt:{title:"Portugu\xEAs",language:"pt",code:"pt-PT"}};var os={ACCOUNT:0,LOGIN:1,MESSAGE:2,RECHARGE:6,MSG_SYSTEM:7,DEVICE:8,IP:9,CALL:10,WITHDRAW:11,JOIN_CLUB:14,CREATE_CLUB:15,COACH_LIST:16,SAY_HELLO_MSG:17,GIFT:18,MATCH:19,MOMENT:20,TASK:21,GAME:22,INVITE:23,CERTIFICATION:24,CONSUME:25,NOTIFICATION:26,RANKING_LIST:27},et={SUCCESS:0,FAIL:1,SEND_HIDE:2,KEFU_DEL:3,USER_DEL:4},ca={SUPER:1,KEFU:2},rn={GIFT:1,COIN:2,BOX:3};var ai={MOMENT:1,SIGN:2,CHECK_SIGN:3,MESSAGE:4,CHECK_NICKNAME:5,CALL:6,CLUB_INTRO:7,CHECK_CLUB_NAME:8,CHECK_CLUB_INTRO:9,REPORT:10,FEEDBACK:11,FEE_ALBUM:12,GREET:13,SENSITIVE:14,MSG_PRI:15,MSG_CLUB:16,MSG_SYS:17,MSG_KEFU:18,GAME_MSG:19,CHECK_CLUB_NAME_V1:20,CHECK_CLUB_INTRO_V1:21,CHECK_CLUB_REASON:22,CLUB_NAME:23,CLUB_APPLICATION_REASON:24,BANNED_REASON:25,WARNING_REASON:26};var Wa={USER:1,STREAMER:3,AGENT:5},ja={NORMAL:1,MANAGE_GIRL:2,OPERATOR:3},Hl={DISBAND:1,CHECK_RESULT:2},Ki={ONLINE:1,CHATTING:2,REST:3};var Ul=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",yt=e=>Ul?Symbol(e):e,Gl=(e,t,i)=>Wl({l:e,k:t,s:i}),Wl=e=>JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),Fe=e=>typeof e=="number"&&isFinite(e),jl=e=>ls(e)==="[object Date]",Qi=e=>ls(e)==="[object RegExp]",on=e=>ne(e)&&Object.keys(e).length===0;function Vl(e,t){typeof console!="undefined"&&(console.warn("[intlify] "+e),t&&console.warn(t.stack))}var We=Object.assign;function ua(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var zl=Object.prototype.hasOwnProperty;function Va(e,t){return zl.call(e,t)}var Le=Array.isArray,Ne=e=>typeof e=="function",H=e=>typeof e=="string",we=e=>typeof e=="boolean",Be=e=>e!==null&&typeof e=="object",za=Object.prototype.toString,ls=e=>za.call(e),ne=e=>ls(e)==="[object Object]",$l=e=>e==null?"":Le(e)||ne(e)&&e.toString===za?JSON.stringify(e,null,2):String(e);var Kl=Object.prototype.hasOwnProperty;function Yl(e,t){return Kl.call(e,t)}var Xi=e=>e!==null&&typeof e=="object",bt=[];bt[0]={w:[0],i:[3,0],["["]:[4],o:[7]};bt[1]={w:[1],["."]:[2],["["]:[4],o:[7]};bt[2]={w:[2],i:[3,0],[0]:[3,0]};bt[3]={i:[3,0],[0]:[3,0],w:[1,1],["."]:[2,1],["["]:[4,1],o:[7,1]};bt[4]={["'"]:[5,0],['"']:[6,0],["["]:[4,2],["]"]:[1,3],o:8,l:[4,0]};bt[5]={["'"]:[4,0],o:8,l:[5,0]};bt[6]={['"']:[4,0],o:8,l:[6,0]};var Jl=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function ql(e){return Jl.test(e)}function Xl(e){let t=e.charCodeAt(0),i=e.charCodeAt(e.length-1);return t===i&&(t===34||t===39)?e.slice(1,-1):e}function Zl(e){if(e==null)return"o";switch(e.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return e;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function Ql(e){let t=e.trim();return e.charAt(0)==="0"&&isNaN(parseInt(e))?!1:ql(t)?Xl(t):"*"+t}function ec(e){let t=[],i=-1,a=0,n=0,s,r,l,c,p,h,g,_=[];_[0]=()=>{r===void 0?r=l:r+=l},_[1]=()=>{r!==void 0&&(t.push(r),r=void 0)},_[2]=()=>{_[0](),n++},_[3]=()=>{if(n>0)n--,a=4,_[0]();else{if(n=0,r===void 0||(r=Ql(r),r===!1))return!1;_[1]()}};function C(){let b=e[i+1];if(a===5&&b==="'"||a===6&&b==='"')return i++,l="\\"+b,_[0](),!0}for(;a!==null;)if(i++,s=e[i],!(s==="\\"&&C())){if(c=Zl(s),g=bt[a],p=g[c]||g.l||8,p===8||(a=p[0],p[1]!==void 0&&(h=_[p[1]],h&&(l=s,h()===!1))))return;if(a===7)return t}}var da=new Map;function en(e,t){if(!Xi(e))return null;let i=da.get(t);if(i||(i=ec(t),i&&da.set(t,i)),!i)return null;let a=i.length,n=e,s=0;for(;s<a;){let r=n[i[s]];if(r===void 0)return null;n=r,s++}return n}function Xn(e){if(!Xi(e))return e;for(let t in e)if(Yl(e,t))if(!t.includes("."))Xi(e[t])&&Xn(e[t]);else{let i=t.split("."),a=i.length-1,n=e;for(let s=0;s<a;s++)i[s]in n||(n[i[s]]={}),n=n[i[s]];n[i[a]]=e[t],delete e[t],Xi(n[i[a]])&&Xn(n[i[a]])}return e}var tc=e=>e,ic=e=>"",nc="text",sc=e=>e.length===0?"":e.join(""),ac=$l;function pa(e,t){return e=Math.abs(e),t===2?e?e>1?1:0:1:e?Math.min(e,2):0}function rc(e){let t=Fe(e.pluralIndex)?e.pluralIndex:-1;return e.named&&(Fe(e.named.count)||Fe(e.named.n))?Fe(e.named.count)?e.named.count:Fe(e.named.n)?e.named.n:t:t}function oc(e,t){t.count||(t.count=e),t.n||(t.n=e)}function lc(e={}){let t=e.locale,i=rc(e),a=Be(e.pluralRules)&&H(t)&&Ne(e.pluralRules[t])?e.pluralRules[t]:pa,n=Be(e.pluralRules)&&H(t)&&Ne(e.pluralRules[t])?pa:void 0,s=L=>L[a(i,L.length,n)],r=e.list||[],l=L=>r[L],c=e.named||{};Fe(e.pluralIndex)&&oc(i,c);let p=L=>c[L];function h(L){let O=Ne(e.messages)?e.messages(L):Be(e.messages)?e.messages[L]:!1;return O||(e.parent?e.parent.message(L):ic)}let g=L=>e.modifiers?e.modifiers[L]:tc,_=ne(e.processor)&&Ne(e.processor.normalize)?e.processor.normalize:sc,C=ne(e.processor)&&Ne(e.processor.interpolate)?e.processor.interpolate:ac,b=ne(e.processor)&&H(e.processor.type)?e.processor.type:nc,N={list:l,named:p,plural:s,linked:(L,O)=>{let W=h(L)(N);return H(O)?g(O)(W):W},message:h,type:b,interpolate:C,normalize:_};return N}function $a(e,t,i={}){let{domain:a,messages:n,args:s}=i,r=e,l=new SyntaxError(String(r));return l.code=e,t&&(l.location=t),l.domain=a,l}var cc="9.1.9",ln=-1,ha="";function uc(){return{upper:e=>H(e)?e.toUpperCase():e,lower:e=>H(e)?e.toLowerCase():e,capitalize:e=>H(e)?`${e.charAt(0).toLocaleUpperCase()}${e.substr(1)}`:e}}var dc,ma=0;function pc(e={}){let t=H(e.version)?e.version:cc,i=H(e.locale)?e.locale:"en-US",a=Le(e.fallbackLocale)||ne(e.fallbackLocale)||H(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:i,n=ne(e.messages)?e.messages:{[i]:{}},s=ne(e.datetimeFormats)?e.datetimeFormats:{[i]:{}},r=ne(e.numberFormats)?e.numberFormats:{[i]:{}},l=We({},e.modifiers||{},uc()),c=e.pluralRules||{},p=Ne(e.missing)?e.missing:null,h=we(e.missingWarn)||Qi(e.missingWarn)?e.missingWarn:!0,g=we(e.fallbackWarn)||Qi(e.fallbackWarn)?e.fallbackWarn:!0,_=!!e.fallbackFormat,C=!!e.unresolving,b=Ne(e.postTranslation)?e.postTranslation:null,N=ne(e.processor)?e.processor:null,L=we(e.warnHtmlMessage)?e.warnHtmlMessage:!0,O=!!e.escapeParameter,W=Ne(e.messageCompiler)?e.messageCompiler:dc,Y=Ne(e.onWarn)?e.onWarn:Vl,D=e,J=Be(D.__datetimeFormatters)?D.__datetimeFormatters:new Map,Me=Be(D.__numberFormatters)?D.__numberFormatters:new Map,st=Be(D.__meta)?D.__meta:{};return ma++,{version:t,cid:ma,locale:i,fallbackLocale:a,messages:n,datetimeFormats:s,numberFormats:r,modifiers:l,pluralRules:c,missing:p,missingWarn:h,fallbackWarn:g,fallbackFormat:_,unresolving:C,postTranslation:b,processor:N,warnHtmlMessage:L,escapeParameter:O,messageCompiler:W,onWarn:Y,__datetimeFormatters:J,__numberFormatters:Me,__meta:st}}function cs(e,t,i,a,n){let{missing:s,onWarn:r}=e;if(s!==null){let l=s(e,i,t,n);return H(l)?l:t}else return t}function Mi(e,t,i){let a=e;a.__localeChainCache||(a.__localeChainCache=new Map);let n=a.__localeChainCache.get(i);if(!n){n=[];let s=[i];for(;Le(s);)s=ga(n,s,t);let r=Le(t)?t:ne(t)?t.default?t.default:null:t;s=H(r)?[r]:r,Le(s)&&ga(n,s,!1),a.__localeChainCache.set(i,n)}return n}function ga(e,t,i){let a=!0;for(let n=0;n<t.length&&we(a);n++){let s=t[n];H(s)&&(a=hc(e,t[n],i))}return a}function hc(e,t,i){let a,n=t.split("-");do{let s=n.join("-");a=mc(e,s,i),n.splice(-1,1)}while(n.length&&a===!0);return a}function mc(e,t,i){let a=!1;if(!e.includes(t)&&(a=!0,t)){a=t[t.length-1]!=="!";let n=t.replace(/!/g,"");e.push(n),(Le(i)||ne(i))&&i[n]&&(a=i[n])}return a}function Ai(e,t,i){let a=e;a.__localeChainCache=new Map,Mi(e,i,t)}function Zt(e){return $a(e,null,void 0)}var fa=()=>"",Ft=e=>Ne(e);function _a(e,...t){let{fallbackFormat:i,postTranslation:a,unresolving:n,fallbackLocale:s,messages:r}=e,[l,c]=Zn(...t),p=we(c.missingWarn)?c.missingWarn:e.missingWarn,h=we(c.fallbackWarn)?c.fallbackWarn:e.fallbackWarn,g=we(c.escapeParameter)?c.escapeParameter:e.escapeParameter,_=!!c.resolvedMessage,C=H(c.default)||we(c.default)?we(c.default)?l:c.default:i?l:"",b=i||C!=="",N=H(c.locale)?c.locale:e.locale;g&&gc(c);let[L,O,W]=_?[l,N,r[N]||{}]:fc(e,l,N,s,h,p),Y=l;if(!_&&!(H(L)||Ft(L))&&b&&(L=C,Y=L),!_&&(!(H(L)||Ft(L))||!H(O)))return n?ln:l;let D=!1,J=()=>{D=!0},Me=Ft(L)?L:Ka(e,l,O,L,Y,J);if(D)return L;let st=bc(e,O,W,c),ke=lc(st),Ue=_c(e,Me,ke);return a?a(Ue):Ue}function gc(e){Le(e.list)?e.list=e.list.map(t=>H(t)?ua(t):t):Be(e.named)&&Object.keys(e.named).forEach(t=>{H(e.named[t])&&(e.named[t]=ua(e.named[t]))})}function fc(e,t,i,a,n,s){let{messages:r,onWarn:l}=e,c=Mi(e,a,i),p={},h,g=null,_="translate";for(let C=0;C<c.length&&(h=c[C],p=r[h]||{},(g=en(p,t))===null&&(g=p[t]),!(H(g)||Ne(g)));C++){let b=cs(e,t,h,s,_);b!==t&&(g=b)}return[g,h,p]}function Ka(e,t,i,a,n,s){let{messageCompiler:r,warnHtmlMessage:l}=e;if(Ft(a)){let p=a;return p.locale=p.locale||i,p.key=p.key||t,p}let c=r(a,yc(e,i,n,a,l,s));return c.locale=i,c.key=t,c.source=a,c}function _c(e,t,i){return t(i)}function Zn(...e){let[t,i,a]=e,n={};if(!H(t)&&!Fe(t)&&!Ft(t))throw Zt(14);let s=Fe(t)?String(t):(Ft(t),t);return Fe(i)?n.plural=i:H(i)?n.default=i:ne(i)&&!on(i)?n.named=i:Le(i)&&(n.list=i),Fe(a)?n.plural=a:H(a)?n.default=a:ne(a)&&We(n,a),[s,n]}function yc(e,t,i,a,n,s){return{warnHtmlMessage:n,onError:r=>{throw s&&s(r),r},onCacheKey:r=>Gl(t,i,r)}}function bc(e,t,i,a){let{modifiers:n,pluralRules:s}=e,l={locale:t,modifiers:n,pluralRules:s,messages:c=>{let p=en(i,c);if(H(p)){let h=!1,_=Ka(e,c,t,p,c,()=>{h=!0});return h?fa:_}else return Ft(p)?p:fa}};return e.processor&&(l.processor=e.processor),a.list&&(l.list=a.list),a.named&&(l.named=a.named),Fe(a.plural)&&(l.pluralIndex=a.plural),l}function ya(e,...t){let{datetimeFormats:i,unresolving:a,fallbackLocale:n,onWarn:s}=e,{__datetimeFormatters:r}=e,[l,c,p,h]=Qn(...t),g=we(p.missingWarn)?p.missingWarn:e.missingWarn;we(p.fallbackWarn)?p.fallbackWarn:e.fallbackWarn;let _=!!p.part,C=H(p.locale)?p.locale:e.locale,b=Mi(e,n,C);if(!H(l)||l==="")return new Intl.DateTimeFormat(C).format(c);let N={},L,O=null,W="datetime format";for(let J=0;J<b.length&&(L=b[J],N=i[L]||{},O=N[l],!ne(O));J++)cs(e,l,L,g,W);if(!ne(O)||!H(L))return a?ln:l;let Y=`${L}__${l}`;on(h)||(Y=`${Y}__${JSON.stringify(h)}`);let D=r.get(Y);return D||(D=new Intl.DateTimeFormat(L,We({},O,h)),r.set(Y,D)),_?D.formatToParts(c):D.format(c)}function Qn(...e){let[t,i,a,n]=e,s={},r={},l;if(H(t)){if(!/\d{4}-\d{2}-\d{2}(T.*)?/.test(t))throw Zt(16);l=new Date(t);try{l.toISOString()}catch(c){throw Zt(16)}}else if(jl(t)){if(isNaN(t.getTime()))throw Zt(15);l=t}else if(Fe(t))l=t;else throw Zt(14);return H(i)?s.key=i:ne(i)&&(s=i),H(a)?s.locale=a:ne(a)&&(r=a),ne(n)&&(r=n),[s.key||"",l,s,r]}function ba(e,t,i){let a=e;for(let n in i){let s=`${t}__${n}`;a.__datetimeFormatters.has(s)&&a.__datetimeFormatters.delete(s)}}function xa(e,...t){let{numberFormats:i,unresolving:a,fallbackLocale:n,onWarn:s}=e,{__numberFormatters:r}=e,[l,c,p,h]=es(...t),g=we(p.missingWarn)?p.missingWarn:e.missingWarn;we(p.fallbackWarn)?p.fallbackWarn:e.fallbackWarn;let _=!!p.part,C=H(p.locale)?p.locale:e.locale,b=Mi(e,n,C);if(!H(l)||l==="")return new Intl.NumberFormat(C).format(c);let N={},L,O=null,W="number format";for(let J=0;J<b.length&&(L=b[J],N=i[L]||{},O=N[l],!ne(O));J++)cs(e,l,L,g,W);if(!ne(O)||!H(L))return a?ln:l;let Y=`${L}__${l}`;on(h)||(Y=`${Y}__${JSON.stringify(h)}`);let D=r.get(Y);return D||(D=new Intl.NumberFormat(L,We({},O,h)),r.set(Y,D)),_?D.formatToParts(c):D.format(c)}function es(...e){let[t,i,a,n]=e,s={},r={};if(!Fe(t))throw Zt(14);let l=t;return H(i)?s.key=i:ne(i)&&(s=i),H(a)?s.locale=a:ne(a)&&(r=a),ne(n)&&(r=n),[s.key||"",l,s,r]}function wa(e,t,i){let a=e;for(let n in i){let s=`${t}__${n}`;a.__numberFormatters.has(s)&&a.__numberFormatters.delete(s)}}var xc="9.1.9";function Mt(e,...t){return $a(e,null,void 0)}var ts=yt("__transrateVNode"),is=yt("__datetimeParts"),ns=yt("__numberParts");yt("__enableEmitter");yt("__disableEmitter");var wc=yt("__setPluralRules");yt("__intlifyMeta");var Ya=yt("__injectWithOption"),Ca=0;function Sa(e){return(t,i,a,n)=>e(i,a,(0,V.getCurrentInstance)()||void 0,n)}function Ja(e,t){let{messages:i,__i18n:a}=t,n=ne(i)?i:Le(a)?{}:{[e]:{}};if(Le(a)&&a.forEach(({locale:s,resource:r})=>{s?(n[s]=n[s]||{},tn(r,n[s])):tn(r,n)}),t.flatJson)for(let s in n)Va(n,s)&&Xn(n[s]);return n}var Yi=e=>!Be(e)||Le(e);function tn(e,t){if(Yi(e)||Yi(t))throw Mt(20);for(let i in e)Va(e,i)&&(Yi(e[i])||Yi(t[i])?t[i]=e[i]:tn(e[i],t[i]))}function Cc(e={}){let{__root:t}=e,i=t===void 0,a=we(e.inheritLocale)?e.inheritLocale:!0,n=(0,V.ref)(t&&a?t.locale.value:H(e.locale)?e.locale:"en-US"),s=(0,V.ref)(t&&a?t.fallbackLocale.value:H(e.fallbackLocale)||Le(e.fallbackLocale)||ne(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:n.value),r=(0,V.ref)(Ja(n.value,e)),l=(0,V.ref)(ne(e.datetimeFormats)?e.datetimeFormats:{[n.value]:{}}),c=(0,V.ref)(ne(e.numberFormats)?e.numberFormats:{[n.value]:{}}),p=t?t.missingWarn:we(e.missingWarn)||Qi(e.missingWarn)?e.missingWarn:!0,h=t?t.fallbackWarn:we(e.fallbackWarn)||Qi(e.fallbackWarn)?e.fallbackWarn:!0,g=t?t.fallbackRoot:we(e.fallbackRoot)?e.fallbackRoot:!0,_=!!e.fallbackFormat,C=Ne(e.missing)?e.missing:null,b=Ne(e.missing)?Sa(e.missing):null,N=Ne(e.postTranslation)?e.postTranslation:null,L=we(e.warnHtmlMessage)?e.warnHtmlMessage:!0,O=!!e.escapeParameter,W=t?t.modifiers:ne(e.modifiers)?e.modifiers:{},Y=e.pluralRules||t&&t.pluralRules,D;function J(){return pc({version:xc,locale:n.value,fallbackLocale:s.value,messages:r.value,messageCompiler:function(I){return $e=>$e.normalize([I])},datetimeFormats:l.value,numberFormats:c.value,modifiers:W,pluralRules:Y,missing:b===null?void 0:b,missingWarn:p,fallbackWarn:h,fallbackFormat:_,unresolving:!0,postTranslation:N===null?void 0:N,warnHtmlMessage:L,escapeParameter:O,__datetimeFormatters:ne(D)?D.__datetimeFormatters:void 0,__numberFormatters:ne(D)?D.__numberFormatters:void 0,__v_emitter:ne(D)?D.__v_emitter:void 0,__meta:{framework:"vue"}})}D=J(),Ai(D,n.value,s.value);function Me(){return[n.value,s.value,r.value,l.value,c.value]}let st=(0,V.computed)({get:()=>n.value,set:S=>{n.value=S,D.locale=n.value}}),ke=(0,V.computed)({get:()=>s.value,set:S=>{s.value=S,D.fallbackLocale=s.value,Ai(D,n.value,S)}}),Ue=(0,V.computed)(()=>r.value),ze=(0,V.computed)(()=>l.value),Kt=(0,V.computed)(()=>c.value);function Yt(){return Ne(N)?N:null}function Jt(S){N=S,D.postTranslation=S}function Si(){return C}function Gn(S){S!==null&&(b=Sa(S)),C=S,D.missing=b}function gt(S,I,$e,Oe,Vn,$i){Me();let ki;if(ki=S(D),Fe(ki)&&ki===ln){let[Cl,Zg]=I();return t&&g?Oe(t):Vn(Cl)}else{if($i(ki))return ki;throw Mt(14)}}function zi(...S){return gt(I=>_a(I,...S),()=>Zn(...S),"translate",I=>I.t(...S),I=>I,I=>H(I))}function Wn(...S){let[I,$e,Oe]=S;if(Oe&&!Be(Oe))throw Mt(15);return zi(I,$e,We({resolvedMessage:!0},Oe||{}))}function jn(...S){return gt(I=>ya(I,...S),()=>Qn(...S),"datetime format",I=>I.d(...S),()=>ha,I=>H(I))}function x(...S){return gt(I=>xa(I,...S),()=>es(...S),"number format",I=>I.n(...S),()=>ha,I=>H(I))}function Q(S){return S.map(I=>H(I)?(0,V.createVNode)(V.Text,null,I,0):I)}let rl={normalize:Q,interpolate:S=>S,type:"vnode"};function ol(...S){return gt(I=>{let $e,Oe=I;try{Oe.processor=rl,$e=_a(Oe,...S)}finally{Oe.processor=null}return $e},()=>Zn(...S),"translate",I=>I[ts](...S),I=>[(0,V.createVNode)(V.Text,null,I,0)],I=>Le(I))}function ll(...S){return gt(I=>xa(I,...S),()=>es(...S),"number format",I=>I[ns](...S),()=>[],I=>H(I)||Le(I))}function cl(...S){return gt(I=>ya(I,...S),()=>Qn(...S),"datetime format",I=>I[is](...S),()=>[],I=>H(I)||Le(I))}function ul(S){Y=S,D.pluralRules=Y}function dl(S,I){let $e=H(I)?I:n.value,Oe=ta($e);return en(Oe,S)!==null}function pl(S){let I=null,$e=Mi(D,s.value,n.value);for(let Oe=0;Oe<$e.length;Oe++){let Vn=r.value[$e[Oe]]||{},$i=en(Vn,S);if($i!=null){I=$i;break}}return I}function hl(S){let I=pl(S);return I!=null?I:t?t.tm(S)||{}:{}}function ta(S){return r.value[S]||{}}function ml(S,I){r.value[S]=I,D.messages=r.value}function gl(S,I){r.value[S]=r.value[S]||{},tn(I,r.value[S]),D.messages=r.value}function fl(S){return l.value[S]||{}}function _l(S,I){l.value[S]=I,D.datetimeFormats=l.value,ba(D,S,I)}function yl(S,I){l.value[S]=We(l.value[S]||{},I),D.datetimeFormats=l.value,ba(D,S,I)}function bl(S){return c.value[S]||{}}function xl(S,I){c.value[S]=I,D.numberFormats=c.value,wa(D,S,I)}function wl(S,I){c.value[S]=We(c.value[S]||{},I),D.numberFormats=c.value,wa(D,S,I)}return Ca++,t&&((0,V.watch)(t.locale,S=>{a&&(n.value=S,D.locale=S,Ai(D,n.value,s.value))}),(0,V.watch)(t.fallbackLocale,S=>{a&&(s.value=S,D.fallbackLocale=S,Ai(D,n.value,s.value))})),{id:Ca,locale:st,fallbackLocale:ke,get inheritLocale(){return a},set inheritLocale(S){a=S,S&&t&&(n.value=t.locale.value,s.value=t.fallbackLocale.value,Ai(D,n.value,s.value))},get availableLocales(){return Object.keys(r.value).sort()},messages:Ue,datetimeFormats:ze,numberFormats:Kt,get modifiers(){return W},get pluralRules(){return Y||{}},get isGlobal(){return i},get missingWarn(){return p},set missingWarn(S){p=S,D.missingWarn=p},get fallbackWarn(){return h},set fallbackWarn(S){h=S,D.fallbackWarn=h},get fallbackRoot(){return g},set fallbackRoot(S){g=S},get fallbackFormat(){return _},set fallbackFormat(S){_=S,D.fallbackFormat=_},get warnHtmlMessage(){return L},set warnHtmlMessage(S){L=S,D.warnHtmlMessage=S},get escapeParameter(){return O},set escapeParameter(S){O=S,D.escapeParameter=S},t:zi,rt:Wn,d:jn,n:x,te:dl,tm:hl,getLocaleMessage:ta,setLocaleMessage:ml,mergeLocaleMessage:gl,getDateTimeFormat:fl,setDateTimeFormat:_l,mergeDateTimeFormat:yl,getNumberFormat:bl,setNumberFormat:xl,mergeNumberFormat:wl,getPostTranslationHandler:Yt,setPostTranslationHandler:Jt,getMissingHandler:Si,setMissingHandler:Gn,[ts]:ol,[ns]:ll,[is]:cl,[wc]:ul,[Ya]:e.__injectWithOption}}var us={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:e=>e==="parent"||e==="global",default:"parent"},i18n:{type:Object}};We({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:e=>Fe(e)||!isNaN(e)}},us);function Sc({slots:e},t){return t.length===1&&t[0]==="default"?e.default?e.default():[]:t.reduce((i,a)=>{let n=e[a];return n&&(i[a]=n()),i},{})}function qa(e,t,i,a){let{slots:n,attrs:s}=t;return()=>{let r={part:!0},l={};e.locale&&(r.locale=e.locale),H(e.format)?r.key=e.format:Be(e.format)&&(H(e.format.key)&&(r.key=e.format.key),l=Object.keys(e.format).reduce((g,_)=>i.includes(_)?We({},g,{[_]:e.format[_]}):g,{}));let c=a(e.value,r,l),p=[r.key];Le(c)?p=c.map((g,_)=>{let C=n[g.type];return C?C({[g.type]:g.value,index:_,parts:c}):[g.value]}):H(c)&&(p=[c]);let h=We({},s);return H(e.tag)?(0,V.h)(e.tag,h,p):Be(e.tag)?(0,V.h)(e.tag,h,p):(0,V.h)(V.Fragment,h,p)}}var kc=["localeMatcher","style","unit","unitDisplay","currency","currencyDisplay","useGrouping","numberingSystem","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","notation","formatMatcher"];We({value:{type:Number,required:!0},format:{type:[String,Object]}},us);var Ac=["dateStyle","timeStyle","fractionalSecondDigits","calendar","dayPeriod","numberingSystem","localeMatcher","timeZone","hour12","hourCycle","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"];We({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},us);function ds(e={}){let t=(0,V.getCurrentInstance)();if(t==null)throw Mt(16);if(!t.appContext.app.__VUE_I18N_SYMBOL__)throw Mt(17);let i=(0,V.inject)(t.appContext.app.__VUE_I18N_SYMBOL__);if(!i)throw Mt(22);let a=i.mode==="composition"?i.global:i.global.__composer,n=on(e)?"__i18n"in t.type?"local":"global":e.useScope?e.useScope:"local";if(n==="global"){let l=Be(e.messages)?e.messages:{};"__i18nGlobal"in t.type&&(l=Ja(a.locale.value,{messages:l,__i18n:t.type.__i18nGlobal}));let c=Object.keys(l);if(c.length&&c.forEach(p=>{a.mergeLocaleMessage(p,l[p])}),Be(e.datetimeFormats)){let p=Object.keys(e.datetimeFormats);p.length&&p.forEach(h=>{a.mergeDateTimeFormat(h,e.datetimeFormats[h])})}if(Be(e.numberFormats)){let p=Object.keys(e.numberFormats);p.length&&p.forEach(h=>{a.mergeNumberFormat(h,e.numberFormats[h])})}return a}if(n==="parent"){let l=Tc(i,t,e.__useComponent);return l==null&&(l=a),l}if(i.mode==="legacy")throw Mt(18);let s=i,r=s.__getInstance(t);if(r==null){let l=t.type,c=We({},e);l.__i18n&&(c.__i18n=l.__i18n),a&&(c.__root=a),r=Cc(c),vc(s,t),s.__setInstance(t,r)}return r}function Tc(e,t,i=!1){let a=null,n=t.root,s=t.parent;for(;s!=null;){let r=e;if(e.mode==="composition")a=r.__getInstance(s);else{let l=r.__getInstance(s);l!=null&&(a=l.__composer),i&&a&&!a[Ya]&&(a=null)}if(a!=null||n===s)break;s=s.parent}return a}function vc(e,t,i){(0,V.onMounted)(()=>{},t),(0,V.onUnmounted)(()=>{e.__deleteInstance(t)},t)}function se(e,t,i=!1,a=null){let n=ps(e,i);a?uni.setStorage({key:n,data:t,success:a}):uni.setStorageSync(n,t)}function X(e,t=!1,i=null){let a=ps(e,t);if(i)uni.getStorage({key:a,success:i});else return uni.getStorageSync(a)}function lt(e,t=!1){uni.removeStorage({key:ps(e,t)})}function ps(e,t){return t?`_a_${e}`:`m_${e}`}function Xa(e,t,i){let a=i;typeof i=="undefined"&&(a=getApp().globalData.uid),se(e+"_"+a,t)}function hs(e,t){let i=t;return typeof t=="undefined"&&(i=getApp().globalData.uid),X(e+"_"+i)}var Li={NONE:0,WAITING:1,GAME:2,WEEK_UP:3,JUDGE_ROOM:100};var rt={VIDEO:1,VOICE:2},cn={CALL:1,ANSWER:2,MATCH_ACCEPT:3,MATCH_CONNECT:4},ms={CALL:1,MATCH:2},gs={DEF:0,NOTIFY:1,CONNECT:2},un={HOME:0,MSG:1,MATCH:2,RECOMMEND:3,MATCH_NOTIFY:4,QUALITY:5,NO_COINS_DIALOG:6,CALL_LOG:7,GAME_MATCH:8,GAME_MATCH_NOTIFY:9,RANKING_LIST:10,PRIVACY_SET_MSG:11,MOMENT:12,CALlING:98,FREE_MIN_POP:99,ANSWER_ERROR:100,END_PAGE:101,APP_NOTIFY:102};function Ve(e){return e==1?u("himLower"):u("herLower")}function fs(e){return e==1?u("heLower"):u("sheLower")}function Za(e){return e>=12?`1 ${u("yearLower")}`:`${e} ${Dc(e)}`}function Dc(e){return e>1?u("monthsLower"):u("monthLower")}function Qa(e){return e>1?u("weeksLower"):u("weekLower")}function er(e){return e>1?u("daysLower"):u("dayLower")}function Lc(e){return e>1?u("hoursLower"):u("hourLower")}function tr(e){return e>1?u("minsLower"):u("minLower")}function ir(e){return e==1?u("videoChatLower"):u("audioChatLower")}function ri(e){return`${e} ${e>1?u("coinsLower"):u("coinLower")}`}function Ec(e){return e>1?u("time.hoursAgo",{number:e}):u("time.hourAgo",{number:e})}function ka(e){return e>1?u("time.daysAgo",{number:e}):u("time.dayAgo",{number:e})}function Aa(e){return e>1?u("time.minutesAgo",{number:e}):u("time.minuteAgo",{number:e})}function nr(e){return e==1?u("himselfLower"):u("herselfLower")}function Oi(e){return e+" "+Lc(e)}function y(e){return typeof e=="undefined"||e==null||e==""}function Ic(e){return e===""||e===null}var Ke=new Promise(()=>{});function Rc(e,t,i=""){if(y(e))return"";let a=[];for(let n in e)a.push(n+"="+e[n]);return i+a.join(t)}function Qt(e){return typeof e=="number"?e+"":typeof e=="boolean"?e?"true":"false":y(e)?"null":typeof e=="object"?JSON.stringify(e):e}function me(e){return e.replace(new RegExp("'","gm"),"\uFF07")}function Nt(e){return e.replace(new RegExp("\uFF07","gm"),"'")}function Ji(e,t){let i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in i)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,RegExp.$1.length==1?i[a]:("00"+i[a]).substr((""+i[a]).length)));return t}function oi(e,t=18){if(y(e))return"";let i=new Date(Date.parse(e.replace(/-/g,"/"))),a=Math.ceil((new Date().getTime()-i)/31536e6),n=a>1?a-1:a;return n<t?t:n}function Mc(e){return e=parseInt(e),e.toString().length==16?e=Math.round(e/1e3):e<1e10&&(e=e*1e3),e}function Rt(e){return e<10?"0"+e:e}function sr(e,t=!1,i=!1,a=!0){e<1e10&&(e=e*1e3);var n=new Date(e),s=n.getFullYear(),r=n.getMonth()+1,l=n.getDate(),c=n.getHours(),p=n.getMinutes(),h=n.getSeconds();let g=t?`${s}-`:"";if(i)return g+Rt(r)+"-"+Rt(l);{let _=a?":"+Rt(h):"";return g+Rt(r)+"-"+Rt(l)+" "+Rt(c)+":"+Rt(p)+_}}function _s(e,t=!0,i=!1,a=""){if(y(e))return"";e=Mc(e);let n;a==""?n=new Date:n=Oc(a);let s=new Date(e),r=n.getFullYear(),l=n.getMonth()+1,c=n.getDate(),p=s.getFullYear(),h=s.getMonth()+1,g=s.getDate(),_="",C=t?" "+Ji(s,"hh:mm"):"";if(r==p){let O=n.getTime()-e;if(l==h&&c==g)O<60*1e3&&!t?_=u("just"):_=`${u("today")} ${Ji(s,"hh:mm")}`;else{let W=new Date;W.setDate(W.getDate()-1);let Y=new Date;if(Y.setDate(Y.getDate()-2),h==W.getMonth()+1&&g==W.getDate())_=`${u("yesterday")} ${C}`;else{var b=O/36e5;if(b<=7*24){let D=new Array(7),J=i?"Short":"";D[0]=u("week.sun"+J),D[1]=u("week.mon"+J),D[2]=u("week.tues"+J),D[3]=u("week.wed"+J),D[4]=u("week.thur"+J),D[5]=u("week.fri"+J),D[6]=u("week.sat"+J);var N=D[s.getDay()];_=N+" "+C}else _=Ji(s,"M/d")+C}}}else _=Ji(s,"M/d")+C;return _}function Oc(e){let t=new Date,i=t.getTime(),s=t.getTimezoneOffset()*6e4+i+36e5*e;return new Date(s)}function tt(e,t=!1){if(y(e)||e<0||isNaN(e))return t?"00:00:00":"00:00";var i=0,a=0;e>0&&e<10?e="0"+parseInt(e):e<=0?e="00":e>60&&(i=parseInt(e/60)<10?"0"+parseInt(e/60):parseInt(e/60),e=parseInt(e%60)<10?"0"+parseInt(e%60):parseInt(e%60),i>60&&(a=parseInt(i/60)<10?"0"+parseInt(i/60):parseInt(i/60),i=parseInt(i%60)<10?"0"+parseInt(i%60):parseInt(i%60)));var n;return a>0?n=a+":"+i+":"+e:i>0?(n=i+":"+e,t&&(n="00:"+n)):(n="00:"+e,t&&(n="00:"+n)),n}function dn(e,t,i){return Math.abs(e-t)>i*60*1e3}function re(e){try{let t=JSON.parse(e);if(typeof t=="object")return t}catch(t){}return!1}function pn(e){let t=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e.match(t)}function ys(e,t){for(let i in e)if(t[i]!=null&&e[i]!=t[i])return!0;return!1}function ar(e){return y(e)?!0:Object.keys(e).length<=0}function rr(e,t){let i=t-e,a=Math.random();return e+Math.round(a*i)}function or(){return Math.random().toString(36).substr(2)}function li(e){return!!(e.startsWith("file://")||e.startsWith("/var/mobile/")||e.indexOf("apps/__UNI")!=-1||e.startsWith("/storage/")||e.startsWith("_doc/uniapp_temp"))}function lr(e,t=3,i=0){let a=60,n=a*60,s=n*24,c=Date.parse(new Date).toString().substr(0,10)-e;if(c<0)return Aa(1);let p=c/s,h=c/n,g=c/a;if(p>t)return ka(t);if(p>=1&&p<t)return ka(parseInt(p));if(h>=1&&h<24)return Ec(parseInt(h));if(g>=0&&g<60){if(i!=0&&g<=i)return u("online");let _=parseInt(g);return Aa(_==0?1:_)}}var Yn={};function bs(e,t=500,i="throttle"){let a=e.name;y(a)&&(a=i),!Yn[a]&&(Yn[a]=!0,e(),setTimeout(function(){Yn[a]=""},t))}function Bt(e,t,i=1e4){return e<=0||t<=0?[108,192]:(t>e?(t=t*108/e,t>i&&(t=i),e=108):(t=t*148/e,e=148),[e,t])}function Fc(e){if(y(e))return"";let t=e.split("/");if(y(t))return"";let i=t[t.length-1];if(y(i))return"";let a=i.split(".");if(y(a))return"";let n=a[a.length-1];return y(n)?"":n.toLowerCase()}function cr(e){if(!e)return"";let t=JSON.stringify(e);return(typeof t!="string"||t=="{}")&&(t=e.toString()),t}function Nc(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}var Ot={adminAgencyList:"/pagesAdmin/agency/list",adminAgencyDetail:"/pagesAdmin/agency/agency-detail",adminAgencyEdit:"/pagesAdmin/agency/agency-edit",adminAgencyEditPrice:"/pagesAdmin/agency/agency-edit-price",adminAgencyEditWithdrawInfo:"/pagesAdmin/agency/withdraw-info",adminAgencyEditName:"/pagesAdmin/agency/agency-edit-nickname",adminAgencyEditCountry:"/pagesAdmin/agency/agency-edit-country",adminAgencyEditEmail:"/pagesAdmin/agency/agency-edit-email",adminAgencyEditWhatsApp:"/pagesAdmin/agency/agency-edit-whatsapp",adminAgencyInvited:"/pagesAdmin/agency/invited",adminAgencyListSub:"/pagesAdmin/agency/list-sub",adminAgencyGirlsList:"/pagesAdmin/agency/girls-list",adminAgencyGirlsListSub:"/pagesAdmin/agency/girls-list-sub",adminAgencyDataPanel:"/pagesAdmin/agency/data-panel",adminAgencyDataHistory:"/pagesAdmin/agency/data-history",adminAgencyDataDetail:"/pagesAdmin/agency/data-detail",adminAgencyDataDetailTask:"/pagesAdmin/agency/data-detail-task",adminAgencyWithdrawRecords:"/pagesAdmin/agency/withdraw-records",adminAgencyWalletDetail:"/pagesAdmin/agency/wallet-detail",adminAgencyHandleBan:"/pagesAdmin/agency/handle-ban",adminAgencyHandleDelete:"/pagesAdmin/agency/handle-delete",adminAgencySelected:"/pagesAdmin/agency/selected-agency",adminAgencyStatus:"/pagesAdmin/agency/agency-status",adminAgencySubAgencyList:"/pagesAdmin/agency/sub-agency-list",adminAgencyWithdrawGirlList:"/pagesAdmin/agency/withdraw/girl-list",adminAgencyWithdrawSubAgentList:"/pagesAdmin/agency/withdraw/sub-agent-list",adminAgencyWithdrawSettlementDetail:"/pagesAdmin/agency/withdraw/settlement-detail",adminAgencyWithdrawEntiretyDetail:"/pagesAdmin/agency/withdraw/entirety-detail",adminAgencyWithdrawEntiretyDetailReject:"/pagesAdmin/agency/withdraw/entirety-detail-reject",adminAgencyHistoricalMemberList:"/pagesAdmin/agency/historical-list",adminAgencyWithdrawSubAgentDetail:"/pagesAdmin/agency/withdraw/sub-agent-detail",adminAuditSettlement:"/pagesAdmin/auditNew/settlement",adminAuditSettlementSub:"/pagesAdmin/auditNew/settlement-sub",adminAuditWithdraw:"/pagesAdmin/auditNew/withdraw",adminAuditWithdrawCashList:"/pagesAdmin/audit/withdraw-cash-list",adminWallet:"/pagesAdmin/wallet/wallet",adminWalletCoinStat:"/pagesAdmin/wallet/coin-stat",adminAgencyAnchorDetail:"/pagesAdmin/agencyManager/anchor-detail",adminChannelBackend:"/pagesAdmin/channel/channel-backend",adminAuditAgencyAvatar:"/pagesAdmin/auditNew/agency-avatar",adminAuditAgencyName:"/pagesAdmin/auditNew/agency-name",adminAuditCheckAllUnderReview:"/pagesAdmin/audit/check-all-under-review",adminPermissionWebManage:"/pagesAdmin/more/permission-web-manage",adminPermissionList:"/pagesAdmin/more/permission-list",adminPermissionEdit:"/pagesAdmin/more/permission-edit",adminPermissionNewAccount:"/pagesAdmin/more/permission-new-account",adminPermissionChooseRole:"/pagesAdmin/more/permission-choose-role",adminPermissionNewRole:"/pagesAdmin/more/permission-new-role",adminWhiteList:"/pagesAdmin/more/white-list",adminCallEvaluationList:"/pagesAdmin/user/call-evaluation-list",adminWarnDeviceUser:"/pagesAdmin/user/ban-device-user",adminWarnList:"/pagesAdmin/audit/warn-list",adminVersionUseList:"/pagesAdmin/more/version-use-list",adminAuditSettlementReview:"/pagesAdmin/auditNew/settlement-review",adminAuditWithdrawReview:"/pagesAdmin/auditNew/withdraw-review",adminClubApplication:"/pagesAdmin/auditNew/club-application",adminClubModification:"/pagesAdmin/auditNew/club-modification",adminClubManagement:"/pagesAdmin/club/management",warningDialog:"/pagesDialog/warning",homeFilterSexGuide:"/pagesDialog/home-filter-sex-guide",club:"/pagesClub/club",clubReachLevel:"/pagesDialog/club-reach-level",clubStatusRemind:"/pagesDialog/club-status-remind",clubApplyCreate:"/pagesClub/apply-create",clubCreateSuccess:"/pagesClub/create-success",clubRules:"/pagesDialog/club-rules",clubApplicationList:"/pagesClub/application-list",clubWarning:"/pagesDialog/club-warning",clubDisband:"/pagesDialog/club-disband",adminClubManagementSub:"/pagesAdmin/club/management-sub",adminClubTodayNew:"/pagesAdmin/club/club-today-new",adminClubNormal:"/pagesAdmin/club/club-normal",adminClubManageGirls:"/pagesAdmin/club/club-manage-girls",adminClubOperator:"/pagesAdmin/club/club-operator",adminClubDisbanded:"/pagesAdmin/club/club-disbanded",adminClubMemberList:"/pagesAdmin/club/member-new",adminClubInfo:"/pagesAdmin/club/detail-new",adminCLubWarning:"/pagesAdmin/club/warning",adminClubOperatorLog:"/pagesAdmin/club/operation-log",adminClubPersonalApplication:"/pagesAdmin/auditNew/club-application-personal",adminOutsourcingIndex:"/pagesAdmin/more/outsourcing/index",adminOutsourcingPermissionList:"/pagesAdmin/more/outsourcing/permission-list",adminOutsourcingNewRole:"/pagesAdmin/more/outsourcing/new-role",adminOutsourcingEditRole:"/pagesAdmin/more/outsourcing/edit-role",adminRefundDetail:"/pagesAdmin/refund/detail"};function ur(e,t){let i=Ot[e];return i||(i=e),i+Rc(t,"&","?")}function q(e,t=null,i=null,a=!1){let n=ur(e,t),s={url:n,fail:r=>{M("error","at common/route.js:107",`\u6253\u5F00\u9875\u9762\u5931\u8D25${n} ${JSON.stringify(r)}`),getApp().globalData.appCRE&&n.startsWith("/pagesAdmin")&&f.zT!=3&&B.request("/sign/reload-route",{},!0)}};a&&(s=Object.assign(s,a)),i!=null&&(s.events=i),uni.navigateTo(s)}function ce(e,t,i,a,n=null){let r={url:ur(e,t),success(l){l.eventChannel.emit(i,a)}};n!=null&&(r.events=n),uni.navigateTo(r)}function Bc(e=1,t="",i=""){let a={delta:e};t&&(a.animationType=t),i&&(a.animationDuration=i),uni.navigateBack(a)}function Pc(e){y(e)||uni.switchTab({url:e})}function ci(){let e=[],t=getCurrentPages();for(let i=0,a=t.length;i<a;i++){let n=t[i].$page;e.push(n.path)}return e}function xt(e="path"){let t=getCurrentPages(),i=t[t.length-1];if(!i)return"";let a=i.$page;return a?a[e]:""}function Fi(e){let t=bn();t&&(t==ca.SUPER?q("/pagesAdmin/user/info",{uid:e}):t==ca.KEFU&&q("/pagesAdmin/user/info-sub",{user_detail:t,uid:e}))}function hn(e,t){e==getApp().globalData.uid?t&&Pc(Ti.MY):q("/pages/main/user-home",{uid:e})}function Hc(e,t=null,i=null){let n={uid:typeof e=="object"?e.uid:e};i&&(n=Object.assign(n,i)),ce("/pagesMsg/pri/chat",n,"priData",{user:e,extra:t})}function Uc(e,t=null){let a={id:typeof e=="object"?e.club_id:e};t&&(a=Object.assign(a,t)),ce("/pagesMsg/club/chat",a,"clubData",{club:e})}function dr(){Ds(os.GAME,!0)||ce("/pages/call/chat-view",{},"callViewData",{isGame:!0})}function Pt(e,t=0,i=0){if(y(e))return;if(t&&i){Uc(e);return}q("/pagesClub/info",{id:e,isMember:t})}function Di(e,t=!0){return e.startsWith("http")?e:e.startsWith("file://")?t?e:e.replace("file://",""):e.startsWith("/storage/")||e.startsWith("/var/mobile/")?t?`file://${e}`:e:e.startsWith("_doc/uniapp")?t?e:plus.io.convertLocalFileSystemURL(e):e.indexOf("apps/__UNI")!=-1?e:!1}function pr(e){e&&e.height>0&&(getApp().globalData.keyboardH=e.height)}function hr(e,t,i=null){return new Promise(a=>{let n=Su(e),s;if(i)s=i.getTitleNView();else{let r=getCurrentPages();s=r[r.length-1].$getAppWebview().getTitleNView()}s.draw([{tag:"rect",id:"rect",position:{left:`${t}px`,top:"18px",width:"8px",height:"8px"},rectStyles:{color:n,radius:"4px"}}]),a()})}var Gc=[{key:"tr",title:"T\xFCrk"},{key:"pt",title:"Portugu\xEAs"}];function Ei(e=!0){let t=X("language_app_key");if(!e||!Ic(t))return t;let i=xs(!1),a=Pl[i];return y(a)?"en":i}function xs(e){let t=uni.getAppBaseInfo().language;return y(t)?e?"en-US":"en":e?t:t.split("-")[0]}function ws(e){getApp().globalData.translateAuto!=e&&(e&&!X("translate_auto_open_first")&&(uni.showModal({title:u("tips"),content:u("msg.translateAutoOpenMsgTips"),showCancel:!1,confirmText:u("gotIt")}),se("translate_auto_open_first",1)),se("translate_auto_close",e?0:1),getApp().globalData.translateAuto=e,uni.$emit("event_translate_auto_change",e),B.request("/user/sync-permission",{auto_translate:e?1:0}))}function mn(e){return getApp().globalData.translateAuto?getApp().globalData.translateKey!=e:!1}function gn(){uni.showModal({title:u("tips"),content:u("msg.translateAutoCloseTips"),showCancel:!0,cancelText:u("cancel"),confirmText:u("turnOff"),success(e){e.confirm&&ws(!1)}})}function Wc(){return X("call_automatic_source_language")||Ei()}function jc(){return!!X("call_automatic_open")}function u(...e){return getApp().globalData.s.state.pubI18n(...e)}function Cs(e){function t(r,l,c){for(;0<c--;)r.push(l)}function i(r,l){return r<<l|r>>>32-l}function a(r,l,c){return r^l^c}function n(r,l){var c=(l&65535)+(r&65535),p=(l>>>16)+(r>>>16)+(c>>>16);return(p&65535)<<16|c&65535}var s="0123456789abcdef";return function(r){for(var l=[],c=r.length*4,p,h=0;h<c;h++)p=r[h>>2]>>(3-h%4)*8,l.push(s.charAt(p>>4&15)+s.charAt(p&15));return l.join("")}(function(r,l){var c,p,h,g,_,C=r.length,b=1732584193,N=4023233417,L=2562383102,O=271733878,W=3285377520,Y=[];t(Y,1518500249,20),t(Y,1859775393,20),t(Y,2400959708,20),t(Y,3395469782,20),r[l>>5]|=128<<24-l%32,r[(l+65>>9<<4)+15]=l;for(var D=0;D<C;D+=16){c=b,p=N,h=L,g=O,_=W;for(var J=0,Me=[];J<80;J++){Me[J]=J<16?r[J+D]:i(Me[J-3]^Me[J-8]^Me[J-14]^Me[J-16],1);var st=function(ke,Ue,ze,Kt,Yt){var Jt=(Yt&65535)+(ke&65535)+(Ue&65535)+(ze&65535)+(Kt&65535),Si=(Yt>>>16)+(ke>>>16)+(Ue>>>16)+(ze>>>16)+(Kt>>>16)+(Jt>>>16);return(Si&65535)<<16|Jt&65535}(J<20?function(ke,Ue,ze){return ke&Ue^~ke&ze}(p,h,g):J<40?a(p,h,g):J<60?function(ke,Ue,ze){return ke&Ue^ke&ze^Ue&ze}(p,h,g):a(p,h,g),_,Y[J],Me[J],i(c,5));_=g,g=h,h=i(p,30),p=c,c=st}b=n(b,c),N=n(N,p),L=n(L,h),O=n(O,g),W=n(W,_)}return[b,N,L,O,W]}(function(r){for(var l=[],c=255,p=r.length*8,h=0;h<p;h+=8)l[h>>5]|=(r.charCodeAt(h/8)&c)<<24-h%32;return l}(e).slice(),e.length*8))}function Ss(e,t,i=!0){return fr(getApp().globalData.ossPicPath,e,t,i)}function Ye(e,t,i=!0){return fr(getApp().globalData.ossPath,e,t,i)}function ct(e,t){uni.saveFile({tempFilePath:t}).then(i=>{if(!i||!i.savedFilePath)return;let a=Cs(e);se(`img_${a}`,i.savedFilePath),_r("tempFile success")})}function mr(e){return y(e)?"":e.substr(0,5)==="_doc/"||e.substr(0,4)==="http"?e:getApp().globalData.ossPath+e}function gr(e){if(y(e)||e.startsWith("http"))return;let i=`img_${Cs(e)}`,a=X(i);lt(i),a&&uni.removeSavedFile({filePath:a})}function fr(e,t,i,a=!0){if(y(t))return"";if(t.startsWith("http")||t.startsWith("file://"))return t;if(t.startsWith("/var/mobile/"))return"file://"+t;if(t.startsWith("/storage/"))return t;let s=`img_${Cs(t)}`,r=X(s);if(r){let c={filePath:r,fail(p){_r(`\u7F13\u5B58\u68C0\u6D4B\u5931\u8D25${t}`,p),lt(s),typeof i=="function"&&i(e+t)},success(p){}};return typeof i=="function"&&(c.success=function(){i(r)}),uni.getFileInfo(c),r}let l=e+t;return getApp().globalData.picCacheObj[s]||(getApp().globalData.picCacheObj[s]=1,typeof i=="function"&&!a&&i(l),mu(l).then(c=>{se(s,c),typeof i=="function"&&a&&i(c),delete getApp().globalData.picCacheObj[s]}).catch(()=>{})),l}function _r(e,t){M("error","at common/cache.js:118",`cache ${e}`,t)}function ks(e,t,i){return new Promise(a=>{let n=e;n.startsWith("_doc")&&(n=plus.io.convertLocalFileSystemURL(n)),getApp().globalData.pluginImageBrowser.getVideoCover({url:n},s=>{Vc(`getVideoCover ${s}`),a(s)})})}function fn(e,t){let i=e.msg_type==f.M_VIDEO||e.msg_type==f.M_PAID_VIDEO,a;if(i){let n=t.small_url||t.cover_url||t.cover,s=t.cover_url||t.cover,r=t.url;r.startsWith("_doc")&&(r=plus.io.convertLocalFileSystemURL(r)),a=nn(!0,n,r,s)}else{let n=t.small_url||t.image_url;a=nn(!1,n,t.image_url)}return a}function nn(e,t,i,a="1",n=0,s=0){let r,l=Di(t,!1);if(l)r=l;else{let h;if(f.isAndroid,h=!1,h){let g=Ss(t);r=g.startsWith("http")?g:plus.io.convertLocalFileSystemURL(g)}else r=f.ossPicPath+t}let c=Di(i,!1)||`${getApp().globalData.ossPath}${i}`,p=e?Di(a,!1)||`${getApp().globalData.ossPicPath}${a}`:a;return{isVideo:e,thumbnailUrl:r||"",url:c,coverUrl:p,width:n,height:s}}function ui(e,t,i=1){getApp().globalData.filterAppHide=!0,bs(function(){let a=JSON.parse(JSON.stringify(e));getApp().globalData.pluginImageBrowser.openBrowser({info:a,index:t,showIndicator:i},n=>{M("info","at comExtend/plugin-image-browser.js:80","Preview.preview "+JSON.stringify(n))})},500,"previewImage")}function Vc(e,t){M("error","at comExtend/plugin-image-browser.js:90",`preview media ${e}`,t)}var at={CANDY_CHAT_I:"__UNI__CB903B1",CANDY_CHAT_A:"__UNI__564E31A",CHAT_NOW_A:"__UNI__DB0D401",CHAT_NOW_DEV:"__UNI__DEED62E",HOT_FACE_A:"__UNI__0D44E11",HOT_FACE_DEV:"__UNI__58DBD61",LOVE_SKY:"__UNI__0EE5E5E",DEV:"__UNI__3932C1F",DEV2:"__UNI__9C66D76"};function Ni(){let e=plus.runtime.appid,t,i,a,n,s,r,l,c;switch(e){case at.CANDY_CHAT_I:case at.CANDY_CHAT_A:t="Candy Chat",i="https://apps.apple.com/us/app/id1596210708",a="s/logo/CandyChat.png",n="Fanfanzhijiao Network Technology Co., Ltd.",s="fanfanzhijiao2021@163.com",r="https://sites.google.com/view/candy-chat-terms-policy/terms-of-use?authuser=0",l="https://sites.google.com/view/candy-chat-terms-policy/privacy-policy?authuser=0",c="s/pub/sys_notice_bg_candy_chat.png";break;case at.CHAT_NOW_A:case at.CHAT_NOW_DEV:t="Chat Now",i="https://apps.apple.com/us/app/id1596210708",a="s/logo/ChatNow.png",n="Fanfanzhijiao Network Technology Co., Ltd.",s="atree0120@gmail.com",r="https://sites.google.com/view/chats-now/privacy-policy",l="https://sites.google.com/view/chats-now/user-agreement?authuser=0",c="s/pub/sys_notice_bg_chat_now.png";break;case at.HOT_FACE_A:case at.HOT_FACE_DEV:t="HotFace",i="https://apps.apple.com/us/app/id1596210708",a="s/logo/HotFace.png",n="Fanfanzhijiao Network Technology Co., Ltd.",s="atree0120@gmail.com",r="https://sites.google.com/view/meu-agreement/user-agreement?authuser=0",l="https://sites.google.com/view/meu-agreement/privacy-policy?authuser=0",c="s/pub/sys_notice_bg_hot_face.png";break;case at.LOVE_SKY:t="LoveSky",i="",a="s/logo/lovesky.png",n="Fanfanzhijiao Network Technology Co., Ltd.",s="fanfanzhijiao2021@163.com",r="https://sites.google.com/view/lovesky-terms-of-use/terms-of-use?authuser=0",l="https://sites.google.com/view/lovesky-privacy-policy/privacy-policy?authuser=0";break;case at.DEV:case at.DEV2:t="Candy Chat Dev",i="https://apps.apple.com/us/app/id1596210708",a="s/logo/qialiao@3x.png",n="Liuyi Cool Technology Co., Ltd.",s="support_matchstar@163.com",r="https://sites.google.com/view/lovesky-terms-of-use/terms-of-use?authuser=0",l="https://sites.google.com/view/lovesky-privacy-policy/privacy-policy?authuser=0",c="s/pub/sys_notice_bg_candy_chat.png";break}return{name:t,iosStore:i,logo:a,cName:n,cMail:s,agreement:r,privacy:l,sysNoticeBg:c}}function zc(){return getApp().globalData.pluginTool.vpnConnected()}function yr(e){return new Promise(t=>{getApp().globalData.pluginTool.permissionRequest({permission:e},i=>{t(i)})})}function $c(e){return getApp().globalData.pluginTool.permissionStatusSync({permission:e})}function Kc(e){return getApp().globalData.pluginTool.permissionOpenSetting({permission:e})}function Yc(){return getApp().globalData.pluginTool.permissionCheckAll()}function Jc(){return getApp().globalData.pluginTool.locationAuthorizationStatusSync()}function qc(){return new Promise(e=>{getApp().globalData.pluginTool.locationAuthorizationStatus({},t=>{e(t)})})}var j={ALBUM:1,CAMERA:2,VIDEO:3,MICROPHONE:4,NOTIFY:5,LOCATION:6,DRAW_OVERLAYS:7,ALBUM_AND_CAMERA:101},he={GRANTED:1,DENIED:0,DENIED_ALWAYS:-1};function _n(e,t=!0,i=!0){return new Promise(a=>{if(e==j.ALBUM_AND_CAMERA){Bi(j.ALBUM_AND_CAMERA)?a(!0):(i&&Ta(e),a(!1));return}let n=function(s){s==he.GRANTED?a(!0):(s==he.DENIED||s==he.DENIED_ALWAYS&&i&&Ta(e),a(!1))};if(f.isAndroid)if(e==j.NOTIFY)tu().then(n);else{let s=yn(e);yr(s).then(n)}else uu(e)(t).then(n)})}function Xc(e,t,i){if(getApp().globalData.uid!=0)return new Promise(a=>{let n;if(i==null?n=br():n=i,n==null){a();return}let s={fromType:e,showClose:t,resList:n[0]};ce("/pagesDialog/check-permission",null,"permissionData",s,{onCloseListener:()=>{a()}})})}function br(){let e=[],t=!0;if(f.isAndroid){let s=Yc();e.push({key:"notice",value:s.notice,permission:j.NOTIFY}),e.push({key:"camera",value:s.camera,permission:j.CAMERA}),e.push({key:"voice",value:s.voice,permission:j.MICROPHONE}),e.push({key:"album",value:s.storage,permission:j.ALBUM})}else e.push({key:"notice",value:As(),permission:j.NOTIFY}),e.push({key:"camera",value:lu(),permission:j.CAMERA}),e.push({key:"voice",value:xr(),permission:j.MICROPHONE}),e.push({key:"album",value:cu(),permission:j.ALBUM});for(let s=0,r=e.length;s<r;s++)if(!e[s].value){t=!1;break}let i={};for(let s=0,r=e.length;s<r;s++){let l=e[s];i[l.key]=l.value?1:0}i.auto_translate=getApp().globalData.translateAuto?1:0;let a=jc()?1:0,n=Wc();return i.audio_translate=a,i.audio_language=n,B.request("/user/sync-permission",i),[e,t]}function Bi(e){if(e==j.NOTIFY)return f.isAndroid?Zi(e):As();if(e==j.MICROPHONE)return f.isAndroid?Zi(e):xr();if(e==j.ALBUM_AND_CAMERA){let i=br()[0];return i?i[1].value&&i[3].value:!0}else if(e==j.LOCATION)return f.isAndroid?Zi(e):Jc();return!0}function Zc(e){f.isAndroid?Qc(yn(e)):iu()}function Ta(e,t){uni.showModal({title:u("tips"),content:du(e),showCancel:!0,cancelText:u("cancel"),confirmText:u("toTurnOn"),complete(i){i.confirm?(Zc(e),typeof t=="function"&&t(!0)):i.cancel&&typeof t=="function"&&t(!1)}})}function Zi(e){let t=yn(e);return $c(t)}function Qc(e){if(y(e)){eu();return}Kc(e)}function eu(){var e=plus.android.importClass("android.content.Intent"),t=plus.android.importClass("android.provider.Settings"),i=plus.android.importClass("android.net.Uri"),a=plus.android.runtimeMainActivity(),n=new e;n.setAction(t.ACTION_APPLICATION_DETAILS_SETTINGS);var s=i.fromParts("package",a.getPackageName(),null);n.setData(s),a.startActivity(n)}function yn(e){switch(e){case j.LOCATION:return["android.permission.ACCESS_FINE_LOCATION","android.permission.ACCESS_COARSE_LOCATION"];case j.ALBUM:case j.VIDEO:return["android.permission.READ_MEDIA_IMAGES","android.permission.READ_MEDIA_VIDEO"];case j.MICROPHONE:return["android.permission.RECORD_AUDIO"];case j.CAMERA:return["android.permission.CAMERA"];case j.NOTIFY:return["android.permission.POST_NOTIFICATIONS"]}}function tu(){return new Promise(e=>{if(getApp().globalData.sys.androidAPILevel>=Nl.LEVEL_33)yr(yn(j.NOTIFY)).then(t=>{e(t)});else{let t=Zi(j.NOTIFY);e(t?he.GRANTED:he.DENIED_ALWAYS)}})}function iu(){var e=plus.ios.import("UIApplication"),t=e.sharedApplication(),i=plus.ios.import("NSURL"),a=i.URLWithString("app-settings:");t.openURL(a),plus.ios.deleteObject(a),plus.ios.deleteObject(i),plus.ios.deleteObject(t)}function nu(){return new Promise(e=>{qc().then(t=>{e(t==1?he.GRANTED:he.DENIED_ALWAYS)})})}function su(e){return new Promise(t=>{let i=plus.ios.importClass("AVCaptureDevice"),a=i.authorizationStatusForMediaType("soun");a==3?(plus.ios.deleteObject(i),t(he.GRANTED)):a==0?plus.ios.invoke("AVCaptureDevice","requestAccessForMediaType:completionHandler:","soun",function(){if(e){let n=i.authorizationStatusForMediaType("soun");plus.ios.deleteObject(i),t(n==3?he.GRANTED:he.DENIED)}else plus.ios.deleteObject(i),t(he.DENIED)}):(plus.ios.deleteObject(i),t(he.DENIED_ALWAYS))})}function au(e){return new Promise(t=>{let i=plus.ios.importClass("AVCaptureDevice"),a=i.authorizationStatusForMediaType("vide");a==3?(plus.ios.deleteObject(i),t(he.GRANTED)):a==0?plus.ios.invoke("AVCaptureDevice","requestAccessForMediaType:completionHandler:","vide",function(){if(e){let n=i.authorizationStatusForMediaType("vide");plus.ios.deleteObject(i),t(n==3?he.GRANTED:he.DENIED)}else plus.ios.deleteObject(i),t(he.DENIED)}):(plus.ios.deleteObject(i),t(he.DENIED_ALWAYS))})}function ru(e){return new Promise(t=>{let i=plus.ios.import("PHPhotoLibrary"),a=i.authorizationStatus();a==3||a==4?(plus.ios.deleteObject(i),t(he.GRANTED)):a==0?plus.ios.invoke("PHPhotoLibrary","requestAuthorization:",function(){if(e){let n=i.authorizationStatus();plus.ios.deleteObject(i),t(n==3||n==4?he.GRANTED:he.DENIED)}else plus.ios.deleteObject(i),t(he.DENIED)}):(plus.ios.deleteObject(i),t(he.DENIED_ALWAYS))})}function ou(){return new Promise(e=>{let t=As();e(t?he.GRANTED:he.DENIED_ALWAYS)})}function xr(){let e=plus.ios.importClass("AVCaptureDevice"),t=e.authorizationStatusForMediaType("soun");return plus.ios.deleteObject(e),t==3}function lu(){let e=plus.ios.importClass("AVCaptureDevice"),t=e.authorizationStatusForMediaType("vide");return plus.ios.deleteObject(e),t==3}function cu(){var e=!1,t=plus.ios.import("PHPhotoLibrary"),i=t.authorizationStatus();return(i==3||i==4)&&(e=!0),plus.ios.deleteObject(t),e}function As(){var e=!1,t=plus.ios.import("UIApplication"),i=t.sharedApplication(),a=0;if(i.currentUserNotificationSettings){var n=i.currentUserNotificationSettings();a=n.plusGetAttribute("types"),e=a!=0,plus.ios.deleteObject(n)}else a=i.enabledRemoteNotificationTypes(),e=a!=0;return plus.ios.deleteObject(i),plus.ios.deleteObject(t),e}function uu(e){switch(e){case j.LOCATION:return nu;case j.ALBUM:case j.VIDEO:return ru;case j.MICROPHONE:return su;case j.CAMERA:return au;case j.NOTIFY:return ou}}function du(e){let t=Ni();return e==j.LOCATION?u("openLocationPerTip",{appName:t.name}):e==j.ALBUM||e==j.VIDEO?u("openAlbumPerTip",{appName:t.name}):e==j.MICROPHONE?u("openMicrophonePerTip",{appName:t.name}):e==j.NOTIFY?u("msg.openNoticePerTips",{appName:t.name}):e==j.CAMERA?u("openCameraPerTip",{appName:t.name}):e==j.ALBUM_AND_CAMERA?u("openPermissionTipAlbumCamera",{appName:t.name}):""}function Pi(e,t){getApp().globalData.s.commit("setPubValue",{name:e,value:t})}function U(e,t){getApp().globalData.s.commit(e,t)}function pu(e){let t=uni.getSystemInfoSync().uniRuntimeVersion;if(!e)return t;let i=t.split("."),a=i[i.length-1];a.length<=1&&(i[i.length-1]=a+"0");let n=i.join("");return Number(n)}function sn(e,t){e==ti.MSG&&getApp().setNumberBadge(),t>0?uni.setTabBarBadge({index:e,text:t+""}):uni.removeTabBarBadge({index:e})}function hu(e,t=!0){t?uni.showTabBarRedDot({index:e}):uni.hideTabBarRedDot({index:e})}function mu(e){return new Promise((t,i)=>{uni.downloadFile({url:e}).then(a=>!a||a.statusCode!=200||!a.tempFilePath?(i(),new Promise(()=>{})):uni.saveFile({tempFilePath:a.tempFilePath})).then(a=>{!a||!a.savedFilePath?i():t(a.savedFilePath)}).catch(a=>{M("error","at common/common.js:65","downloadFile error "+JSON.stringify(a))})})}function Ts(e,t="md5"){return new Promise(i=>{uni.getFileInfo({filePath:e,digestAlgorithm:t,success(a){i(a)},fail(){i(null)}})})}function Ii(e,t){t?plus.runtime.openWeb(e):plus.runtime.openURL(e)}function wr(e){e!=""&&uni.setClipboardData({data:e+"",success(){ut(u("copied"))}})}function Ee(e,t,i,a=u("confirm")){it(e,t,i,"",a,!1)}function gu(e){return["Si, desbloquear","Reenviar Completar"].indexOf(e)!=-1}function it(e,t,i,a,n=u("confirm"),s=!0,r=u("cancel"),l=!1){let c=!1;if(!f.isAndroid&&(c=gu(n),c)){let p=n;n=r,r=p}uni.showModal({title:e,content:t,showCancel:s,cancelText:r,confirmText:n,editable:l,success(p){p.confirm?c?typeof a=="function"&&a():typeof i=="function"&&i(p):p.cancel&&(c?typeof i=="function"&&i(p):typeof a=="function"&&a())}})}function ut(e,t="none",i="center"){uni.showToast({title:e,duration:2e3,icon:t,position:i})}function fu(e,t){uni.showToast({title:e,duration:t,icon:"none",position:"center"})}function vs(e){return new Promise(t=>{plus.io.getVideoInfo({filePath:e,success(i){t(i)},fail(i){t(`getVideoInfo ${JSON.stringify(i)}`)}})})}function Cr(e,t){return new Promise((i,a)=>{uni.compressVideo({src:e,quality:t,success(n){M("log","at common/common.js:226","videoCompress res "+JSON.stringify(n)),i(n)},fail(n){M("log","at common/common.js:230","videoCompress error "+JSON.stringify(n)),a(`videoCompress ${JSON.stringify(n)}`)}})})}function Sr(e,t=1,i=!1,a=!1){return new Promise((n,s)=>{let r=["album","camera"],l;e==1?(r=["album"],l=j.ALBUM):e==2?(r=["camera"],l=j.CAMERA):e==0&&(l=j.ALBUM_AND_CAMERA);let c=["compressed"];i&&c.push("original");let p={};if(a){let h=getApp().globalData.window.width;p={width:h,height:h}}_n(l).then(h=>{if(!h){s(),M("error","at common/common.js:260","choose image permission fail");return}getApp().globalData.filterAppHide=!0,uni.chooseImage({count:t,sourceType:r,sizeType:c,crop:p,success:function(g){let _=[];for(let C=0,b=g.tempFilePaths.length;C<b;C++){let N=g.tempFilePaths[C],L=Fc(N);Bl.indexOf(L)!=-1&&_.push(C)}if(_.length>0&&(g.tempFilePaths=g.tempFilePaths.filter((C,b)=>_.indexOf(b)==-1),g.tempFiles&&(g.tempFiles=g.tempFiles.filter((C,b)=>_.indexOf(b)!=-1))),e!=1)for(let C=0,b=g.tempFilePaths.length;C<b;C++)g.tempFilePaths[C]=plus.io.convertLocalFileSystemURL(g.tempFilePaths[C]);n(g)},fail:function(g){s(),M("error","at common/common.js:299","choose image error --->"+JSON.stringify(g))}})})})}function kr(e,t,i=!1,a=15){return new Promise((n,s)=>{let r,l=["album","camera"],c;e==1?(l=["album"],c=j.VIDEO):e==2&&(l=["camera"],c=j.CAMERA),_n(c).then(p=>{if(!p){s(),M("error","at common/common.js:321","choose video permission fail");return}return getApp().globalData.filterAppHide=!0,uni.chooseVideo({sourceType:l,compressed:!1,maxDuration:a,camera:i?"front":"back"})}).then(p=>{if(M("error","at common/common.js:332","----> uni.chooseVideo "+JSON.stringify(p)),r=JSON.parse(JSON.stringify(p)),r&&r.duration&&parseInt(r.duration)>a){let h=setTimeout(()=>{clearTimeout(h),fu(u("video.durationExceedTip",{number:a}),3e3)},500);return s(null),Ke}return r.tempFilePath=r.tempFilePath.replace("file://",""),f.isAndroid&&pu(!0)<3617?vs(r.tempFilePath):new Promise(h=>{h(null)})}).then(p=>{if(p&&(p.orientation=="right"||p.orientation=="left")){M("error","at common/common.js:354","----> uni.chooseVideo videoInfo "+JSON.stringify(p));let h=r.height,g=r.width;r.width=h,r.height=g}return t?ks(r.tempFilePath,r.width,r.height):new Promise(h=>{h(null)})}).then(p=>(M("error","at common/common.js:368","----> uni.chooseVideo coverUrl "+p),r.coverPath=p,n(r))).catch(p=>{M("error","at common/common.js:372","-----> chooseVideo error "+JSON.stringify(p)),s()})})}var F={LIGHT:1,DARK:2};function Ht(e){let t=Number(e);if(isNaN(t)){M("error","at common/user.js:35","\u5237\u65B0\u4F59\u989D\u5931\u8D25");return}Pi("pubAccount.money",t),M("error","at common/user.js:39",`\u5237\u65B0\u4F59\u989D ${t}`)}function di(e,t=1,i=!0){if(e=Number(e),isNaN(e))return!0;let a=getApp().pubAccount.money-e*t;return a>=0?!0:(i&&wt(Math.abs(a),0),!1)}function Ar(e,t=1,i=!0,a=!1){if(e=Number(e),isNaN(e))return 1;let n=getApp().pubAccount.money-e*t;return n>=0?1:getApp().pubAccount.free_coins>0?(a&&B.request("/pay/coin/free",{},!0),2):(i&&wt(Math.abs(n),0),0)}function wt(e,t=0,i,a){let s=X("coin_callback"),r={};r.order_source=typeof i=="undefined"?0:i,r.click_type=typeof a=="undefined"?0:a,s?(r.fromType=t,r.diffCoin=e,ce("/pages/coin/coin-dialog",r,"coinDialogData",s)):(r.from_type=t,r.diff_coin=e,B.request("/pay/coin/callback",r,!0))}function Tr(e,t,i){let a=u(t?"unBlockUserTip":"blockUserTip"),n=u(t?"cancelBlock":"confirmBlock");it(u("areYouSure"),a,()=>{_u(t,e,()=>{typeof i=="function"&&i()})},"",n,!0,u("cancel"))}function _u(e,t,i){let n={target_uid:t,flag:e?"del":"add"};B.request("/user/black",n).then(()=>{typeof i=="function"&&i()})}function yu(e){let t=getApp().pubUser.seeking_sex;return e?t:t==0?getApp().pubUser.sex==1?2:1:t}function fe(){return getApp().globalData.s.state.pubUser.is_auth}function bu(){return!fe()&&getApp().pubUser.recharge_money>0}function xu(){let e=getApp().globalData.admin;return e&&e.permission&&e.permission.kefu}function wu(){let e=getApp().globalData.admin;return e&&e.permission&&e.permission.check_all}function bn(){let e=getApp().globalData.admin;return!e||!e.permission?0:e.permission.user_detail}function Cu(){let e=getApp().globalData.admin;return!y(e)&&e.type==1}function Ds(e,t){let i=getApp().globalData.bannedInfos[e];if(y(i))return!1;if(t){if(U("appDialog/addDialogBan",i),xt()=="/pagesDialog/banned")return;U("appDialog/executeBanWarningDialog")}return!0}function Hi(e){if(fe()){if(e.send_limit_level&&e.send_limit_level>0){let t={level:e.send_limit_level,sex:e.sex,from_type:4};return q("/pagesDialog/level-limit-def",t),!0}return e.send_alert_tips?(Ee(u("tips"),e.send_alert_tips,"",u("gotIt")),!0):!1}}function vr(e){let t=getApp().globalData.bossRules;if(Object.keys(t).length<=0)return!1;let i=Number(e.recharge_money),a=Number(e.level);return t.recharge>0?i>=t.recharge:t.level>0?a>=t.level:!1}function Su(e){return getApp().globalData.themeObj.style==F.LIGHT?e==Ki.ONLINE?"#34C759":e==Ki.CHATTING?"#FF9537":"#999999":e==Ki.ONLINE?"#2A9F47":e==Ki.CHATTING?"#CC7732":"#666666"}var ss={DEFAULT:1e4,FAIL:0,SUCCESS:1,DISCONNECT:6,RECONNECT:7},ku={INIT:"init",APP_SHOW:"app_show",TAB_SHOW:"tab_show",MSG_INDEX_REFRESH:"msg_index_refresh",STOP_TAKING_RECOVERY:"stop_taking_recovery",CATCH_MSG_SYNC:"sync_catch",API_CALL_BACK:"api_call_back",RECONNECT_LISTENER:"reconnect_listener",RECONNECT_LOCAL:"reconnect_local"};function Au(e){return new Promise((t,i)=>{getApp().globalData.pluginDB.selectSql({sql:e},a=>{a.status==1?t(a.rows):(M("error","at comExtend/plugin-DB.js:44","db \u63D2\u4EF6 select \u6267\u884C \u9519\u8BEF "+a.message),i(a.message))})})}function Tu(e){return new Promise((t,i)=>{getApp().globalData.pluginDB.executeSql({sql:e},a=>{a.status==1?t(a.rows):(M("error","at comExtend/plugin-DB.js:57","db \u63D2\u4EF6 execute \u6267\u884C \u9519\u8BEF "+a.message),i(a.message))})})}function ye(e,t){return new Promise((i,a)=>{Tu(e).then(n=>{i(n)},n=>{a(),t||Ir("execute",n,e)})})}function Ce(e,t){return new Promise((i,a)=>{Au(e).then(n=>{i(n)},n=>{a(),t||Ir("select",n,e)})})}function $(e){return y(e)?0:parseInt(e)}function dt(e){return y(e)?"":e}function Ls(e,t){return y(e)?Math.round(t/1e3):(e+"").length==16?Math.round(e/1e3):e}function vu(e,t){let i=e.length,a,n,s,r;if(i>t)n=!0,a=t,s=e[i-2].ctime,r=e[i-2].mtime;else{n=!1,a=i;let l=e[i-1];y(l)?(s=0,r=0):(s=l.ctime,r=l.mtime)}return{rows:e,hasMore:n,forLen:a,ctime:s,mtime:r}}function Dr(e,t){let i=vu(e,t);for(let a=0,n=i.forLen;a<n;a++){let s=i.rows[a];s&&(s.msg_content=Nt(s.msg_content))}return i}function Du(){return getApp().globalData.pluginMqtt.checkStatusSync()?ss.SUCCESS:ss.FAIL}function Lu(){return Du()}function Es(){return Lu()==ss.SUCCESS}var ii={getUserDesc(){let e=getApp().pubUser;return Object.keys(e).length<=3?"\u672A\u767B\u5F55":[e.uid,e.is_auth?"\u4E3B\u64AD":"\u7528\u6237",`\u7B49\u7EA7-${e.level}`,`vip${e.is_vip?"\u662F":"\u5426"}`,`\u5145\u503C${e.recharge_money}`,`\u4F59\u989D${getApp().pubAccount.money}`,`\u540E\u53F0\u8EAB\u4EFD${Eu()}`].join("|")},getActionDesc(){let e=ci(),t=e.length;return[`\u9875\u9762: ${(t>5?e.slice(t-5):e).join(",")}`,`${getApp().globalData.catchApiUrlList.join(",")}`].join("|")},getEnvironsDesc(){let e=getApp().globalData.ua.split("|"),t=[`${e[1]}`,`app\u7248\u672C${e[2]}`,`zip\u7248\u672C${e[3]}-${e[13]}`,`${e[6]}`,`\u54C1\u724C${e[11]}`,`\u578B\u53F7${e[12]}`,`\u7F51\u7EDC${getApp().globalData.network.type}`,`MQTT${Es()?"\u662F":"\u5426"}`],i=zc();return typeof i!="undefined"&&t.push(`VPN${i?"\u662F":"\u5426"}`),t.join("|")}};function Eu(){if(Cu())return"\u8D85\u7BA1";let e=[];return xu()&&e.push("\u5BA2\u670D"),wu()&&e.push("\u5BA1\u6838"),e.length<=0?"\u65E0":e.join("\u548C")}var Jn=0;function Iu(e){return Mu(Ru(Ou(e)))}function Ru(e){return Nu(Bu(Fu(e),e.length*8))}function Mu(e){try{}catch(s){Jn=0}for(var t=Jn?"0123456789ABCDEF":"0123456789abcdef",i="",a,n=0;n<e.length;n++)a=e.charCodeAt(n),i+=t.charAt(a>>>4&15)+t.charAt(a&15);return i}function Ou(e){for(var t="",i=-1,a,n;++i<e.length;)a=e.charCodeAt(i),n=i+1<e.length?e.charCodeAt(i+1):0,55296<=a&&a<=56319&&56320<=n&&n<=57343&&(a=65536+((a&1023)<<10)+(n&1023),i++),a<=127?t+=String.fromCharCode(a):a<=2047?t+=String.fromCharCode(192|a>>>6&31,128|a&63):a<=65535?t+=String.fromCharCode(224|a>>>12&15,128|a>>>6&63,128|a&63):a<=2097151&&(t+=String.fromCharCode(240|a>>>18&7,128|a>>>12&63,128|a>>>6&63,128|a&63));return t}function Fu(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(var i=0;i<e.length*8;i+=8)t[i>>5]|=(e.charCodeAt(i/8)&255)<<i%32;return t}function Nu(e){for(var t="",i=0;i<e.length*32;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function Bu(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var i=1732584193,a=-271733879,n=-1732584194,s=271733878,r=0;r<e.length;r+=16){var l=i,c=a,p=n,h=s;i=Ae(i,a,n,s,e[r+0],7,-680876936),s=Ae(s,i,a,n,e[r+1],12,-389564586),n=Ae(n,s,i,a,e[r+2],17,606105819),a=Ae(a,n,s,i,e[r+3],22,-1044525330),i=Ae(i,a,n,s,e[r+4],7,-176418897),s=Ae(s,i,a,n,e[r+5],12,1200080426),n=Ae(n,s,i,a,e[r+6],17,-1473231341),a=Ae(a,n,s,i,e[r+7],22,-45705983),i=Ae(i,a,n,s,e[r+8],7,1770035416),s=Ae(s,i,a,n,e[r+9],12,-1958414417),n=Ae(n,s,i,a,e[r+10],17,-42063),a=Ae(a,n,s,i,e[r+11],22,-1990404162),i=Ae(i,a,n,s,e[r+12],7,1804603682),s=Ae(s,i,a,n,e[r+13],12,-40341101),n=Ae(n,s,i,a,e[r+14],17,-1502002290),a=Ae(a,n,s,i,e[r+15],22,1236535329),i=Te(i,a,n,s,e[r+1],5,-165796510),s=Te(s,i,a,n,e[r+6],9,-1069501632),n=Te(n,s,i,a,e[r+11],14,643717713),a=Te(a,n,s,i,e[r+0],20,-373897302),i=Te(i,a,n,s,e[r+5],5,-701558691),s=Te(s,i,a,n,e[r+10],9,38016083),n=Te(n,s,i,a,e[r+15],14,-660478335),a=Te(a,n,s,i,e[r+4],20,-405537848),i=Te(i,a,n,s,e[r+9],5,568446438),s=Te(s,i,a,n,e[r+14],9,-1019803690),n=Te(n,s,i,a,e[r+3],14,-187363961),a=Te(a,n,s,i,e[r+8],20,1163531501),i=Te(i,a,n,s,e[r+13],5,-1444681467),s=Te(s,i,a,n,e[r+2],9,-51403784),n=Te(n,s,i,a,e[r+7],14,1735328473),a=Te(a,n,s,i,e[r+12],20,-1926607734),i=ve(i,a,n,s,e[r+5],4,-378558),s=ve(s,i,a,n,e[r+8],11,-2022574463),n=ve(n,s,i,a,e[r+11],16,1839030562),a=ve(a,n,s,i,e[r+14],23,-35309556),i=ve(i,a,n,s,e[r+1],4,-1530992060),s=ve(s,i,a,n,e[r+4],11,1272893353),n=ve(n,s,i,a,e[r+7],16,-155497632),a=ve(a,n,s,i,e[r+10],23,-1094730640),i=ve(i,a,n,s,e[r+13],4,681279174),s=ve(s,i,a,n,e[r+0],11,-358537222),n=ve(n,s,i,a,e[r+3],16,-722521979),a=ve(a,n,s,i,e[r+6],23,76029189),i=ve(i,a,n,s,e[r+9],4,-640364487),s=ve(s,i,a,n,e[r+12],11,-421815835),n=ve(n,s,i,a,e[r+15],16,530742520),a=ve(a,n,s,i,e[r+2],23,-995338651),i=De(i,a,n,s,e[r+0],6,-198630844),s=De(s,i,a,n,e[r+7],10,1126891415),n=De(n,s,i,a,e[r+14],15,-1416354905),a=De(a,n,s,i,e[r+5],21,-57434055),i=De(i,a,n,s,e[r+12],6,1700485571),s=De(s,i,a,n,e[r+3],10,-1894986606),n=De(n,s,i,a,e[r+10],15,-1051523),a=De(a,n,s,i,e[r+1],21,-2054922799),i=De(i,a,n,s,e[r+8],6,1873313359),s=De(s,i,a,n,e[r+15],10,-30611744),n=De(n,s,i,a,e[r+6],15,-1560198380),a=De(a,n,s,i,e[r+13],21,1309151649),i=De(i,a,n,s,e[r+4],6,-145523070),s=De(s,i,a,n,e[r+11],10,-1120210379),n=De(n,s,i,a,e[r+2],15,718787259),a=De(a,n,s,i,e[r+9],21,-343485551),i=_t(i,l),a=_t(a,c),n=_t(n,p),s=_t(s,h)}return Array(i,a,n,s)}function xn(e,t,i,a,n,s){return _t(Pu(_t(_t(t,e),_t(a,s)),n),i)}function Ae(e,t,i,a,n,s,r){return xn(t&i|~t&a,e,t,n,s,r)}function Te(e,t,i,a,n,s,r){return xn(t&a|i&~a,e,t,n,s,r)}function ve(e,t,i,a,n,s,r){return xn(t^i^a,e,t,n,s,r)}function De(e,t,i,a,n,s,r){return xn(i^(t|~a),e,t,n,s,r)}function _t(e,t){var i=(e&65535)+(t&65535),a=(e>>16)+(t>>16)+(i>>16);return a<<16|i&65535}function Pu(e,t){return e<<t|e>>>32-t}var as={md5:function(e){return Iu(e)}};function Lr(){return"tb_error_log"}function Hu(e,t){return new Promise(i=>{let a=`SELECT * FROM ${Lr()} WHERE status = ${$(e)} AND identify = '${t}' ORDER BY id DESC LIMIT 1`;Ce(a,!0).then(n=>{i(n[0])})})}function Uu(e,t,i,a,n,s,r,l,c,p){return Hu(e,t).then(h=>{if(h)return Promise.resolve(!0);let g=`INSERT INTO ${Lr()} (status, identify, grade, flag, user_desc, action_desc, environs_desc, error_desc, create_time, exp_time) values (${$(e)}, '${t}', ${i}, '${a}', '${me(n)}', '${me(s)}', '${me(r)}', '${me(l)}', ${$(c)}, ${$(p)})`;return ye(g,!0)})}var wn={CRASH:1,USER:11,API_FAIL:12,API_ERROR:13,MSG_SYNC:14,DB_PLUGIN:15,FRAME:21,LISTENER:31,BUG_DB_GET_NONE:201,BUG_MSG_SYNC_PLUGIN_LOSS:202,BUG_MSG_SYNC_JS_LOSS:203},Cn={CRASH:"crash",MEMORY:"memory",LISTENER:"listener",FRAME_API:"frame_api",API:"api",DB:"db",PAYMENT:"payment",AUTH_FACE:"auth_face",CHAT_CALL:"chat_call",HOT_UPDATE:"hot_update",MESSAGE_PARSE:"message_parse",BUG:"bug"};function Er(){return getApp().globalData.uid==0?!1:f.zT==3?!0:f.appId==at.CHAT_NOW_A||f.ENV=="dev"}var Gu=1e3;function Wu(e,t){try{if(!Er())return;let i=an(t),a=`api-${e} ${i}`;M("error","at comCatch/catch-save.js:15","catch api fail "+a);let n=Rs(a);zu().then(s=>{let r;typeof s=="boolean"?r="\u6D4B\u8BD5\u8C37\u6B4C\u6210\u529F":r=`\u6D4B\u8BD5\u8C37\u6B4C\u5931\u8D25-${an(s)}`,n.errorDesc=`${n.errorDesc} - ${r}`,Ms(wn.API_FAIL,Cn.API,n)})}catch(i){}}function ju(e,t,i){try{if(!Er())return;let a=an(i);a=a.substring(0,120);let n=`statusCode-${i.statusCode}-${a}-api-${e}-${JSON.stringify(t)}`;M("error","at comCatch/catch-save.js:37","catch api error "+n);let s=Rs(n);Ms(wn.API_ERROR,Cn.API,s)}catch(a){}}function Ir(e,t,i){try{if(i.indexOf("tb_error_log")!=-1)return;let a=`${e} - ${t}`;i&&(a+=` - ${i}`),M("error","at comCatch/catch-save.js:74","catch db "+a),Vu(wn.DB_PLUGIN,Cn.DB,a)}catch(a){}}function Is(e,t,i,a){try{let n=an(e),s=JSON.stringify(t),r=JSON.stringify(i),l=JSON.stringify(a);n=`${n} | ${s} | ${r} | ${l}`,M("error","at comCatch/catch-save.js:118","catch message parse "+n);let c=Rs(n);Ms(wn.USER,Cn.MESSAGE_PARSE,c)}catch(n){}}function an(e){if(!e)return"";let t=JSON.stringify(e);return(typeof t!="string"||t=="{}")&&(t=e.toString()),t}function Rs(e){return{identify:as.md5(e),errorDesc:e,userDesc:ii.getUserDesc(),actionDesc:ii.getActionDesc(),environsDesc:ii.getEnvironsDesc(),expTime:0}}function Ms(e,t,i){Uu(0,i.identify,e,t,i.userDesc,i.actionDesc,i.environsDesc,i.errorDesc,new Date().getTime(),i.expTime)}function Vu(e,t,i){let a=[],n=new Date().getTime();if(n-getApp().globalData.catchApiLastReqTime<=Gu)return;getApp().globalData.catchApiLastReqTime=n,a.push({grade:e,flag:t,user_desc:ii.getUserDesc(),action_desc:ii.getActionDesc(),environs_desc:ii.getEnvironsDesc(),error_desc:i,create_time:n,createTimeStr:sr(n)});let s={log_list:a};B.request("/monitor/record-exception-log",s)}function zu(){return new Promise(e=>{uni.request({url:"https://google.com",method:"GET",timeout:5e3,success(t){e(!0)},fail(t){e(t)}})})}var $u=["/monitor/index","/chat/call/log","/chat/msg/mq-log","/user/sync-permission","/monitor/record-exception-log"],va=["/monitor/record-exception-log"],Da=5,qi={invoke(e,t){if($u.indexOf(e)!=-1)return;let i="";i+=`\u63A5\u53E3=${e};`,i+=`\u53C2\u6570=${JSON.stringify(t)}`,i+=`\u65F6\u95F4=${sr(new Date().getTime())}`,getApp().globalData.catchApiUrlList.push(`\u3010${i}\u3011`);let a=getApp().globalData.catchApiUrlList.length;a>Da&&(getApp().globalData.catchApiUrlList=getApp().globalData.catchApiUrlList.slice(a-Da))},error(e,t,i){va.indexOf(e)==-1&&getApp().globalData.network.isConnected&&(!i||typeof i.statusCode=="undefined"||ju(e,t,i))},fail(e,t){va.indexOf(e)==-1&&getApp().globalData.network.isConnected&&Wu(e,t)}},Ku={INIT:1,OPEN:2,CALLBACK:3,SOCKET:4,LOGIN:5};function pi(e,t=!1){if(!t&&e.hide_profile){let i=e.uid%9999;return i<1e3&&(i="0"+i),u("mysteryer")+i}else return e.nickname||""}function Sn(e,t="small_avatar",i=!1,a=1){if(!i&&e.hide_profile)return Yu(a);{if(e[t])return e[t];let n=t=="small_avatar"?"avatar":"small_avatar";return e[n]}}function Yu(e){return e==2?"s/privacy/masker_list_card.png":e==3?"s/privacy/masker_card.png":"s/privacy/masker_avatar.png"}function La(){if(getApp().pubUnreadMy.moment>0){sn(ti.MY,getApp().pubUnreadMy.moment);return}sn(ti.MY,0),hu(ti.MY,getApp().pubUnreadMy.fans>0)}var E={PERMISSION:"permission",PERFECT_DATA:"perfect_data",REST:"rest",HOME_FILTER:"home_filter",GRID_GUIDE:"grid_guide",NOTIFY:"notify",HELLO:"hello",SHARE:"share",LANGUAGE_UP:"language_up",RAMADAN:"ramadan",MSG_DISTURB:"msg_disturb",CALL_DISTURB:"call_disturb",BAN:"ban",WARNING:"warning",HOME_SEX_FILTER:"home_sex_filter",CLUB_RESULT:"club_result",CLUB_DISBAND:"club_disband"},Ju={[E.HOME_FILTER]:"seeking_sex_open_time",[E.GRID_GUIDE]:"dialog_show_time_grid_guide",[E.NOTIFY]:"dialog_show_time_notify",[E.HELLO]:"dialog_show_time_hello"},rs=-99,Ri=-100,qu={[E.HOME_FILTER]:1,[E.HOME_SEX_FILTER]:1,[E.GRID_GUIDE]:1,[E.NOTIFY]:2,[E.SHARE]:3,[E.HELLO]:4,[E.LANGUAGE_UP]:5,[E.RAMADAN]:6},Os={[E.PERMISSION]:1,[E.PERFECT_DATA]:2,[E.REST]:3,[E.HOME_FILTER]:4,[E.HOME_SEX_FILTER]:4,[E.GRID_GUIDE]:4,[E.NOTIFY]:5,[E.SHARE]:7,[E.LANGUAGE_UP]:8};function Xu(e){return ed(E.HOME_FILTER,21600)?!1:yu(!1)!=e}function Zu(e){return f.isAndroid||e||X(Fs(E.GRID_GUIDE))?!1:!X("user_list_sort_"+getApp().globalData.uid)}function Rr(){return Bi(j.NOTIFY)?!1:!Qu()}function Qu(){let e=hs(`${E.NOTIFY}_show_status`);if(!y(e))return!0;let t=X(Fs(E.NOTIFY));return!y(t)}function Fs(e){return`${Ju[e]}_${getApp().globalData.uid}`}function ed(e,t){let i=X(Fs(e));if(!i)return!1;let a=new Date().getTime();return a<=i?!1:parseInt((a-i)/1e3)<=t}var Ea=!1,qt=!1,ft=0,vi={appDialogList:[],appDialogStop:!1,appDialogCurKey:"",appDialogHelloData:!1,appBanDialogList:[],appClubResultList:[],appDialogIsShowBan:!1,appBanDialogCurKey:"",appWarningDialogCurKey:"",appClubResultCurKey:""},td={setDialogHelloData(e,t){e.appDialogHelloData=t},setDialogCurKey(e,t){e.appDialogCurKey=t},setDialogList(e,t){e.appDialogList=t,e.appDialogList.sort((i,a)=>i.sort-a.sort)},sortDialogList(e){e.appDialogList.sort((t,i)=>t.sort-i.sort)},resetDialogItem(e,t){let i=e.appDialogList.findIndex(a=>a.key==t.key);i!=-1&&(e.appDialogList[i].hasExec=!1,e.appDialogList[i].delay=t.delay)},resetClubResultDialogItem(e,t){let i=e.appClubResultList.findIndex(a=>a.key==t.key);i!=-1&&(e.appClubResultList[i].hasExec=!1)},delDialogItem(e,t){y(e.appDialogList)||e.appDialogList.splice(t,1)},delDialogItemByKey(e,t){if(y(e.appDialogList))return;let i=e.appDialogList.findIndex(a=>a.key==t);i!=-1&&e.appDialogList.splice(i,1)},clearDialog(e){e.appDialogStop=!0,e.appDialogList=[]},executeDialog(e,t){if(e.appBanDialogCurKey||e.appWarningDialogCurKey||e.appClubResultCurKey||y(e.appDialogList)||e.appDialogStop)return;let i=e.appDialogList[0];y(i)||i.hasExec||i.isCanExecute&&(e.appDialogList[0].hasExec=!0,qn[i.funcName](i).then(()=>{e.appDialogCurKey="";let a=e.appDialogList.indexOf(i);a!=-1&&U("appDialog/delDialogItem",a),U("appDialog/executeDialog","execute then")}))},addDialog(e,t){let i=t.key;e.appDialogStop=!0;let a=e.appDialogList.findIndex(n=>n.key==i);if(a!=-1){if(e.appDialogList[a].isAdd){e.appDialogStop=!1,e.appDialogCurKey||U("appDialog/executeDialog");return}e.appDialogList[a].isAdd=!0,e.appDialogList[a].addTime=new Date().getTime(),e.appDialogList[a].isCanExecute=!0}else{let n=fe()?1:2,s;switch(i){case E.HOME_FILTER:s=ld(n,!0);break;case E.HELLO:s=Ia(t.delay);break;case E.MSG_DISTURB:s=ud(t.delay);break;case E.CALL_DISTURB:s=dd(t.delay);break;default:e.appDialogStop=!1,e.appDialogCurKey||U("appDialog/executeDialog");return}s.isAdd=!0,s.addTime=new Date().getTime(),e.appDialogList.push(s)}e.appDialogList.sort((n,s)=>n.sort==s.sort?s.addTime-n.addTime||(n.isCanExecute?Ri:0):n.sort-s.sort),!e.appDialogCurKey&&(e.appDialogCurKey=i,e.appDialogStop=!1,U("appDialog/executeDialog"))},addDialogHomeFilter(e,t){getApp().globalData.appCRE==0||!Xu(t)||U("appDialog/addDialog",{key:E.HOME_FILTER})},addDialogHomeSexFilter(e,t){getApp().globalData.appCRE!=0&&(U("appDialog/addDialog",{key:E.HOME_SEX_FILTER,value:t}),U("appDialog/sortDialogList"))},addDialogGridGuide(e,t){let i=e.appDialogList.findIndex(n=>n.key==E.GRID_GUIDE);if(Zu(t)){if(i==-1)return;U("appDialog/addDialog",{key:E.GRID_GUIDE})}else i!=-1&&U("appDialog/delDialogItem",i)},addDialogNotify(e,t){t&&!Rr()||q("/pagesDialog/open-sys-notice")},addDialogHello(e,t){if(getApp().globalData.appCRE==0||Ea)return;Ea=!0;let i=e.appDialogList[0];if(i&&i.key==E.SHARE){ft=30;let a=Ia(ft);a.sort=Ut(fe()?1:2,E.SHARE+1),a.isAdd=!0,a.addTime=new Date().getTime(),e.appDialogList.push(a),e.appDialogList.sort((n,s)=>n.sort==s.sort?s.addTime-n.addTime||(n.isCanExecute?Ri:0):n.sort-s.sort);return}ft=t,U("appDialog/addDialog",{key:E.HELLO,delay:t})},addDialogMsgDisturb(e,t){U("appDialog/addDialog",{key:E.MSG_DISTURB,delay:t})},addDialogCallDisturb(e,t){U("appDialog/addDialog",{key:E.CALL_DISTURB,delay:t})},delBanDialogItem(e){y(vi.appBanDialogList)||vi.appBanDialogList.splice(e,1)},delClubResultDialogItem(e){y(vi.appClubResultList)||vi.appClubResultList.splice(e,1)},addDialogBan(e,t){let i=pd(t);e.appDialogIsShowBan?uni.$emit("event_refresh_banned_data",t):(e.appBanDialogList.push(i),U("appDialog/sortBanWarningDialog"))},addDialogWarning(e,t){if(e.appBanDialogList.map(n=>n.sort).indexOf(Number(t.id))!=-1)return;let a;t.from_type==2?a=md(t):a=hd(t),e.appBanDialogList.push(a),!(e.appBanDialogCurKey||e.appWarningDialogCurKey)&&U("appDialog/executeBanWarningDialog")},addDialogClubNoticeDialog(e,t){let i,a,n=e.appClubResultList.map(s=>s.key);t.type==Hl.CHECK_RESULT?(a=E.CLUB_RESULT+"_"+t.club_id,n.indexOf(a)==-1&&(i=fd(t))):(a=E.CLUB_DISBAND+"_"+t.club_id,n.indexOf(a)==-1&&(i=gd(t))),i&&e.appClubResultList.push(i),!(e.appBanDialogCurKey||e.appWarningDialogCurKey)&&(e.appClubResultCurKey||U("appDialog/executeClubNoticeDialog"))},executeBanWarningDialog(e){if(y(e.appBanDialogList)){U("appDialog/executeClubNoticeDialog");return}let t=e.appBanDialogList[0];if(y(t)||t.hasExec)return;let i=getApp().globalData.curCallId>Li.WAITING;if(i){t.isBan&&uni.$emit("event_banned_close_chat");return}e.appBanDialogList[0].hasExec=!i||!t.isBan,e.appDialogIsShowBan=t.isBan,t.isBan?e.appBanDialogCurKey="ban":e.appWarningDialogCurKey="warning",qn[t.funcName](t).then(a=>{if(t.isBan){if(e.appBanDialogCurKey="",e.appDialogIsShowBan=!1,a==1){let n=e.appBanDialogList.indexOf(t);n!=-1&&U("appDialog/delBanDialogItem",n)}}else{e.appWarningDialogCurKey="";let n=e.appBanDialogList.indexOf(t);n!=-1&&U("appDialog/delBanDialogItem",n)}U("appDialog/executeBanWarningDialog","execute then")})},executeClubNoticeDialog(e,t){if(e.appBanDialogCurKey||e.appWarningDialogCurKey)return;if(y(e.appClubResultList)){U("appDialog/executeDialog");return}let i=e.appClubResultList[0];y(i)||i.hasExec||getApp().globalData.curCallId>Li.WAITING||(e.appClubResultCurKey="club_result",e.appClubResultList[0].hasExec=!0,t&&t.delay&&(i.delay=t.delay),qn[i.funcName](i).then(()=>{e.appClubResultCurKey="";let n=e.appClubResultList.indexOf(i);n!=-1&&U("appDialog/delClubResultDialogItem",n),U("appDialog/executeClubNoticeDialog","execute then")}))},sortBanWarningDialog(e){let t=e.appBanDialogList.filter(a=>a.sort==rs),i=e.appBanDialogList.filter(a=>a.sort!=rs);i=i.sort((a,n)=>a.sort-n.sort),e.appBanDialogList=[...t,...i]}},id={init(i,a){return Ge(this,arguments,function*({state:e},t){M("error","at store/modules/app-dialog.js:326","------> init dialog list, data ",t);let n=[];fe()?n=ad(t.data,t.homeViewSizeObj):n=sd(t.data,t.homeViewSizeObj),U("appDialog/setDialogList",n),U("appDialog/executeDialog")})}},nd={namespaced:!0,state:vi,mutations:td,actions:id};function sd(e,t){permissionGetAllStatus();let i=[],a=Mr(2,t,e.homeFilterSex);a&&i.push(a);let n=Or(2,t);n&&i.push(n);let s=Fr(2,e.share);s&&i.push(s);let r=Nr(2);r&&i.push(r);let l=cd(2,e.notifyTips);return l&&i.push(l),i}function ad(e,t){let i=[],a=rd(e.authList);a&&i.push(a);let n=od();n&&i.push(n);let s=Mr(2,t,e.homeFilterSex);s&&i.push(s);let r=Or(1,t);r&&i.push(r);let l=5,c=Fr(1,e.share,l);c&&i.push(c);let p=Nr(1);return p&&i.push(p),i}function rd(e){return typeof e=="undefined"?null:{key:E.PERFECT_DATA,sort:Os[E.PERFECT_DATA],delay:0,data:e,hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecutePerfectData"}}function od(){return Br()||!getApp().pubUser.is_rest?null:{key:E.REST,sort:Os[E.REST],delay:0,data:{},hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteRest"}}function ld(e,t){return{key:E.HOME_FILTER,sort:Ut(e,E.HOME_FILTER),delay:0,data:{},hasExec:!1,isCanExecute:t,addTime:new Date().getTime(),funcName:"_dialogExecuteHomeFilter"}}function Mr(e,t,i){return getApp().globalData.appCRE==0||!t||!t.filter?null:{key:E.HOME_SEX_FILTER,sort:Ut(e,E.HOME_SEX_FILTER),delay:0,data:{value:i,size:t.filter},hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteHomeSexFilter"}}function Or(e,t){if(getApp().globalData.appCRE==0)return null;let i="grid";if(!t||!t[i])return null;let a={sizeList:[{key:i,size:t[i]}],from_type:1};return{key:E.GRID_GUIDE,sort:Ut(e,E.GRID_GUIDE),delay:0,data:a,hasExec:!1,isCanExecute:!1,addTime:new Date().getTime(),funcName:"_dialogExecuteGridGuide"}}function Fr(e,t,i=5){return getApp().globalData.appCRE==0||y(t)||getApp().globalData.launchCount<3||bu()?null:{key:E.SHARE,sort:Ut(e,E.SHARE),delay:i,data:t,hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteShare"}}function Ia(e){return{key:E.HELLO,sort:Ri,delay:e,data:{},hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteHello"}}function Nr(e){let t=X("user_switch_language_status");if(t)return null;let i=Ei(!1);if(t||y(i))return null;let a=Gc.map(r=>r.key),n=Ei();if(a.indexOf(n)!=-1)return null;let s=xs(!1);return a.indexOf(s)==-1?null:{key:E.LANGUAGE_UP,sort:Ut(e,E.LANGUAGE_UP),delay:5,data:{},hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteLanguageUp"}}function cd(e,t){return y(t)||X(`stop_notify_${getApp().globalData.uid}_${t.time}`)||!Bi(j.NOTIFY)?null:{key:E.RAMADAN,sort:Ut(e,E.RAMADAN),delay:5,data:t,hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteRamadan"}}function ud(e){return{key:E.MSG_DISTURB,sort:Ri,delay:e,data:{from_type:1},hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteMsgDisturb"}}function dd(e){return{key:E.CALL_DISTURB,sort:Ri,delay:e,data:{from_type:2},hasExec:!1,isCanExecute:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteCallDisturb"}}function pd(e){return{key:E.BAN,sort:rs,data:e,delay:e.delay||0,hasExec:!1,isBan:!0,addTime:new Date().getTime(),funcName:"_dialogExecuteBan"}}function hd(e){return{key:E.WARNING,sort:Number(e.id),data:e,delay:e.delay||0,hasExec:!1,isBan:!1,addTime:new Date().getTime(),funcName:"_dialogExecuteWarning"}}function md(e){return{key:E.WARNING,sort:Number(e.id),data:e,delay:e.delay||0,hasExec:!1,isBan:!1,addTime:new Date().getTime(),funcName:"_dialogExecuteClubWarning"}}function gd(e){return{key:E.CLUB_DISBAND+"_"+e.club_id,data:e,delay:e.delay||0,hasExec:!1,isBan:!1,addTime:new Date().getTime(),funcName:"_dialogExecuteClubDisband"}}function fd(e){return{key:E.CLUB_RESULT+"_"+e.club_id,data:e,delay:e.delay||0,hasExec:!1,isBan:!1,addTime:new Date().getTime(),funcName:"_dialogExecuteClubResult"}}var qn={_dialogExecutePermission(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),Qe(e.key,e.delay,0)&&(U("appDialog/setDialogCurKey",E.PERMISSION),Xc(1,!1,e.permissionRes).then(()=>{t()}))},e.delay*1e3)})},_dialogExecutePerfectData(e){return new Promise(t=>{U("appDialog/setDialogCurKey",E.PERFECT_DATA),ce("/pagesDialog/complete-content-first",{},"DataCompleteContentFirst",e.data,{onCloseListener(){t()}})})},_dialogExecuteRest(){return new Promise(e=>{U("appDialog/setDialogCurKey",E.REST),it(u("tips"),u("anchor.rest.openedTip"),()=>{let t={user_info:{is_rest:0}};B.request("/user/update-info",t,!0,!0).then(i=>{Pi("pubUser.is_rest",0),Ee(u("tips"),u("anchor.rest.turnOff"),()=>{e()},u("gotIt"))},()=>{e()})},()=>{e()},u("startWorking"))})},_dialogExecuteHomeFilter(e){return new Promise(t=>{Qe(e.key,e.delay,Ti.USER)&&(U("appDialog/setDialogCurKey",E.HOME_FILTER),q("/pagesDialog/seeking-sex-guide",{},{onCloseChooseSeekingSex:i=>{uni.$emit("event_app_dialog_seeking_sex_after",i),t()}}))})},_dialogExecuteHomeSexFilter(e){return new Promise(t=>{Qe(e.key,e.delay,Ti.USER)&&(U("appDialog/setDialogCurKey",E.HOME_SEX_FILTER),q(Ot.homeFilterSexGuide,{params:JSON.stringify(e.data)},{onCloseListener:()=>{uni.$emit("event_handle_filter_seeking_sex"),t()}}))})},_dialogExecuteGridGuide(e){return new Promise(t=>{if(!Qe(e.key,e.delay,Ti.USER))return;U("appDialog/setDialogCurKey",E.GRID_GUIDE);let i=e.data.sizeList;q("/pagesDialog/guide-cover",{list:encodeURIComponent(JSON.stringify(i))},{onCloseGuideCover:()=>{uni.$emit("event_app_dialog_close_guide",{from_type:e.data.from_type}),t()}})})},_dialogExecuteShare(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),Qe(e.key,e.delay,0)&&(U("appDialog/setDialogCurKey",E.SHARE),ce("/pagesDialog/share",{},"shareData",e.data.data,{onCloseListener:()=>{t()}}))},e.delay*1e3)})},_dialogExecuteLanguageUp(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),Qe(e.key,e.delay,0)&&(U("appDialog/setDialogCurKey",E.LANGUAGE_UP),se("user_switch_language_status","1"),q("/pagesDialog/switch-language-remind",{},{onCloseListener(){t()}}))},e.delay*1e3)})},_dialogExecuteRamadan(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),Qe(e.key,e.delay,0)&&(U("appDialog/setDialogCurKey",E.RAMADAN),ce("/pagesDialog/stop-notify",{},"dataStopNotify",e.data,{onCloseListener(){t()}}))},e.delay*1e3)})},_dialogExecuteHello(e){return new Promise(t=>{bd().then(i=>{if(!i){t();return}if(qt&&clearInterval(qt),e.delay<=0||ft<=0){if(!Qe(e.key,ft,0))return;U("appDialog/setDialogCurKey",E.HELLO),Ra(i,()=>{t()});return}qt=setInterval(()=>{if(!Qe(e.key,ft,0)){qt&&clearInterval(qt);return}ft-=1,ft<=0&&(clearInterval(qt),U("appDialog/setDialogCurKey",E.HELLO),Ra(i,()=>{t()}))},1e3)})})},_dialogExecuteMsgDisturb(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),Qe(e.key,e.delay,Ti.MSG)&&(U("appDialog/setDialogCurKey",E.MSG_DISTURB),q("/pagesDialog/disturb-def",e.data,{onCloseListener:()=>{t()}}))},e.delay*1e3)})},_dialogExecuteCallDisturb(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),Qe(e.key,e.delay,0)&&(U("appDialog/setDialogCurKey",E.CALL_DISTURB),q("/pagesDialog/disturb-def",e.data,{onCloseListener:()=>{t()}}))},e.delay*1e3)})},_dialogExecuteBan(e){return new Promise(t=>{let i=e.exp_time;if(parseInt(new Date().getTime()/1e3)>i){t();return}let a=setTimeout(()=>{clearTimeout(a);let n=e.data.from_cache?1:0;ce("/pagesDialog/banned",{from_cache:n},"bannedDialogData",e.data,{onCloseListener:s=>{t(s)}})},e.delay*1e3)})},_dialogExecuteWarning(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),ce("/pagesDialog/warning",{},"warningDialogData",e.data,{onCloseListener:()=>{t()}})},e.delay*1e3)})},_dialogExecuteClubWarning(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),ce(Ot.clubWarning,{},"clubDialogData",e.data,{onCloseListener:()=>{t()}})},e.delay*1e3)})},_dialogExecuteClubDisband(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),ce(Ot.clubDisband,{},"clubDialogData",e.data,{onCloseListener:()=>{t()}})},e.delay*1e3)})},_dialogExecuteClubResult(e){return new Promise(t=>{let i=setTimeout(()=>{clearTimeout(i),ce(Ot.clubStatusRemind,{from_type:2},"clubDialogData",e.data,{onCloseListener:()=>{t()}})},e.delay*1e3)})}};function Qe(e,t,i){let a;return i==0?a=_d():a=yd(i),getApp().globalData.isGestureBacking||getApp().globalData.s.state.appDialog.appDialogStop||Br()||!a?(U("appDialog/resetDialogItem",{key:e,delay:t}),!1):!0}function Br(){return getApp().globalData.uid==0}function _d(){return getCurrentPages().length==1}function yd(e){let t=ci();return t.length==1&&t[0]==e}function Ut(e,t){return e==1?Os[t]:qu[t]}function bd(){return new Promise(e=>{let t=getApp().globalData.s.state.appDialog.appDialogHelloData;t?e(t):B.request("/user/greet-coach-list",{},!1,!0).then(i=>{y(i.data)||y(i.data.list)?e(null):(U("appDialog/setDialogHelloData",i.data),e(i.data))},i=>{e(null)})})}function Ra(e,t){ce("/pagesDialog/quality-user",{},"qualityUserData",e,{onCloseListener:i=>{i&&Rr()?setTimeout(()=>{U("appDialog/addDialogNotify")},2300):t()}})}var xd={curSendCont:0,msgMtimeList:[]},wd=60,Ma=6,Cd={addSendCount(e){e.curSendCont+=1},clearSendCount(e){e.curSendCont=0},addMsgDisturbSaveCount(e,t){let i=e.msgMtimeList.length;if(e.msgMtimeList.length<Ma&&(e.msgMtimeList.push(t/1e6),i=e.msgMtimeList.length),i>=Ma){let a=e.msgMtimeList[0];e.msgMtimeList[i-1]-a<=wd&&U("appDialog/addDialogMsgDisturb",2),e.msgMtimeList.splice(0,1)}}},Sd={namespaced:!0,state:xd,mutations:Cd},kd={callMtimeList:[]},Ad=60,Oa=3,Td={addCallDisturbReceiveCount(e,t){let i=e.callMtimeList.length;if(e.callMtimeList.length<Oa&&(e.callMtimeList.push(t/1e3),i=e.callMtimeList.length),i>=Oa){let a=e.callMtimeList[0];e.callMtimeList[i-1]-a<=Ad&&U("appDialog/addDialogCallDisturb",2),e.callMtimeList.splice(0,1)}},clearCallDisturbReceiveMtime(e){e.callMtimeList=[]}},vd={namespaced:!0,state:kd,mutations:Td},ei=X("pubData");ei||(ei={});var Dd=["pubToken","pubUser","pubAccount","pubPrivacy"],Ld=function(e,t){if(Dd.indexOf(e)==-1)return;let i=X("pubData");i=i||{},i[e]=t,se("pubData",i),["pubUser","pubAccount"].indexOf(e)!=-1?uni.$emit("event_vuex_watch",e):uni.$emit(`event_vuex_watch_${e}`)},Ed=(0,Fa.createStore)({state:{pubToken:ei.pubToken||"",pubUser:ei.pubUser||{nickname:"",uid:0,avatar:""},pubAccount:ei.pubAccount||{money:0},pubPrivacy:ei.pubPrivacy||{},pubUnread:0,pubUnreadMy:{fans:0,moment:0,moment_type:1},pubI18n:"",pubAI18n:""},mutations:{setPubValue(e,t){let i=t.name.split("."),a="",n=i.length;if(n>=2){let s=e[i[0]];for(let r=1;r<n-1;r++)s=s[i[r]];s[i[n-1]]=t.value,a=i[0]}else e[t.name]=t.value,a=t.name;Ld(a,e[a])},initUnread(e,t){let i=parseInt(t);i<0&&(i=0),e.pubUnread=i,sn(ti.MSG,e.pubUnread),uni.$emit("event_vuex_watch_pub_unread",i)},setUnread(e,t){let i=parseInt(t);if(isNaN(i)||i==0)return;let a=e.pubUnread+i;a<0&&(a=0),e.pubUnread=a,sn(ti.MSG,e.pubUnread),uni.$emit("event_vuex_watch_pub_unread",a)},initUnreadMy(e,t){let i=e.pubUnreadMy;typeof t.fans!="undefined"&&(i.fans=Number(t.fans)),typeof t.moment!="undefined"&&(i.moment=Number(t.moment)),typeof t.moment_type!="undefined"&&(i.moment_type=Number(t.moment_type)),e.pubUnreadMy=i,La(),uni.$emit("event_vuex_watch_pubUnreadMy",i)},setUnreadMy(e,t){let i=e.pubUnreadMy;for(let a in t)i[a]=t[a];e.pubUnreadMy=i,La(),uni.$emit("event_vuex_watch_pubUnreadMy",i)}},modules:{appDialog:nd,message:Sd,call:vd}}),Xt={handleCache(){let e=Xt.getCache();y(e)||(e=re(e),!Xt.checkIsShow()&&(e.from_cache=1,U("appDialog/addDialogBan",e),U("appDialog/executeBanWarningDialog")))},checkIsShow(){return xt()=="/pagesDialog/banned"},setCache(e){let t=JSON.stringify(e);se(Xt.getCacheKey(),t)},getCache(){return X(Xt.getCacheKey())},getCacheKey(){return`banned_data_${Ed.state.pubUser.uid}`},removeCache(){lt(Xt.getCacheKey())}},B={setToken(e){y(e)||Pi("pubToken",e)},isLogin(){let e=getApp().globalData.s.state;return!y(e.pubToken)&&e.pubUser.uid},requestOutsourcing(e,t,i,a,n=!1){return B.requestBase(e,t,i,a,n,3)},requestManager(e,t,i,a,n=!1){return B.requestBase(e,t,i,a,n,2)},request(e,t,i,a,n=!1){return B.requestBase(e,t,i,a,n,1)},requestBase(e,t,i,a,n=!1,s){return new Promise((r,l)=>{let c=!1;try{c=getApp().globalData.s.state.pubToken}catch(C){M("error","at common/api.js:35","request token catch "+JSON.stringify(C))}let p={"content-type":"application/json",ua:getApp().globalData.ua},h;s==1?(h=getApp().globalData.apiHost,c&&(p.auth=`Bearer ${c}`)):s==2?(h=getApp().globalData.pApiHost,c&&(p.Authorization=`Bearer ${c}`)):s==3&&(h=getApp().globalData.oApiHost,c&&(p.Authorization=`Bearer ${c}`));let g=!1;if(i)if(i=="refresh")g=!0;else{let C={mask:!0};typeof i=="string"&&(C.title=i),uni.showLoading(C)}qi.invoke(e,t);let _=Bd(t);uni.request({url:h+e,method:"POST",header:p,data:_,dataType:"json",timeout:1e4,complete(C){if(i&&uni.hideLoading(),M("log","at common/api.js:74",`request ${e} obj ${JSON.stringify(t)}`),C.statusCode==200){let b=C.data;if(b.data&&typeof b.data.callback=="object"&&(B.handleCallback(b.data.callback),n))return Ke;if(b.ok===99)return getApp().loginOut(),Ke;if(b.ok==-98)return Nd(b.data),a&&l(b),Ke;if(y(b.msg)||ut(b.msg),b.ok>0){r(b);return}a&&l(b)}else if(g&&uni.stopPullDownRefresh(),a)l(C),qi.error(e,t,C);else return qi.error(e,t,C),Ke},fail(C){qi.fail(e,C)}})})},handleCallback(e){switch(e.func_name){case"alert":Id(e.func_data);break;case"open":Rd(e.func_data);break;case"vip_alert":ce("/pages/vip/vip-dialog",null,"vipDialogData",e.func_data);break;case"recharge_alert":let t={fromType:e.func_data.from_type,diffCoin:e.func_data.diff_coin||0};t.order_source=typeof e.func_data.order_source=="undefined"?0:e.func_data.order_source,t.click_type=typeof e.func_data.click_type=="undefined"?0:e.func_data.click_type,ce("/pages/coin/coin-dialog",t,"coinDialogData",e.func_data);break;case"close":Bc();break;case"banned_alert":let i=e.func_data.exp_time;if(parseInt(new Date().getTime()/1e3)>i||(U("appDialog/addDialogBan",e.func_data),Xt.setCache(e.func_data),xt()=="/pagesDialog/banned"))return;let n=setTimeout(()=>{clearTimeout(n),U("appDialog/executeBanWarningDialog")},e.delay*1e3);break;case"reconnect_mqtt":getApp().socketReconnect(ku.API_CALL_BACK,e.func_data);break;case"reload_route":getApp().handleSecret(e.func_data,Ku.CALLBACK,{});break;case"event":Md(e.func_data);break;case"api":Od(e.func_data);break;case"sensitive_alert":ce("/pagesDialog/sensitive-check",null,"sensitiveData",e.func_data),uni.hideKeyboard();break;case"free_coins":ce("/pagesDialog/coins-free",{coin:e.func_data.free_coins},"coinsFree",{},{});break}},accessLog(e,t){this.request("/other/access-log",{api_name:e,content:Qt(t)})},accessLogExtra(e,t,i){let a=`${Qt(t)} ${Qt(i)}`;this.request("/other/access-log",{api_name:e,content:a})},accessLogApi(e,t,i,a){let n=`url:${t} p:${JSON.stringify(i)} res ${Qt(a)}`;B.accessLog(e,n)}};function Id(e){let t=e.enter_func,i=e.cancel_title,a=e.enter_title,n=e.cancel_func,s=!y(i);uni.hideKeyboard(),uni.showModal({title:e.title,content:e.msg,showCancel:s,cancelText:s?i:u("cancel"),confirmText:a||u("ok"),complete(r){r.confirm?y(t)||B.handleCallback(t):r.cancel&&(y(n)||B.handleCallback(n))}})}function Rd(e){let t=e.page_name,i=e.data;t=="inside_web"?Ii(i.route,!0):t=="safari"?Ii(i.route,!1):t=="web"?q(i.route):t=="native"?Fd(i.route):t=="chat"&&(ci().indexOf("/pages/call/chat-view")==-1?Hc(i.user_info):uni.$emit("event_no_connect_close_listener",{action:"chat_pri",user:i.user_info}))}function Md(e){let t=e.event_key;if(y(t))return;let i=e.data;y(i)?uni.$emit(t):uni.$emit(t,i)}function Od(e){if(e.type==1){let i={user_info:{is_rest:0}};B.request("/user/update-info",i,!0).then(()=>{getApp().pubUser.is_rest=0,Ee(u("tips"),u("anchorTurnedOffRest"),"",u("gotIt"))})}}function Fd(e){return new Function("return "+e)()}function Nd(e){ci().indexOf("/pagesDialog/stop_taking")==-1&&(getApp().globalData.appStopTaking=!0,getApp().socketDisconnect(),ce("/pagesDialog/stop_taking",{},"stopTakingData",e))}function Bd(e){try{y(e)&&(e={}),e.times=new Date().getTime();let t=Object.keys(e).sort(),i={};for(let n=0,s=t.length;n<s;n++)i[t[n]]=e[t[n]];let a=Pr(i).substr(1);return i.sign=as.md5(`${as.md5(a)}fMHjgD94yoc6TbB7sGoA`),i}catch(t){return e}}function Pr(e,t){if(e==null)return"";try{let i="",a=typeof e;if(a=="string"||a=="number")i+="&"+t+"="+Nc(e);else if(a=="boolean")i+="&"+t+"="+(e?1:0);else for(let n in e){let s=t==null?n:t+Pd(n);i+=Pr(e[n],s)}return i}catch(i){return""}}function Pd(e){return`${encodeURIComponent("[")}${e}${encodeURIComponent("]")}`}var v=(e,t)=>{let i=e.__vccOpts||e;for(let[a,n]of t)i[a]=n;return i};var Hd=["titleIcon","titleIconRadius","subtitleText","subtitleSize","subtitleColor","subtitleOverflow","titleAlign","backgroundImage","backgroundRepeat","blurEffect"],Ud={props:{title:{type:String,default:""},titleIcon:{type:String,default:""},titleIconRadius:{type:String,default:""},subtitleText:{type:String,default:""},subtitleSize:{type:String,default:""},subtitleColor:{type:String,default:""},subtitleOverflow:{type:String,default:""},titleAlign:{type:String,default:""},backgroundImage:{type:String,default:""},backgroundRepeat:{type:String,default:""},blurEffect:{type:String,default:""},loading:{type:Boolean,default:!1},frontColor:{type:String,default:"#ffffff"},backgroundColor:{type:String,default:"#000000"},colorAnimationDuration:{type:Number,default:0},colorAnimationTimingFunc:{type:String,default:"linear"}},created(){let e=getCurrentPages(),t=e[e.length-1];this.__$page=t,this.$watch("title",()=>{this.setNavigationBarTitle()}),this.$watch("loading",()=>{this.setNavigationBarLoading()}),this.$watch(()=>[this.frontColor,this.backgroundColor,this.colorAnimationDuration,this.colorAnimationTimingFunc],()=>{this.setNavigationBarColor()}),this.__$webview=t.$getAppWebview(),Hd.forEach(i=>{let a={};(this[i]||this[i].length>0)&&(a[i]=this[i]),this.setTitleNView(a),this.$watch(i,n=>{let s={};s[i]=n,this.setTitleNView(s)})})},beforeMount(){this.title&&this.setNavigationBarTitle(),this.setNavigationBarLoading(),this.setNavigationBarColor()},methods:{setNavigationBarTitle(){uni.setNavigationBarTitle({__page__:this.__$page,title:this.title})},setNavigationBarLoading(){uni[(this.loading?"show":"hide")+"NavigationBarLoading"]({__page__:this.__$page})},setNavigationBarColor(){uni.setNavigationBarColor({__page__:this.__$page,frontColor:this.frontColor,backgroundColor:this.backgroundColor,animation:{duration:this.colorAnimationDuration,timingFunc:this.colorAnimationTimingFunc}})},setTitleNView(e){let t=this.__$webview,i=t.getStyle();i&&i.titleNView&&t.setStyle({titleNView:e})}}};function Gd(e,t,i,a,n,s){return(0,Se.openBlock)(),(0,Se.createElementBlock)("view",{style:{display:"none"},renderWhole:!0})}var Wd=v(Ud,[["render",Gd]]),jd={name:"PageMeta",setup(e,{emit:t}){Na(i=>{t("resize",i)})},props:{backgroundTextStyle:{type:String,default:"dark",validator(e){return["dark","light"].indexOf(e)!==-1}},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created(){let e=getCurrentPages()[0];this.$pageVm=e.$vm||e,this._currentWebview=e.$getAppWebview(),this.enablePullDownRefresh&&this.setPullDownRefresh(this._currentWebview,!0),this.$watch("enablePullDownRefresh",t=>{this.setPullDownRefresh(this._currentWebview,t)}),this.$watch("backgroundTextStyle",()=>{this.setBackgroundTextStyle()}),this.$watch(()=>[this.rootFontSize,this.pageStyle],()=>{this.setPageMeta()}),this.$watch(()=>[this.backgroundColor,this.backgroundColorTop,this.backgroundColorBottom],()=>{this.setBackgroundColor()}),this.$watch(()=>[this.scrollTop,this.scrollDuration],()=>{this.pageScrollTo()})},beforeMount(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle()},mounted(){this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh(e,t){e.setStyle({pullToRefresh:{support:t,style:plus.os.name==="Android"?"circle":"default"}})},setPageMeta(){uni.setPageMeta({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle(){},setBackgroundColor(){},pageScrollTo(){let e=String(this.scrollTop);e.indexOf("rpx")!==-1&&(e=uni.upx2px(e.replace("rpx",""))),e=parseFloat(e),!isNaN(e)&&uni.pageScrollTo({scrollTop:e,duration:this.scrollDuration,success:()=>{}})}}};function Vd(e,t,i,a,n,s){return(0,Se.openBlock)(),(0,Se.createElementBlock)("view",{style:{display:"none"},renderWhole:!0},[(0,Se.renderSlot)(e.$slots,"default")])}var zd=v(jd,[["render",Vd]]),$d={props:{useBg1_1:{type:Boolean,default:!1},otherStyle:{type:String,default:""},enableRefresh:{type:Boolean,default:!1},title:{type:String,default:""}},data(){return{themeObj:getApp().globalData.themeObj}},computed:{style(){let e=`background:${this.useBg1_1?this.themeObj.color.bg1_1:this.themeObj.color.bg1};`;return y(this.otherStyle)||(e=e+this.otherStyle),e},navBarFontColor(){return this.themeObj.style==F.LIGHT?"#000000":"#FFFFFF"},navBarBgColor(){return this.themeObj.color.bg2}}};function Kd(e,t,i,a,n,s){let r=A((0,Se.resolveDynamicComponent)("navigation-bar"),Wd),l=A((0,Se.resolveDynamicComponent)("page-meta"),zd);return(0,Se.openBlock)(),(0,Se.createBlock)(l,{"page-style":s.style,"enable-pull-down-refresh":i.enableRefresh},{default:(0,Se.withCtx)(()=>[(0,Se.createVNode)(r,{title:i.title,"background-color":s.navBarBgColor,"front-color":s.navBarFontColor},null,8,["title","background-color","front-color"])]),_:1},8,["page-style","enable-pull-down-refresh"])}var Ns=v($d,[["render",Kd]]),Hr={data(){return{themeObj:getApp().globalData.themeObj,webStyle:!1,currentWebview:!1,loadTitleViewCount:0}},computed:{pageBgColor(){return this.useBg1_1?this.themeObj.color.bg1_1:this.themeObj.color.bg1},pageBg(){return{background:this.pageBgColor}},navBarFontColor(){return this.themeObj.style==F.LIGHT?"#000000":"#FFFFFF"}},methods:{initNavBarRBtn(e,t,i,a=""){this._setNavBar(e,t,i?this.themeObj.color.barBtn:this.themeObj.color.barBtnN,"14px",a)},initNavBarRBtnText(e,t,i="",a="14px"){let n=i||this.navBarFontColor;this._setNavBar(e,t,n,a)},initNavBarRBtnType(e,t,i){let a=i||(this.themeObj.style==F.LIGHT?"#000000":"#FFFFFF");this._setNavBarType(e,t,a)},initNavBarRBtnTextIcon(e,t,i="22px"){let a=this.themeObj.style==F.LIGHT?"#000000":"#FFFFFF";this._setNavBar(e,t,a,i)},initNavBarRImg(e,t){this._setNavBarImg(e,t)},initNavBarImgStyle(e,t){this._setNavBarImgStyle(e,t)},setNavBarRBtnStatus(e,t){this._setNavBarColor(e,t?this.themeObj.color.barBtn:this.themeObj.color.barBtnN)},setNavBarTitle(e){this._setNavBarTitle(e)},_setNavBarImgStyle(e,t){let i=this.webStyle.titleNView;if(i&&i.tags&&i.tags[t]){let a=i.tags[t].position,n=Object.assign(a,e);i.tags[t].position=n,this.currentWebview.setStyle({titleNView:i})}},_setNavBar(e,t,i,a,n){let s=this.webStyle.titleNView;n&&(s.titleText=n),s&&s.buttons&&s.buttons[t]&&(s.buttons[t].text=e,s.buttons[t].color=i,s.buttons[t].fontSize=a,this.currentWebview.setStyle({titleNView:s}))},_setNavBarType(e,t,i){let a=this.webStyle.titleNView;a&&a.buttons&&a.buttons[t]&&(a.buttons[t].type=e,a.buttons[t].color=i,this.currentWebview.setStyle({titleNView:a}))},_setNavBarImg(e,t){let i=this.webStyle.titleNView;i&&i.tags&&i.tags[t]&&(i.tags[t].src=e,this.currentWebview.setStyle({titleNView:i}))},_setNavBarColor(e,t){let i=this.webStyle.titleNView;i&&i.buttons&&i.buttons[e]&&(i.buttons[e].color=t,this.currentWebview.setStyle({titleNView:i}))},_setNavBarTitle(e=""){let t=this.webStyle.titleNView;t&&e&&(t.titleText=e,this.currentWebview.setStyle({titleNView:t}))},_setViewBg(e,t,i){try{if(this.webStyle=this.currentWebview.getStyle(),i&&typeof this.webStyle.titleNView=="undefined"&&this.loadTitleViewCount<10){this.loadTitleViewCount+=1,setTimeout(()=>{this._setViewBg(e,t)},100);return}this.webStyle.titleNView?(this.webStyle.titleNView.splitLine&&(this.webStyle.titleNView.splitLine.color=e),this.webStyle.titleNView.titleColor&&(this.webStyle.titleNView.titleColor=this.navBarFontColor),this.webStyle.titleNView.backgroundColor&&(this.webStyle.titleNView.backgroundColor=this.themeObj.color.bg2),this.currentWebview.setStyle({titleNView:this.webStyle.titleNView})):uni.setNavigationBarColor({frontColor:this.navBarFontColor}),this.webStyle.background=t,this.currentWebview.setStyle({background:t})}catch(a){M("error","at coms/theme.mixin.js:133","error theme.mixin.js catch ...",a)}}},onReady(){let e,t;this.themeObj.style==F.LIGHT?e="rgba(230,230,230,0.5)":e=this.themeObj.color.bg2,t=this.useBg1_1?this.themeObj.color.bg1_1:this.themeObj.color.bg1;let i=getCurrentPages(),a=i[i.length-1];if(!a)return;this.currentWebview=a.$getAppWebview();let n,s=this.currentWebview.getNavigationbar();y(s)||Object.keys(s).length<=0?n=!0:n=!1,this._setViewBg(e,t,n)}};var d=ee(ie());var Ie=ee(ie());var Yd=e=>e!==null&&typeof e=="object",Jd=["{","}"],Hs=class{constructor(){this._caches=Object.create(null)}interpolate(t,i,a=Jd){if(!i)return[t];let n=this._caches[t];return n||(n=Zd(t,a),this._caches[t]=n),Qd(n,i)}},qd=/^(?:\d)+/,Xd=/^(?:\w)+/;function Zd(e,[t,i]){let a=[],n=0,s="";for(;n<e.length;){let r=e[n++];if(r===t){s&&a.push({type:"text",value:s}),s="";let l="";for(r=e[n++];r!==void 0&&r!==i;)l+=r,r=e[n++];let c=r===i,p=qd.test(l)?"list":c&&Xd.test(l)?"named":"unknown";a.push({value:l,type:p})}else s+=r}return s&&a.push({type:"text",value:s}),a}function Qd(e,t){let i=[],a=0,n=Array.isArray(t)?"list":Yd(t)?"named":"unknown";if(n==="unknown")return i;for(;a<e.length;){let s=e[a];switch(s.type){case"text":i.push(s.value);break;case"list":i.push(t[parseInt(s.value,10)]);break;case"named":n==="named"&&i.push(t[s.value]);break}a++}return i}var Bs="zh-Hans",Ur="zh-Hant",hi="en",ep="fr",tp="es",ip=Object.prototype.hasOwnProperty,Gr=(e,t)=>ip.call(e,t),np=new Hs;function sp(e,t){return!!t.find(i=>e.indexOf(i)!==-1)}function ap(e,t){return t.find(i=>e.indexOf(i)===0)}function Wr(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if(e=e.toLowerCase(),e==="chinese")return Bs;if(e.indexOf("zh")===0)return e.indexOf("-hans")>-1?Bs:e.indexOf("-hant")>-1||sp(e,["-tw","-hk","-mo","-cht"])?Ur:Bs;let i=[hi,ep,tp];t&&Object.keys(t).length>0&&(i=Object.keys(t));let a=ap(e,i);if(a)return a}var Us=class{constructor({locale:t,fallbackLocale:i,messages:a,watcher:n,formater:s}){this.locale=hi,this.fallbackLocale=hi,this.message={},this.messages={},this.watchers=[],i&&(this.fallbackLocale=i),this.formater=s||np,this.messages=a||{},this.setLocale(t||hi),n&&this.watchLocale(n)}setLocale(t){let i=this.locale;this.locale=Wr(t,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],i!==this.locale&&this.watchers.forEach(a=>{a(this.locale,i)})}getLocale(){return this.locale}watchLocale(t){let i=this.watchers.push(t)-1;return()=>{this.watchers.splice(i,1)}}add(t,i,a=!0){let n=this.messages[t];n?a?Object.assign(n,i):Object.keys(i).forEach(s=>{Gr(n,s)||(n[s]=i[s])}):this.messages[t]=i}f(t,i,a){return this.formater.interpolate(t,i,a).join("")}t(t,i,a){let n=this.message;return typeof i=="string"?(i=Wr(i,this.messages),i&&(n=this.messages[i])):a=i,Gr(n,t)?this.formater.interpolate(n[t],a).join(""):(console.warn(`Cannot translate the value of keypath ${t}. Use the value of keypath as default.`),t)}};function rp(e,t){e.$watchLocale?e.$watchLocale(i=>{t.setLocale(i)}):e.$watch(()=>e.$locale,i=>{t.setLocale(i)})}function op(){return typeof uni!="undefined"&&uni.getLocale?uni.getLocale():typeof global!="undefined"&&global.getLocale?global.getLocale():hi}function lp(e,t={},i,a){typeof e!="string"&&([e,t]=[t,e]),typeof e!="string"&&(e=op()),typeof i!="string"&&(i=typeof __uniConfig!="undefined"&&__uniConfig.fallbackLocale||hi);let n=new Us({locale:e,fallbackLocale:i,messages:t,watcher:a}),s=(r,l)=>{if(typeof getApp!="function")s=function(c,p){return n.t(c,p)};else{let c=!1;s=function(p,h){let g=getApp().$vm;return g&&(g.$locale,c||(c=!0,rp(g,n))),n.t(p,h)}}return s(r,l)};return{i18n:n,f(r,l,c){return n.f(r,l,c)},t(r,l){return s(r,l)},add(r,l,c=!0){return n.add(r,l,c)},watch(r){return n.watchLocale(r)},getLocale(){return n.getLocale()},setLocale(r){return n.setLocale(r)}}}var cp={"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"},up={"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"Loading...","uni-load-more.contentnomore":"No more data"},dp={"uni-load-more.contentdown":"\u4E0A\u62C9\u986F\u793A\u66F4\u591A","uni-load-more.contentrefresh":"\u6B63\u5728\u52A0\u8F09...","uni-load-more.contentnomore":"\u6C92\u6709\u66F4\u591A\u6578\u64DA\u4E86"},pp={"uni-load-more.contentdown":"Tire hacia arriba para mostrar m\xE1s","uni-load-more.contentrefresh":"cargando...","uni-load-more.contentnomore":"No m\xE1s datos"},hp={"uni-load-more.contentdown":"\u0627\u0633\u062D\u0628 \u0644\u0623\u0639\u0644\u0649 \u0644\u0625\u0638\u0647\u0627\u0631 \u0627\u0644\u0645\u0632\u064A\u062F","uni-load-more.contentrefresh":"\u062C\u0627\u0631 \u0627\u0644\u062A\u062D\u0645\u064A\u0644...","uni-load-more.contentnomore":"\u0644\u0627 \u0645\u0632\u064A\u062F \u0645\u0646 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"},mp={"uni-load-more.contentdown":"K\xE9o l\xEAn \u0111\u1EC3 hi\u1EC3n th\u1ECB th\xEAm","uni-load-more.contentrefresh":"\u0111ang t\u1EA3i...","uni-load-more.contentnomore":"Kh\xF4ng c\xF2n d\u1EEF li\u1EC7u"},gp={en:cp,"zh-Hans":up,"zh-Hant":dp,es:pp,ar:hp,vi:mp},fp={"uni-load-more":{"":{flexDirection:"row",height:40,alignItems:"center",justifyContent:"center"}},"uni-load-more__text":{"":{fontSize:14,marginLeft:8}},"uni-load-more__img":{"":{width:24,height:24}},"uni-load-more__img--nvue":{"":{color:"#666666"}},"uni-load-more__img--android":{"":{width:24,height:24,transform:"rotate(0deg)"}},"uni-load-more__img--ios":{"":{width:24,height:24,transform:"rotate(0deg)"}}},jr;setTimeout(()=>{jr=uni.getSystemInfoSync().platform},16);var{t:Ps}=lp(gp),_p={name:"UniLoadMore",emits:["clickLoadMore"],props:{status:{type:String,default:"more"},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"auto"},iconSize:{type:Number,default:24},color:{type:String,default:"#777777"},contentText:{type:Object,default(){return{contentdown:"",contentrefresh:"",contentnomore:""}}},showText:{type:Boolean,default:!1}},data(){return{webviewHide:!1,platform:jr,imgBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzlBMzU3OTlEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzlBMzU3OUFEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDOUEzNTc5N0Q5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDOUEzNTc5OEQ5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt+ALSwAAA6CSURBVHja1FsLkFZVHb98LM+F5bHL8khA1iSeiyQBCRM+YGqKUnnJTDLGI0BGZlKDIU2MMglUiDApEZvSsZnQtBRJtKwQNKQMFYeRDR10WOLd8ljYXdh+v8v5fR3Od+797t1dnOnO/Ofce77z+J//+b/P+ZqtXbs2sJ9MJhNUV1cHJ06cCJo3bx7EPc2aNcvpy7pWrVoF+/fvDyoqKoI2bdoE9fX1F7TjN8a+EXBn/fkfvw942Tf+wYMHg9mzZwfjxo0LDhw4EPa1x2MbFw/fOGfPng1qa2tzcCkILsLDydq2bRsunpOTMM7TD/W/tZDZhPdeKD+yGxHhdu3aBV27dg3OnDlzMVANMheLAO3btw8KCwuDmpoaX5OxbgUIMEq7K8IcPnw4KCsrC/r37x8cP378/4cAXAB3vqSkJMuiDhTkw+XcuXNhOWbMmKBly5YhUT8xArhyFvP0BfwRsAuwxJZJsm/nzp2DTp06he/OU+cZ64K6o0ePBkOHDg2GDx8e6gEbJ5Q/NHNuAJQ1hgBeHUDlR7nVTkY8rQAvAi4z34vR/mPs1FoRsaCgIJThI0eOBC1atEiFGGV+5MiRoS45efJkqFjJFXV1dQuA012m2WcwTw98fy6CqBdsaiIO4CScrGPHjvk4odhavPquRtFWXEC25VgkREKOCh/qDSq+vn37htzD/mZTOmOc5U7zKzBPEedygWshcDyWvs30igAbU+6oyMgJBCFhwQE0fccxN60Ay9iebbjoDh06hMowjQxT4fXq1SskArmHZpkArvixp/kWzHdMeArExSJEaiXIjjRjRJ4DaAGWpibLzXN3Fm1vA5teBgh3j1Rv3bp1YgKwPdmf2p9zcyNYYgPKMfY0T5f5nNYdw158nJ8QawW4CLKwiOBSEgO/hok2eBydR+3dYH+PLxA5J8Vv0KBBwenTp0P2JWAx6+yFEBfs8lMY+y0SWMBNI9E4ThKi58VKTg3FQZS1RQF1cz27eC0QHMu+3E0SkUowjhVt5VdaWhp07949ZHv2Qd1EjDXM2cla1M0nl3GxAs3J9yREzyTdFVKVFOaE9qRA8GM0WebRuo9JGZKA7Mv2SeS/Z8+eoQ9BArMfFrLGo6jvxbhHbJZnKX2Rzz1O7QhJJ9Cs2ZMaWIyq/zhdeqPNfIoHd58clIQD+JSXl4dKlyIAuBdVXZwFVWKspSSoxE++h8x4k3uCnEhE4I5KwRiFWGOU0QWKiCYLbdoRMRKAu2kQ9vkfLU6dOhX06NEjlH+yMRZSinnuyWnYosVcji8CEA/6Cg2JF+IIUBqnGKUTCNwtwBN4f89RiK1R96DEgO2o0NDmtEdvVFdVVYV+P3UAPUEs6GFwV3PHmXkD4vh74iDFJysVI/MlaQhwKeBNTLYX5VuA8T4/gZxA4MRGFxDB6R7OmYPfyykGRJbyie+XnGYnQIC/coH9+vULiYrxrkL9ZA9+0ykaHIfEpM7ge8TiJ2CsHYwyMfafAF1yCGBHYIbCVDjDjKt7BeB51D+LgQa6OkG7IDYEEtvQ7lnXLKLtLdLuJBpE4gPUXcW2+PkZwOex+4cGDhwYDBkyRL7/HFcEwUGPo/8uWRUpYnfxGHco8HkewLHLyYmAawAPuIFZxhOpDfJQ8gbUv41yORAptMWBNr6oqMhWird5+u+iHmBb2nhjDV7HWBNQTgK8y11l5NetWzc5ULscAtSj7nbNI0skhWeUZCc0W4nyH/jO4Vz0u1IeYhbk4AiwM6tjxIWByHsoZ9qcIBPJd/y+DwPfBESOmCa/QF3WiZHucLlEDpNxcNhmheEOPgdQNx6/VZFQzFZ5TN08AHXQt2Ii3EdyFuUsPtTcGPhW5iMiCNELvz+Gdn9huG4HUJaW/w3g0wxV0XaG7arG2WeKiUWYM4Y7GO5ezshTARbbWGw/DvXkpp/ivVvE0JVoMxN4rpGzJMhE5Pl+xlATsDIqikP9F9D2z3h9nOksEUFhK+qO4rcPkoalMQ/HqJLIyb3F3JdjrCcw1yZ8joyJLR5gCo54etlag7qIoeNh1N1BRYj3DTFJ0elotxPlVzkGuYAmL0VSJVGAJA41c4Z6A3BzTLfn0HYwYKEI6CUAMzZEWvLsIcQOo1AmmyyM72nHJCfYsogflGV6jEk9vyQZXSuq6w4c16NsGcGZbwOPr+H1RkOk2LEzjNepxQkihHSCQ4ynAYNRx2zMKV92CQMWqj8J0BRE8EShxRFN6YrfCRhC0x3r/Zm4IbQCcmJoV0kMamllccR6FjHqUC5F2R/wS2dcymOlfAKOS4KmzQb5cpNC2MC7JhVn5wjXoJ44rYhLh8n0eXOCorJxa7POjbSlCGVczr34/RsAmrcvo9s+wGp3tzVhntxiXiJ4nvEYb4FJkf0O8HocAePmLvCxnL0AORraVekJk6TYjDabRVXfRE2lCN1h6ZQRN1+InUbsCpKwoBZHh0dODN9JBCUffItXxEavTQkUtnfTVAplCWL3JISz29h4NjotnuSsQKJCk8dF+kJR6RARjrqFVmfPnj3ZbK8cIJ0msd6jgHPGtfVTQ8VLmlvh4mct9sobRmPic0DyDQQnx/NlfYUgyz59+oScsH379pAwXABD32nTpoUHIToESeI5mnbE/UqDdyLcafEBf2MCqgC7NwxIbMREJQ0g4D4sfJwnD+AmRrII05cfMWJE+L1169bQr+fip06dGp4oJ83lmYd5wj/EmMa4TaHivo4EeCguYZBnkB5g2aWA69OIEnUHOaGysjIYMGBAMGnSpODYsWPZwCpFmm4lNq+4gSLQA7jcX8DwtjEyRC8wjabnXEx9kfWnTJkSJkAo90xpJVV+FmcVNeYAF5zWngS4C4O91MBxmAv8blLEpbjI5sz9MTdAhcgkCT1RO8mZkAjfiYpTEvStAS53Uw1vAiUGgZ3GpuQEYvoiBqlIan7kSDHnTwJQFNiPu0+5VxCVYhcZIjNrdXUDdp+Eq5AZ3Gkg8QAyVZRZIk4Tl4QAbF9cXJxNYZMAtAokgs4BrNxEpCtteXg7DDTMDKYNSuQdKsnJBek7HxewvxaosWxLYXtw+cJp18217wql4aKCfBNoEu0O5VU+PhctJ0YeXD4C6JQpyrlpSLTojpGGGN5YwNziChdIZLk4lvLcFJ9jMX3QdiImY9bmGQU+TRUL5CHITTRlgF8D9ouD1MfmLoEPl5xokIumZ2cfgMpHt47IW9N64Hsh7wQYYjyIugWuF5fCqYncXRd5vPMWyizzvhi/32+nvG0dZc9vR6fZOu0md5e+uC408FvKSIOZwXlGvxPv95izA2Vtvg1xKFWARI+vMX66HUhpQQb643uW1bSjuTWyw2SBvDrBvjFic1eGGlz5esq3ko9uSIlBRqPuFcCv8F4WIcN12nVaBd0SaYwI6PDDImR11JkqgHcPmQssjxIn6bUshygDFJUTxPMpHk+jfjPgupgdnYV2R/g7xSjtpah8RJBewhwf0gGK6XI92u4wXFEU40afJ4DN4h5LcAd+40HI3JgJecuT0c062W0i2hQJUTcxan3/CMW1PF2K6bbA+Daz4xRs1D3Br1Cm0OihKCqizW78/nXAF/G5TXrEcVzaNMH6CyMswqsAHqDyDLEyou8lwOXnKF8DjI6KjV3KzMBiXkDH8ij/H214J5A596ekrZ3F0zXlWeL7+P5eUrNo3/QwC15uxthuzidy7DzKRwEDaAViiDgKbTbz7CJnzo0bN7pIfIiid8SuPwn25o3QCmpnyjlZkyxPP8EomCJzrGb7GJMx7tNsq4MT2xMUYaiErZOluTzKsnz3gwCeCZyVRZJfYplNEokEjwrPtxlxjeYAk+F1F74VAzPxQRNYYdtpOUvWs8J1sGhBJMNsb7igN8plJs1eSmLIhLKE4rvaCX27gOhLpLOsIzJ7qn/i+wZzcvSOZ23/du8TZjwV8zHIXoP4R3ifBxiFz1dcVpa3aPntPE+c6TmIWE9EtcMmAcPdWAhYhAXxcLOQi9L1WhD1Sc8p1d2oL7XGiRKp8F4A2i8K/nfI+y/gsTDJ/YC/8+AD5Uh04KHiGl+cIFPnBDDrPMjwRGkLXyxO4VGbfQWnDH2v0bVWE3C9QOXlepbgjEfIJQI6XDG3z5ahD9cw2pS78ipB85wyScNTvsVzlzzhL8/jRrnmVjfFJK/m3m4nj9vbgQTguT8XZTjsm672R5uJKEaQmBI/c58gyus8ZDagLpEVSJBIyHp4jn++xqPV71OgQgJYEWOtZ/haxRtKmWOBu8xdBLftWltsY84zE6WIEy/eIOWL+BaayMx+KHtL7EAkqdNDLiEXmEMUHniedtJqg9HmZtfvt26vNi0BdG3Ft3g8ZOf7PAu59TxtzivLNIekyi+wD1i8CuUiD9FXAa8C+/xS3JPmZnomyc7H+fb4/Se0bk41Fel621r4cgVxbq91V4jVqwB7HTe2M7jgB+QWHavZkDRPmZcASoZEmBx6i75bGjPcMdL4/VKGFAGWZkGzPG0XAbdL9A81G5LOmUnC9hHKJeO7dcUMjblSl12867ElFTtaGl20xvvLGPdVz/8TVuU7y0x1PG7vtNg24oz9Uo/Z412++VFWI7Fcog9tu9Lm6gvRmIPv9x1xmQAu6RDkXtbOtlGEmpgD5Nvnyc0dcv0EE6cfdi1HmhMf9wDF3k3gtRvEedhxjpgfqPb9PU9iEJHnyOUA7bQUXh6kq/D7l2iTjWv7XOD530BDr8jIrus+srXjt4MzumJMHuTsBa63YKE1+RR5lBjEikCCnWKWiHdzOgKO+nRIBAF88za/IFmJ3eMZov4CYxGBabcpGL8EYx+SeMXJeRwHNsV/h+vdxeuhEpN3ZyNY78Gm2fknJxVGhyjixPiQvVkNzT1elD9Py/aTAL64Hb9vcYmC9zfdXdT/C1LeGbg4rnBaAihDFJH12W5ulfNCNe/xTsP3bp8ikzJs5BF+5PNfAQYAPaseTdsEcaYAAAAASUVORK5CYII="}},computed:{iconSnowWidth(){return(Math.floor(this.iconSize/24)||1)*2},contentdownText(){return this.contentText.contentdown||Ps("uni-load-more.contentdown")},contentrefreshText(){return this.contentText.contentrefresh||Ps("uni-load-more.contentrefresh")},contentnomoreText(){return this.contentText.contentnomore||Ps("uni-load-more.contentnomore")}},mounted(){var e=getCurrentPages(),t=e[e.length-1],i=t.$getAppWebview();i.addEventListener("hide",()=>{this.webviewHide=!0}),i.addEventListener("show",()=>{this.webviewHide=!1})},methods:{onClick(){this.$emit("clickLoadMore",{detail:{status:this.status}})}}};function yp(e,t,i,a,n,s){return(0,Ie.openBlock)(),(0,Ie.createElementBlock)("view",{class:"uni-load-more",onClick:t[0]||(t[0]=(...r)=>s.onClick&&s.onClick(...r)),renderWhole:!0},[!n.webviewHide&&i.status==="loading"&&i.showIcon?((0,Ie.openBlock)(),(0,Ie.createElementBlock)("loading-indicator",{key:0,style:(0,Ie.normalizeStyle)({color:i.color,width:i.iconSize+"px",height:i.iconSize+"px"}),animating:!0,class:"uni-load-more__img uni-load-more__img--nvue"},null,4)):(0,Ie.createCommentVNode)("",!0),i.showText?((0,Ie.openBlock)(),(0,Ie.createElementBlock)("u-text",{key:1,class:"uni-load-more__text",style:(0,Ie.normalizeStyle)({color:i.color})},(0,Ie.toDisplayString)(i.status==="more"?s.contentdownText:i.status==="loading"?s.contentrefreshText:s.contentnomoreText),5)):(0,Ie.createCommentVNode)("",!0)])}var Gt=v(_p,[["render",yp],["styles",[fp]]]);var ue=ee(ie()),bp={"l-img":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"place-img":{"":{position:"absolute",top:0,left:0}},"text-place":{"":{color:"#999999",position:"absolute",bottom:0,textAlign:"center"}}},xp={name:"LImg",emits:["click","onError","onLoad"],props:{src:{type:String,default:""},mode:{type:String,default:"aspectFill"},w:{type:String,default:"0"},h:{type:String,default:"0"},radius:{type:String,default:"0"},lazyLoad:{type:Boolean,default:!1},fade:{type:Boolean,default:!0},placeType:{type:Number,default:0},placeW:{type:String,default:""},placeFontSize:{type:[String,Boolean],default:""},placeBottom:{type:String,default:""},border:{type:String,default:""},otherStyle:{type:Object,default(){return{}}},click:{type:Boolean,default:!0},isGif:{type:Boolean,default:!1},needStyle:{type:[String,Number],default:0},useCache:{type:Boolean,default:!1},fitWH:{type:String,default:""}},data(){return{errorCount:1,path:"",refresh:!0,darkDir:"",isLoad:!1,fitStr:""}},watch:{src(){this.isLoad=!1,this.path=this.parse()}},computed:{placeSrc(){return this.placeType==1?"/static/img_load_s.png":this.placeType==2?"/static/img_load_b.png":""},placeViewStyle(){let e={width:this.placeW,height:this.placeW,position:"relative"};return this.placeBottom&&(e.marginBottom=this.placeBottom),e},placeFontSizeVal(){return this.placeFontSize===!1?"":this.placeFontSize?this.placeFontSize:this.placeType==2?"24rpx":"16rpx"},borderStyle(){if(this.border=="")return{};let e={},t=this.border.split(" ");return e.borderWidth=t[0],e.borderStyle=t[1],e.borderColor=t[2],e},viewStyle(){let e={width:this.w,minWidth:this.w,height:this.h,minHeight:this.h};return this.setRadius(e)},imgStyle(){let e={width:this.w,height:this.h};return e=Object.assign(e,this.otherStyle),this.setRadius(e)},ossPathOriginal(){return this.isGif?getApp().globalData.ossPath:getApp().globalData.ossPicPath}},methods:{$str:u,clickImg(e){this.click&&this.$emit("click",e)},setRadius(e){let t=this.radius.split(" ");return t.length<=1?e.borderRadius=this.radius:(e.borderTopLeftRadius=t[0],e.borderTopRightRadius=t[1],e.borderBottomRightRadius=t[2],e.borderBottomLeftRadius=t[3]),e},onLoadError(){if(this.path){if(this.path.startsWith("http")){if(this.errorCount>2){this.isError=!0,this.$emit("onError");return}this.errorCount+=1,this.refresh=!1,setTimeout(()=>{this.refresh=!0},500);return}this.path=this.ossPathOriginal+this.darkDir+this.src,gr(this.darkDir+this.src)}},onLoad(){this.isLoad=!0,this.$emit("onLoad")},parse(){let e;if(e=0,this.src.startsWith("/static"))return this.src;if(this.src.startsWith("s/")){let t=getApp().getAppFilePath(this.darkDir+this.src,e);if(!y(t))return t}return this.useCache||e&&f.isAndroid?this.isGif?Ye(this.fitStr+this.darkDir+this.src):Ss(this.fitStr+this.darkDir+this.src):this.src.startsWith("file://")?this.src:this.src.startsWith("/var/mobile/")?"file://"+this.src:this.src.startsWith("/storage/")?this.src:this.ossPathOriginal+this.fitStr+this.darkDir+this.src}},created(){this.needStyle==1&&getApp().globalData.themeObj.style==F.DARK?this.darkDir="dark/":this.darkDir="",this.fitWH&&this.src.indexOf("fit-in")==-1&&(this.fitStr="fit-in/"+this.fitWH+"/"),this.path=this.parse()}};function wp(e,t,i,a,n,s){return(0,ue.openBlock)(),(0,ue.createElementBlock)("view",{class:"l-img",onClick:t[2]||(t[2]=(...r)=>s.clickImg&&s.clickImg(...r)),style:(0,ue.normalizeStyle)([s.viewStyle,s.borderStyle]),renderWhole:!0},[(0,ue.createElementVNode)("view",{class:"l-img",style:(0,ue.normalizeStyle)([{position:"relative"},s.viewStyle])},[i.placeType&&!n.isLoad?((0,ue.openBlock)(),(0,ue.createElementBlock)("view",{key:0,style:(0,ue.normalizeStyle)(s.placeViewStyle)},[(0,ue.createElementVNode)("u-image",{src:s.placeSrc,style:(0,ue.normalizeStyle)({width:i.placeW,height:i.placeW})},null,12,["src"]),s.placeFontSizeVal?((0,ue.openBlock)(),(0,ue.createElementBlock)("u-text",{key:0,class:"text-place",style:(0,ue.normalizeStyle)({fontSize:s.placeFontSizeVal,width:i.placeW})},(0,ue.toDisplayString)(s.$str("loading"))+"...",5)):(0,ue.createCommentVNode)("",!0)],4)):(0,ue.createCommentVNode)("",!0),n.refresh?((0,ue.openBlock)(),(0,ue.createElementBlock)("u-image",{key:1,onError:t[0]||(t[0]=(...r)=>s.onLoadError&&s.onLoadError(...r)),onLoad:t[1]||(t[1]=(...r)=>s.onLoad&&s.onLoad(...r)),src:n.path,mode:i.mode,lazyLoad:i.lazyLoad,fadeShow:i.fade,style:(0,ue.normalizeStyle)([s.imgStyle,s.borderStyle]),class:"place-img"},null,44,["src","mode","lazyLoad","fadeShow"])):(0,ue.createCommentVNode)("",!0)],4)],4)}var P=v(xp,[["render",wp],["styles",[bp]]]);var T=ee(ie());var Je=ee(ie());var Cp=xe("animation"),kn=class{constructor(t,i){this.options=t,this.animation=uni.createAnimation(t),this.currentStepAnimates={},this.next=0,this.$=i}_nvuePushAnimates(t,i){let a=this.currentStepAnimates[this.next],n={};if(a?n=a:n={styles:{},config:{}},zr.includes(t)){n.styles.transform||(n.styles.transform="");let s="";t==="rotate"&&(s="deg"),n.styles.transform+=`${t}(${i+s}) `}else n.styles[t]=`${i}`;this.currentStepAnimates[this.next]=n}_animateRun(t={},i={}){let a=this.$.$refs.ani.ref;if(a)return new Promise((n,s)=>{Cp.transition(a,$n({styles:t},i),r=>{n()})})}_nvueNextAnimate(t,i=0,a){let n=t[i];if(n){let{styles:s,config:r}=n;this._animateRun(s,r).then(()=>{i+=1,this._nvueNextAnimate(t,i,a)})}else this.currentStepAnimates={},typeof a=="function"&&a(),this.isEnd=!0}step(t={}){return this.currentStepAnimates[this.next].config=Object.assign({},this.options,t),this.currentStepAnimates[this.next].styles.transformOrigin=this.currentStepAnimates[this.next].config.transformOrigin,this.next++,this}run(t){this.isEnd=!1,this.$.$refs.ani&&this.$.$refs.ani.ref&&(this._nvueNextAnimate(this.currentStepAnimates,0,t),this.next=0)}},zr=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"],Sp=["opacity","backgroundColor"],kp=["width","height","left","right","top","bottom"];zr.concat(Sp,kp).forEach(e=>{kn.prototype[e]=function(...t){return this._nvuePushAnimates(e,t),this}});function Vr(e,t){if(t)return clearTimeout(t.timer),new kn(e,t)}var Ap={name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default(){return"fade"}},duration:{type:Number,default:300},styles:{type:Object,default(){return{}}},customClass:{type:String,default:""}},data(){return{isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}},watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e=aa($n({},this.styles),{"transition-duration":this.duration/1e3+"s"}),t="";for(let i in e){let a=this.toLine(i);t+=a+":"+e[i]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=Vr(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){if(this.animation){for(let i in e)try{typeof e[i]=="object"?this.animation[i](...e[i]):this.animation[i](e[i])}catch(a){M("error","at uni_modules/uni-transition/components/uni-transition/uni-transition.vue:139",`\u65B9\u6CD5 ${i} \u4E0D\u5B58\u5728`)}return this.animation.step(t),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);typeof e!="undefined"&&(this.opacity=e),this.transform=t,this.$nextTick(()=>{this.timer=setTimeout(()=>{this.animation=Vr(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})},20)})},close(e){this.animation&&this.tranfromInit(!0).step().run(()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:t,transform:i}=this.styleInit(!1);this.opacity=t||1,this.transform=i,this.$emit("change",{detail:this.isShow})})},styleInit(e){let t={transform:""},i=(a,n)=>{n==="fade"?t.opacity=this.animationType(a)[n]:t.transform+=this.animationType(a)[n]+" "};return typeof this.modeClass=="string"?i(e,this.modeClass):this.modeClass.forEach(a=>{i(e,a)}),t},tranfromInit(e){let t=(i,a)=>{let n=null;a==="fade"?n=i?0:1:(n=i?"-100%":"0",a==="zoom-in"&&(n=i?.8:1),a==="zoom-out"&&(n=i?1.2:1),a==="slide-right"&&(n=i?"100%":"0"),a==="slide-bottom"&&(n=i?"100%":"0")),this.animation[this.animationMode()[a]](n)};return typeof this.modeClass=="string"?t(e,this.modeClass):this.modeClass.forEach(i=>{t(e,i)}),this.animation},animationType(e){return{fade:e?1:0,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}},animationMode(){return{fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}},toLine(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}}};function Tp(e,t,i,a,n,s){return n.isShow?((0,Je.openBlock)(),(0,Je.createElementBlock)("view",{key:0,ref:"ani",animation:n.animationData,class:(0,Je.normalizeClass)(i.customClass),style:(0,Je.normalizeStyle)(s.transformStyles),onClick:t[0]||(t[0]=(...r)=>s.onClick&&s.onClick(...r)),renderWhole:!0},[(0,Je.renderSlot)(e.$slots,"default")],14,["animation"])):(0,Je.createCommentVNode)("",!0)}var Ct=v(Ap,[["render",Tp]]);var oe=ee(ie()),vp={"uni-popup":{"":{position:"fixed"},".top":{top:0},".left":{top:0},".right":{top:0}},"uni-popup__wrapper":{".uni-popup ":{position:"relative"},".uni-popup .left":{paddingTop:0,flex:1},".uni-popup .right":{paddingTop:0,flex:1}},"fixforpc-top":{"":{top:0}}},Dp={name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},maskClick:{type:Boolean,default:!0},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBgColor:{type:String,default:"rgba(0, 0, 0, 0.4)"}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},transClass:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:this.isDesktop?"fixforpc-top":"top"}},computed:{maskClass(){return{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:this.maskBgColor}},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return this.backgroundColor===""||this.backgroundColor==="none"?"transparent":this.backgroundColor}},mounted(){(()=>{let{windowWidth:t,windowHeight:i,windowTop:a,safeAreaInsets:n}=uni.getSystemInfoSync();this.popupWidth=t,this.popupHeight=i+a,this.safeArea?this.safeAreaInsets=n:this.safeAreaInsets=0})()},created(){this.mkclick=this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1},methods:{closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){this.clearPropagation=!0},open(e,t=!0){if(e&&["top","center","bottom","left","right","message","dialog","share"].indexOf(e)!==-1||(e=this.type),this.maskShow=t,!this.config[e]){M("error","at uni_modules/uni-popup/components/uni-popup/uni-popup.vue:218","\u7F3A\u5C11\u7C7B\u578B\uFF1A",e);return}this[this.config[e]](),this.$emit("change",{show:!0,type:e})},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout(()=>{this.showPopup=!1},300)},touchstart(){this.clearPropagation=!1},onTap(){if(this.clearPropagation){this.clearPropagation=!1;return}this.$emit("maskClick"),this.mkclick&&this.close()},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0,this.$nextTick(()=>{this.messageChild&&this.type==="message"&&this.messageChild.timerClose()}))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets&&this.safeAreaInsets.bottom||0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},!e&&(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg},!e&&(this.showPopup=!0,this.showTrans=!0)}}};function Lp(e,t,i,a,n,s){let r=A((0,oe.resolveDynamicComponent)("uni-transition"),Ct);return n.showPopup?((0,oe.openBlock)(),(0,oe.createElementBlock)("view",{key:0,class:(0,oe.normalizeClass)(["uni-popup",[n.popupstyle,s.isDesktop?"fixforpc-z-index":""]]),onTouchmove:t[2]||(t[2]=(0,oe.withModifiers)((...l)=>s.clear&&s.clear(...l),["stop","prevent"])),renderWhole:!0},[(0,oe.createElementVNode)("view",{onTouchstart:t[1]||(t[1]=(...l)=>s.touchstart&&s.touchstart(...l))},[n.maskShow?((0,oe.openBlock)(),(0,oe.createBlock)(r,{key:"1",name:"mask","mode-class":"fade",styles:s.maskClass,duration:n.duration,show:n.showTrans,onClick:s.onTap},null,8,["styles","duration","show","onClick"])):(0,oe.createCommentVNode)("",!0),(0,oe.createVNode)(r,{key:"2","mode-class":n.ani,name:"content",styles:n.transClass,duration:n.duration,show:n.showTrans,onClick:s.onTap},{default:(0,oe.withCtx)(()=>[(0,oe.createElementVNode)("view",{class:(0,oe.normalizeClass)(["uni-popup__wrapper",[n.popupstyle]]),style:(0,oe.normalizeStyle)({backgroundColor:s.bg}),onClick:t[0]||(t[0]=(...l)=>s.clear&&s.clear(...l))},[(0,oe.renderSlot)(e.$slots,"default")],6)]),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],34)):(0,oe.createCommentVNode)("",!0)}var St=v(Dp,[["render",Lp],["styles",[vp]]]);var kt=ee(ie());var Ep={id:"2852637",name:"uniui\u56FE\u6807\u5E93",font_family:"uniicons",css_prefix_text:"uniui-",description:"",glyphs:[{icon_id:"25027049",name:"yanse",font_class:"color",unicode:"e6cf",unicode_decimal:59087},{icon_id:"25027048",name:"wallet",font_class:"wallet",unicode:"e6b1",unicode_decimal:59057},{icon_id:"25015720",name:"settings-filled",font_class:"settings-filled",unicode:"e6ce",unicode_decimal:59086},{icon_id:"25015434",name:"shimingrenzheng-filled",font_class:"auth-filled",unicode:"e6cc",unicode_decimal:59084},{icon_id:"24934246",name:"shop-filled",font_class:"shop-filled",unicode:"e6cd",unicode_decimal:59085},{icon_id:"24934159",name:"staff-filled-01",font_class:"staff-filled",unicode:"e6cb",unicode_decimal:59083},{icon_id:"24932461",name:"VIP-filled",font_class:"vip-filled",unicode:"e6c6",unicode_decimal:59078},{icon_id:"24932462",name:"plus_circle_fill",font_class:"plus-filled",unicode:"e6c7",unicode_decimal:59079},{icon_id:"24932463",name:"folder_add-filled",font_class:"folder-add-filled",unicode:"e6c8",unicode_decimal:59080},{icon_id:"24932464",name:"yanse-filled",font_class:"color-filled",unicode:"e6c9",unicode_decimal:59081},{icon_id:"24932465",name:"tune-filled",font_class:"tune-filled",unicode:"e6ca",unicode_decimal:59082},{icon_id:"24932455",name:"a-rilidaka-filled",font_class:"calendar-filled",unicode:"e6c0",unicode_decimal:59072},{icon_id:"24932456",name:"notification-filled",font_class:"notification-filled",unicode:"e6c1",unicode_decimal:59073},{icon_id:"24932457",name:"wallet-filled",font_class:"wallet-filled",unicode:"e6c2",unicode_decimal:59074},{icon_id:"24932458",name:"paihangbang-filled",font_class:"medal-filled",unicode:"e6c3",unicode_decimal:59075},{icon_id:"24932459",name:"gift-filled",font_class:"gift-filled",unicode:"e6c4",unicode_decimal:59076},{icon_id:"24932460",name:"fire-filled",font_class:"fire-filled",unicode:"e6c5",unicode_decimal:59077},{icon_id:"24928001",name:"refreshempty",font_class:"refreshempty",unicode:"e6bf",unicode_decimal:59071},{icon_id:"24926853",name:"location-ellipse",font_class:"location-filled",unicode:"e6af",unicode_decimal:59055},{icon_id:"24926735",name:"person-filled",font_class:"person-filled",unicode:"e69d",unicode_decimal:59037},{icon_id:"24926703",name:"personadd-filled",font_class:"personadd-filled",unicode:"e698",unicode_decimal:59032},{icon_id:"24923351",name:"back",font_class:"back",unicode:"e6b9",unicode_decimal:59065},{icon_id:"24923352",name:"forward",font_class:"forward",unicode:"e6ba",unicode_decimal:59066},{icon_id:"24923353",name:"arrowthinright",font_class:"arrow-right",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923353",name:"arrowthinright",font_class:"arrowthinright",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrow-left",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrowthinleft",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923355",name:"arrowthinup",font_class:"arrow-up",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923355",name:"arrowthinup",font_class:"arrowthinup",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923356",name:"arrowthindown",font_class:"arrow-down",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923356",name:"arrowthindown",font_class:"arrowthindown",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923349",name:"arrowdown",font_class:"bottom",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923349",name:"arrowdown",font_class:"arrowdown",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923346",name:"arrowright",font_class:"right",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923346",name:"arrowright",font_class:"arrowright",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923347",name:"arrowup",font_class:"top",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923347",name:"arrowup",font_class:"arrowup",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923348",name:"arrowleft",font_class:"left",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923348",name:"arrowleft",font_class:"arrowleft",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923334",name:"eye",font_class:"eye",unicode:"e651",unicode_decimal:58961},{icon_id:"24923335",name:"eye-filled",font_class:"eye-filled",unicode:"e66a",unicode_decimal:58986},{icon_id:"24923336",name:"eye-slash",font_class:"eye-slash",unicode:"e6b3",unicode_decimal:59059},{icon_id:"24923337",name:"eye-slash-filled",font_class:"eye-slash-filled",unicode:"e6b4",unicode_decimal:59060},{icon_id:"24923305",name:"info-filled",font_class:"info-filled",unicode:"e649",unicode_decimal:58953},{icon_id:"24923299",name:"reload-01",font_class:"reload",unicode:"e6b2",unicode_decimal:59058},{icon_id:"24923195",name:"mic_slash_fill",font_class:"micoff-filled",unicode:"e6b0",unicode_decimal:59056},{icon_id:"24923165",name:"map-pin-ellipse",font_class:"map-pin-ellipse",unicode:"e6ac",unicode_decimal:59052},{icon_id:"24923166",name:"map-pin",font_class:"map-pin",unicode:"e6ad",unicode_decimal:59053},{icon_id:"24923167",name:"location",font_class:"location",unicode:"e6ae",unicode_decimal:59054},{icon_id:"24923064",name:"starhalf",font_class:"starhalf",unicode:"e683",unicode_decimal:59011},{icon_id:"24923065",name:"star",font_class:"star",unicode:"e688",unicode_decimal:59016},{icon_id:"24923066",name:"star-filled",font_class:"star-filled",unicode:"e68f",unicode_decimal:59023},{icon_id:"24899646",name:"a-rilidaka",font_class:"calendar",unicode:"e6a0",unicode_decimal:59040},{icon_id:"24899647",name:"fire",font_class:"fire",unicode:"e6a1",unicode_decimal:59041},{icon_id:"24899648",name:"paihangbang",font_class:"medal",unicode:"e6a2",unicode_decimal:59042},{icon_id:"24899649",name:"font",font_class:"font",unicode:"e6a3",unicode_decimal:59043},{icon_id:"24899650",name:"gift",font_class:"gift",unicode:"e6a4",unicode_decimal:59044},{icon_id:"24899651",name:"link",font_class:"link",unicode:"e6a5",unicode_decimal:59045},{icon_id:"24899652",name:"notification",font_class:"notification",unicode:"e6a6",unicode_decimal:59046},{icon_id:"24899653",name:"staff",font_class:"staff",unicode:"e6a7",unicode_decimal:59047},{icon_id:"24899654",name:"VIP",font_class:"vip",unicode:"e6a8",unicode_decimal:59048},{icon_id:"24899655",name:"folder_add",font_class:"folder-add",unicode:"e6a9",unicode_decimal:59049},{icon_id:"24899656",name:"tune",font_class:"tune",unicode:"e6aa",unicode_decimal:59050},{icon_id:"24899657",name:"shimingrenzheng",font_class:"auth",unicode:"e6ab",unicode_decimal:59051},{icon_id:"24899565",name:"person",font_class:"person",unicode:"e699",unicode_decimal:59033},{icon_id:"24899566",name:"email-filled",font_class:"email-filled",unicode:"e69a",unicode_decimal:59034},{icon_id:"24899567",name:"phone-filled",font_class:"phone-filled",unicode:"e69b",unicode_decimal:59035},{icon_id:"24899568",name:"phone",font_class:"phone",unicode:"e69c",unicode_decimal:59036},{icon_id:"24899570",name:"email",font_class:"email",unicode:"e69e",unicode_decimal:59038},{icon_id:"24899571",name:"personadd",font_class:"personadd",unicode:"e69f",unicode_decimal:59039},{icon_id:"24899558",name:"chatboxes-filled",font_class:"chatboxes-filled",unicode:"e692",unicode_decimal:59026},{icon_id:"24899559",name:"contact",font_class:"contact",unicode:"e693",unicode_decimal:59027},{icon_id:"24899560",name:"chatbubble-filled",font_class:"chatbubble-filled",unicode:"e694",unicode_decimal:59028},{icon_id:"24899561",name:"contact-filled",font_class:"contact-filled",unicode:"e695",unicode_decimal:59029},{icon_id:"24899562",name:"chatboxes",font_class:"chatboxes",unicode:"e696",unicode_decimal:59030},{icon_id:"24899563",name:"chatbubble",font_class:"chatbubble",unicode:"e697",unicode_decimal:59031},{icon_id:"24881290",name:"upload-filled",font_class:"upload-filled",unicode:"e68e",unicode_decimal:59022},{icon_id:"24881292",name:"upload",font_class:"upload",unicode:"e690",unicode_decimal:59024},{icon_id:"24881293",name:"weixin",font_class:"weixin",unicode:"e691",unicode_decimal:59025},{icon_id:"24881274",name:"compose",font_class:"compose",unicode:"e67f",unicode_decimal:59007},{icon_id:"24881275",name:"qq",font_class:"qq",unicode:"e680",unicode_decimal:59008},{icon_id:"24881276",name:"download-filled",font_class:"download-filled",unicode:"e681",unicode_decimal:59009},{icon_id:"24881277",name:"pengyouquan",font_class:"pyq",unicode:"e682",unicode_decimal:59010},{icon_id:"24881279",name:"sound",font_class:"sound",unicode:"e684",unicode_decimal:59012},{icon_id:"24881280",name:"trash-filled",font_class:"trash-filled",unicode:"e685",unicode_decimal:59013},{icon_id:"24881281",name:"sound-filled",font_class:"sound-filled",unicode:"e686",unicode_decimal:59014},{icon_id:"24881282",name:"trash",font_class:"trash",unicode:"e687",unicode_decimal:59015},{icon_id:"24881284",name:"videocam-filled",font_class:"videocam-filled",unicode:"e689",unicode_decimal:59017},{icon_id:"24881285",name:"spinner-cycle",font_class:"spinner-cycle",unicode:"e68a",unicode_decimal:59018},{icon_id:"24881286",name:"weibo",font_class:"weibo",unicode:"e68b",unicode_decimal:59019},{icon_id:"24881288",name:"videocam",font_class:"videocam",unicode:"e68c",unicode_decimal:59020},{icon_id:"24881289",name:"download",font_class:"download",unicode:"e68d",unicode_decimal:59021},{icon_id:"24879601",name:"help",font_class:"help",unicode:"e679",unicode_decimal:59001},{icon_id:"24879602",name:"navigate-filled",font_class:"navigate-filled",unicode:"e67a",unicode_decimal:59002},{icon_id:"24879603",name:"plusempty",font_class:"plusempty",unicode:"e67b",unicode_decimal:59003},{icon_id:"24879604",name:"smallcircle",font_class:"smallcircle",unicode:"e67c",unicode_decimal:59004},{icon_id:"24879605",name:"minus-filled",font_class:"minus-filled",unicode:"e67d",unicode_decimal:59005},{icon_id:"24879606",name:"micoff",font_class:"micoff",unicode:"e67e",unicode_decimal:59006},{icon_id:"24879588",name:"closeempty",font_class:"closeempty",unicode:"e66c",unicode_decimal:58988},{icon_id:"24879589",name:"clear",font_class:"clear",unicode:"e66d",unicode_decimal:58989},{icon_id:"24879590",name:"navigate",font_class:"navigate",unicode:"e66e",unicode_decimal:58990},{icon_id:"24879591",name:"minus",font_class:"minus",unicode:"e66f",unicode_decimal:58991},{icon_id:"24879592",name:"image",font_class:"image",unicode:"e670",unicode_decimal:58992},{icon_id:"24879593",name:"mic",font_class:"mic",unicode:"e671",unicode_decimal:58993},{icon_id:"24879594",name:"paperplane",font_class:"paperplane",unicode:"e672",unicode_decimal:58994},{icon_id:"24879595",name:"close",font_class:"close",unicode:"e673",unicode_decimal:58995},{icon_id:"24879596",name:"help-filled",font_class:"help-filled",unicode:"e674",unicode_decimal:58996},{icon_id:"24879597",name:"plus-filled",font_class:"paperplane-filled",unicode:"e675",unicode_decimal:58997},{icon_id:"24879598",name:"plus",font_class:"plus",unicode:"e676",unicode_decimal:58998},{icon_id:"24879599",name:"mic-filled",font_class:"mic-filled",unicode:"e677",unicode_decimal:58999},{icon_id:"24879600",name:"image-filled",font_class:"image-filled",unicode:"e678",unicode_decimal:59e3},{icon_id:"24855900",name:"locked-filled",font_class:"locked-filled",unicode:"e668",unicode_decimal:58984},{icon_id:"24855901",name:"info",font_class:"info",unicode:"e669",unicode_decimal:58985},{icon_id:"24855903",name:"locked",font_class:"locked",unicode:"e66b",unicode_decimal:58987},{icon_id:"24855884",name:"camera-filled",font_class:"camera-filled",unicode:"e658",unicode_decimal:58968},{icon_id:"24855885",name:"chat-filled",font_class:"chat-filled",unicode:"e659",unicode_decimal:58969},{icon_id:"24855886",name:"camera",font_class:"camera",unicode:"e65a",unicode_decimal:58970},{icon_id:"24855887",name:"circle",font_class:"circle",unicode:"e65b",unicode_decimal:58971},{icon_id:"24855888",name:"checkmarkempty",font_class:"checkmarkempty",unicode:"e65c",unicode_decimal:58972},{icon_id:"24855889",name:"chat",font_class:"chat",unicode:"e65d",unicode_decimal:58973},{icon_id:"24855890",name:"circle-filled",font_class:"circle-filled",unicode:"e65e",unicode_decimal:58974},{icon_id:"24855891",name:"flag",font_class:"flag",unicode:"e65f",unicode_decimal:58975},{icon_id:"24855892",name:"flag-filled",font_class:"flag-filled",unicode:"e660",unicode_decimal:58976},{icon_id:"24855893",name:"gear-filled",font_class:"gear-filled",unicode:"e661",unicode_decimal:58977},{icon_id:"24855894",name:"home",font_class:"home",unicode:"e662",unicode_decimal:58978},{icon_id:"24855895",name:"home-filled",font_class:"home-filled",unicode:"e663",unicode_decimal:58979},{icon_id:"24855896",name:"gear",font_class:"gear",unicode:"e664",unicode_decimal:58980},{icon_id:"24855897",name:"smallcircle-filled",font_class:"smallcircle-filled",unicode:"e665",unicode_decimal:58981},{icon_id:"24855898",name:"map-filled",font_class:"map-filled",unicode:"e666",unicode_decimal:58982},{icon_id:"24855899",name:"map",font_class:"map",unicode:"e667",unicode_decimal:58983},{icon_id:"24855825",name:"refresh-filled",font_class:"refresh-filled",unicode:"e656",unicode_decimal:58966},{icon_id:"24855826",name:"refresh",font_class:"refresh",unicode:"e657",unicode_decimal:58967},{icon_id:"24855808",name:"cloud-upload",font_class:"cloud-upload",unicode:"e645",unicode_decimal:58949},{icon_id:"24855809",name:"cloud-download-filled",font_class:"cloud-download-filled",unicode:"e646",unicode_decimal:58950},{icon_id:"24855810",name:"cloud-download",font_class:"cloud-download",unicode:"e647",unicode_decimal:58951},{icon_id:"24855811",name:"cloud-upload-filled",font_class:"cloud-upload-filled",unicode:"e648",unicode_decimal:58952},{icon_id:"24855813",name:"redo",font_class:"redo",unicode:"e64a",unicode_decimal:58954},{icon_id:"24855814",name:"images-filled",font_class:"images-filled",unicode:"e64b",unicode_decimal:58955},{icon_id:"24855815",name:"undo-filled",font_class:"undo-filled",unicode:"e64c",unicode_decimal:58956},{icon_id:"24855816",name:"more",font_class:"more",unicode:"e64d",unicode_decimal:58957},{icon_id:"24855817",name:"more-filled",font_class:"more-filled",unicode:"e64e",unicode_decimal:58958},{icon_id:"24855818",name:"undo",font_class:"undo",unicode:"e64f",unicode_decimal:58959},{icon_id:"24855819",name:"images",font_class:"images",unicode:"e650",unicode_decimal:58960},{icon_id:"24855821",name:"paperclip",font_class:"paperclip",unicode:"e652",unicode_decimal:58962},{icon_id:"24855822",name:"settings",font_class:"settings",unicode:"e653",unicode_decimal:58963},{icon_id:"24855823",name:"search",font_class:"search",unicode:"e654",unicode_decimal:58964},{icon_id:"24855824",name:"redo-filled",font_class:"redo-filled",unicode:"e655",unicode_decimal:58965},{icon_id:"24841702",name:"list",font_class:"list",unicode:"e644",unicode_decimal:58948},{icon_id:"24841489",name:"mail-open-filled",font_class:"mail-open-filled",unicode:"e63a",unicode_decimal:58938},{icon_id:"24841491",name:"hand-thumbsdown-filled",font_class:"hand-down-filled",unicode:"e63c",unicode_decimal:58940},{icon_id:"24841492",name:"hand-thumbsdown",font_class:"hand-down",unicode:"e63d",unicode_decimal:58941},{icon_id:"24841493",name:"hand-thumbsup-filled",font_class:"hand-up-filled",unicode:"e63e",unicode_decimal:58942},{icon_id:"24841494",name:"hand-thumbsup",font_class:"hand-up",unicode:"e63f",unicode_decimal:58943},{icon_id:"24841496",name:"heart-filled",font_class:"heart-filled",unicode:"e641",unicode_decimal:58945},{icon_id:"24841498",name:"mail-open",font_class:"mail-open",unicode:"e643",unicode_decimal:58947},{icon_id:"24841488",name:"heart",font_class:"heart",unicode:"e639",unicode_decimal:58937},{icon_id:"24839963",name:"loop",font_class:"loop",unicode:"e633",unicode_decimal:58931},{icon_id:"24839866",name:"pulldown",font_class:"pulldown",unicode:"e632",unicode_decimal:58930},{icon_id:"24813798",name:"scan",font_class:"scan",unicode:"e62a",unicode_decimal:58922},{icon_id:"24813786",name:"bars",font_class:"bars",unicode:"e627",unicode_decimal:58919},{icon_id:"24813788",name:"cart-filled",font_class:"cart-filled",unicode:"e629",unicode_decimal:58921},{icon_id:"24813790",name:"checkbox",font_class:"checkbox",unicode:"e62b",unicode_decimal:58923},{icon_id:"24813791",name:"checkbox-filled",font_class:"checkbox-filled",unicode:"e62c",unicode_decimal:58924},{icon_id:"24813794",name:"shop",font_class:"shop",unicode:"e62f",unicode_decimal:58927},{icon_id:"24813795",name:"headphones",font_class:"headphones",unicode:"e630",unicode_decimal:58928},{icon_id:"24813796",name:"cart",font_class:"cart",unicode:"e631",unicode_decimal:58929}]},Ip="/static/uniicons.ttf",Rp={"uni-icons":{"":{fontFamily:"uniicons",textDecoration:"none",textAlign:"center"}}},Mp=weex.requireModule("dom");Mp.addRule("fontFace",{fontFamily:"uniicons",src:"url('"+Ip+"')"});var Op={name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""}},data(){return{icons:Ep.glyphs}},computed:{unicode(){let e=this.icons.find(t=>t.font_class===this.type);return e?unescape(`%u${e.unicode}`):""}},methods:{_onClick(e){this.$emit("click",e)}}};function Fp(e,t,i,a,n,s){return(0,kt.openBlock)(),(0,kt.createElementBlock)("u-text",{style:(0,kt.normalizeStyle)({color:i.color,"font-size":i.size}),class:"uni-icons",onClick:t[0]||(t[0]=(...r)=>s._onClick&&s._onClick(...r))},(0,kt.toDisplayString)(s.unicode),5)}var ge=v(Op,[["render",Fp],["styles",[Rp]]]);var mi=ee(ie());var Np={line:{"":{height:"2rpx",transform:"scaleY(0.5)",transformOrigin:"50% 100%"}}},Bp={computed:{bgColor(){return getApp().globalData.themeObj.color.line}}};function Pp(e,t,i,a,n,s){return(0,mi.openBlock)(),(0,mi.createElementBlock)("view",{style:(0,mi.normalizeStyle)({background:s.bgColor}),class:"line",renderWhole:!0},null,4)}var At=v(Bp,[["render",Pp],["styles",[Np]]]);var Tt=ee(ie());var Hp={props:{text:{type:[String,Number],default:""},type:{type:String,default:"title"},useText:{type:[Number,Boolean],default:!1},colorVal:{type:String,default:""}},computed:{color(){return this.colorVal?this.colorVal:getApp().globalData.themeObj.color[this.type]}}};function Up(e,t,i,a,n,s){return(0,Tt.openBlock)(),(0,Tt.createElementBlock)("u-text",{style:(0,Tt.normalizeStyle)({color:s.color})},(0,Tt.toDisplayString)(i.text),5)}var de=v(Hp,[["render",Up]]);var Gp={"level-center":{"":{alignItems:"center",flexDirection:"row"}},"center-between":{"":{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},"column-center":{"":{flexDirection:"column",alignItems:"center"}},"action-wrap":{"":{borderRadius:"26rpx",marginTop:"12rpx",marginRight:"16rpx",marginBottom:0,marginLeft:"16rpx"}},"title-item":{".action-wrap ":{paddingTop:"28rpx",paddingRight:"28rpx",paddingBottom:"28rpx",paddingLeft:"28rpx"}},"action-item":{".action-wrap ":{height:"106rpx",paddingTop:0,paddingRight:"40rpx",paddingBottom:0,paddingLeft:"40rpx"}},title:{".action-wrap .action-item ":{marginLeft:"50rpx"}},"item-text":{".action-wrap .action-item ":{textAlign:"center",lineHeight:"106rpx"}},"paid-media-class":{"":{borderRadius:"8rpx",paddingTop:"10rpx",paddingRight:"16rpx",paddingBottom:"10rpx",paddingLeft:"16rpx",marginLeft:"20rpx",backgroundImage:"linear-gradient(to bottom right, #F2AE00, #FF008B)"}},"label-text":{".paid-media-class ":{color:"#FFFFFF",fontSize:"24rpx"}},"warn-photo":{"":{paddingTop:"32rpx",paddingRight:15,paddingBottom:"32rpx",paddingLeft:15}},"photo-item":{".warn-photo ":{position:"relative"}},"photo-desc":{".warn-photo .photo-item ":{marginTop:"20rpx",height:"28rpx",lineHeight:"28rpx",textAlign:"center",fontSize:"20rpx",color:"#E02020"}}},Wp={components:{MText:de,MLine:At,UniIcons:ge,LImg:P},emits:["onClickActionItem","onChange","onMaskClick"],props:{title:{type:String,default:""},titleColor:{type:String,default:"gray"},titleSize:{type:String,default:"28rpx"},actions:{type:[Array,Object],default:[]},iconSize:{type:String,default:"46rpx"},textSize:{type:String,default:"38rpx"},textColor:{type:String,default:""},cancelText:{type:String,default(){return u("cancel")}},cancelColor:{type:String,default:""},cancelSize:{type:String,default:"38rpx"},bgColor:{type:String,default:""},cancelBgColor:{type:String,default:""},textIconDis:{type:String,default:"50rpx"},titleLineH:{type:String,default:"24rpx"},maskBgColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},titleFw:{type:[String,Number],default:400},showWarnMedia:{type:Boolean,default:!1}},data(){return{warnList:[],isArray:Array.isArray(this.actions),warnPhotoW:0}},computed:{getLen(){return Array.isArray(this.actions)?this.actions.length:Object.keys(this.actions).length},getBottomDis(){return 10},getTitle(){return this.showWarnMedia?u("user.useWarnPhotoWarning"):this.title},getTitleColor(){return this.showWarnMedia?"#E02020":this.titleColor},getTitleLineH(){return this.showWarnMedia?"34rpx":this.titleLineH},getTitleSize(){return this.showWarnMedia?"24rpx":this.titleSize},getTitleFw(){return this.showWarnMedia?fe()?600:400:this.titleFw},viewBg(){return y(this.bgColor)?getApp().globalData.themeObj.style==F.LIGHT?getApp().globalData.themeObj.color.bg2:getApp().globalData.themeObj.color.bg3:this.bgColor},viewCancelBg(){return y(this.cancelBgColor)?getApp().globalData.themeObj.style==F.LIGHT?getApp().globalData.themeObj.color.bg2:getApp().globalData.themeObj.color.bg3:this.cancelBgColor},itemTextColor(){return y(this.textColor)?getApp().globalData.themeObj.color.title:this.textColor},itemCancelColor(){return y(this.textColor)?getApp().globalData.themeObj.color.title:this.cancelColor}},methods:{clickThis(e){e&&e.stopPropagation()},clickItem(e){this.$refs.popup.close(),this.$nextTick(()=>{let t=e!=-1?this.actions[e]:{key:"cancel"};this.$emit("onClickActionItem",t)})},onMaskClick(){this.$emit("onMaskClick")},onChange(e){this.$emit("onChange",e)},initWarnMedia(){this.warnPhotoW=(getApp().globalData.window.width-70-uni.upx2px(32))/5,this.warnList=[{url:"s/pub/warn_pornographic.png",text:u("pornographic")},{url:"s/pub/warn_nude.png",text:u("nude")},{url:"s/pub/warn_nation_flag.png",text:u("nationFlag")},{url:"s/pub/warn_arms.png",text:u("arms")},{url:"s/pub/warn_bloody.png",text:u("bloody")}]},open(){this.$refs.popup.open()}},created(){this.showWarnMedia&&this.initWarnMedia()}};function jp(e,t,i,a,n,s){let r=(0,T.resolveComponent)("m-line"),l=A((0,T.resolveDynamicComponent)("l-img"),P),c=A((0,T.resolveDynamicComponent)("uni-popup"),St);return(0,T.openBlock)(),(0,T.createBlock)(c,{onClick:(0,T.withModifiers)(s.clickThis,["stop"]),ref:"popup",type:"bottom",maskBgColor:i.maskBgColor,onChange:s.onChange,onMaskClick:s.onMaskClick,style:{"z-index":"99999"}},{default:(0,T.withCtx)(()=>[(0,T.createElementVNode)("view",{class:"action-wrap",style:(0,T.normalizeStyle)({backgroundColor:s.viewBg})},[s.getTitle?((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:0},[(0,T.createElementVNode)("u-text",{class:"title-item",style:(0,T.normalizeStyle)({color:s.getTitleColor,fontSize:s.getTitleSize,lineHeight:s.getTitleLineH,fontWeight:s.getTitleFw})},(0,T.toDisplayString)(s.getTitle),5),(0,T.createVNode)(r)])):(0,T.createCommentVNode)("",!0),n.warnList.length>0?((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:1},[(0,T.createElementVNode)("view",{class:"center-between warn-photo"},[((0,T.openBlock)(!0),(0,T.createElementBlock)(T.Fragment,null,(0,T.renderList)(n.warnList,(p,h)=>((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:h,class:"photo-item column-center",style:(0,T.normalizeStyle)({width:`${n.warnPhotoW}px`})},[(0,T.createVNode)(l,{src:p.url,w:`${n.warnPhotoW}px`,h:`${n.warnPhotoW}px`},null,8,["src","w","h"]),(0,T.createVNode)(l,{src:"s/pub/del_red.png",w:"14px",h:"14px",style:(0,T.normalizeStyle)([{position:"absolute"},{top:`${n.warnPhotoW-7}px`}])},null,8,["style"]),(0,T.createElementVNode)("u-text",{class:"photo-desc"},(0,T.toDisplayString)(p.text),1)],4))),128))]),(0,T.createVNode)(r)])):(0,T.createCommentVNode)("",!0),((0,T.openBlock)(!0),(0,T.createElementBlock)(T.Fragment,null,(0,T.renderList)(i.actions,(p,h,g)=>((0,T.openBlock)(),(0,T.createElementBlock)("view",{index:"a"+h},[p.icon?((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:0,class:"action-item level-center",onClick:_=>s.clickItem(h)},[(0,T.createVNode)(l,{h:i.iconSize,src:p.icon,style:(0,T.normalizeStyle)({marginRight:i.textIconDis}),w:i.iconSize},null,8,["h","src","style","w"]),(0,T.createElementVNode)("u-text",{style:(0,T.normalizeStyle)({fontSize:i.textSize,color:s.itemTextColor})},(0,T.toDisplayString)(p.title),5),p.label_class?((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:0,class:(0,T.normalizeClass)([p.label_class])},[(0,T.createElementVNode)("u-text",{class:"label-text"},(0,T.toDisplayString)(p.label_text?p.label_text:""),1)],2)):(0,T.createCommentVNode)("",!0)],8,["onClick"])):((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:1,class:"action-item",onClick:_=>s.clickItem(h)},[(0,T.createElementVNode)("u-text",{style:(0,T.normalizeStyle)({fontSize:i.textSize,color:s.itemTextColor}),class:"item-text"},(0,T.toDisplayString)(p.title),5)],8,["onClick"])),n.isArray?((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:2},[h<s.getLen-1?((0,T.openBlock)(),(0,T.createBlock)(r,{key:0})):(0,T.createCommentVNode)("",!0)])):((0,T.openBlock)(),(0,T.createElementBlock)("view",{key:3},[g<s.getLen-1?((0,T.openBlock)(),(0,T.createBlock)(r,{key:0})):(0,T.createCommentVNode)("",!0)]))],8,["index"]))),256))],4),(0,T.createElementVNode)("view",{class:"action-wrap action-bottom",style:(0,T.normalizeStyle)({marginBottom:`${s.getBottomDis}px`,backgroundColor:s.viewCancelBg})},[(0,T.createElementVNode)("view",{class:"action-item level-center",onClick:t[0]||(t[0]=p=>s.clickItem(-1)),style:{"justify-content":"center"}},[(0,T.createElementVNode)("u-text",{style:(0,T.normalizeStyle)({color:s.itemCancelColor,fontSize:i.cancelSize})},(0,T.toDisplayString)(i.cancelText),5)])],4)]),_:1},8,["onClick","maskBgColor","onChange","onMaskClick"])}var Ui=v(Wp,[["render",jp],["styles",[Gp]]]);var m=ee(ie());var pe=ee(ie()),Vp={wrap:{"":{position:"fixed",alignItems:"center",flexDirection:"row",paddingTop:0,paddingRight:"4rpx",paddingBottom:0,paddingLeft:"4rpx"}},cover:{"":{zIndex:111,position:"fixed",backgroundColor:"rgba(0,0,0,0)"}},popover:{"":{borderRadius:"8rpx",textAlign:"center",zIndex:111,position:"relative"}},triangle:{"":{width:"28rpx",height:"28rpx",transform:"rotate(45deg)",position:"absolute",zIndex:11}}},zp=xe("dom"),$p={emits:["onClickOther"],props:{size:{type:Object,default(){return{}}},minMargin:{type:[String,Number],default:15},bgColor:{type:String,default:"#FFFFFF"},direction:{type:String,default:"above"},boxShadow:{type:String,default:"0 4rpx 8rpx 0 rgba(0, 0, 0, 0.09)"},triBoxShadow:{type:String,default:"0 4rpx 4rpx 0 rgba(0, 0, 0, 0.09)"},triangleIsTop:{type:Boolean,default:!0}},computed:{getStyle(){return{top:this.getTop()[0]+"px",height:this.popFatherHeight+"px",opacity:this.opacity,left:this.getSide()[0]+"px"}},getTriangleStyle(){return{top:this.getTop()[1]+"px",left:this.getSide()[1]+"px","background-color":this.bgColor}},triangleBoxShadow(){return y(this.boxShadow)?"":this.triangleBoxShadow}},data(){return{opacity:0,popWidth:0,popHeight:0,show:!1,showPop:!1,popFatherHeight:0,coverWidth:getApp().globalData.window.width,coverHeight:getApp().globalData.window.height}},methods:{getTop(){let e,t,i=this.size.top,a=this.size.height,n=this.size.bottom;if(this.direction=="above")i<this.popFatherHeight+10?(e=i+a+6,t=2):(e=i-this.popFatherHeight-6,t=this.popHeight);else if(this.direction=="below"){let s=getApp().globalData.window;this.coverHeight-s.statusBarHeight-s.safeBottom-44-50-n<this.popFatherHeight+10?(e=i-this.popFatherHeight-6,t=this.popHeight):(e=i+a+6,t=2)}return[e,t]},getSide(){let e=this.coverWidth,t=this.size,i=this.popWidth/2,a=t.left+(t.width-12)/2,n,s;return i>=a?(n=this.minMargin,s=a-this.minMargin):this.size.left+this.popWidth>=e?(n=e-this.popWidth-this.minMargin,s=t.left-n+t.width/2-7):(n=a-i+5,s=i-6),[n,s]},clickOther(){this.show=!1,this.$emit("onClickOther")},getPopHeight(){var e=this;zp.getComponentRect(e.$refs.popContent,t=>{if(t&&t.size){let i=t.size;e.popWidth=i.width,e.popHeight=i.height,e.popFatherHeight=i.height+18,e.opacity=1}})},open(){var e=this;e.show=!0,e.opacity=0;let t=setTimeout(function(){e.getPopHeight(),clearTimeout(t)},100)},close(){this.show&&(this.show=!1)}}};function Kp(e,t,i,a,n,s){return n.show?((0,pe.openBlock)(),(0,pe.createElementBlock)("view",{key:0,onClick:t[0]||(t[0]=(...r)=>s.clickOther&&s.clickOther(...r)),class:"cover",style:(0,pe.normalizeStyle)({width:n.coverWidth+"px",height:n.coverHeight+"px"}),renderWhole:!0},[(0,pe.createElementVNode)("view",{style:(0,pe.normalizeStyle)(s.getStyle),class:"wrap"},[(0,pe.createElementVNode)("view",{class:"triangle",style:(0,pe.normalizeStyle)([s.getTriangleStyle,{boxShadow:s.triangleBoxShadow}])},null,4),i.triangleIsTop?((0,pe.openBlock)(),(0,pe.createElementBlock)("view",{key:0,class:"triangle",style:(0,pe.normalizeStyle)([s.getTriangleStyle])},null,4)):(0,pe.createCommentVNode)("",!0),(0,pe.createElementVNode)("view",{ref:"popContent",class:"popover",style:(0,pe.normalizeStyle)({"background-color":i.bgColor,boxShadow:i.boxShadow})},[(0,pe.renderSlot)(e.$slots,"default")],4),i.triangleIsTop?(0,pe.createCommentVNode)("",!0):((0,pe.openBlock)(),(0,pe.createElementBlock)("view",{key:1,class:"triangle",style:(0,pe.normalizeStyle)([s.getTriangleStyle])},null,4))],4)],4)):(0,pe.createCommentVNode)("",!0)}var pt=v($p,[["render",Kp],["styles",[Vp]]]);var _e={MSG:1,CALL:2,HOME:3,GAME:4,CLUB:5,GRAB:6,MOMENT:8},Re={GIFT:1,BAG:2},Yp={};function $r(){return new Promise(e=>{let t=X("g_gift_1");y(t)||getApp().globalData.giftVersion>parseInt(t.version)?B.request("/chat/gift/res",{}).then(i=>{let a={version:i.data.version,content:i.data.res};se("g_gift_1",a),An(i.data.res),e(a.content)}):(An(t.content),e(t.content))})}function Kr(){return new Promise(e=>{let t=X("gift_bag_"+getApp().globalData.uid);y(t)?Wt().then(i=>{e(i)}):(An(t),e(t))})}function Wt(){return new Promise(e=>{B.request("/chat/gift/bag",{}).then(t=>{let i=t.data.list||[],a=qp(i),n={list:i,count:a};se("gift_bag_"+getApp().globalData.uid,n),An(i),Jp(i),e(n)})})}function Jp(e){let t="gift_bag_swipe_current_"+getApp().globalData.uid,i="gift_bag_current_info_"+getApp().globalData.uid,a=X(t),n=X(i);if(y(e))a&&lt(t),n&&lt(i);else if(!n)se(i,e[0]);else{let s="";for(let r=0,l=e.length;r<l;r++){let c=e[r];c.gift_id==n.gift_id&&(s=c)}y(s)?se(i,e[0]):se(i,s)}}function qp(e){let t=0;for(let i=0,a=e.length;i<a;i++)t+=e[i].num;return t}function An(e){for(let t=0,i=e.length;t<i;t++){let a=e[t];Yp[a.gift_id]=a}}var Yr={};function gi(e,t="",i={}){if(Xp()&&typeof Yr.fbEvent!="undefined")try{Yr.fbEvent({event:e,valueToSum:t,params:i},function(){M("info","at comEvent/event.js:17",`fbEvent ${e} success`)},function(){M("error","at comEvent/event.js:19",`fbEvent ${e} error`)})}catch(a){}}function Xp(){return!(!f.isAndroid&&f.appV<133)}function qr(e,t,i=!1,a=0){t&&(gi("videochat_click_total"),gi(`videochat_click_${Jr()}_total`));let n=`videochat_${e}`;i&&(n=`${n}_${Jr(a)}`),gi(n)}function jt(e,t){t==1?gi("gift_total_click"):t==2&&gi("gift_total_success"),gi(`gift_${e}`)}function Jr(e){return fe()?e?"anchor".substr(0,6-e):"anchor":"user"}var Nf=ee(ie());function Vt(e,t){let i=Gs();return new Promise(a=>{let n=0;Ce(`SELECT * FROM ${i} WHERE uid = ${e.uid} LIMIT 1`).then(s=>{if(s.length>0)if(t&&ys(s[0],e)){n=1;let r=`UPDATE ${i} SET nickname = '${me(e.nickname)}', avatar = '${e.avatar}', sex = ${$(e.sex)}, birthday = '${dt(e.birthday)}', is_vip = ${$(e.is_vip)}, is_auth = ${$(e.is_auth)}, level = ${$(e.level)}, country_code = '${dt(e.country_code)}', country_flag = '${dt(e.country_flag)}', language = '${dt(e.language)}', hide_vip = ${$(e.hide_vip)}, hide_level = ${$(e.hide_level)}, hide_profile = ${$(e.hide_profile)}, auth_status = ${$(e.auth_status)} WHERE uid = ${e.uid}`;ye(r).then(()=>{a(n)},()=>{a(n)})}else a(n);else{n=2;let r=`INSERT INTO ${i} (uid, nickname, avatar, sex, birthday, is_vip, is_auth, level, country_code, country_flag, language, hide_vip, hide_level, hide_profile, auth_status) VALUES (${e.uid}, '${me(e.nickname)}', '${e.avatar}', ${$(e.sex)}, '${dt(e.birthday)}', ${$(e.is_vip)}, ${$(e.is_auth)}, ${$(e.level)}, '${dt(e.country_code)}', '${dt(e.country_flag)}', '${dt(e.language)}', ${$(e.hide_vip)}, ${$(e.hide_level)}, ${$(e.hide_profile)}, ${$(e.auth_status)})`;ye(r).then(()=>{a(n)},()=>{a(n)})}},()=>{a(n)})})}function Xr(e){return new Promise(t=>{let i=Array.isArray(e),a=0,n=i?e.length:Object.keys(e).length;for(let s in e){let r=e[s];Vt(r,!0).then(()=>{a+=1,a>=n&&t()})}})}function Tn(e,t=!0){let i=Gs();return new Promise(a=>{if(e==0){a(null);return}if(e==f.SYSTEM_ID){let n=Ni();a({uid:f.SYSTEM_ID,nickname:n.name,avatar:n.logo,sex:1});return}Ce(`SELECT * FROM ${i} WHERE uid = ${e} LIMIT 1`).then(n=>{let s=n[0];if(y(s)&&e==f.SYSTEM_ID){a({uid:f.SYSTEM_ID,avatar:Ni().logo,nickname:Ni().nickname});return}if(s&&(s.nickname=Nt(s.nickname)),y(s)&&e!=f.SYSTEM_ID){if(!t){a(null);return}B.request("/user/info",{target_uid:e,extra:"extra"},!1,!0).then(r=>{r.data&&r.data.user_info?(s=r.data.user_info,s.small_avatar&&(s.avatar=s.small_avatar),a(s),Vt(s,!0)):a(null)},()=>{a(null)})}else a(s)},()=>{a(null)})})}function vn(e,t=!0){let i=Gs();return new Promise(a=>{if(t&&(e=e.filter(r=>!y(r))),e.length<=0){a({});return}let n={},s=`SELECT * FROM ${i} WHERE uid IN (${e.join(",")}) LIMIT ${e.length}`;Ce(s).then(r=>{for(let l=0,c=r.length;l<c;l++){let p=r[l];p&&(p.nickname=Nt(p.nickname),n[p.uid]=p)}a(n)})})}function Gs(){return getApp().globalData.uid==2256587?"tb_user_1":"tb_user"}var vt=ee(ie());var Zp={props:{type:{type:String,default:"bg2"}},computed:{bgColor(){return getApp().globalData.themeObj.color[this.type]}}};function Qp(e,t,i,a,n,s){return(0,vt.openBlock)(),(0,vt.createElementBlock)("view",{style:(0,vt.normalizeStyle)({background:s.bgColor}),renderWhole:!0},[(0,vt.renderSlot)(e.$slots,"default")],4)}var Dt=v(Zp,[["render",Qp]]);function eh(e,t){return new Promise(i=>{Vt(t,!0).then(()=>{let a=`SELECT * FROM tb_club_member WHERE club_id = ${e} AND uid = ${t.uid}`;Ce(a).then(n=>{if(n[0]){let r=`UPDATE tb_club_member SET sex = ${$(t.sex)}, is_auth = ${$(t.is_auth)}, member_type = ${$(t.member_type)}, is_mute = ${$(t.is_mute)}, join_type = ${$(t.join_type)}, join_time = ${$(t.join_time)}, active_time = ${$(t.active_time)} WHERE club_id = ${e} AND uid = ${t.uid}`;ye(r).then(()=>{i()})}else th(e,t).then(()=>{i()})},()=>{i()})})})}function Ws(e,t){return new Promise(i=>{let a=t.length,n=0;for(let s=0,r=t.length;s<r;s++){let l=t[s];l.uid&&eh(e,l).then(()=>{n+=1,n==a&&i()})}})}function th(e,t){let i=`INSERT INTO tb_club_member (club_id, uid, sex, is_auth, member_type, is_mute, join_type, join_time, active_time, remark) VALUES (${e}, ${$(t.uid)}, ${$(t.sex)}, ${$(t.is_auth)}, ${$(t.member_type)}, ${$(t.is_mute)}, ${$(t.join_type)}, ${$(t.join_time)}, ${$(t.active_time)}, '')`;return ye(i)}function ih(e,t,i){let a=[],n=[],s=[],r=[],l,c;return new Promise(p=>{let h;i==1?h=nh:h=function(){return new Promise(_=>{_()})},h(e,t).then(g=>{g&&(r=g.uidList,n=g.founderList,s=g.managerList);let _;return t==-1?_=`SELECT * FROM tb_club_member WHERE club_id = ${e} AND member_type = 1 ORDER BY active_time DESC`:_=`SELECT * FROM tb_club_member WHERE club_id = ${e} AND member_type = 1 AND is_auth = ${$(t)} ORDER BY active_time DESC`,Ce(_)}).then(g=>{l=g,c=g.length;for(let _=0,C=c;_<C;_++){let b=g[_];r.push(b.uid)}return vn(r,!1)}).then(g=>{for(let _=0,C=c;_<C;_++){let b=l[_],N=g[b.uid];if(N){let L=Object.assign(b,N);a.push(L)}}if(i==1){for(let _=0,C=s.length;_<C;_++){let b=s[_],N=g[b.uid];if(N){let L=Object.assign(b,N);a.unshift(L)}}for(let _=0,C=n.length;_<C;_++){let b=n[_],N=g[b.uid];if(N){let L=Object.assign(b,N);a.unshift(L)}}}p({list:a})})})}function nh(e,t){let i=[],a=[],n=[];return new Promise(s=>{let r;t==-1?r="":r=` AND is_auth = ${$(t)} `,Ce(`SELECT * FROM tb_club_member WHERE club_id = ${e} AND member_type > 1 ${r}`).then(l=>{for(let c=0,p=l.length;c<p;c++){let h=l[c];i.push(h.uid),h.member_type==2?a.push(h):n.push(h)}s({uidList:i,founderList:a,managerList:n})})})}function Zr(e){return new Promise(t=>{let i=`DELETE FROM tb_club_member WHERE club_id = ${e}`;ye(i).then(()=>{t()},()=>{t()})})}var sh={wrap:{"":{boxShadow:"none"}}},ah={center:{"":{flexDirection:"row",alignItems:"center"}},"center-between":{"":{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},"center-align":{"":{alignItems:"center",justifyContent:"center",flexDirection:"row"}},ellipsis:{"":{lines:1,overflow:"hidden",textOverflow:"ellipsis"}},"receivers-pop":{"":{width:"450rpx",borderRadius:"8rpx",backgroundColor:"rgba(0,0,0,0)"}},"choose-bar":{".receivers-pop ":{paddingTop:"18rpx",paddingRight:"10rpx",paddingBottom:"18rpx",paddingLeft:"10rpx"}},"choose-str":{".receivers-pop .choose-bar ":{fontSize:"22rpx",color:"#FF4477",lineHeight:"32rpx"}},"btn-wrap":{".receivers-pop .choose-bar ":{height:"40rpx",backgroundColor:"#000102",borderRadius:"4rpx",paddingTop:"2rpx",paddingRight:"2rpx",paddingBottom:"2rpx",paddingLeft:"2rpx",position:"relative"}},btn:{".receivers-pop .choose-bar .btn-wrap ":{fontSize:"18rpx",color:"#FFFFFF",height:"36rpx",lineHeight:"36rpx",textAlign:"center",width:"90rpx"}},"btn-active":{".receivers-pop .choose-bar .btn-wrap ":{backgroundColor:"#5A5A59",borderRadius:"4rpx"}},"btn-line":{".receivers-pop .choose-bar .btn-wrap ":{width:"2rpx",height:"20rpx",backgroundColor:"#666666",position:"absolute",top:"10rpx"}},"split-line":{".receivers-pop ":{height:"2rpx",opacity:.1,backgroundColor:"#FFFFFF"}},"member-list":{".receivers-pop ":{flex:1,paddingTop:0,paddingRight:"10rpx",paddingBottom:0,paddingLeft:"10rpx"}},"avatar-bg":{".receivers-pop .member-list ":{width:"32rpx",height:"32rpx",backgroundColor:"#716F6F",borderRadius:"4rpx"}},"member-item":{".receivers-pop .member-list ":{paddingTop:"10rpx",paddingRight:0,paddingBottom:"10rpx",paddingLeft:0}},nickname:{".receivers-pop .member-list .member-item ":{fontSize:"22rpx",color:"#FFFFFF",lineHeight:"32rpx"}},"loading-view":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:"10rpx",minHeight:"50rpx"}}},rh={emits:["onReceiversClose","onChangeSelectStr"],components:{UniLoadMore:Gt,LImg:P,CustomPopover:pt},props:{size:{type:Object,default(){return{}}},clubId:{type:[Number,String],default:0}},data(){return{chooseIdx:-1,memberList:{},allList:{},boysList:{},girlsList:{},allPageTime:1,boysPageTime:1,girlsPageTime:1,selectUidList:[],selectNameList:[],selectStr:"",isSelectAll:!1,selectUserList:[],loadMore:"nomore",loadContent:{contentrefresh:" ",contentnomore:" "},showLoading:!1,openCount:0}},computed:{selectCount(){return this.selectUidList.length}},methods:{$str:u,clickReceivePop(e){e&&e.stopPropagation()},clickMember(e){if(e==-1)this.isSelectAll=!0,this.selectStr=u("allMembers"),this.selectUidList.length>0&&(this.parseList("all",!0),this.parseList("boys",!0),this.parseList("girls",!0)),this.selectUidList=[],this.selectNameList=[],this.selectUserList=[],this.$refs.receiversPop.close(),this.onClickOther();else{this.isSelectAll=!1;let t=this.getMemberKey(),i=this.memberList["u_"+e],a=this.selectUidList.indexOf(i.uid);a!=-1?(this.selectUidList.splice(a,1),this.selectNameList.splice(a,1),this.selectUserList.splice(a,1)):(this.selectUidList.push(i.uid),this.selectNameList.push(i.nickname),this.selectUserList.push(i)),this.selectNameList.length>0?this.selectStr=this.selectNameList.join("\u3001"):this.selectStr="",this.memberList=JSON.parse(JSON.stringify(this[t+"List"]))}this.$emit("onChangeSelectStr",this.selectStr)},clickChooseBtn(e,t,i){t&&this.chooseIdx==e||(this.memberList=JSON.parse(JSON.stringify({})),this.chooseIdx=e,this.$nextTick(()=>{let a=this.getMemberKey(),n=this.getIsAuth(),s=this[a+"List"];Object.keys(s).length>0?(this.showLoading=!0,this.parseList(a,!1,()=>{let r={club_id:this.clubId,page_time:0};n!=-1&&(r.is_auth=n),this.reqSyncMembers(r,a,!0),typeof i=="function"&&i()})):this.loadMembers(!0,n,()=>{typeof i=="function"&&i()})}))},chooseUserSet(e){let t=this.selectUidList.indexOf(e.uid);t!=-1&&this.selectUidList.splice(t,1),this.clickMember(e.uid)},getIsAuth(){return this.chooseIdx==0?-1:this.chooseIdx==1?0:1},getMemberKey(){return this.chooseIdx==0?"all":this.chooseIdx==1?"boys":"girls"},onClickOther(){let e={isSelectAll:this.isSelectAll,uidList:this.selectUidList,userList:this.selectUserList};this.$emit("onReceiversClose",e)},onLoadMore(){if(this.loadMore=="nomore")return;this.loadMore="loading";let e=this.getMemberKey(),t=this.getIsAuth(),i={club_id:this.clubId,page_time:this[e+"PageTime"]};t!=-1&&(i.is_auth=t),this.reqSyncMembers(i,e,!1)},handleMember(e){if(e.chat_id!=this.clubId||!e.send_uid||e.send_uid==f.SYSTEM_ID)return;let t=e.user_infos[e.send_uid];if(this.memberList["u_"+t.uid])return;let a=this.getIsAuth();a!=-1&&a!=t.is_auth||(this.memberList["u"+t.uid]=t)},handleSaveMember(){let e=Object.values(this.allList);Ws(this.clubId,e)},parseList(e,t=!1,i){let a=this[e+"List"];for(let n=0,s=this.selectUidList.length;n<s;n++){let r=this.selectUidList[n],l=a["u_"+r];l&&(l.selected=!t)}t||(this[e+"List"]=JSON.parse(JSON.stringify(a)),this.memberList=this[e+"List"]),typeof i=="function"&&i()},parseListNew(e,t,i,a=!1){i&&(this[e+"List"]={});for(let n=0,s=t.length;n<s;n++){let r=t[n];r.uid&&r.uid!=getApp().pubUser.uid&&(r.member_type==2?r.identityStr=u("owner"):r.member_type==3&&(r.identityStr=u("admin")),this.memberList["u_"+r.uid]=r,i&&(this[e+"List"]["u_"+r.uid]=r),a&&Vt(r,!0))}},reqSyncMembers(e,t,i){B.request("/chat/club/sync-members",e,!1,!0).then(a=>{this.showLoading=!1,i&&(this.memberList=JSON.parse(JSON.stringify({})),this[t+"List"]=JSON.parse(JSON.stringify({}))),this[t+"PageTime"]=a.data.page_time,this.parseListNew(t,a.data.list,i,!0),this.loadMore=a.data.has_more?"loadmore":"nomore",this.getIsAuth()==-1&&i&&Zr(this.clubId).then(()=>{Ws(this.clubId,a.data.list)})},()=>{this.showLoading=!1})},loadMembers(e,t,i){let a=this.getMemberKey();e?this[a+"Page"]=1:this[a+"Page"]++;let n=this[a+"Page"];this.showLoading=!0,ih(this.clubId,t,n).then(s=>{this.parseListNew(a,s.list,!0,!1);let r={club_id:this.clubId,page_time:0};return t!=-1&&(r.is_auth=t),B.request("/chat/club/sync-members",r,!1,!0)}).then(s=>{this.showLoading=!1,this.memberList=JSON.parse(JSON.stringify({})),this[a+"PageTime"]=s.data.page_time,this.parseListNew(a,s.data.list,!0,!0),this.loadMore=s.data.has_more?"loadmore":"nomore",typeof i=="function"&&i(),t==-1&&e&&Zr(this.clubId).then(()=>{Ws(this.clubId,s.data.list)})},()=>{this.showLoading=!1})},clear(){this.selectUidList=[],this.selectNameList=[],this.selectUserList=[],this.isSelectAll=!1,this.selectStr=""},open(e){this.openCount+=1,e&&this.clear(),this.$refs.receiversPop.open();let t=this.chooseIdx==-1?0:this.chooseIdx;this.clickChooseBtn(t,!1,()=>{e&&this.chooseUserSet(e)})}},created(){uni.$on("event_message_update_member",this.handleMember)},unmounted(){uni.$off("event_message_update_member",this.handleMember),this.openCount>1&&this.handleSaveMember()}};function oh(e,t,i,a,n,s){let r=A((0,m.resolveDynamicComponent)("l-img"),P),l=A((0,m.resolveDynamicComponent)("uni-load-more"),Gt),c=A((0,m.resolveDynamicComponent)("custom-popover"),pt);return(0,m.openBlock)(),(0,m.createBlock)(c,{ref:"receiversPop",size:i.size,"bg-color":"#424344","box-shadow":"",onOnClickOther:s.onClickOther,style:{"z-index":"1000"}},{default:(0,m.withCtx)(()=>[(0,m.createElementVNode)("view",{onClick:t[5]||(t[5]=(...p)=>s.clickReceivePop&&s.clickReceivePop(...p)),class:"receivers-pop",style:{height:"480rpx"}},[(0,m.createElementVNode)("view",{class:"choose-bar center-between"},[(0,m.createElementVNode)("u-text",{class:"choose-str"},(0,m.toDisplayString)(s.$str("selected"))+"("+(0,m.toDisplayString)(s.selectCount)+")",1),(0,m.createElementVNode)("view",{class:"center btn-wrap"},[(0,m.createElementVNode)("u-text",{onClick:t[0]||(t[0]=p=>s.clickChooseBtn(0,!0)),class:(0,m.normalizeClass)(["btn",[n.chooseIdx==0?"btn-active":""]])},(0,m.toDisplayString)(s.$str("all")),3),n.chooseIdx==2?((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:0,class:"btn-line",style:{left:"90rpx"}})):(0,m.createCommentVNode)("",!0),(0,m.createElementVNode)("u-text",{onClick:t[1]||(t[1]=p=>s.clickChooseBtn(1,!0)),class:(0,m.normalizeClass)(["btn",[n.chooseIdx==1?"btn-active":""]])},(0,m.toDisplayString)(s.$str("boys")),3),n.chooseIdx==0?((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:1,class:"btn-line",style:{right:"90rpx"}})):(0,m.createCommentVNode)("",!0),(0,m.createElementVNode)("u-text",{onClick:t[2]||(t[2]=p=>s.clickChooseBtn(2,!0)),class:(0,m.normalizeClass)(["btn",[n.chooseIdx==2?"btn-active":""]])},(0,m.toDisplayString)(s.$str("girls")),3)])]),(0,m.createElementVNode)("view",{class:"split-line"}),n.showLoading?((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:0,class:"loading-view"},[(0,m.createElementVNode)("loading-indicator",{animating:!0,style:{color:"#FFFFFF",width:"30rpx",height:"30rpx"}})])):(0,m.createCommentVNode)("",!0),(0,m.createElementVNode)("list",{ref:"memberList",showScrollbar:!1,onLoadmore:t[4]||(t[4]=(...p)=>s.onLoadMore&&s.onLoadMore(...p)),class:"member-list"},[(0,m.createElementVNode)("cell",{style:{height:"10rpx",width:"10rpx"}}),n.chooseIdx==0?((0,m.openBlock)(),(0,m.createElementBlock)("cell",{key:0},[(0,m.createElementVNode)("view",{onClick:t[3]||(t[3]=p=>s.clickMember(-1)),class:"center-between member-item"},[(0,m.createElementVNode)("view",{class:"center"},[(0,m.createElementVNode)("view",{class:"center-align avatar-bg"},[(0,m.createVNode)(r,{src:"s/club/person_many_yellow.png",w:"16rpx",h:"18rpx"})]),(0,m.createElementVNode)("u-text",{class:"nickname",style:{"margin-left":"12rpx"}},(0,m.toDisplayString)(s.$str("allMembers")),1)]),(0,m.createVNode)(r,{src:n.isSelectAll?"s/msg/select_square_s.png":"s/msg/select_square_n.png",w:"20rpx",h:"20rpx"},null,8,["src"])])])):(0,m.createCommentVNode)("",!0),((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n.memberList,(p,h,g)=>((0,m.openBlock)(),(0,m.createElementBlock)("cell",{key:n.chooseIdx+"_"+p.uid},[(0,m.createElementVNode)("view",{onClick:_=>s.clickMember(p.uid),class:"center-between member-item"},[(0,m.createElementVNode)("view",{class:"center",style:{"padding-right":"20rpx"}},[(0,m.createVNode)(r,{src:p.avatar,w:"32rpx",h:"32rpx",radius:"4rpx"},null,8,["src"]),(0,m.createElementVNode)("view",{class:"center",style:{"margin-left":"12rpx"}},[(0,m.createElementVNode)("u-text",{class:"nickname ellipsis",style:{"max-width":"250rpx"}},(0,m.toDisplayString)(p.nickname),1),(0,m.createElementVNode)("u-text",{class:"nickname",style:{"margin-left":"6rpx","min-width":"max-content"}},(0,m.toDisplayString)(p.identityStr?"("+p.identityStr+")":""),1)])]),(0,m.createVNode)(r,{src:n.selectUidList.indexOf(p.uid)==-1?"s/msg/select_square_n.png":"s/msg/select_square_s.png",w:"20rpx",h:"20rpx"},null,8,["src"])],8,["onClick"])]))),128)),(0,m.createElementVNode)("cell",null,[n.loadMore!="nomore"?((0,m.openBlock)(),(0,m.createBlock)(l,{key:0,status:n.loadMore,contentText:n.loadContent,color:"#FFFFFF"},null,8,["status","contentText"])):(0,m.createCommentVNode)("",!0)]),(0,m.createElementVNode)("cell",{style:{height:"10rpx",width:"10rpx"}})],544)])]),_:1},8,["size","onOnClickOther"])}var lh=v(rh,[["render",oh],["styles",[sh,ah]]]),ch={center:{"":{display:"flex",alignItems:"center",flexDirection:"row"}},"center-between":{"":{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-between"}},"center-align":{"":{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"center"}},"column-center":{"":{flexDirection:"column",alignItems:"center",justifyContent:"center"}},ellipsis:{"":{lines:1,overflow:"hidden",textOverflow:"ellipsis"}},"split-line":{"":{height:"2rpx",backgroundColor:"#EDEDED",transform:"scaleY(0.5)",transformOrigin:"50% 100%"}},"gift-sheet":{"":{borderTopLeftRadius:"20rpx",borderTopRightRadius:"20rpx",borderBottomRightRadius:0,borderBottomLeftRadius:0,backgroundColor:"#FFFFFF"}},"top-bar":{"":{position:"relative",borderTopLeftRadius:"20rpx",borderTopRightRadius:"20rpx",borderBottomRightRadius:0,borderBottomLeftRadius:0,backgroundImage:"linear-gradient(to right, #FF008B, #FF5954)"}},"new-packet":{".top-bar ":{height:"90rpx",paddingTop:0,paddingRight:"28rpx",paddingBottom:0,paddingLeft:"28rpx",zIndex:111}},tip:{".top-bar .new-packet ":{fontSize:"24rpx",color:"#FFDC0D",marginLeft:"10rpx"}},"look-over":{".top-bar .new-packet ":{backgroundColor:"#FFFFFF",height:"48rpx",borderRadius:"8rpx",paddingTop:0,paddingRight:"20rpx",paddingBottom:0,paddingLeft:"20rpx",color:"#FF4477",lineHeight:"48rpx",fontSize:"28rpx"}},"new-recharge-bg":{".top-bar ":{position:"absolute",top:0,left:0}},"gift-item":{"":{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"26rpx",zIndex:111,position:"relative",borderRadius:"24rpx",paddingBottom:"8rpx",boxSizing:"border-box"}},title:{".gift-item ":{fontSize:"24rpx",lineHeight:"34rpx",maxHeight:"34rpx",lines:1,overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"}},price:{".gift-item ":{fontSize:"20rpx",color:"#FFAA0D",marginRight:"4rpx",marginTop:"2rpx",textAlign:"center",lineHeight:"28rpx"}},"gift-num":{".gift-item ":{backgroundColor:"#FF4477",fontSize:"20rpx",color:"#FFFFFF",paddingTop:0,paddingRight:"8rpx",paddingBottom:0,paddingLeft:"8rpx",borderRadius:"18rpx",position:"absolute",right:0,bottom:0}},"balance-wrap":{"":{marginBottom:"-10rpx",paddingRight:"28rpx",height:"60rpx"}},"type-text":{".balance-wrap ":{fontSize:"24rpx",color:"#999999",lineHeight:"34rpx",marginLeft:"6rpx"}},"type-active":{".balance-wrap ":{fontWeight:"600",color:"#FF4477"}},balance:{".balance-wrap ":{fontSize:"24rpx",color:"#FFB000",fontWeight:"500",lineHeight:"34rpx",marginRight:"4rpx",marginTop:"2rpx"}},"recharge-text":{".balance-wrap ":{fontSize:"24rpx",lineHeight:"34rpx",color:"#FF743F",marginRight:"4rpx"}},"recharge-bottom":{"":{paddingTop:0,paddingRight:"28rpx",paddingBottom:0,paddingLeft:"28rpx"}},"choose-user":{".recharge-bottom ":{fontSize:"24rpx",color:"#FF4477",lineHeight:"34rpx"}},"send-wrap":{".recharge-bottom ":{borderRadius:"8rpx",borderWidth:"2rpx",borderStyle:"solid",borderColor:"#FF4477"}},"choose-count":{".recharge-bottom .send-wrap ":{paddingTop:0,paddingRight:"24rpx",paddingBottom:0,paddingLeft:"24rpx",lineHeight:"52rpx",height:"52rpx"}},count:{".recharge-bottom .send-wrap .choose-count ":{fontSize:"24rpx",marginRight:"6rpx"}},button:{".recharge-bottom .send-wrap ":{height:"56rpx",borderRadius:"4rpx",lineHeight:"56rpx",paddingTop:0,paddingRight:"32rpx",paddingBottom:0,paddingLeft:"32rpx",fontSize:"28rpx",color:"#FFFFFF",backgroundImage:"linear-gradient(to right, #FF00BD, #FF5954)"}},"count-pop":{"":{width:"100rpx",borderRadius:"8rpx",backgroundColor:"#000000",marginTop:"-10rpx"}},"count-text":{".count-pop ":{fontSize:"24rpx",color:"#FFFFFF",textAlign:"center",paddingTop:"16rpx",paddingRight:0,paddingBottom:"16rpx",paddingLeft:0}},"go-btn":{"":{marginTop:"20rpx",backgroundImage:"linear-gradient(to right, #FF00BD, #FF5954)",borderRadius:"8rpx",color:"#FFFFFF",lineHeight:"40rpx",paddingTop:"6rpx",paddingRight:"40rpx",paddingBottom:"6rpx",paddingLeft:"40rpx",fontSize:"28rpx"}},"view-title-action":{"":{height:"60rpx",paddingTop:0,paddingRight:"30rpx",paddingBottom:0,paddingLeft:"30rpx"}}},Qr=xe("dom"),uh={components:{MView:Dt,MText:de,ChooseReceiversPop:lh,UniPopup:St,CustomPopover:pt,LImg:P,UniIcons:ge},emits:["onSendAskGift","onSendGift","onChange"],props:{fromType:{type:[String,Number],default:1},isAsk:{type:Boolean,default:!1},isGreeting:{type:Boolean,default:!1},roomId:{type:[String,Number],default:""},showSend:{type:Boolean,default:!0}},data(){return{prizeWheelShow:getApp().globalData.prizeWheelShow,actionId:0,accountInfo:getApp().pubAccount,giftList:{},giftBagList:{slide:[]},popShow:!1,paddingBottom:getApp().globalData.window.safeBottom+10,giftInfo:{},giftWidth:parseInt(getApp().globalData.window.width/4),screenW:getApp().globalData.window.width,myUser:getApp().pubUser,giftId:"",chooseCount:1,giftCountPopSize:{},countArr:[999,699,198,99,38,12,5,1],swipeCurrent:0,sheetHeight:0,openTimer:!1,receiverSize:{},uidList:[],selectStr:"",selectUserList:[],isSelectAll:!1,chooseUser:"",giftListType:1,bagCount:0,typeGift:Re.GIFT,typeBag:Re.BAG,isAuth:fe()}},computed:{giftSwiperItemStyle(){let e={"flex-wrap":"wrap"};return e["flex-direction"]="row",e},showList(){return this.giftListType==Re.GIFT?this.giftList:this.giftBagList},showIndicatorDots(){return this.giftListType==Re.GIFT||this.showList.slide.length>1}},methods:{$str:u,clickThis(e){e&&e.stopPropagation()},clickGoBtn(){q("/pagesPub/luck-draw/index"),this.$refs.giftPopup.close()},clickType(e,t){e&&e.stopPropagation(),this.giftListType=t,t==1&&this.parseGiftList(),this.parseDefChoose(),this.$nextTick(()=>{this.setSheetHeight()})},clickCount(e){this.chooseCount=e},clickGiftReceivers(){Qr.getComponentRect(this.$refs.giftReceivers,e=>{e&&e.size&&(this.receiverSize=e.size,this.$refs.receiversPop.open(this.chooseUser),this.chooseUser&&(this.chooseUser=""))})},clickChooseCount(){var e=this;Qr.getComponentRect(this.$refs.giftCount,t=>{t&&t.size&&(e.giftCountPopSize=t.size,e.$refs.giftCountPop.open())})},clickGift(e,t,i){e&&e.stopPropagation();let a=this.showList.slide;if(this.giftInfo=a[t].list[i],this.isAsk){this.$emit("onSendAskGift",this.giftInfo),this.$refs.giftPopup.close();return}this.giftId=this.giftInfo.gift_id;let n=this.getStorageKey();this.giftListType==Re.GIFT?(se(n[0],this.swipeCurrent),se(n[1],this.giftInfo)):(se(n[2],this.swipeCurrent),se(n[3],this.giftInfo))},clickSend(){if(y(this.giftId)){ut(this.$str("msg.giftPleaseChoose"));return}this.isAsk||(this.fromType==_e.CALL||this.fromType==_e.GAME?jt("call_click",1):jt("chat_click",1));let e=this.giftInfo;e.count=this.chooseCount;let t={gift_id:this.giftInfo.gift_id,to_uid:this.actionId,from_type:this.fromType,number:this.chooseCount};if(this.giftListType==Re.BAG?(e.gift_source=1,t.gift_source=1):delete e.gift_source,this.fromType==_e.CLUB){if(this.uidList.length>0){if(this.giftListType==Re.GIFT){let i=this.uidList.length*this.chooseCount*this.giftInfo.price;if(!di(i))return}else if(!this.checkGiftCount())return}else if(!this.checkGiftCount())return;e.club_id=this.actionId,!this.isSelectAll&&this.uidList.length<=0?(e.to_uid=-1,e.from_type=6):e.to_uid=this.isSelectAll?0:this.uidList,this.selectUserList.length>0&&(e.user_list=this.selectUserList),this.clearMemberPopData()}else if(!this.checkGiftCount())return;if(se("gift_list_type_"+getApp().globalData.uid,this.giftListType+""),[_e.MSG,_e.CALL,_e.GAME,_e.CLUB].indexOf(parseInt(this.fromType))!=-1){this.$emit("onSendGift",e),this.$refs.giftPopup.close();return}B.request("/chat/gift/send",t,!0).then(i=>{this.$emit("onSendGift",e),Ht(i.data.balance),i.data.from_bag&&Wt()})},clickRecharge(){wt(0,1)},checkGiftCount(){if(this.giftListType!=Re.BAG)return!0;let e=this.giftInfo.num;if((this.uidList.length>0?this.uidList.length:1)*this.chooseCount-e>0){let a=e>1?"gift.notEnoughGiftsTips":"gift.notEnoughGiftTips";return Ee(u("tips"),u(a,{num:e}),"",u("gotIt")),!1}return!0},clearMemberPopData(){this.selectStr="",this.uidList=[],this.selectUserList=[],this.isSelectAll=!1,this.$refs.receiversPop.clear(),this.chooseUser&&(this.chooseUser="")},onSheetChange(e){e.height=this.sheetHeight,e.show?this.openTimer=setTimeout(()=>{clearTimeout(this.openTimer),this.$emit("onChange",e)},500):(clearTimeout(this.openTimer),this.$emit("onChange",e))},onSwipeChange(e){this.swipeCurrent=e.detail.current},onReceiversClose(e){this.uidList=e.uidList,this.isSelectAll=e.isSelectAll,this.selectUserList=e.userList},onChangeSelectStr(e){this.selectStr=e},setChooseUser(e){this.isSelectAll=!1,this.uidList=[e.uid],this.selectUserList=[e],this.selectStr=e.nickname,this.chooseUser=e},setSheetHeight(){let e=this.giftWidth*2;e+=uni.upx2px(20),e+=this.isAsk?0:uni.upx2px(100),e+=uni.upx2px(100),e+=this.paddingBottom,this.sheetHeight=e},getStorageKey(){let e=getApp().globalData.uid;return["gift_swipe_current_"+e,"gift_current_info_"+e,"gift_bag_swipe_current_"+e,"gift_bag_current_info_"+e]},parseGifts(e){let t=[],i=[];if(this.isGreeting){let a=getApp().globalData.config.max_ask_gift_price;for(let n=0,s=e.length;n<s;n++){let r=e[n];r.price>=a||i.push(r)}}else{let a=[];for(let n=0,s=e.length;n<s;n++){let r=e[n];y(r.title)||y(r.icon)||a.push(r)}i=a}for(let a=0,n=i.length;a<n;a+=8)t.push({list:i.slice(a,a+8)});return{slide:t}},parseDefInfo(){let e=X("gift_swipe_current");if(e){let i="gift_swipe_current_"+getApp().globalData.uid;se(i,e),lt("gift_swipe_current")}let t=X("gift_current_info");if(t){let i="gift_current_info_"+getApp().globalData.uid;se(i,t),lt("gift_current_info")}},parseGiftList(){Object.keys(this.giftList).length<=0&&$r().then(e=>{this.giftList=this.parseGifts(e)})},parseDefChoose(){this.giftListType==Re.GIFT&&this.parseDefInfo();let e=this.getStorageKey(),t=this.giftListType==Re.GIFT?e[0]:e[2],i=X(t);this.swipeCurrent=i?Number(i):0;let a=this.giftListType==Re.GIFT?e[1]:e[3],n=X(a);n&&(this.giftInfo=n,this.giftId=n.gift_id)},open(e,t){uni.hideKeyboard(),this.actionId=e,this.isAsk||this.isAuth?(this.giftId=0,this.giftListType=Re.GIFT,this.parseGiftList(),this.setSheetHeight(),this.$nextTick(()=>{this.$refs.giftPopup.open()})):Kr().then(i=>{if(typeof t!="undefined")this.giftListType=t;else{let a=X("gift_list_type_"+getApp().globalData.uid);a?this.giftListType=Number(a):this.giftListType=i.count<=0?Re.GIFT:Re.BAG}this.bagCount=i.count,this.giftBagList=this.parseGifts(i.list),this.giftListType==Re.GIFT&&this.parseGiftList(),this.parseDefChoose(),this.setSheetHeight(),this.$nextTick(()=>{this.$refs.giftPopup.open()})})}}};function dh(e,t,i,a,n,s){let r=A((0,m.resolveDynamicComponent)("l-img"),P),l=A((0,m.resolveDynamicComponent)("uni-icons"),ge),c=(0,m.resolveComponent)("swiper-item"),p=(0,m.resolveComponent)("m-text"),h=(0,m.resolveComponent)("swiper"),g=A((0,m.resolveDynamicComponent)("uni-popup"),St),_=A((0,m.resolveDynamicComponent)("custom-popover"),pt),C=(0,m.resolveComponent)("choose-receivers-pop");return(0,m.openBlock)(),(0,m.createElementBlock)("view",{onClick:t[10]||(t[10]=(...b)=>s.clickThis&&s.clickThis(...b)),renderWhole:!0},[(0,m.createVNode)(g,{"safe-area":!1,onChange:s.onSheetChange,"border-radius":"20rpx",ref:"giftPopup",style:{"z-index":"999"},type:"bottom"},{default:(0,m.withCtx)(()=>[(0,m.createElementVNode)("view",{class:"gift-sheet",style:(0,m.normalizeStyle)({paddingBottom:n.paddingBottom+"px"})},[i.isAsk?(0,m.createCommentVNode)("",!0):((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:0,class:"top-bar"},[(0,m.createVNode)(r,{src:"s/gift/icon/gift_new_recharge_bg_1.png",w:`${n.screenW}px`,h:"88rpx",radius:"20rpx 20rpx 0 0",style:{position:"absolute",left:"0",top:"0"}},null,8,["w"]),(0,m.createElementVNode)("view",{class:"new-packet center-between"},[(0,m.createElementVNode)("view",{class:"center"},[(0,m.createVNode)(r,{src:"s/pub/more_coins.png",w:"56rpx",h:"56rpx"}),(0,m.createElementVNode)("u-text",{class:"tip"},(0,m.toDisplayString)(s.$str("gift.sheetReceiveNewPacket")),1)]),(0,m.createElementVNode)("u-text",{onClick:t[0]||(t[0]=(...b)=>s.clickRecharge&&s.clickRecharge(...b)),class:"look-over"},(0,m.toDisplayString)(s.$str("check")),1)])])),(0,m.createElementVNode)("view",{class:"balance-wrap center-between"},[(0,m.createElementVNode)("view",{class:"center"},[(0,m.createElementVNode)("view",{onClick:t[2]||(t[2]=b=>s.clickType(b,1)),class:"center view-title-action"},[(0,m.createVNode)(r,{onClick:t[1]||(t[1]=b=>s.clickType(b,1)),src:`s/pub/gift_home_${n.giftListType==n.typeGift?"s":"n"}.png`,w:"32rpx",h:"32rpx"},null,8,["src"]),(0,m.createElementVNode)("u-text",{class:(0,m.normalizeClass)(["type-text",[n.giftListType==n.typeGift?"type-active":""]])},(0,m.toDisplayString)(s.$str("gift")),3)]),!i.isAsk&&!n.isAuth?((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:0,onClick:t[4]||(t[4]=b=>s.clickType(b,2)),class:"center view-title-action"},[(0,m.createVNode)(r,{onClick:t[3]||(t[3]=b=>s.clickType(b,2)),src:`s/pub/gift_bag_${n.giftListType==n.typeBag?"s":"n"}.png`,w:"32rpx",h:"32rpx"},null,8,["src"]),(0,m.createElementVNode)("u-text",{class:(0,m.normalizeClass)(["type-text",[n.giftListType==n.typeBag?"type-active":""]])},(0,m.toDisplayString)(n.bagCount>0?s.$str("bagNum",{num:n.bagCount}):s.$str("bag")),3)])):(0,m.createCommentVNode)("",!0)]),(0,m.createElementVNode)("view",{class:"center"},[(0,m.createElementVNode)("view",{class:"center",style:{"margin-right":"44rpx"}},[(0,m.createElementVNode)("u-text",{class:"balance"},(0,m.toDisplayString)(Number(n.accountInfo.money)),1),(0,m.createVNode)(r,{src:"s/my/i_coins.png",w:"24rpx",h:"24rpx"})]),(0,m.createElementVNode)("view",{onClick:t[5]||(t[5]=(...b)=>s.clickRecharge&&s.clickRecharge(...b)),class:"center"},[(0,m.createElementVNode)("u-text",{class:"recharge-text"},(0,m.toDisplayString)(s.$str("topUp")),1),(0,m.createVNode)(l,{type:"right",size:"12px",color:"#FF743F"})])])]),(0,m.createVNode)(h,{"indicator-dots":s.showIndicatorDots,"indicator-active-color":"#F70AB8","indicator-color":"rgba(255, 3, 187, .3)",onChange:s.onSwipeChange,current:n.swipeCurrent,style:{height:"480rpx"}},{default:(0,m.withCtx)(()=>[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(s.showList.slide,(b,N)=>((0,m.openBlock)(),(0,m.createBlock)(c,{key:N,style:(0,m.normalizeStyle)(s.giftSwiperItemStyle)},{default:(0,m.withCtx)(()=>[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(b.list,(L,O)=>((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:O,style:(0,m.normalizeStyle)([{position:"relative"},{height:`${n.giftWidth+12}px`}])},[(0,m.createElementVNode)("view",{onClick:W=>s.clickGift(W,N,O),class:"gift-item",style:(0,m.normalizeStyle)({width:`${n.giftWidth}px`,border:`1px solid ${n.giftId==L.gift_id?"#FF4477":"#FFFFFF"}`})},[(0,m.createElementVNode)("view",{style:{"margin-top":"4px",position:"relative",padding:"0 20rpx"}},[(0,m.createVNode)(r,{onClick:W=>s.clickGift(W,N,O),src:L.icon,"use-cache":!0,w:"100rpx",h:"100rpx"},null,8,["onClick","src"]),n.giftListType==n.typeBag?((0,m.openBlock)(),(0,m.createElementBlock)("u-text",{key:0,class:"gift-num"},"x"+(0,m.toDisplayString)(L.num),1)):(0,m.createCommentVNode)("",!0)]),(0,m.createElementVNode)("u-text",{class:"title",style:(0,m.normalizeStyle)({width:`${n.giftWidth-16}px`})},(0,m.toDisplayString)(L.title),5),(0,m.createElementVNode)("view",{class:"center"},[(0,m.createElementVNode)("u-text",{class:"price"},(0,m.toDisplayString)(L.price),1),(0,m.createVNode)(r,{src:"s/my/i_coins.png",w:"18rpx",h:"18rpx",style:{"margin-top":"2rpx"}})])],12,["onClick"])],4))),128))]),_:2},1032,["style"]))),128)),n.giftListType==n.typeBag&&n.bagCount<=0?((0,m.openBlock)(),(0,m.createBlock)(c,{key:0,style:(0,m.normalizeStyle)(s.giftSwiperItemStyle)},{default:(0,m.withCtx)(()=>[(0,m.createElementVNode)("view",{class:"column-center",style:{flex:"1"}},[(0,m.createVNode)(r,{src:"s/pub/empty_gift_1.png",w:"192rpx",h:"168rpx"}),n.prizeWheelShow?((0,m.openBlock)(),(0,m.createBlock)(p,{key:0,type:"desc",text:s.$str("gift.getByPrizeWheelTips"),style:{"margin-top":"20rpx","font-size":"24rpx"}},null,8,["text"])):(0,m.createCommentVNode)("",!0),n.prizeWheelShow?((0,m.openBlock)(),(0,m.createElementBlock)("u-text",{key:1,onClick:t[6]||(t[6]=(...b)=>s.clickGoBtn&&s.clickGoBtn(...b)),class:"go-btn"},(0,m.toDisplayString)(s.$str("go")),1)):(0,m.createCommentVNode)("",!0)])]),_:1},8,["style"])):(0,m.createCommentVNode)("",!0)]),_:1},8,["indicator-dots","onChange","current"]),i.showSend?((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:1,class:"recharge-bottom center-between"},[i.fromType==5?((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:0,ref:"giftReceivers",onClick:t[7]||(t[7]=(...b)=>s.clickGiftReceivers&&s.clickGiftReceivers(...b)),class:"center"},[n.selectStr?((0,m.openBlock)(),(0,m.createElementBlock)("u-text",{key:0,class:"choose-user ellipsis",style:{"max-width":"400rpx"}},(0,m.toDisplayString)(s.$str("sendTo"))+":\xA0"+(0,m.toDisplayString)(n.selectStr),1)):((0,m.openBlock)(),(0,m.createElementBlock)("u-text",{key:1,class:"choose-user"},(0,m.toDisplayString)(s.$str("gift.sheetChooseReceivers")),1)),(0,m.createVNode)(l,{type:"right",size:"20rpx",color:"#FF4477",style:{"margin-top":"-2rpx"}})],512)):((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:1})),i.isAsk?(0,m.createCommentVNode)("",!0):((0,m.openBlock)(),(0,m.createElementBlock)("view",{key:2,class:"send-wrap center"},[(0,m.createElementVNode)("view",{onClick:t[8]||(t[8]=(...b)=>s.clickChooseCount&&s.clickChooseCount(...b)),ref:"giftCount",class:"choose-count center-align"},[(0,m.createElementVNode)("u-text",{class:"count"},(0,m.toDisplayString)(n.chooseCount),1),(0,m.createVNode)(l,{color:"#000000",size:"12px",style:{"margin-top":"-2rpx"},type:"top"})],512),(0,m.createElementVNode)("u-text",{onClick:t[9]||(t[9]=(...b)=>s.clickSend&&s.clickSend(...b)),class:"button"},(0,m.toDisplayString)(s.$str("give")),1)]))])):(0,m.createCommentVNode)("",!0)],4)]),_:1},8,["onChange"]),(0,m.createVNode)(_,{ref:"giftCountPop",size:n.giftCountPopSize,"bg-color":"black",style:{"z-index":"1000"}},{default:(0,m.withCtx)(()=>[(0,m.createElementVNode)("view",{class:"count-pop"},[((0,m.openBlock)(!0),(0,m.createElementBlock)(m.Fragment,null,(0,m.renderList)(n.countArr,(b,N)=>((0,m.openBlock)(),(0,m.createElementBlock)("u-text",{onClick:L=>s.clickCount(b),key:"c"+N,class:"count-text"},(0,m.toDisplayString)(b),9,["onClick"]))),128))])]),_:1},8,["size"]),i.fromType==5?((0,m.openBlock)(),(0,m.createBlock)(C,{key:0,ref:"receiversPop","club-id":n.actionId,size:n.receiverSize,onOnChangeSelectStr:s.onChangeSelectStr,onOnReceiversClose:s.onReceiversClose},null,8,["club-id","size","onOnChangeSelectStr","onOnReceiversClose"])):(0,m.createCommentVNode)("",!0)])}var js=v(uh,[["render",dh],["styles",[ch]]]);var R=ee(ie());var fi=ee(ie());var ph={emits:["click"],components:{LImg:P},props:{user:{type:Object,default(){return{}}},w:{type:String,default:"0"},h:{type:String,default:"0"},radius:{type:String,default:"0"},setKey:{type:String,default:"small_avatar"},border:{type:String,default:""},placeType:{type:Number,default:1},placeW:{type:String,default:""},placeFontSize:{type:[String,Boolean],default:""},placeBottom:{type:String,default:""},click:{type:Boolean,default:!0},fromAdmin:{type:[Boolean,Number],default:!1},fromType:{type:Number,default:1},fade:{type:Boolean,default:!0}},computed:{avatarUrl(){return Sn(this.user,this.setKey,this.fromAdmin,this.fromType)}},methods:{clickAvatar(e){this.click&&this.$emit("click",e)}}};function hh(e,t,i,a,n,s){let r=A((0,fi.resolveDynamicComponent)("l-img"),P);return(0,fi.openBlock)(),(0,fi.createBlock)(r,{onClick:s.clickAvatar,src:s.avatarUrl,w:i.w,h:i.h,radius:i.radius,border:i.border,"place-type":i.placeType,"place-w":i.placeW,"place-font-size":i.placeFontSize,"place-bottom":i.placeBottom,fade:i.fade},null,8,["onClick","src","w","h","radius","border","place-type","place-w","place-font-size","place-bottom","fade"])}var Gi=v(ph,[["render",hh]]);function eo(){return getApp().globalData.appCRE||di(40,1,!1)?!0:(it(u("tips"),u("call40CoinsTip"),()=>{q("/pages/coin/coins")},"","Purchase"),!1)}function to(e,t,i){eo()&&no(ms.CALL,rt.VIDEO,cn.CALL,e,t,null,i,gs.DEF)}function io(e,t,i,a){eo()&&no(ms.CALL,e,cn.CALL,t,i,null,a,gs.DEF)}function no(e,t,i,a,n,s,r,l){if(M("error","at comCall/call.js:48","_openCall "+getApp().globalData.curCallId),y(a))return;if(a.uid==getApp().globalData.uid){if(i!=cn.CALL)return;Ee(u("tips"),u("noCallSelf"),"",u("gotIt"));return}if(getApp().globalData.curCallId!=Li.NONE)return;getApp().globalData.curCallId=Li.WEEK_UP;let c=mh(e,t,i,a,n,s,r,l);ce("/pages/call/chat-view",{},"callViewData",c)}function mh(e,t,i,a,n,s,r,l){let c={user:a,roomType:e,callType:t,actionType:i,fromType:r,videoInfo:n,openType:l};return n&&(c.videoInfo=n),s&&(c.roomInfo=s,s.isGame&&(c.isGame=s.isGame)),c}var gh=xe("animation"),fh={props:{id:{type:String,default:""},isTab:{type:Boolean,default:!1}},data(){return{sW:getApp().globalData.window.width,left:-getApp().globalData.window.width,show:!1,data:{},userInfo:{},club:{},animDoing:!1,animationData:{},list:[],listTwo:[]}},computed:{bottom(){let e=getApp().globalData.window.height*.2;return this.isTab?e-getApp().globalData.window.tabBarHeight-getApp().globalData.window.safeBottom:e},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#000000":"#444444"}},methods:{clickThis(e){if(e&&e.stopPropagation(),this.data.type==6||this.data.type==8){let t=fe()?this.userInfo.uid:this.data.to_user.uid;this.openUserHome(t)}else if(this.data.type==9)dr();else if(this.data.type==13)q("/pagesMsg/notice/chat");else if(this.data.type==11||this.data.type==14)this.openClub();else if(this.data.type==15)to(this.userInfo,null,un.RECOMMEND);else if(this.data.type==17){if(xt()=="/pagesPub/luck-draw/index")return;q("/pagesPub/luck-draw/index")}else this.openUserHome(this.userInfo.uid)},clickItem(e,t){if(e&&e.stopPropagation(),t.uid){if(this.data.type==17){if(xt()=="/pagesPub/luck-draw/index")return;q("/pagesPub/luck-draw/index");return}this.openUserHome(t.uid)}else t.clubId&&this.openClub()},openUserHome(e){hn(e)},openClub(){Pt(this.club.club_id,parseInt(this.club.is_member)==1?1:0,1)},anim(e,t,i,a){return new Promise(n=>{gh.transition(this.$refs.animView,{styles:e,duration:t,timingFunction:a,needLayout:!1,delay:i},()=>{n()})})},startAnimIn(){return this.anim({transform:`translateX(${this.sW}px)`},1e3,0,"ease-out")},startAnimOut(){return this.anim({opacity:"0"},1e3,4e3,"linear")},startAnimReset(){return this.anim({opacity:"1",transform:`translateX(-${this.sW}px)`},50,0,"linear")},startAnimH5(e){let t=uni.createAnimation({timingFunction:"linear"});t.translateX(this.sW).step({duration:500,timingFunction:"ease-out"}),f.isAndroid?t.translateX(-this.sW).opacity(0).step({duration:1e3,delay:4e3}):(t.opacity(0).step({duration:1e3,delay:4e3}),t.translateX(-this.sW).step({duration:50})),t.opacity(1).step({duration:50}),this.animationData=t.export(),setTimeout(()=>{e()},6e3)},getTextItem(e,t,i,a){let n={color:t||"#0091FF"};return i!=0&&(n.maxWidth=`${i}rpx`),{type:1,text:e,extra:a,style:n}},getImgItem(e,t,i,a,n){return{type:2,url:e,width:"48rpx",height:"48rpx",radius:t||"4rpx",extra:n,style:{marginLeft:`${a}rpx`,marginRight:`${i}rpx`}}},getRightItem(){return{type:3}},getUserList(e,t){return[this.getImgItem(e.small_avatar,"","8",0,{uid:e.uid}),this.getTextItem(e.nickname,"",t,{uid:e.uid})]},getClubList(e,t){return[this.getImgItem(e.club_logo,"","8",0,{clubId:e.club_id}),this.getTextItem(e.club_name,"",t,{clubId:e.club_id})]},parseList(e,t){let i=[],a=e.split(/(\[%\w+%\])/).filter(function(n){return n!==""});for(let n=0,s=a.length;n<s;n++){let r=a[n];if(r.startsWith("[%")){let c=r.replace(/[\s+,\[%,%\]]/g,""),p=t[c];p&&(i=[...i,...p])}else{let c={};i.push({type:0,content:r,style:c})}}return i},parseVip(){let e;return this.data.date_type==1?e=Za(this.data.vip_time):this.data.date_type==2?e=Qa(this.data.vip_time):this.data.date_type==3&&(e=er(this.data.vip_time)),this.parseList(u("noticeS.vip"),{name:this.getUserList(this.userInfo,"140"),time:[{type:0,content:e}]})},parseRecharge(){return this.parseList(u("noticeS.recharge"),{name:this.getUserList(this.userInfo,"140"),coin:[{type:0,content:this.data.money}]})},parseChecked(){return this.parseList(u("noticeS.check"),{name:this.getUserList(this.userInfo,"140")})},parseFollow(){return this.parseList(u("noticeS.follow"),{name:this.getUserList(this.userInfo,"140")})},parseOnline(){return this.parseList(u("noticeS.online"),{name:this.getUserList(this.userInfo,"140")})},parseCall(){let e=parseInt(this.data.call_duration);e=isNaN(e)?1:Math.ceil(e/60);let t=`${e} ${tr(e)}`;return this.listTwo=this.parseList(u("noticeS.callTwo",{time:t}),{name:[this.getTextItem(this.data.to_user.nickname,"","140",{uid:this.data.to_user.uid})]}),this.parseList(u("noticeS.callOne",{chatType:ir(this.data.call_type)}),{name:this.getUserList(this.userInfo,"140"),avatar:[this.getImgItem(this.data.to_user.small_avatar,"","8",0,{uid:this.data.to_user.uid})]})},parseGift(){return this.parseList(u("noticeS.gift"),{user:this.getUserList(this.userInfo,"140"),to_user:this.getUserList(this.data.to_user,"140"),gift:[this.getImgItem(this.data.gift_icon,0,0,0,null),{type:0,content:`x${this.data.gift_num}`}]})},parseGameLucky(){return this.listTwo=this.parseList(u("noticeS.gameLuckyTwo",{number:this.data.bonus}),{}),this.parseList(u("noticeS.gameLuckyOne"),{name:this.getUserList(this.userInfo,"140")})},parseRankingRecommend(){return this.listTwo=[this.getImgItem(this.userInfo.small_avatar,0,"8",0,{uid:this.userInfo.uid}),this.getTextItem(this.userInfo.nickname,"","240",{uid:this.userInfo.uid}),this.getRightItem()],this.parseList(u("noticeS.rankingRecommend",{number:this.data.rank}),{})},parseClubGift(){return this.listTwo=[{type:0,content:u("noticeS.clubGift2")},this.getRightItem()],this.parseList(u("noticeS.clubGift1"),{club:this.getClubList(this.club,"180")})},parseClubInvite(){let e=this.parseList(u("noticeS.clubInvite"),{user:this.getUserList(this.userInfo,"100"),club:this.getClubList(this.club,"120")});return e.push(this.getRightItem()),e},parseClubRecommend(){let e=this.parseList(u("noticeS.clubRecommend"),{club:this.getClubList(this.club,"140")});return e.push(this.getRightItem()),e},parseCallRecommend(){return this.listTwo=this.parseList(u("noticeS.callRecommend2",{whom:Ve(this.userInfo.sex)}),{}),this.parseList(u("noticeS.callRecommend1"),{user:this.getUserList(this.userInfo,"120")})},parseBoostUser(){return this.listTwo=this.parseList(u("noticeS.boostUser2"),{}),this.parseList(u("noticeS.boostUser1",{himself:nr(this.userInfo.sex)}),{user:this.getUserList(this.userInfo,"120")})},parsePrizeWheel(){let e,t;if(this.data.bonus_list.length>1)e=!1;else{let i=this.data.bonus_list[0];i.type==rn.BOX?(e=i.result.type==rn.GIFT,t=i.result):(e=i.type==rn.GIFT,t=i)}return e?this.listTwo=this.parseList(u("noticeS.prizeWheelTwo"),{prize:[this.getImgItem(t.icon,0,0,0,null),{type:0,content:t.num>1?`x${t.num}`:""}]}):this.listTwo=this.parseList(u("noticeS.prizeWheelTwo"),{prize:[this.getTextItem(ri(this.data.total_bonus),"#FFFFFF",0,{})]}),this.parseList(u("noticeS.prizeWheelOne"),{user:this.getUserList(this.userInfo,"120")})},parseNodes(){switch(this.data.type){case 1:return this.listTwo=[],this.parseVip();case 2:return this.listTwo=[],this.parseRecharge();case 3:return this.listTwo=[],this.parseChecked();case 4:return this.listTwo=[],this.parseFollow();case 5:return this.listTwo=[],this.parseOnline();case 6:return this.parseCall();case 8:return this.listTwo=[],this.parseGift();case 9:return this.parseGameLucky();case 10:return this.parseRankingRecommend();case 11:return this.parseClubGift();case 13:return this.listTwo=[],this.parseClubInvite();case 14:return this.listTwo=[],this.parseClubRecommend();case 15:return getApp().globalData.appCRE?this.parseCallRecommend():null;case 16:return this.parseBoostUser();case 17:return this.parsePrizeWheel();default:return null}},parseData(e,t){this.list=[],this.data=e,this.userInfo=this.data.user_info,this.club=this.data.club_info;let i=this.parseNodes();if(i==null){typeof t=="function"&&t(!1);return}this.list=i,this.$nextTick(()=>{t(!0)})},open(e){e.type==17&&e.user_info.uid==getApp().globalData.uid||this.animDoing||(this.animDoing=!0,this.show=!0,this.parseData(e,t=>{if(!t){this.animDoing=!1;return}let i=setTimeout(()=>{this.animDoing&&(this.animDoing=!1)},1e4);this.startAnimIn().then(()=>this.startAnimOut()).then(()=>this.startAnimReset()).then(()=>{clearTimeout(i),this.show=!1,this.animDoing=!1})}))}},created(){uni.$on(`event_${this.id}`,this.open)},unmounted(){uni.$off(`event_${this.id}`,this.open)}},_h={"view-notice":{"":{borderRadius:"8rpx",paddingTop:"10rpx",paddingRight:"10rpx",paddingBottom:"10rpx",paddingLeft:"10rpx"}},"view-content":{"":{alignItems:"center",flexWrap:"wrap",flexDirection:"row"}},text:{"":{fontSize:"24rpx"}},"text-def":{"":{color:"#FFFFFF"}},"text-s":{"":{lines:1,textOverflow:"ellipsis",wordWrap:"anywhere"}}},yh={mixins:[fh]};function bh(e,t,i,a,n,s){let r=A((0,R.resolveDynamicComponent)("l-img"),P),l=A((0,R.resolveDynamicComponent)("uni-icons"),ge);return(0,R.openBlock)(),(0,R.createElementBlock)("view",{style:(0,R.normalizeStyle)([{bottom:`${e.bottom}px`},{position:"fixed",left:"0","z-index":"9999"}]),renderWhole:!0},[e.show?((0,R.openBlock)(),(0,R.createElementBlock)("view",{key:0,ref:"animView",onClick:t[0]||(t[0]=(...c)=>e.clickThis&&e.clickThis(...c)),animation:e.animationData,class:"view-notice",style:(0,R.normalizeStyle)({left:`${e.left}px`,background:e.viewBg})},[(0,R.createElementVNode)("view",{style:{"align-items":"center","flex-direction":"row"}},[(0,R.createElementVNode)("view",null,[(0,R.createElementVNode)("view",{class:"view-content"},[((0,R.openBlock)(!0),(0,R.createElementBlock)(R.Fragment,null,(0,R.renderList)(e.list,(c,p)=>((0,R.openBlock)(),(0,R.createElementBlock)("view",{key:p},[c.type==0?((0,R.openBlock)(),(0,R.createElementBlock)("u-text",{key:0,class:"text text-def",style:(0,R.normalizeStyle)(c.style)},(0,R.toDisplayString)(c.content),5)):c.type==1?((0,R.openBlock)(),(0,R.createElementBlock)("u-text",{key:1,onClick:(0,R.withModifiers)(h=>e.clickItem(h,c.extra),["stop"]),class:"text text-s",style:(0,R.normalizeStyle)(c.style)},(0,R.toDisplayString)(c.text),13,["onClick"])):c.type==2?((0,R.openBlock)(),(0,R.createBlock)(r,{key:2,onClick:(0,R.withModifiers)(h=>e.clickItem(h,c.extra),["stop"]),src:c.url,w:c.width,h:c.height,radius:c.radius,style:(0,R.normalizeStyle)(c.style)},null,8,["onClick","src","w","h","radius","style"])):c.type==3?((0,R.openBlock)(),(0,R.createBlock)(l,{key:3,type:"right",size:"26rpx",color:"rgba(255,255,255,0.6)"})):(0,R.createCommentVNode)("",!0)]))),128))]),e.listTwo.length>0?((0,R.openBlock)(),(0,R.createElementBlock)("view",{key:0,class:"view-content",style:{"margin-top":"4rpx"}},[((0,R.openBlock)(!0),(0,R.createElementBlock)(R.Fragment,null,(0,R.renderList)(e.listTwo,(c,p)=>((0,R.openBlock)(),(0,R.createElementBlock)("view",{key:"a"+p},[c.type==0?((0,R.openBlock)(),(0,R.createElementBlock)("u-text",{key:0,class:"text text-def",style:(0,R.normalizeStyle)(c.style)},(0,R.toDisplayString)(c.content),5)):c.type==1?((0,R.openBlock)(),(0,R.createElementBlock)("u-text",{key:1,onClick:(0,R.withModifiers)(h=>e.clickItem(h,c.extra),["stop"]),class:"text text-s",style:(0,R.normalizeStyle)(c.style)},(0,R.toDisplayString)(c.text),13,["onClick"])):c.type==2?((0,R.openBlock)(),(0,R.createBlock)(r,{key:2,onClick:(0,R.withModifiers)(h=>e.clickItem(h,c.extra),["stop"]),src:c.url,w:c.width,h:c.height,radius:c.radius,style:(0,R.normalizeStyle)(c.style)},null,8,["onClick","src","w","h","radius","style"])):c.type==3?((0,R.openBlock)(),(0,R.createBlock)(l,{key:3,type:"right",size:"26rpx",color:"rgba(255,255,255,0.6)"})):(0,R.createCommentVNode)("",!0)]))),128))])):(0,R.createCommentVNode)("",!0)]),e.data.type==15?((0,R.openBlock)(),(0,R.createBlock)(r,{key:0,onClick:e.clickThis,src:"s/call/video_def.png",w:"48rpx",h:"48rpx",style:{"margin-left":"16rpx"}},null,8,["onClick"])):(0,R.createCommentVNode)("",!0)])],12,["animation"])):(0,R.createCommentVNode)("",!0)],4)}var Vs=v(yh,[["render",bh],["styles",[_h]]]);var k=ee(ie());var _i=ee(ie()),xh={emits:["onEvent"],props:{src:{type:String,default:""},autoPlay:{type:Boolean,default:!1},loops:{type:Number,default:0},repeatMode:{type:Number,default:1},frame:{type:Number,default:0},progress:{type:Number,default:0},speed:{type:Number,default:1},eventStep:{type:Boolean,default:!1}},data(){return{refView:null}},computed:{params(){return{src:Di(Ye(this.src),!1),autoPlay:this.autoPlay,loops:this.loops,repeatMode:this.repeatMode,initFrame:this.frame,progress:this.progress,speed:this.speed,eventStep:this.eventStep}}},methods:{event(e){y(e)||typeof e.detail=="undefined"||this.$emit("onEvent",e.detail)},play(){this.$refs.lottie&&this.$refs.lottie.play()},pause(){this.$refs.lottie&&this.$refs.lottie.pause()},resume(){this.$refs.lottie&&this.$refs.lottie.resume()},stop(){this.$refs.lottie&&this.$refs.lottie.stop()},setFrame(e){this.$refs.lottie&&this.$refs.lottie.setFrame(e)},setProgress(e){this.$refs.lottie&&this.$refs.lottie.setProgress(e)},setSpeed(e){this.$refs.lottie&&this.$refs.lottie.setSpeed(e)},setEventStep(e){this.$refs.lottie&&this.$refs.lottie.setEventStep(e)}},created(){}};function wh(e,t,i,a,n,s){let r=(0,_i.resolveComponent)("nav-anim-lottie");return(0,_i.openBlock)(),(0,_i.createBlock)(r,{ref:"lottie",params:s.params,onEvent:s.event},null,8,["params","onEvent"])}var so=v(xh,[["render",wh]]);var ao="call_evaluate_label_res";function oo(){return new Promise(e=>{let t=X(ao),i=Ei();if(y(t)||y(t.res[i])||getApp().globalData.callEvaluateVersion>parseInt(t.version))B.request("/chat/call/tap-reason",{}).then(a=>{let n=a.data.reason_list,s=re(JSON.stringify(t));y(s)&&(s={}),y(s.res)&&(s.res={}),s.res[i]=n;let r={version:a.data.version,res:s.res};se(ao,r);let l=ro(n);e(l)});else{let a=ro(t.res[i]);e(a)}})}function ro(e){return fe()?e.filter(t=>t.identity!=1):e.filter(t=>t.identity!=2)}var lo={},co={props:{src:{type:String,default:""},w:{type:String,default:"0"},h:{type:String,default:"0"}},data(){return{svgaPath:"",isHide:!1}},created(){Ye(this.src,e=>{this.svgaPath=e})}};function Ch(e,t,i,a,n,s){return(0,k.openBlock)(),(0,k.createElementBlock)("div",{id:"renderScript",class:"view-anim",style:(0,k.normalizeStyle)({width:i.w,height:i.h}),svgaPath:n.svgaPath,"change:svgaPath":e.renderScript.animPathChange,isHide:n.isHide,"change:isHide":e.renderScript.isHideChange},null,12,["svgaPath","change:svgaPath","isHide","change:isHide"])}typeof lo=="function"&&lo(co);var Sh=v(co,[["render",Ch]]),kh={"view-container":{"":{color:"#333333",position:"fixed",zIndex:11111}},center:{"":{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}},"center-align":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"center-between":{"":{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},"view-evaluate":{"":{flex:1,backgroundColor:"#FFFFFF",boxShadow:"0 4rpx 20rpx 0 rgba(0, 0, 0, 0.1), 0 0 12rpx 0 rgba(0, 0, 0, 0.1)",borderRadius:"16rpx",borderWidth:"2rpx",borderStyle:"solid",borderColor:"rgba(0,0,0,0.15)",paddingTop:"24rpx",paddingRight:"20rpx",paddingBottom:"24rpx",paddingLeft:"20rpx",boxSizing:"border-box"}},"view-header":{"":{flexDirection:"row",flex:1,alignItems:"center",justifyContent:"space-between"}},"like-wrap":{"":{height:"60rpx",backgroundColor:"#F1F3F6",borderRadius:"30rpx",paddingTop:0,paddingRight:"16rpx",paddingBottom:0,paddingLeft:"16rpx",marginLeft:"20rpx"}},"split-line":{"":{height:"2rpx",backgroundColor:"rgba(0,0,0,0.1)",transform:"scaleY(0.5)",transformOrigin:"50% 100%",marginTop:"12rpx"}},"split-line-ver":{"":{width:"2rpx",height:"28rpx",backgroundColor:"rgba(0,0,0,0.1)",marginTop:0,marginRight:"12rpx",marginBottom:0,marginLeft:"12rpx"}},"enjoy-text":{"":{lineHeight:"22rpx",marginTop:"10rpx",fontSize:"20rpx",color:"#666666",lines:1,overflow:"hidden",textOverflow:"ellipsis"}},"close-icon":{"":{position:"absolute",top:0,right:0,paddingLeft:"20rpx",paddingBottom:"20rpx"}},"close-bg":{".close-icon ":{minWidth:"16px",minHeight:"16px",width:16,height:16,borderRadius:8,backgroundColor:"#FFFFFF",borderWidth:"2rpx",borderStyle:"solid",borderColor:"rgba(0,0,0,0.1)"}},"report-label":{"":{backgroundColor:"#F1F3F6",borderRadius:"8rpx",paddingTop:0,paddingRight:"28rpx",paddingBottom:0,paddingLeft:"28rpx",minWidth:"max-content",borderWidth:"2rpx",borderStyle:"solid",borderColor:"#F1F3F6",marginTop:"12rpx",marginRight:"12rpx"}},"report-text":{".report-label ":{height:"44rpx",lineHeight:"44rpx",minWidth:"max-content",fontSize:"20rpx"}},active:{"":{"!borderWidth":"2rpx","!borderStyle":"solid","!borderColor":"#FF4477","!backgroundColor":"rgba(255,68,119,0.1)"}},"input-wrap":{"":{height:"56rpx",borderRadius:"4rpx",borderWidth:"2rpx",borderStyle:"solid",borderColor:"rgba(0,0,0,0.1)",paddingTop:0,paddingRight:"12rpx",paddingBottom:0,paddingLeft:"12rpx",marginTop:"12rpx"}},"reason-tips":{"":{marginTop:"10rpx",fontSize:"20rpx",color:"#999999"}},"reason-input":{"":{marginLeft:"16rpx",fontSize:"20rpx",flex:1}},"submit-btn":{"":{backgroundImage:"linear-gradient(to right, #FF00BD, #FF5954)",borderRadius:"12rpx",marginTop:"20rpx",height:"56rpx"}},"submit-text":{".submit-btn ":{textAlign:"center",color:"#FFFFFF",lineHeight:"56rpx",fontSize:"22rpx"}},"nickname-text":{"":{lineHeight:"28rpx",fontSize:"24rpx",fontWeight:"600",lines:1,overflow:"hidden",textOverflow:"ellipsis"}}},Ah={components:{Lottie:so,LSvga:Sh,UniIcons:ge,LImg:P,UniTransition:Ct},props:{id:{type:String,default:""},isTab:{type:Boolean,default:!1},noNavbar:{type:Boolean,default:!1}},data(){return{show:!1,userInfo:{},closeTimer:!1,roomId:0,evaluateId:"",isUnlike:!1,reasonList:[],pageShow:!1,inputReason:"",chooseIds:[],hasClick:!1,scrollViewW:getApp().globalData.window.width-88,windowInfo:getApp().globalData.window,cursorSpacing:uni.upx2px(126),hasLike:!1,hasUnlike:!1,showPath:!1,isFocus:!1,keyboardH:0,eventPathKey:""}},computed:{viewStyle(){let e={};return this.isUnlike?(e.width=this.windowInfo.width+"px",this.isTab||this.noNavbar?e.height=this.windowInfo.height+"px":e.height=this.windowInfo.height-this.windowInfo.statusBarHeight-this.windowInfo.navBarHeight+"px",e.left=0,e.top=0):(e.width=this.windowInfo.width-72+"px",e.bottom=this.contentBottom+"px",e.left="36px"),e},contentStyle(){let e={},t=this.isTab?50:0,i=this.isTab?20:34;if(this.isUnlike){let a=this.windowInfo.safeBottom+t+i;e.position="absolute",e.left="36px",this.isFocus&&(a=this.keyboardH+2),e.bottom=a+"px"}return e.width=this.windowInfo.width-72+"px",e},contentBottom(){if(this.isTab)return 20;let e=this.windowInfo.safeBottom;return e+=34},nicknameWidth(){let t=this.windowInfo.width-88-uni.upx2px(324);return this.ageText&&(t-=uni.upx2px(50)),t},ageText(){let e="";return this.userInfo.birthday&&(e=", "+oi(this.userInfo.birthday)),e},enjoyText(){let e=Ve(this.userInfo.sex);return u("enjoyCallWithOther",{her:e})},enjoyTextWidth(){return this.windowInfo.width-88-uni.upx2px(324)}},methods:{$str:u,clickView(e){e&&e.stopPropagation();let t=this.$refs.inputReason;t&&t.blur&&t.blur()},clickClose(){this.pageShow&&(uni.hideKeyboard(),uni.offKeyboardHeightChange(this.onKeyboardChange),this.show=!1,this.pageShow=!1,this.$nextTick(()=>{this.inputReason="",this.chooseIds=[],this.hasClick=!1,this.hasLike=!1,this.hasUnlike=!1,this.isUnlike=!1,this.evaluateId="",this.roomId=0,this.userInfo={},this.isFocus=!1}))},clickSubmit(e){if(e&&e.stopPropagation(),y(this.chooseIds)&&y(this.inputReason))ut(u("callEvaluateFeedbackTips")),this.clickClose();else{let t={evaluate_id:this.evaluateId};y(this.chooseIds)||(t.reason=this.chooseIds.join(",")),y(this.inputReason)||(t.content=this.inputReason),B.request("/chat/call/tap-record",t,!0,!0).then(()=>{this.clickClose(!1),ut(u("callEvaluateFeedbackTips"))})}},clickReportItem(e,t){e&&e.stopPropagation();let i=this.chooseIds.indexOf(t);i==-1?this.chooseIds.push(t):this.chooseIds.splice(i,1)},clickLike(e){e&&e.stopPropagation(),!this.hasClick&&(this.hasClick=!0,this.hasLike=!0,this.reqEvaluate(1))},clickUnlike(e){e&&e.stopPropagation(),!this.hasClick&&(this.hasClick=!0,this.hasUnlike=!0,this.$nextTick(()=>{this.reqEvaluate(2).then(()=>oo()).then(t=>{this.parseReason(t),this.$nextTick(()=>{this.isUnlike=!0})})}))},startTimer(e){this.clearTimer(),this.closeTimer=setTimeout(()=>{this.clearTimer(),this.show=!1},e*1e3)},clearTimer(){this.closeTimer&&clearTimeout(this.closeTimer)},preventHandler(){},onKeyboardChange(e){this.keyboardH=e.height,this.isFocus=e.height>0},reqEvaluate(e){return this.clearTimer(),new Promise(t=>{let i={uid:getApp().globalData.uid,target_uid:this.userInfo.uid,room_id:this.roomId,type:e};B.request("/chat/call/evaluate",i,!1,!0).then(a=>{this.evaluateId=a.data.evaluate_id,e==1?this.startTimer(2):(this.clearTimer(),t())},()=>{this.hasClick=!1,this.startTimer(2)})})},parseReason(e){let t=e.length,i=parseInt(t/2),a=[];for(let n=0;n<t;n+=i)a.push({list:e.slice(n,n+i)});this.reasonList=a},init(e,t){this.userInfo=e,this.roomId=t,this.hasClick=!1,this.pageShow=!0,this.$nextTick(()=>{this.show=!0,this.startTimer(5),uni.onKeyboardHeightChange(this.onKeyboardChange)})}},created(){this.eventPathKey=xt("fullPath"),uni.$on(`event_${this.eventPathKey}_show_call_evaluate`,this.init),uni.$on(`event_${this.eventPathKey}_close_call_evaluate`,this.clickClose),Ye("s/call/evaluate_like.svga"),Ye("s/call/evaluate_unlike.svga"),Ye("s/call/evaluate_like.json"),Ye("s/call/evaluate_unlike.json")},unmounted(){this.clearTimer(),uni.offKeyboardHeightChange(this.onKeyboardChange),uni.$off(`event_${this.eventPathKey}_show_call_evaluate`,this.init),uni.$off(`event_${this.eventPathKey}_close_call_evaluate`,this.clickClose)}};function Th(e,t,i,a,n,s){let r=A((0,k.resolveDynamicComponent)("l-img"),P),l=(0,k.resolveComponent)("lottie"),c=A((0,k.resolveDynamicComponent)("uni-icons"),ge),p=A((0,k.resolveDynamicComponent)("uni-transition"),Ct);return n.pageShow?((0,k.openBlock)(),(0,k.createElementBlock)("view",{key:0,class:"view-container",onClick:t[5]||(t[5]=(...h)=>s.clickView&&s.clickView(...h)),onTouchmove:t[6]||(t[6]=(0,k.withModifiers)((...h)=>s.preventHandler&&s.preventHandler(...h),["stop","prevent"])),style:(0,k.normalizeStyle)(s.viewStyle),renderWhole:!0},[(0,k.createVNode)(p,{"mode-class":"fade",show:n.show,duration:300,style:(0,k.normalizeStyle)(s.contentStyle)},{default:(0,k.withCtx)(()=>[(0,k.createElementVNode)("view",{style:{padding:"8px",position:"relative"}},[(0,k.createElementVNode)("view",{class:"view-evaluate"},[(0,k.createElementVNode)("view",{class:"view-header"},[(0,k.createElementVNode)("view",{class:"center"},[(0,k.createVNode)(r,{src:n.userInfo.small_avatar,w:"62rpx",h:"62rpx",radius:"31rpx",border:"2rpx solid #EEEEEE"},null,8,["src"]),(0,k.createElementVNode)("view",{style:{"margin-left":"16rpx"}},[(0,k.createElementVNode)("view",{class:"center"},[(0,k.createElementVNode)("u-text",{style:(0,k.normalizeStyle)({maxWidth:`${s.nicknameWidth}px`}),class:"nickname-text"},(0,k.toDisplayString)(n.userInfo.nickname),5),s.ageText?((0,k.openBlock)(),(0,k.createElementBlock)("u-text",{key:0,style:{"line-height":"28rpx","font-size":"24rpx","font-weight":"600"}},(0,k.toDisplayString)(s.ageText),1)):(0,k.createCommentVNode)("",!0)]),(0,k.createElementVNode)("u-text",{class:"enjoy-text",style:(0,k.normalizeStyle)({maxWidth:`${s.enjoyTextWidth}px`})},(0,k.toDisplayString)(s.enjoyText),5)])]),(0,k.createElementVNode)("view",{class:"like-wrap center"},[(0,k.createElementVNode)("view",{onClick:t[0]||(t[0]=(...h)=>s.clickLike&&s.clickLike(...h))},[n.hasLike?((0,k.openBlock)(),(0,k.createBlock)(l,{key:1,src:"s/call/evaluate_like.json","auto-play":!0,style:{width:"60rpx",height:"60rpx"}})):((0,k.openBlock)(),(0,k.createBlock)(r,{key:0,onClick:s.clickLike,src:"s/pub/evaluate_like_n.png",w:"60rpx",h:"60rpx"},null,8,["onClick"]))]),(0,k.createElementVNode)("view",{class:"split-line-ver"}),(0,k.createElementVNode)("view",{onClick:t[1]||(t[1]=(...h)=>s.clickUnlike&&s.clickUnlike(...h))},[n.hasUnlike?((0,k.openBlock)(),(0,k.createBlock)(l,{key:1,src:"s/call/evaluate_unlike.json","auto-play":!0,style:{width:"60rpx",height:"60rpx"}})):((0,k.openBlock)(),(0,k.createBlock)(r,{key:0,onClick:s.clickUnlike,src:"s/pub/evaluate_unlike_n.png",w:"60rpx",h:"60rpx"},null,8,["onClick"]))])])]),n.isUnlike?((0,k.openBlock)(),(0,k.createElementBlock)("view",{key:0,class:"m-t-8"},[(0,k.createElementVNode)("view",{class:"split-line"}),(0,k.createElementVNode)("u-text",{class:"reason-tips"},(0,k.toDisplayString)(s.$str("callEvaluateTips")),1),(0,k.createElementVNode)("scroll-view",{scrollX:!0,showScrollbar:!1,style:{"flex-direction":"row",flex:"1"}},[(0,k.createElementVNode)("view",null,[((0,k.openBlock)(!0),(0,k.createElementBlock)(k.Fragment,null,(0,k.renderList)(n.reasonList,(h,g)=>((0,k.openBlock)(),(0,k.createElementBlock)("view",{key:g,class:"center"},[((0,k.openBlock)(!0),(0,k.createElementBlock)(k.Fragment,null,(0,k.renderList)(h.list,(_,C)=>((0,k.openBlock)(),(0,k.createElementBlock)("view",{key:g+"_"+C,onClick:(0,k.withModifiers)(b=>s.clickReportItem(b,_.id),["stop"]),class:(0,k.normalizeClass)(["report-label",[n.chooseIds.indexOf(_.id)!=-1?"active":""]])},[(0,k.createElementVNode)("u-text",{class:"report-text"},(0,k.toDisplayString)(_.title),1)],10,["onClick"]))),128))]))),128))])]),(0,k.createElementVNode)("view",{class:"input-wrap center"},[(0,k.createVNode)(r,{src:"s/pub/evaluate_edit.png",w:"24rpx",h:"24rpx"}),(0,k.createElementVNode)("u-input",{ref:"inputReason",modelValue:n.inputReason,onInput:t[2]||(t[2]=h=>n.inputReason=h.detail.value),type:"text",placeholder:s.$str("callEvaluateInputTips"),cursorSpacing:n.cursorSpacing,adjustPosition:!1,class:"reason-input"},null,40,["modelValue","placeholder","cursorSpacing"])]),(0,k.createElementVNode)("view",{onClick:t[3]||(t[3]=(...h)=>s.clickSubmit&&s.clickSubmit(...h)),class:"submit-btn center-align"},[(0,k.createElementVNode)("u-text",{class:"submit-text"},(0,k.toDisplayString)(s.$str("submit")),1)])])):(0,k.createCommentVNode)("",!0)]),n.isUnlike?((0,k.openBlock)(),(0,k.createElementBlock)("view",{key:0,onClick:t[4]||(t[4]=h=>s.clickClose(!1)),class:"close-icon"},[(0,k.createElementVNode)("view",{class:"close-bg center-align"},[(0,k.createVNode)(c,{type:"closeempty",size:"20rpx",color:"#333333",style:{"margin-top":"2rpx"}})])])):(0,k.createCommentVNode)("",!0)])]),_:1},8,["show","style"])],36)):(0,k.createCommentVNode)("",!0)}var zs=v(Ah,[["render",Th],["styles",[kh]]]);var uo={data(){return{__isPopGestureBack:!1}},methods:{__getWebview(){return plus.webview.currentWebview()},__webviewPopGestureListener(e){let t=e.progress>=50;getApp().globalData.isGestureBacking=t,this.__isPopGestureBack=t}},onReady(){f.isAndroid||this.__getWebview().addEventListener("popGesture",this.__webviewPopGestureListener)},onUnload(){if(f.isAndroid)return;getApp().globalData.isGestureBacking=!1,this.__isPopGestureBack=!1;let e=this.__getWebview();typeof e!="undefined"&&e.removeEventListener("popGesture",this.__webviewPopGestureListener)}};var k_=ee(ie());function vh(e,t,i,a,n){return new Promise(s=>{getApp().globalData.pluginUpload.singleUpS3({filePath:e,isBase64:t,coverFilePath:i,coverIsBase64:a,ossInfo:n},r=>{s(r)})})}var po="/upload/params-s3";function Dn(e,t,i,a,n=null,s=null){return new Promise((r,l)=>Ge(this,null,function*(){let c=e.replace("file://",""),p={flag:t,type:i};n&&(p.width=n.width,p.height=n.height),s&&(p=Object.assign(p,s));try{if(a){let g=yield Ts(c),_="";g&&(_=g.digest),y(_)||(p.md5=_)}let h=yield B.request(po,p,!1,!0);if(h.ok==1&&h.data.is_upload)M("log","at common/api-upload.js:73","upload media is_upload true"),r({path:h.data.dir,smallPath:h.data.small_url,uploadId:h.data.upload_id||0});else{let g=h.data.upload_id,_=yield mo(c,"",h.data);g&&ho([g]),_.uploadId=g||0,r(_)}}catch(h){let g=cr(h);M("error","at common/api-upload.js:88","upload media fail "+g),go(t,p,g),l(h)}}))}function $s(e,t,i,a,n,s=!0,r=null,l=!0){return Ge(this,null,function*(){let c={};try{t.startsWith("_doc")&&(t=plus.io.convertLocalFileSystemURL(t));let p={},h=f.isAndroid?t:`file://${t}`,g=t,_=i;if(c={flag:e,type:f.VIDEO},r&&(c.width=r.width,c.height=r.height),l){let N=yield Ts(g),L="";N&&(L=N.digest),y(L)||(c.md5=L)}let C=yield B.request(po,c,!1,!0);M("log","at common/api-upload.js:118","upload video params response",C);let b;if(C.ok==1&&C.data.is_upload)return{url:C.data.dir,coverUrl:C.data.cover_url,smallUrl:C.data.small_url,uploadId:C.data.upload_id||0};{C.data&&(b=C.data.upload_id);let N=yield vs(h);if(s&&N?N.size>8*1024*1024:!1){let O=yield Cr(h,"medium");g=plus.io.convertLocalFileSystemURL(O.tempFilePath),_=yield ks(g,a,n)}return g=g.replace("file://",""),_=_.replace("file://",""),p={url:C.data.dir.path,coverUrl:C.data.dir.cover_path,smallUrl:C.data.dir.small_url,uploadId:C.data.upload_id||0},yield mo(g,_,C.data),b&&ho([b]),p}}catch(p){throw M("error","at common/api-upload.js:150","upload video error",p),go(e,c,p),p}})}function ho(e){y(e)||B.request("/upload/success",{id:e},!1,!0).then(t=>{M("error","at common/api-upload.js:162","-----> api upload/success response",t)},t=>{M("error","at common/api-upload.js:164","-----> api upload/success response error",t)})}function mo(e,t,i,a=0,n=0){return new Promise((s,r)=>{vh(e,a,t,n,i).then(l=>{M("log","at common/api-upload.js:171","upload plugin s3 result",l),(typeof l=="object"?l.success:l)?s({path:i.dir.path,smallPath:i.dir.small_url}):r(`_upModuleS3 ${JSON.stringify(l)}`)})})}function go(e,t,i){let a=e=="auth"?"upload_auth":"upload",n=Qt(t);B.accessLogExtra(a,`${e} ${n}`,i)}var D_=ee(ie()),mt={AD:1,AD_SPREAD:2,CONTACT:3,MARK_ID:4,WHITE_LINK:5,PORNOGRAPHIC:6},yi={MSG:1,MOMENT:2,NICKNAME:3,SIGN:4,CLUB_NAME:5,CLUB_INTRO:6,MSG_CALL:7,MSG_CLUB:8};function fo(e,t){try{let i=e.toLocaleLowerCase(),a=!1,n=getApp().globalData.sensitiveWordsObj[mt.AD];if(a=Ln(n,i),a)return ht(!0,n.type,a);let s=pn(i);if(s){if(Dh(s))return ht(!1,mt.WHITE_LINK,"");if(i.indexOf("apps.apple.com")!=-1||i.indexOf("play.google.com")!=-1){let c=getApp().globalData.sensitiveWordsObj[mt.MARK_ID];if(a=c.words.findDfa(i),a)return ht(!0,c.type,a)}let l=getApp().globalData.sensitiveWordsObj[mt.AD_SPREAD];return a=Ln(l,i),a?ht(!0,l.type,a):ht(!0,mt.WHITE_LINK,s[0])}let r=Lh(i);if(r)return ht(!0,mt.CONTACT,r);if([yi.MSG,yi.MSG_CLUB,yi.MSG_CALL].indexOf(t)==-1){let l=getApp().globalData.sensitiveWordsObj[mt.PORNOGRAPHIC];if(a=Ln(l,i),a)return ht(!0,l.type,a)}return ht(!1,0,"")}catch(i){return M("error","at comSensitive/sensitive-check.js:56","sensitive check catch "+JSON.stringify(i)),ht(!1,-1,"")}}function ht(e,t,i){return M("error","at comSensitive/sensitive-check.js:62",`sensitive check ${e} type = ${t} find = ${i}`),{has:e,type:t,find:i}}function Dh(e){let t=getApp().globalData.sensitiveWordsObj[mt.WHITE_LINK];for(let i=0,a=e.length;i<a;i++)if(!t.words.containsDfa(e[i]))return!1;return!0}function Lh(e){let t=!1,i=/[\d\w]+\b@[a-zA-ZA-z0-9]+\.[a-z]+/g;if(t=e.match(i),t)return t[0];let a=/^[0-9]{8,}$/;if(t=e.match(a),t)return t[0];let n=/\+(([0123456789]{6,})+)/g;if(t=e.match(n),t)return t[0];let s=/(@)((\w|=|\?|\.|\/|&|-|:|%)+)/g;if(t=e.match(s),t)return t[0];let r=getApp().globalData.sensitiveWordsObj[mt.CONTACT],l=Ln(r,e);return l||!1}function Ln(e,t){let i=e.words.wordsWithIndex(t);if(i.length<=0)return!1;for(let a=0,n=i.length;a<n;a++){let s=i[a],r=Eh(t,s.text,s.start,s.end);if(r)return r}return!1}function Eh(e,t,i,a){try{if(e.length==t.length)return t;let n=i==0,s=a==e.length,r=i==0?0:i-1,l=a==e.length?a:a+1,c=e.substring(r,l),p=`('|"| |#|@|{|}|\\||/|\\(|\\)|\\[|\\])`,h=`('|"| |#|@|{|}|\\||/|\\(|\\)|\\[|\\]|,|\\.|:)`,g;return n?g=new RegExp(t+h,"g"):s?g=new RegExp(p+t,"g"):g=new RegExp(p+t+h,"g"),c.match(g)?c:!1}catch(n){return M("error","at comSensitive/sensitive-check.js:138","sensitive _checkContext catch "+JSON.stringify(n)),!1}}function bi(e,t,i=""){y(e.svga_url)||ci().indexOf("/pagesDialog/anim")==-1&&Ye(e.svga_url,a=>{M("error","at comGift/gift-anim.js:10","showGiftAnim path "+a),q("/pagesDialog/anim",{path:a,showClose:t?1:0,flag:i})},!1)}function xi(e,t){return new Promise(i=>{let a=`SELECT * FROM tb_msg_index WHERE chat_id = ${e} AND chat_type = ${t} LIMIT 1`;Ce(a).then(n=>{let s=n[0];s&&(s.msg_content=Nt(s.msg_content)),i(s)},()=>{i(null)})})}function yo(e,t,i=0){return new Promise(a=>{En(e,t).then(()=>xi(e,t)).then(n=>{if(n&&n.unread!=i){let s=`UPDATE tb_msg_index SET unread = ${$(i)} WHERE chat_id = ${e} AND chat_type = ${t}`;ye(s),a(n.unread)}else a(0)})})}function bo(e,t,i={}){return new Promise(a=>{if(Object.keys(i).length<=0)return;let n=[];for(let l in i){let c=i[l],p=l+" = "+c;n.push(p)}let r=`UPDATE tb_msg_index SET ${n.join(", ")} WHERE chat_id = ${e} AND chat_type = ${t}`;ye(r).then(()=>{a(1)},()=>{a(0)})})}var _o=20;function En(e,t){return new Promise(i=>{let a=ot(e,t);try{let n=`CREATE TABLE IF NOT EXISTS ${a} (id INTEGER PRIMARY KEY AUTOINCREMENT, chat_id INTEGER, chat_type INTEGER, send_uid INTEGER, mtime INTEGER, ctime INTEGER, msg_type INTEGER, msg_content varchar(500), msg_status INTEGER, m_type INTEGER, remark varchar(500))`;ye(n).then(()=>{ye(`CREATE index IF NOT EXISTS idx_ctime on ${a} (chat_id, ctime, chat_type)`),ye(`CREATE index IF NOT EXISTS idx_mtime on ${a} (chat_id, mtime)`),i()})}catch(n){i()}})}function zt(e,t){let i=1;return new Promise(a=>{En(e.chat_id,e.chat_type).then(()=>Lt(e)).then(n=>n!=1?(a({isSave:0,isNotice:i}),Ke):xi(e.chat_id,e.chat_type)).then(n=>{let s=re(e.msg_content),r=typeof e.msg_status=="undefined"?0:Number(e.msg_status);isNaN(r)&&(r=0);let l,c=Rh(e,s),p=0,h,g="";y(e.remark)?n&&(g=n.remark||""):g=e.remark,n?(h=n.unread<=0,c?i=0:i=n.msg_notice,n.ctime<e.ctime&&(t&&e.send_uid!=getApp().globalData.uid&&getApp().globalData.curChatId!=e.chat_id?(p=c?0:1,l=`UPDATE tb_msg_index SET unread = ${n.unread+p}, send_uid = ${e.send_uid}, msg_type = ${e.msg_type}, msg_content = '${me(e.msg_content)}', mtime = ${e.mtime}, ctime = ${e.ctime}, msg_status = ${r}, remark = '${me(g)}' WHERE chat_id = ${e.chat_id} AND chat_type = ${e.chat_type}`):l=`UPDATE tb_msg_index SET send_uid = ${e.send_uid}, msg_type = ${e.msg_type}, msg_content = '${me(e.msg_content)}', mtime = ${e.mtime}, ctime = ${e.ctime}, msg_status = ${r}, remark = '${me(g)}' WHERE chat_id = ${e.chat_id} AND chat_type = ${e.chat_type}`)):(h=!0,i=c?0:1,p=t&&e.send_uid!=getApp().globalData.uid&&!c?1:0,l=`INSERT INTO tb_msg_index (chat_id, chat_type, send_uid, msg_type, msg_content, mtime, ctime, unread, is_top, msg_notice, has_at, msg_status, remark) values (${e.chat_id}, ${e.chat_type}, ${e.send_uid}, ${e.msg_type}, '${me(e.msg_content)}', ${e.mtime}, ${e.ctime}, ${p}, ${$(e.is_top)}, ${Mh(e.msg_notice)}, 0, ${r}, '${me(g)}')`),y(l)?a({isSave:1,isNotice:0,unread:p,addTabUnread:h}):ye(l).then(_=>{a({isSave:1,isNotice:i,unread:p,addTabUnread:h})})})})}function Lt(e){return new Promise(t=>{let i=ot(e.chat_id,e.chat_type);Ce(`SELECT * FROM ${i} WHERE chat_id = ${e.chat_id} AND mtime = ${e.mtime} LIMIT 1`).then(a=>{if(a[0]){t(2);return}e.ctime=Ls(e.ctime,e.mtime);let s=`INSERT INTO ${i} (chat_id, chat_type, send_uid, mtime, ctime, msg_type, msg_content, msg_status, m_type, remark) VALUES (${e.chat_id}, ${e.chat_type}, ${e.send_uid}, ${e.mtime}, ${e.ctime}, ${e.msg_type}, '${me(e.msg_content)}', ${$(e.msg_status)}, 0, '')`;ye(s).then(()=>{t(1)},()=>{t(0)})},a=>{t(0)})})}function Ks(e,t,i){return new Promise(a=>{let n=ot(e,t),s,r=_o+1;i==0?e!=f.SYSTEM_ID?s=`SELECT * FROM ${n} WHERE chat_id = ${e} ORDER BY ctime DESC LIMIT 0, ${r}`:s=`SELECT * FROM ${n} WHERE chat_type = ${t} ORDER BY ctime DESC LIMIT 0, ${r}`:e!=f.SYSTEM_ID?s=`SELECT * FROM ${n} WHERE chat_id = ${e} AND ctime < ${i} ORDER BY ctime DESC LIMIT 0, ${r}`:s=`SELECT * FROM ${n} WHERE ctime < ${i} AND chat_type = ${t} ORDER BY ctime DESC LIMIT 0, ${r}`,Ce(s).then(l=>{a(Dr(l,_o))})})}function xo(e,t,i,a,n=!1){return new Promise(s=>{let r=`SELECT * FROM ${ot(e,t)} WHERE chat_id = ${e} AND ctime > ${i} AND chat_type = ${t} ORDER BY ctime ${n?"DESC":""} LIMIT ${a}`;Ce(r).then(l=>{s(l)})})}function Ih(e,t,i){return new Promise(a=>{let n=ot(e,t);Ce(`SELECT * FROM ${n} WHERE chat_id = ${i.chat_id} AND mtime = ${i.mtime} LIMIT 1`).then(s=>{if(s[0])a();else{i.ctime=Ls(i.ctime,i.mtime);let r=`INSERT INTO ${n} (chat_id,chat_type,send_uid,mtime,ctime,msg_type,msg_content,msg_status,m_type,remark) VALUES (${e},${t},${i.send_uid},${i.mtime},${i.ctime},${i.msg_type},'${me(i.msg_content)}',${$(i.msg_status)},0,'')`;ye(r).then(l=>{a()},function(l){a()})}},()=>{a()})})}function wo(e,t,i){return new Promise(a=>{let n=i.length,s=0;for(let r=0,l=i.length;r<l;r++)Ih(e,t,i[r]).then(()=>{s+=1,s==n&&a()})})}function nt(e,t,i,a,n=0,s=!0){return new Promise(r=>{let l=ot(e,t),c;n==0?s?c=`UPDATE ${l} SET msg_content = '${me(a)}' WHERE chat_id = ${e} AND ctime = ${i}`:c=`UPDATE ${l} SET msg_content = '${me(a)}' WHERE chat_id = ${e} AND mtime = ${i}`:c=`UPDATE ${l} SET msg_content = '${me(a)}' WHERE id = ${n}`,ye(c).then(p=>{r()})})}function Co(e,t,i,a=0,n=!0){return new Promise(s=>{let r=ot(e,t),l;a!=0?l=`SELECT * FROM ${r} WHERE id = ${a} LIMIT 1`:n?l=`SELECT * FROM ${r} WHERE chat_id = ${e} AND ctime = ${i} LIMIT 1`:l=`SELECT * FROM ${r} WHERE chat_id = ${e} AND mtime = ${i} LIMIT 1`,Ce(l).then(c=>{let p=c[0];p&&(p.msg_content=Nt(p.msg_content)),s(p)})})}function So(e,t,i,a=0){return new Promise(n=>{let s=ot(e,t),r;a==0?r=`DELETE FROM ${s} WHERE chat_id = ${e} AND mtime = ${i}`:r=`DELETE FROM ${s} WHERE chat_id = ${e} AND ctime = ${a}`,ye(r).then(l=>{n()})})}function ko(e,t,i){return new Promise(a=>{let n=`SELECT * FROM ${ot(e,t)} WHERE chat_id = ${e} AND chat_type = ${t} AND send_uid = ${i}`;Ce(n).then(s=>{a(s.length)})})}function Ao(e,t,i,a={}){return new Promise(n=>{if(Object.keys(a).length<=0)return;let s=ot(e,t),r=[];for(let p in a){let h=a[p],g=p+" = "+h;r.push(g)}let l=r.join(", "),c=`UPDATE ${s} SET ${l} WHERE mtime = ${i}`;ye(c).then(()=>{n(1)},()=>{n(0)})})}function Rh(e,t){return e.msg_type==f.M_MATCH_SUCCESS?!0:e.msg_type!=f.M_CALL||e.send_uid==getApp().globalData.uid?!1:t.call_status==2||t.call_status==1}function Mh(e){return e==null?1:parseInt(e)}function ot(e,t){let i=Oh();if(t==f.M_CHAT_CLUB)return`${i}${e}`;if(e==f.SYSTEM_ID)return`${i}${e}`;let a=Number(e)%10;return`${i}${a}`}function Oh(){return"tb_msg_"}function Fh(e,t){it(u("tips"),u("anchor.rest.turnOffTip"),()=>{let i={user_info:{is_rest:0}};B.request("/user/update-info",i,!0).then(()=>{typeof e=="function"&&e(),Pi("pubUser.is_rest",0),Ee(u("tips"),u("anchor.rest.turnOff"),"",u("gotIt"))})},()=>{typeof t=="function"&&t()},u("turnOff"))}function wi(){return!fe()||getApp().pubUser.is_rest!=1?!1:(uni.hideKeyboard(),Fh(!1,!1),!0)}function vo(e,t,i){let a,n,s,r,l=!1,c=e.uid_arr,p=getApp().globalData.uid;try{switch(e.key){case ae.CREATE:if(e.uid==getApp().globalData.uid){let O=e.identity==Wa.USER;a=Bh(O),s=[{action:2,id:i.club_id,member:1}],l=!0}else a=u("msg.clubCreate"),s=[{action:1,id:e.uid}];n={nickname:G(t[c[0]].nickname),club_name:G(i.club_name)};break;case ae.JOIN:n={nickname:G(t[c[0]].nickname)},c[0]==getApp().globalData.uid?(a=To(),n.club_name=G(i.club_name),l=!0,s=[{action:2,id:i.club_id,member:i.is_member}]):(a=u("msg.clubJoin"),s=[{action:1,id:t[c[0]].uid}]);break;case ae.EDIT_NAME:a=u("msg.clubEditName"),e.uid==getApp().globalData.uid?(n={nickname:{text:u("you")}},s=[{action:2,id:i.club_id,member:1}]):(n={nickname:G(t[c[0]].nickname)},s=[{action:1,id:t[c[0]].uid}]),n.club_name=G(e.club_name);break;case ae.MUTE_ALL_MEMBER:e.uid==getApp().globalData.uid?r=e.is_mute?u("msg.clubMuteAllOnF"):u("msg.clubMuteAllOffF"):(a=e.is_mute?u("msg.clubMuteAllOn"):u("msg.clubMuteAllOff"),n={nickname:G(t[c[0]].nickname)},s=[{action:1,id:t[c[0]].uid}]);break;case ae.REMOVE:let h;e.founder==getApp().globalData.uid?(h=t[e.uid],a=u("msg.clubRemoveMemberF")):(h=t[e.founder],a=u("msg.clubRemoveMember")),n={nickname:G(h.nickname)},s=[{action:1,id:h.uid}];break;case ae.QUIT:a=u("msg.clubMemberQuit"),n={nickname:G(t[c[0]].nickname)},s=[{action:1,id:t[c[0]].uid}];break;case ae.DISSOLUTION:e.from_admin==1?r=u("msg.clubDissolveAdmin"):(a=u("msg.clubDissolve"),n={nickname:G(t[c[0]].nickname)},s=[{action:1,id:t[c[0]].uid}]);break;case ae.MUTE_MEMBER:let g;e.founder==getApp().globalData.uid?(g=t[e.uid],e.is_mute?a=u("msg.clubMuteOnF"):a=u("msg.clubMuteOffF")):(g=t[e.founder],e.is_mute?a=u("msg.clubMuteMemberTips"):a=u("msg.clubMuteOff")),n={nickname:G(g.nickname)},s=[{action:1,id:g.uid}];break;case ae.MUTE_SEND_FAIL:a=e.is_mute==2?u("msg.clubMuteAllTips"):u("msg.clubMuteMemberTips"),n={nickname:G(t[c[0]].nickname)},s=[{action:1,id:t[c[0]].uid}];break;case ae.INVITE_JOIN:let _=Array.isArray(e.uid);if(_?s=[{action:2,id:i.club_id,member:i.is_member}]:s=[{action:1,id:e.uid}],e.founder==getApp().globalData.uid){a=u("msg.clubInvite");let O;if(_){O="";for(let W=0,Y=e.uid.length;W<Y;W++){let D=t[e.uid[W]];D&&(O+=`${D.nickname}${W>=Y-1?"":", "}`)}}else O=t[e.uid].nickname;n={nickname:{text:u("you")},invited_name:G(O)}}else{let O=_?e.uid.indexOf(getApp().globalData.uid)!=-1:e.uid==getApp().globalData.uid,W="";if(_)if(O)W=getApp().pubUser.nickname;else for(let Y=0,D=e.uid.length;Y<D;Y++){let J=t[e.uid[Y]];J&&(W+=`${J.nickname}${Y>=D-1?"":", "}`)}else W=O?getApp().pubUser.nickname:t[e.uid].nickname;O?(a=To(),n={nickname:G(W),club_name:G(i.club_name)},l=!0):(a=u("msg.clubInvite"),n={nickname:G(t[e.founder].nickname),invited_name:G(W)})}break;case ae.SET_FOUNDER:e.uid==getApp().globalData.uid?r=u("msg.clubSetFounderF"):(a=u("msg.clubSetFounder"),n={nickname:G(t[e.uid].nickname)},s=[{action:1,id:e.uid}]);break;case ae.SET_MANAGER:let C=t[e.uid],b=t[e.founder];e.status==1?e.uid==getApp().globalData.uid?(a=u("msg.clubAdminSetF"),n={nickname:G(b.nickname)},s=[{action:1,id:b.uid}]):(a=u("msg.clubAdminSet"),n={nickname:G(C.nickname),founder_name:G(b.nickname,"#888196")},s=[{action:1,id:C.uid}]):e.uid==getApp().globalData.uid?(a=u("msg.clubAdminCancelF"),n={nickname:G(b.nickname)},s=[{action:1,id:b.uid}]):(a=u("msg.clubAdminCancel"),n={nickname:G(C.nickname),founder_name:G(b.nickname,"#888196")},s=[{action:1,id:C.uid}]);break;case ae.YOUR_GIFT_RETURN:e.from_type==5?e.uid?(a=u("msg.clubGiftReturnPrivate"),n={nickname:G(t[e.uid].nickname)},s=[{action:1,id:e.uid}]):r=u("msg.clubGiftReturnAll"):e.from_type==6&&(r=u("msg.clubGiftReturnNone"));break;case ae.GIFT_HAS_SIGNED:if(p==e.uid)a=u("msg.giftSignedFromYou"),n={nickname:G(t[e.to_uid].nickname)},s=[{action:1,id:e.to_uid}];else if(p==e.to_uid){a=u("msg.giftYouSignedFrom");let O=e.income>1?u("coinsLower"):u("coinLower");n={nickname:G(t[e.uid].nickname),income:G(e.income,"#888196"),coin_str:G(O,"#888196")},s=[{action:1,id:e.uid}]}break;case ae.SIGN_GIFT:r=u("msg.giftYouSigned");break;case ae.SIGN_GIFT_FAIL:r=u("msg.giftLateAndBeenSigned");break;case ae.YOUR_GIFT_SIGNED:r=u("msg.giftBeenSignedFromYou");break;case ae.ACTION_GIFT:let N=e.from_type==6?u("msg.giftRobbedLower"):u("receivedLower");e.uid==getApp().globalData.uid?(a=u("msg.clubGiftRobSend",{robOrReceive:N}),n={nickname:G(t[e.to_uid].nickname),gift_name:G(e.gift_name,"#FB4476")},s=[{action:1,id:e.to_uid}]):e.to_uid==getApp().globalData.uid?(a=u("msg.clubGiftRobReceive",{rob:N,income:e.income,min:parseInt(e.reply_time/60)}),n={gift_name:G(e.gift_name,"#FB4476"),nickname:G(t[e.uid].nickname)},s=[{action:1,id:e.uid}]):(a=u("msg.clubGiftRobPasserby",{robOrReceive:N}),n={nickname:G(t[e.to_uid].nickname),gift_name:G(e.gift_name,"#FB4476"),from_name:G(t[e.uid].nickname)},s=[{action:1,id:e.uid}]);break;case ae.GIFT_NO_REPLY_RETURN:if(e.uid==getApp().globalData.uid)a=u("msg.clubGiftNoReplyS",{min:parseInt(e.reply_time/60),income:e.income}),n={nickname:G(t[e.to_uid].nickname),gift_name:G(e.gift_name,"#FB4476")},s=[{action:1,id:e.to_uid}];else{let O=t[e.uid],W=parseInt(e.reply_time/60);a=e.from_type==6?u("msg.clubGiftNoReplyRFRob",{number:W}):u("msg.clubGiftNoReplyRFReceive",{number:W}),n={nickname:G(O.nickname),gift_name:G(e.gift_name,"#FB4476"),from_name:G(O.nickname)},s=[{action:1,id:e.uid}]}break;case ae.GIFT_NO_ROB_RETURN:a=u("msg.clubGiftNoRobReturn",{number:e.income}),n={gift_name:G(e.gift_name,"#FB4476")};break;case ae.YOU_GIFT_ROB_OVER:a=u("msg.clubGiftRobOver"),n={gift_name:G(e.gift_name,"#FB4476")};break;case ae.GIFT_NO_SIGN_RETURN:if(e.to_uid==0)a=u("msg.clubGiftNoSignReturnAll",{number:e.income}),n={gift_name:G(e.gift_name,"#FB4476")};else{let O=t[e.to_uid];a=u("msg.clubGiftNoSignReturn",{other_str:Ve(O.sex),income:e.income}),n={nickname:G(O.nickname),gift_name:G(e.gift_name,"#FB4476")}}break;case ae.FIRST_MSG_FEE:r=u("msg.clubSendConsumeCoinTips",{number:ri(e.msg_price||1)});break;case ae.INVITE_FAILED:let L="";for(let O=0,W=e.uid.length;O<W;O++){let Y=t[e.uid[O]];Y&&(L+=`${Y.nickname}${O>=W-1?"":", "}`)}a=e.uid.length>1?u("club.inviteUsersFailedTips"):u("club.inviteUserFailedTips"),n={invited_name:G(L)};break;case ae.SIGNED_FOR:a=u("giftSignedTips"),n={gift_name:G(e.gift_name),nickname:G(e.receiver_name)},s=[{action:1,id:e.to_uid}];break;default:return""}}catch(h){return Is(h,e,t,i),"New Message"}return r||{text:a,info:n,click:s,isLong:l}}function Do(e){let t;try{switch(e.key){case si.NOT_REPLY:t=u("msg.notReplyCountTips",{count:e.count});break;case si.NOT_CHEAT_USER:t=u("msg.notCheatUserTips");break;default:return""}}catch(i){return Is(i,e,{},{}),"New Message"}return t||""}function G(e,t="#0091FF"){return{text:e,color:t}}function Lo(e,t,i,a){if(e==0)return u("cancelled");if(e==1)return t?u("msg.callDeclinedBy",{nickname:Ve(i)}):u("declined");if(e==2)return`${u("duration")}: ${a}`;if(e==3)return t?u("msg.callNotAnswer"):u("cancelled")}function Wi(e){return{2:`[${u("voice")}]`,3:`[${u("picture")}]`,5:`[${u("gift")}]`,6:`[${u("notice")}]`,18:`[${u("video")}]`,21:`[${u("msg.askForGift")}]`,22:`[${u("msg.systemNotice")}]`,23:`[${u("msg.sticker")}]`,25:`[${u("msg.feePhoto")}]`,26:`[${u("msg.feeVideo")}]`,27:`[${u("msg.matchSuccess")}]`,100:`[${u("msg.systemNotice")}]`}[e]||"["+u("msg.newNews")+"]"}function In(e){let t=re(e.msg_content),i="",a="";switch(e.msg_type){case f.M_TEXT:if(t.text){let r=t.text;for(let l=0,c=t.info.length;l<c;l++){let p=t.info[l];r=r.replace("[x]",p.text)}return r}else return t.content;case f.M_IMG:return Wi(e.msg_type);case f.M_VIDEO:return i=Wi(e.msg_type),a=tt(Math.round(t.duration)),i+" "+a;case f.M_RECOMMEND_USER:return i="["+u("user")+"]",i+" "+t.nickname;case f.M_RECOMMEND_CLUB:return i="["+u("club")+"]",i+" "+t.club_name;case f.M_VOICE:return i="["+u("audio")+"]",a=tt(Math.round(t.voice_duration)),i+" "+a;case f.M_CALL:return"["+(t.call_type==rt.VIDEO?u("videoChat"):u("audioChat"))+"]";case f.M_GIFT_ASK:return Wi(e.msg_type);case f.M_GIFT:i=Wi(e.msg_type);let s=t.number>1?" "+t.number:"";return i+s+" "+t.title;case f.M_EXPRESSION:return Wi(e.msg_type);default:return""}}function Rn(e){let t=re(e.msg_content);switch(e.msg_type){case f.M_IMG:return{img_url:t.image_url,small_url:t.small_url,media_type:f.PHOTO};case f.M_VIDEO:return{cover_url:t.cover,small_url:t.small_url,video_url:t.url,media_type:f.VIDEO};case f.M_GIFT_ASK:case f.M_GIFT:return{img_url:t.icon,small_url:t.icon,media_type:f.PHOTO};case f.M_RECOMMEND_CLUB:return{img_url:t.club_logo,small_url:t.club_logo,media_type:f.PHOTO};case f.M_RECOMMEND_USER:return{img_url:t.avatar,small_url:t.avatar,media_type:f.PHOTO};case f.M_EXPRESSION:return{img_url:t.path,small_url:t.path,media_type:f.PHOTO};default:return""}}function Eo(e){let t=[u("clubRules.prohibitionClause1"),u("clubRules.prohibitionClause2"),u("clubRules.prohibitionClause3"),u("clubRules.prohibitionClause4")];e||(t.push(u("clubRules.prohibitionClause5")),t.push(u("clubRules.prohibitionClause6"))),t.push(u("clubRules.prohibitionClause7")),t.push(u("clubRules.prohibitionClause8")),t.push(u("clubRules.prohibitionClause9"));let i="";for(let a=0,n=t.length;a<n;a++){let s=a+1+". "+t[a]+`
`;i+=s}return i}function Nh(){let e=[u("clubRules.belowTips1",{hour_text:Oi(24)}),u("clubRules.belowTips2",{ban_hour_text:Oi(12),mute_hour_text:Oi(24)}),u("clubRules.belowTips3",{hour_text:Oi(24),disband_text:u("clubRules.beDisbanded"),ban_create_text:u("clubRules.nowAllowCreateClub")})],t="";for(let i=0,a=e.length;i<a;i++){let n=i<a-1?`
`:"",s="- "+e[i]+n;t+=s}return t}function Bh(e){let t="";return t=`${u("msg.clubHaveCreatedFounder")}
`,t+=`${u("clubRules.readCarefully")}
`,t+=`${u("clubRules.notTalkBelowContent")}
`,t+=`${Eo(e)}`,t+=`${u("clubRules.punishedTips")}
`,t+=`${Nh()}`,t}function To(){let e="";return e=`${u("msg.clubJoinSelf")}
`,e+=`${u("clubRules.readCarefully")}
`,e+=`${u("clubRules.notTalkBelowContent")}
`,e+=`${Eo(!fe())}`,e+=`${u("msg.chatManner")}
`,e+=`${u("msg.chatReportedWillBanned")}
`,e+=`${u("msg.chatClubReportTip")}`,e}var be=ee(ie());function je(...e){return getApp().globalData.s.state.pubAI18n(...e)}var Mn=0,On=0,K={titleTimeCheck:5,parseMessageHasMore(e,t){let i=0,a,n,s,r;for(let l=0,c=e.forLen;l<c;l++){let p=e.rows[l],h=re(p.msg_content);if(h&&h.has_more){r=p.mtime;let g=e.rows[l+1];g?s=g.mtime:s=0,n=p.id,delete h.has_more,a=h;break}else i+=1}return e.forLen==0&&(s=0,r=t),{msgMtime:s,msgLastMTime:r,countNoHasMore:i,detailIdHasMore:n,contentDelHasMore:a}},parseSendData(e,t,i,a){let n=getApp().getCTime();return{chat_id:e,chat_type:t,send_uid:getApp().globalData.uid,msg_type:i,msg_content:a,ctime:n,mtime:n}},parseItem(e,t,i){let a=e.send_uid==getApp().globalData.uid,n,s,r;return e.chat_type==f.M_CHAT_CLUB?(n=e.contentObj||re(e.msg_content),s=t[e.send_uid],r=t):(n=re(e.msg_content),s=a?getApp().globalData.s.state.pubUser:t,r=a?t:getApp().globalData.s.state.pubUser),{mId:e.id,chat_id:e.chat_id,chat_type:e.chat_type,send_uid:e.send_uid,mtime:e.mtime,ctime:e.ctime,msg_type:e.msg_type,msg_content:e.msg_content,msg_status:e.msg_status||0,m_type:0,isSend:a,user:s,target_user:r,content:n,showTime:_s(e.ctime),remark:re(e.remark),club:i}},parseMsgTime(e){return{msg_type:1e3,ctime:e,showTime:_s(e)}},getHistoryTitleTime(e,t=K.titleTimeCheck){let i=-1;if(Mn==0)return Mn=e,null;i=Mn;let a=null;return dn(i,e,t)&&(a=K.parseMsgTime(i)),Mn=e,a},getAddTitleTime(e,t=K.titleTimeCheck){if(On==0)return On=e,null;let i=null;return dn(On,e,t)&&(i=K.parseMsgTime(e),On=e),i},parseDataText(e){let t=pn(e);if(y(t))return{content:e};let i={action:5,url:t[0]},a=[];for(let n=0,s=t.length;n<s;n++){let r=t[n];e=e.replace(r,"[x]"),a.push({text:r,color:"#0000FF"})}return{text:e,info:a,click:i}},parseDataVoice(e,t){return{voice_url:e,voice_duration:t}},parseDataPicture(e,t,i,a){return{image_url:e,image_width:t,image_height:i,small_url:a}},parseDataPicturePaid(e,t,i,a,n){return{media_type:f.PHOTO,image_url:e,image_width:t,image_height:i,small_url:a,content:n,price:getApp().globalData.feePhotoPrice,check_status:1}},parseDataExpression(e,t,i){return{path:e,image_width:t,image_height:i}},parseDataRecommendClub(e){return{club_id:e.club_id,club_logo:e.club_logo,club_name:e.club_name,intro:e.intro}},parseDataRecommendUser(e){return{uid:e.uid,nickname:e.nickname,avatar:e.small_avatar,sex:e.sex,birthday:e.birthday,level:e.level,is_auth:e.is_auth,is_vip:e.is_vip}},parseDataVideo(e,t,i,a,n,s){return{url:e,cover:t,small_url:i,width:a,height:n,duration:s}},parseDataVideoPaid(e,t,i,a,n,s,r){return{media_type:f.VIDEO,url:e,cover_url:i,small_url:t,width:a,height:n,duration:s,content:r,price:getApp().globalData.feeVideoPrice,check_status:1}},uploadVoice(e,t,i,a,n){let s=t.startsWith("_doc")?plus.io.convertLocalFileSystemURL(t):t;Dn(s,ni.MESSAGE,f.VOICE,!1).then(r=>{let l=JSON.stringify(this.parseDataVoice(r.path,i));e.msg_content=l,a(l)},()=>{n(e)})},uploadPicture(e,t,i,a,n,s){Dn(t,ni.MESSAGE,f.PHOTO,!0,{width:i,height:a}).then(r=>{let l=t.replace("file://","");ct(r.path,l),ct(r.smallPath,l);let c=this.parseDataPicture(r.path,i,a,r.smallPath);r.uploadId&&(c.upload_id=r.uploadId);let p=JSON.stringify(c);e.msg_content=p,n(p,r)},()=>{s(e)})},uploadVideo(e,t,i,a,n,s,r,l){$s(ni.MESSAGE,t,i,a,n,!0,{width:a,height:n}).then(c=>{let p=i.replace("file://","");ct(c.smallUrl,p),ct(c.coverUrl,p);let h=this.parseDataVideo(c.url,c.coverUrl,c.smallUrl,a,n,s);c.uploadId&&(h.upload_id=c.uploadId);let g=JSON.stringify(h);e.msg_content=g,r(g,c)},()=>{l(e)})},uploadPicturePaid(e,t,i,a,n,s,r){Dn(t,ni.MESSAGE,f.PHOTO,!0,{width:i,height:a}).then(l=>{let c=t.replace("file://","");ct(l.path,c),ct(l.smallPath,c);let p=JSON.stringify(this.parseDataPicturePaid(l.path,i,a,l.smallPath,n));e.msg_content=p,s(p,l)},()=>{r(e)})},uploadVideoPaid(e,t,i,a,n,s,r,l,c){$s(ni.MESSAGE,t,i,a,n,!0,{width:a,height:n}).then(p=>{let h=i.replace("file://","");ct(p.smallUrl,h),ct(p.coverUrl,h);let g=JSON.stringify(this.parseDataVideoPaid(p.url,p.smallUrl,p.coverUrl,a,n,s,r));e.msg_content=g,l(g,p)},()=>{c(e)})}},ji=f.M_CHAT_PRI,le={init(e){ji=e},getList(e,t,i,a){return Ge(this,null,function*(){let n=yield Ks(e,t,i);if(n.forLen==0)return n;let s=K.parseMessageHasMore(n,a);if(n.forLen!=0&&s.countNoHasMore==n.forLen)return n;let r={mtime:s.msgMtime,last_mtime:s.msgLastMTime,chat_id:e,chat_type:t},l;try{l=yield B.request("/chat/msg/sync-detail",r,!1,!0)}catch(c){l={data:{list:[]}}}return l.data&&l.data.list.length>0&&(yield wo(e,t,l.data.list),t==f.M_CHAT_CLUB&&l.data.user_infos&&(yield Xr(l.data.user_infos))),s.detailIdHasMore&&s.contentDelHasMore&&(yield nt(e,t,0,JSON.stringify(s.contentDelHasMore),s.detailIdHasMore)),Ks(e,t,i)})},getSendData(e,t,i){return K.parseSendData(e,ji,t,i)},_send(e,t,i=!1,a=!1){let n={chat_id:t.chat_id,chat_type:t.chat_type,data:{msg_content:e,msg_type:t.msg_type}};a&&(n.data=Object.assign(n.data,a)),t.mtime=(Number(t.mtime)*1e3).toString(),zt(t,!1).then(()=>{typeof this.sendMsgBefore=="function"&&this.sendMsgBefore(t,i),B.request("/chat/msg/send",n,!1,!0).then(s=>{this._sendAfterSuccess(t,s,i)},s=>{this._sendAfterFail(t,s,i)})})},_sendAfterSuccess(e,t,i){if(t&&t.ok==1){let a=e.mtime;if(e.msg_status=0,e.mtime=t.data.mtime,t.data){if(t.data.msg_index_content)(e.msg_type==f.M_PAID_PHOTO||e.msg_type==f.M_PAID_VIDEO)&&(t.data.msg_index_content.check_status=1),e.msg_content=JSON.stringify(t.data.msg_index_content);else if(t.data.income){let n=re(e.msg_content);n.income=t.data.income,n.income_uid=getApp().globalData.uid,e.msg_content=JSON.stringify(n)}}Mo(e,a),Hh(e.mtime),this.sendMsgFinish(!0,e,i,t),Ht(t.data.balance)}else this._sendAfterFail(e,t,i)},_sendAfterFail(e,t,i){let a=e.mtime;if(e.msg_status=1,e.mtime=getApp().getCTime()*1e3,Mo(e,a),this.sendMsgFinish(!1,e,i,t),t&&t.ok==0){if(uni.hideKeyboard(),e.chat_type==f.M_CHAT_CLUB){if(typeof t.data.is_mute!="undefined"){let n={key:9,is_mute:t.data.is_mute,uid_arr:[e.club_info.club_uid]},s=this.getSendData(e.chat_id,f.M_NOTICE,JSON.stringify(n));s.send_uid=f.SYSTEM_ID,this.sendMsg(s,!1),Lt(s)}else if(typeof t.data.is_member!="undefined"&&t.data.is_member==0){let n={key:5,uid:getApp().globalData.uid,founder:e.club_info.club_uid,uid_arr:[getApp().globalData.uid,e.club_info.club_uid]},s=this.getSendData(e.chat_id,f.M_NOTICE,JSON.stringify(n));s.send_uid=f.SYSTEM_ID,this.sendMsg(s,!1),Lt(s)}else if(typeof t.data.is_disband!="undefined"&&t.data.is_disband==1){let n={key:7,uid:e.club_info.club_uid,uid_arr:[e.club_info.club_uid]},s=this.getSendData(e.chat_id,f.M_NOTICE,JSON.stringify(n));s.send_uid=f.SYSTEM_ID,this.sendMsg(s,!1),Lt(s)}}}else if(t&&t.ok==-1){let n="";t.data&&t.data.tips&&(n=t.data.tips);let s=this.getSendData(e.chat_id,f.M_C_RECHARGE,JSON.stringify({type:2,tips:n}));s.send_uid=f.SYSTEM_ID,this.sendMsg(s,!1),Lt(s)}else if(t&&t.ok==-2){let n=this.getSendData(e.chat_id,f.M_NOTICE,JSON.stringify({content:t.data.tips}));n.send_uid=f.SYSTEM_ID,this.sendMsg(n,!1),Lt(n)}if(t&&t.data&&t.data.callback&&t.data.callback.func_name=="recharge_alert"){let n=this.getSendData(e.chat_id,f.M_C_RECHARGE,JSON.stringify({type:1,coins:t.data.msg_price||1}));n.send_uid=f.SYSTEM_ID,this.sendMsg(n,!1),Lt(n)}},sendText(e,t,i="",a=null){if(y(t))return;let n,s=!1,r=!1;if(ji==f.M_CHAT_PRI||ji==f.M_CHAT_CLUB){let p=ji==f.M_CHAT_PRI?yi.MSG:yi.MSG_CLUB;r=fo(t,p)}if(r&&r.has){let p=K.parseDataText(t);p.sensitive_type=r.type,le.replyMsgData&&(p.reply=le.replyMsgData),n=JSON.stringify(p),s={sensitive_type:r.type,sensitive_text:r.find}}else{let p=K.parseDataText(t);le.replyMsgData&&(p.reply=le.replyMsgData),n=JSON.stringify(p)}let l=this.getSendData(e,f.M_TEXT,n);this.sendMsg(l);let c={content:t};le.replyMsgData&&(c.reply=le.replyMsgData,le.replyMsgData=""),i&&(c.gift_record=i),a&&(c=Object.assign(c,a)),this._send(JSON.stringify(c),l,!1,s)},sendVoice(e,t,i){let a=JSON.stringify(K.parseDataVoice(t,i)),n=this.getSendData(e,f.M_VOICE,a);this.sendMsg(n),K.uploadVoice(n,t,i,s=>{this._send(s,n)},s=>{this._sendAfterFail(s,null)})},sendRecommendClub(e,t){let i=JSON.stringify(K.parseDataRecommendClub(t)),a=this.getSendData(e,f.M_RECOMMEND_CLUB,i);this.sendMsg(a),this._send(i,a)},sendRecommendUser(e,t){let i=JSON.stringify(K.parseDataRecommendUser(t)),a=this.getSendData(e,f.M_RECOMMEND_USER,i);this.sendMsg(a),this._send(i,a)},sendPicture(e,t,i,a){let n=JSON.stringify(K.parseDataPicture(t,i,a,t)),s=this.getSendData(e,f.M_IMG,n);this.sendMsg(s),K.uploadPicture(s,t,i,a,r=>{this._send(r,s)},r=>{this._sendAfterFail(r,null)})},sendVideo(e,t,i,a,n,s){let r=`file://${i}`,l=JSON.stringify(K.parseDataVideo(t,r,r,a,n,s)),c=this.getSendData(e,f.M_VIDEO,l);this.sendMsg(c),K.uploadVideo(c,t,i,a,n,s,p=>{this._send(p,c)},p=>{this._sendAfterFail(p,null)})},sendPaidPhoto(e,t,i,a,n){let s=JSON.stringify(K.parseDataPicturePaid(t,i,a,t,n)),r=this.getSendData(e,f.M_PAID_PHOTO,s);this.sendMsg(r),K.uploadPicturePaid(r,t,i,a,n,(l,c)=>{this.reqSendPaidMedia(r,Ys(e,n,i,a,c.path))},l=>{this._sendAfterFail(l,null)})},sendPaidVideo(e,t,i,a,n,s,r){let l=`file://${i}`,c=JSON.stringify(K.parseDataVideoPaid(t,l,l,a,n,s,r)),p=this.getSendData(e,f.M_PAID_VIDEO,c);this.sendMsg(p),K.uploadVideoPaid(p,t,i,a,n,s,r,(h,g)=>{this.reqSendPaidMedia(p,Js(e,r,a,n,s,g.url,g.coverUrl))},h=>{this._sendAfterFail(h,null)})},sendGift(e,t){if(Object.keys(t).length<=0)return;let i={gift_id:t.gift_id,icon:t.icon,price:t.price,title:t.title,number:t.count,svga_url:t.svga_url},a=1;if(t.gift_source)i.gift_source=1,bi(t,!0);else{if(a=Ar(t.price),a==0)return;a==1&&bi(t,!0)}let n,s=JSON.stringify(i);n=this.getSendData(e,f.M_GIFT,s),this.sendMsg(n),this.reqSendGift(n,Io(e,t),!1)},sendClubGift(e,t){if(Object.keys(t).length<=0)return;let i={gift_id:t.gift_id,icon:t.icon,price:t.price,title:t.title,number:t.count,svga_url:t.svga_url,to_uid:t.to_uid};bi(t,!0),i.from_type=t.from_type?t.from_type:_e.CLUB,t.gift_source&&(i.gift_source=1);let a=[],n={};if(t.user_list)for(let r=0,l=t.user_list.length;r<l;r++){let c=t.user_list[r];i.to_user_info=c,n=this.getSendData(e,f.M_GIFT,JSON.stringify(i)),this.sendMsg(n),a.push(n)}else n=this.getSendData(e,f.M_GIFT,JSON.stringify(i)),this.sendMsg(n),a=[n];let s=Ro(e,t,t.count);this.reqSendClubGift(a,s)},sendAskGift(e,t){if(Object.keys(t).length<=0)return;let i={gift_id:t.gift_id,icon:t.icon,price:t.price,title:t.title},a=this.getSendData(e,f.M_GIFT_ASK,JSON.stringify(i));this.sendMsg(a),this.reqSendGiftAsk(a,{gift_id:t.gift_id,to_uid:e})},sendExpressionImg(e,t,i,a){let n=JSON.stringify(K.parseDataExpression(t,i,a,t)),s=this.getSendData(e,f.M_EXPRESSION,n);this.sendMsg(s),this._send(n,s)},reqSendClubGift(e,t,i=!1){Ph(e).then(()=>{B.request("/chat/gift/send",t,!1,!0,!1).then(a=>{Ht(a.data.balance);for(let n=0,s=e.length;n<s;n++)this._sendAfterSuccess(e[n],a,i);jt("chat_success",2),a.data.from_bag&&Wt()},()=>{for(let a=0,n=e.length;a<n;a++)this._sendAfterFail(e[a],!1,i)})})},reqSendGift(e,t,i=!1){e.mtime=(Number(e.mtime)*1e3).toString(),zt(e,!1).then(()=>{B.request("/chat/gift/send",t,!1,!0,!1).then(a=>{Ht(a.data.balance),this._sendAfterSuccess(e,a,i),jt("chat_success",2),a.data.from_bag&&Wt()},a=>{this._sendAfterFail(e,!1,i)})})},reqSendGiftAsk(e,t,i=!1){e.mtime=(Number(e.mtime)*1e3).toString(),zt(e,!1).then(()=>{B.request("/chat/gift/ask",t,!1,!0).then(a=>{this._sendAfterSuccess(e,a,i)},()=>{this._sendAfterFail(e,!1,i)})})},reqSendPaidMedia(e,t,i=!1){B.request("/chat/album/send",t,!1,!0,!1).then(a=>{this._sendAfterSuccess(e,a,i)},a=>{a&&a.data&&typeof a.data.callback=="object"||this._sendAfterFail(e,!1,i)})},resend(e){if(e.ctime=getApp().getCTime(),e.mtime=e.ctime*1e3,e.msg_status=0,this.sendMsg(e),e.msg_type==f.M_VOICE){let t=re(e.msg_content);li(t.voice_url)?K.uploadVoice(e,t.voice_url,t.voice_duration,i=>{this._send(i,e,!0)},i=>{this._sendAfterFail(i,null,!0)}):this._send(e.msg_content,e,!0)}else if(e.msg_type==f.M_IMG){let t=re(e.msg_content);li(t.image_url)?K.uploadPicture(e,t.image_url,t.image_width,t.image_height,i=>{this._send(i,e,!0)},i=>{this._sendAfterFail(i,null,!0)}):this._send(e.msg_content,e,!0)}else if(e.msg_type==f.M_VIDEO){let t=re(e.msg_content);li(t.url)?K.uploadVideo(e,t.url,t.cover,t.width,t.height,t.duration,i=>{this._send(i,e,!0)},i=>{this._sendAfterFail(i,null,!0)}):this._send(e.msg_content,e,!0)}else if(e.msg_type==f.M_GIFT){let t=re(e.msg_content);if(!t)return;let i={};e.chat_type==f.M_CHAT_CLUB?i=Ro(e.chat_id,t,t.number):(t.count=t.number,i=Io(e.chat_id,t)),this.reqSendGift(e,i,!0)}else if(e.msg_type==f.M_GIFT_ASK){let t=re(e.msg_content);this.reqSendGiftAsk(e,{gift_id:t.gift_id,to_uid:e.chat_id},!0)}else if(e.msg_type==f.M_PAID_PHOTO){let t=re(e.msg_content);li(t.image_url)?K.uploadPicturePaid(e,t.image_url,t.image_width,t.image_height,t.content,(i,a)=>{this.reqSendPaidMedia(e,Ys(e.chat_id,t.content,t.image_width,t.image_height,a.path),!0)},i=>{this._sendAfterFail(i,null,!0)}):this.reqSendPaidMedia(e,Ys(e.chat_id,t.content,t.image_width,t.image_height,t.image_url),!0)}else if(e.msg_type==f.M_PAID_VIDEO){let t=re(e.msg_content);li(t.url)?K.uploadVideoPaid(e,t.url,t.cover_url,t.width,t.height,t.duration,t.content,(i,a)=>{this.reqSendPaidMedia(e,Js(e.chat_id,t.content,t.width,t.height,t.duration,a.url,a.coverUrl))},i=>{this._sendAfterFail(i,null)}):this.reqSendPaidMedia(e,Js(e.chat_id,t.content,t.width,t.height,t.duration,t.url,t.cover_url))}else this._send(e.msg_content,e,!0)},replyMsgData:""};function Io(e,t){let i={from_type:_e.MSG,gift_id:t.gift_id,to_uid:e,action:1,number:t.count};return typeof t.gift_source!="undefined"&&(i.gift_source=t.gift_source),typeof t.from_ask!="undefined"&&(i.from_ask=t.from_ask),i}function Ro(e,t,i){let a={from_type:_e.CLUB,gift_id:t.gift_id,to_uid:t.to_uid,action:1,number:i,club_id:e};return t.gift_source&&(a.gift_source=1),a}function Ys(e,t,i,a,n){return{chat_id:e,media_type:f.PHOTO,content:t||"",media:{width:i,height:a,photo_url:n}}}function Js(e,t,i,a,n,s,r){return{chat_id:e,media_type:f.VIDEO,content:t||"",media:{width:i,height:a,duration:n,video_url:s,photo_url:r}}}function Ph(e){return new Promise(t=>{let i=e.length,a=0;for(let n=0;n<i;n++){let s=e[n];s.mtime=(Number(s.mtime)*1e3).toString(),zt(s,!1).then(()=>{a+=1,a==i&&t()})}})}function Mo(e,t){let i={mtime:e.mtime,msg_status:e.msg_status,msg_content:`'${me(e.msg_content)}'`};Ao(e.chat_id,e.chat_type,t,i).then(()=>xi(e.chat_id,e.chat_type)).then(a=>a?a.mtime!=t?Ke:bo(e.chat_id,e.chat_type,i):Ke).then(a=>{typeof a!="undefined"&&a==1&&uni.$emit("event_msg_index_send",e)})}function Hh(e){let t=X(`msg_index_sync_time_${getApp().globalData.uid}`);e>=t&&Es()&&(getApp().globalData.adminKefuDBSyncDoing||se(`msg_index_sync_time_${getApp().globalData.uid}`,e))}var Fn=getApp().globalData.window,Oo=xe("dom"),Uh=xe("animation"),Nn=0,Fo={data(){return{indexCTime:0,indexMTime:0,messageNone:1,navBarTitle:"",showMask:!0,sw:Fn.width,viewHeight:Fn.height-Fn.statusBarHeight-44,msgBarHeight:Fn.safeBottom+uni.upx2px(104),scrollable:!0,historyList:[],addList:[],previewList:[],previewKeyList:[],isAddTitleClick:!1,failObj:{},inputHeight:uni.upx2px(35),itemHeightLast:10,itemHeightFirst:10,changeHTop:0,changeHBottom:0,barActionHeight:0,barSlotShow:!0,barSlotH:0,barSlotHeight:uni.upx2px(84),replyMsgData:"",replyMsgMtime:""}},computed:{classRotate(){return this.messageNone?"":"rotate-list"},mutedTips(){return this.muteMaskType==1?u("msg.mutedYouTip"):u("msg.mutedAllTip")}},methods:{clickBarGift(){this.checkClubMuted()||this.$refs.giftSheet.open(this.chatId)},clickBarUser(){this.checkClubMuted()||ce("/pagesPub/user/user-list",{from_type:3},"data",{},{onRecommendListener:this.onRecommendListener})},clickBarClub(){this.checkClubMuted()||ce("/pagesClub/search",{type:2},"data",{},{onRecommendListener:this.onRecommendListener})},clickMsgList(e){e&&e.stopPropagation(),this.$refs.msgBar&&this.$refs.msgBar.hide()},clickPicture(e){let t=this.previewKeyList.indexOf(e.pKey);t!=-1&&ui(this.previewList,t,0)},clickFail(e,t,i){!e||e.chat_id!=this.chatId||e.chat_type!=this.chatType||this.chatType==f.M_CHAT_ASS&&Ds(os.MSG_SYSTEM,!1)||wi()||Hi(this.user)||it(u("tips"),u("msg.resendTips"),()=>{let a=this.failObj[e.ctime];y(a)&&(a=e);let n;if(i==1?n=this.historyList[t-1]:n=this.addList[t+1],this.onMsgAction(1,i,t,e),n){let s=!1;n.msg_type==f.M_C_RECHARGE?s=!0:n.msg_type==f.M_NOTICE&&(s=[5,7,9].indexOf(n.content.key)!=-1),s&&this.$nextTick(()=>{let r=this.$refs[`msg${n.ctime}`][0].index;typeof r!="undefined"&&this.onMsgAction(1,i,r,n)})}this.scrollBottom(),this.resend(a)},"",u("resend"))},checkClubMuted(){return this.chatType==f.M_CHAT_CLUB&&this.muteMaskType>0?(Ee(u("tips"),this.mutedTips,"",u("gotIt")),!0):!1},sendMsgFinish(e,t,i,a){try{if(this.$refs[`msg${t.ctime}`][0].hideLoading(t.mtime),a&&a.data&&a.data.income&&this.$refs[`msg${t.ctime}`][0].showIncome(a.data.income),this.chatType!=f.M_CHAT_CLUB?t.user_info=this.user:(t.club_info=this.club,t.user_info=this.userInfos[getApp().globalData.uid]),e){delete this.failObj[t.ctime],typeof this.sendMsgFinishAfter=="function"&&this.sendMsgFinishAfter(t,a);return}this.handleFail(t)}catch(n){M("error","at pagesMsg/chat.mixin.js:145","sendMsgFinish catch error ---> ",n)}},sendMsgBefore(e,t){try{this.chatType!=f.M_CHAT_CLUB?e.user_info=this.user:(e.club_info=this.club,e.user_info=this.userInfos[getApp().globalData.uid]),uni.$emit("event_msg_index_send",e,t)}catch(i){M("error","at pagesMsg/chat.mixin.js:158","sendMsgBefore catch error ---> ",i)}},clearIndexUnread(){yo(this.chatId,this.chatType).then(e=>{e<=0||uni.$emit("event_msg_index_unread",{chatId:this.chatId,chatType:this.chatType,unread:e})})},clearReplyMsgData(){y(this.replyMsgData)||(this.replyMsgData="",this.barSlotHeight-=uni.upx2px(88))},animDef(e,t,i,a=!1,n){Uh.transition(e,{styles:t,duration:i,timingFunction:"ease",needLayout:a,delay:0},()=>{typeof n=="function"&&n()})},addPreviewInfo(e,t){if([f.M_IMG,f.M_VIDEO,f.M_PAID_PHOTO,f.M_PAID_VIDEO].indexOf(Number(e.msg_type))==-1)return null;if(!((e.msg_type==f.M_PAID_PHOTO||e.msg_type==f.M_PAID_VIDEO)&&e.content.check_status==0))try{let i=or(),a=e.content,n=fn(e,a);return t==1?(this.previewList.unshift(n),this.previewKeyList.unshift(i)):(this.previewList.push(n),this.previewKeyList.push(i)),i}catch(i){return null}},addMsgTimeByFirst(){let e=this.historyList[this.historyList.length-1];e==null||e.msg_type==1e3||this.historyList.push(K.parseMsgTime(e.ctime))},addMsgTimeByLast(e,t=K.titleTimeCheck){if(Nn==0){let i=this.addList.length>0?this.addList[this.addList.length-1]:this.historyList[0];!y(i)&&i.ctime&&(Nn=i.ctime)}dn(Nn,e,t)&&(this.addList.push(K.parseMsgTime(e)),Nn=e)},addMsgTranslateTip(e,t=!1){if(e&&t){if(X("translate_auto_msg"))return;se("translate_auto_msg",1)}let i=e?u("msg.translateAutoOpenMsgTips"):u("msg.translateAutoCloseMsgTips"),a=K.parseSendData(this.chatId,f.M_CHAT_PRI,f.M_NOTICE,JSON.stringify({content:i})),n=getApp().getCTime();a.ctime=n,a.mtime=n*1e3,a.send_uid=1;let s=K.parseItem(a,getApp().pubUser);t?this.messageNone?this.addList.push(s):this.historyList.unshift(s):this.addList.push(s)},addMsg(e,t,i){let a;e.chat_type==f.M_CHAT_CLUB?(this.userInfos=Object.assign(this.userInfos,e.user_infos),a=K.parseItem(e,this.userInfos,this.club)):a=K.parseItem(e,t,{}),this.addMsgTimeByLast(a.ctime);let n=this.addPreviewInfo(a,2);n&&(a.pKey=n),this.addList.push(a),this.$nextTick(()=>{this.messageNone&&this.scrollBottom(),typeof i=="function"&&i()})},setCurChat(e){e?(getApp().globalData.curChatId==this.chatId&&(getApp().globalData.curChatId=0),getApp().globalData.curChatType==this.chatType&&(getApp().globalData.curChatType=0)):(getApp().globalData.curChatId=this.chatId,getApp().globalData.curChatType=this.chatType)},changeBarSlot(e){if(!(this.barSlotH<=0)&&this.barSlotShow!=e&&!(e&&this.barActionHeight>0))if(this.barSlotShow=e,this.messageNone){let t={transform:`translateY(${e?0:this.barSlotH}px)`};this.animDef(this.$refs.refBarSlot,t,f.isAndroid?10:200,!0)}else if(f.isAndroid)this.barSlotHeight=e?this.barSlotH:0;else{let t={height:`${e?this.barSlotH:0}px`};this.animDef(this.$refs.refBarSlot,t,200,!0)}},parseMsgItem(e,t,i,a){if(i==1){let r=K.getHistoryTitleTime(t.ctime);r!=null&&a!=0&&e.push(r)}else{let r=K.getAddTitleTime(t.ctime);r!=null&&e.push(r)}let n;t.chat_type==f.M_CHAT_CLUB?n=K.parseItem(t,this.userInfos,this.club):n=K.parseItem(t,this.user,{});let s=this.addPreviewInfo(n,i);s&&(n.pKey=s),e.push(n)},handleFail(e){this.failObj[e.ctime]=e,this.$refs[`msg${e.ctime}`][0].showFail()},handleGetUsers(e){return new Promise(t=>Ge(this,null,function*(){let i=[];for(let a=0,n=e.length;a<n;a++){let s=e[a],r=re(s.msg_content);if(s.contentObj=r,r.uid_arr)for(let l=0,c=r.uid_arr.length;l<c;l++)!this.userInfos[r.uid_arr[l]]&&i.indexOf(r.uid_arr[l])==-1&&i.push(r.uid_arr[l]);r.tran_text&&(this.tranTextLen+=1),!this.userInfos[s.send_uid]&&i.indexOf(s.send_uid)==-1&&i.push(s.send_uid)}if(i.length>0){let a=yield vn(i,!1);this.userInfos=Object.assign(this.userInfos,a),t()}else t()}))},handleSyncFinish(){return Ge(this,null,function*(){M("error","at pagesMsg/chat.mixin.js:331","--------> \u6267\u884C\u6D88\u606F\u540C\u6B65\u7ED3\u675F \u5237\u65B0\u6D88\u606F\u3002\u3002\u3002");let e;this.addList.length>0?e=this.addList[this.addList.length-1]:this.historyList.length>0?e=this.historyList[0]:e=null;let t=e?e.ctime:0,i;xo(this.chatId,this.chatType,t,40).then(a=>!a.length||a.length<=0?Ke:(i=a,this.handleGetUsers(a))).then(()=>{this.clearIndexUnread();let a=!1,n=-1;for(let p=0,h=i.length;p<h;p++){let g=i[p],_=re(g.msg_content);if(a=_?_.has_more:!1,a){n=p;break}}let s=i;if(a&&(s=i.slice(n+1,i.length),this.previewList=[],this.previewKeyList=[]),typeof this.syncFinish=="function"){this.syncFinish(a,s);return}let r=this.addList.length,l=[];for(let p=0,h=s.length;p<h;p++)this.parseMsgItem(l,s[p],2,p);if(this.addList=[...this.addList,...l],this.$nextTick(()=>{this.scrollBottom(),typeof this.handleSyncFinishNext=="function"&&this.handleSyncFinishNext()}),!a)return;this.historyList=[],this.addList.splice(0,r);let c=s[0];this.indexCTime=c.ctime,this.indexMTime=c.mtime,typeof this.handleSyncFinishNext=="function"&&this.handleSyncFinishNext()})})},scrollBottom(e=!1){let t=this.messageNone?"cellNew":"cellLast";this.scrollList(this.$refs[t],e)},scrollList(e,t=!0){Oo.scrollToElement(e,{animated:t})},getReplyMsgNickname(e){return e.chat_type==f.M_CHAT_ASS?e.chat_id==f.SYSTEM_ID&&e.send_uid!=getApp().globalData.uid?u("customerService"):e.chat_id!=f.SYSTEM_ID&&e.send_uid!=e.chat_id?u("customerService"):e.user.nickname:e.user.nickname},getSaveReplyMsg(e){let t=In(e),i=Rn(e);return{nickname:this.getReplyMsgNickname(e),ctime:e.ctime,mtime:e.mtime,msg_type:e.msg_type,content:t,img:i}},onClickTextReplyContent(e){let t=this.$refs["cell"+e.mtime];if(!t)return;Oo.scrollToElement(t[0],{animated:!0,offset:0});let i=setTimeout(()=>{this.replyMsgMtime=e.mtime;let a=setTimeout(()=>{this.replyMsgMtime="",clearTimeout(a)},500);clearTimeout(i)},300)},onClickMsgBarReplyClose(){this.clearReplyMsgData(),le.replyMsgData&&(le.replyMsgData="")},onTranslateAutoChange(e){this.addMsgTranslateTip(e,!1)},onRecordFinish(e){M("error","at pagesMsg/chat.mixin.js:443","-----> msg onRecordFinish "+JSON.stringify(e)),this.onRecordFinishNext(e)},onKeyboardChange(e){let t=e.height>0;t&&this.scrollBottom(),this.changeBarSlot(!t),this.onKeyboardChangeNext(t,e.height),pr(e)},onRecommendListener(e,t){e==2?le.sendRecommendClub(this.chatId,t):e==1&&le.sendRecommendUser(this.chatId,t)},onMsgItemPopListener(e){e.data.isAdmin||!e.data||e.data.chat_id!=this.chatId||e.data.chat_type!=this.chatType||this.$refs.msgItemPop.open(e)},onMsgItemPopDel(e){this.onMsgAction(1,e.listType,e.index,e.msgData)},onMsgItemPopReply(e){this.onMsgAction(2,e.listType,e.index,e.msgData)},onGiftSheetChange(e){if(e.show){if(this.barActionHeight>0)return;let t=e.height-this.msgBarHeight;this.messageNone?(this.changeHBottom=t,this.$nextTick(()=>{this.scrollBottom()})):this.changeHTop=t}else this.changeHTop=0,this.changeHBottom=0},onMsgAction(e,t,i,a){if(!(a.chat_id!=this.chatId||a.chat_type!=this.chatType))if(e==1){if(i<0)return;t==1?this.historyList.splice(i,1):this.addList.splice(i,1),So(a.chat_id,a.chat_type,0,a.ctime);let n=this.previewKeyList.indexOf(a.pKey);if(n==-1)return;this.previewList.splice(n,1),this.previewKeyList.splice(n,1)}else e==2&&(y(this.replyMsgData)&&(this.barSlotHeight=this.barSlotHeight+uni.upx2px(88)),this.replyMsgData=a,le.replyMsgData=this.getSaveReplyMsg(a),this.$refs.msgBar.focus())},onActionOpen(e,t){this.barActionHeight=t,this.$nextTick(()=>{if(e)this.messageNone&&this.scrollBottom();else{let i=setTimeout(()=>{this.messageNone&&this.scrollBottom(),clearTimeout(i)},100)}this.changeBarSlot(!e),this.onActionOpenNext(e,t)})},onInputLineChange(){this.messageNone&&this.scrollBottom()},initTitle(){this.chatType!=f.M_CHAT_CLUB&&this.initNavBarRBtnType("menu",0),this.isAddTitleClick||(this.currentWebview.getTitleNView().addEventListener("click",this.clickTitle,!1),this.isAddTitleClick=!0)}},onShow(){this.setCurChat(!1)},onHide(){this.setCurChat(!0),uni.hideKeyboard()},onLoad(){uni.$on("event_translate_auto_change",this.onTranslateAutoChange)},onUnload(){uni.$off("event_translate_auto_change",this.onTranslateAutoChange),this.setCurChat(!0)}},Gh={"view-content":{"":{flexDirection:"row",alignItems:"center"}},"op-item":{"":{height:"72rpx",width:"146rpx",textAlign:"center",lineHeight:"72rpx",fontSize:"28rpx"}},"op-text":{"":{height:"72rpx",width:"146rpx",textAlign:"center",lineHeight:"72rpx",fontSize:"28rpx",color:"#FFFFFF"}}},Wh={emits:["onMsgItemPopDel","onMsgItemPopReply"],data(){return{size:{},msgData:{},msgListType:0,msgIndex:0,contentList:[],fromAdmin:!1,fromKefu:!1}},computed:{viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#444444":"#555555"}},methods:{clickItem(e){switch(e){case"delete":this.$emit("onMsgItemPopDel",{msgData:this.msgData,listType:this.msgListType,index:this.msgIndex});break;case"report":q("/pagesPub/my/report",{type:1,targetId:this.msgData.send_uid});break;case"copy":let t=this.msgData.content.content;if(this.msgData.content.text){t=this.msgData.content.text;for(let i=0,a=this.msgData.content.info.length;i<a;i++)t=t.replace("[x]",this.msgData.content.info[i].text)}wr(t);break;case"admin_del":it(je("tips"),je("deleteMsgForAllTip"),()=>{let i={chat_id:this.msgData.chat_id,chat_type:this.msgData.chat_type,mtime:this.msgData.mtime,target_uid:this.msgData.uid};i.target_uid=this.msgData.chat_type==1?this.msgData.uid:this.msgData.send_uid,B.request("/admin/msg/delete",i,!0).then(()=>{this.$emit("onMsgItemPopDel",{msgData:this.msgData,listType:this.msgListType,index:this.msgIndex})})},"",je("delete"),!0,je("cancel"));break;case"admin_del_ass":it(je("tips"),je("deleteMsgForAllTip"),()=>{let i={chat_id:f.SYSTEM_ID,chat_type:this.msgData.chat_type,mtime:this.msgData.mtime,target_uid:this.msgData.chat_id,status:3};B.request("/admin/msg/delete",i,!0).then(()=>{this.$emit("onMsgItemPopDel",{msg_status:et.KEFU_DEL,msgData:this.msgData,listType:this.msgListType,index:this.msgIndex})})},"",je("delete"),!0,je("cancel"));break;case"reply":this.$emit("onMsgItemPopReply",{msgData:this.msgData,listType:this.msgListType,index:this.msgIndex});break}},parseContentList(){if(this.contentList=[],this.fromAdmin)this.msgData.chat_type==f.M_CHAT_ASS?!this.msgData.is_del&&this.msgData.msg_status!=et.KEFU_DEL&&([f.M_TEXT,f.M_IMG,f.M_VIDEO,f.M_EXPRESSION].indexOf(this.msgData.msg_type)!=-1&&this.contentList.push({key:"admin_del_ass",title:je("delete")}),this.msgData.msg_status!=et.FAIL&&this.contentList.unshift({key:"reply",title:u("reply")})):this.msgData.is_del||this.contentList.push({key:"admin_del",title:je("delete")});else{this.contentList.push({key:"delete",title:u("delete")});let e=[f.M_CHAT_NOTICE,f.M_CHAT_NOTIFY,f.M_CHAT_CLUB_NOTICE].indexOf(this.msgData.chat_type)!=-1;!this.msgData.isSend&&this.msgData.msg_type!=f.M_GIFT&&!e&&this.contentList.push({key:"report",title:u("report")}),this.msgData.msg_status!=et.FAIL&&this.contentList.unshift({key:"reply",title:u("reply")})}this.msgData.msg_type==f.M_TEXT&&this.contentList.unshift({key:"copy",title:u("copy")})},open(e,t=!1,i=!1){this.size=e.size,this.msgData=e.data,this.msgListType=e.listType,this.msgIndex=e.index,this.fromAdmin=t,this.fromKefu=i,this.parseContentList(),!(this.contentList.length<=0)&&this.$refs.refPop.open()}}};function jh(e,t,i,a,n,s){let r=A((0,be.resolveDynamicComponent)("custom-popover"),pt);return(0,be.openBlock)(),(0,be.createBlock)(r,{ref:"refPop",size:n.size,bgColor:s.viewBg,"triangle-is-top":!1},{default:(0,be.withCtx)(()=>[(0,be.createElementVNode)("view",{class:"view-content"},[((0,be.openBlock)(!0),(0,be.createElementBlock)(be.Fragment,null,(0,be.renderList)(n.contentList,(l,c)=>((0,be.openBlock)(),(0,be.createElementBlock)("u-text",{key:"op_"+c,onClick:p=>s.clickItem(l.key),class:"op-text"},(0,be.toDisplayString)(l.title),9,["onClick"]))),128))])]),_:1},8,["size","bgColor"])}var No=v(Wh,[["render",jh],["styles",[Gh]]]);var Bo={data(){return{playTimer:!1,isPlayingByTouch:!1,mAudioInner:uni.createInnerAudioContext(),mLastPlayCTime:0}},methods:{clickMsgVoice(e,t){let i=this.$refs[`msg${e.ctime}`][0];if(!i)return;if(!e.isSend&&e.content.voice_unread==0&&(e.content.voice_unread=1,nt(this.chatId,this.chatType,e.ctime,JSON.stringify(e.content))),typeof this.mAudioInner.paused!="undefined"&&!this.mAudioInner.paused&&(this.mAudioInner.stop(),this.playTimer&&clearInterval(this.playTimer),this.$refs[`msg${this.mLastPlayCTime}`][0].changeIcon(!1),this.mLastPlayCTime==e.ctime)){this.mLastPlayCTime=0;return}this.mAudioInner.src=mr(e.content.voice_url),this.mAudioInner.startTime=t,this.mLastPlayCTime=e.ctime,this.mAudioInner.play(),this.handlePlayTimer(e.ctime),i.changeIcon(!0)},onMsgVoiceChange(e,t,i){if(!e){this.scrollable=!1,!this.mAudioInner.paused&&i.ctime==this.mLastPlayCTime?(this.isPlayingByTouch=!0,this.mAudioInner.pause(),this.playTimer&&clearInterval(this.playTimer)):this.isPlayingByTouch=!1;return}this.scrollable=!0,this.isPlayingByTouch&&(this.mAudioInner.seek(t),this.mAudioInner.play(),this.handlePlayTimer(i.ctime))},handlePlayTimer(e){let t=this.$refs[`msg${e}`][0];this.playTimer&&clearInterval(this.playTimer),this.playTimer=setInterval(()=>{if(this.mAudioInner.paused)return;let i=this.mAudioInner.currentTime,a=Math.round(i*100);isNaN(a)||t.changeDuration(Math.round(i),a)},100)},initAudio(){this.mAudioInner.onEnded(()=>{this.playTimer&&clearInterval(this.playTimer),this.$refs[`msg${this.mLastPlayCTime}`][0].changeIcon(!1),this.$refs[`msg${this.mLastPlayCTime}`][0].changeDuration(-1,0),this.mLastPlayCTime=0}),this.mAudioInner.onError(e=>{this.playTimer&&clearInterval(this.playTimer),this.$refs[`msg${this.mLastPlayCTime}`][0].changeIcon(!1),this.mLastPlayCTime=0})}},onLoad(){this.initAudio()},onUnload(){this.mAudioInner.destroy(),this.playTimer&&clearInterval(this.playTimer)}};var o=ee(ie());var Ci=ee(ie());var Vh={components:{UniIcons:ge},props:{type:{type:String,default:"right"},size:{type:String,default:"28rpx"},modeType:{type:String,default:"desc"},color:{type:String,default:""}},computed:{iconColor(){return y(this.color)?getApp().globalData.themeObj.color[this.modeType]:this.color}}};function zh(e,t,i,a,n,s){let r=A((0,Ci.resolveDynamicComponent)("uni-icons"),ge);return(0,Ci.openBlock)(),(0,Ci.createBlock)(r,{type:i.type,size:i.size,color:s.iconColor},null,8,["type","size","color"])}var Bn=v(Vh,[["render",zh]]);var qe=ee(ie()),$h={"fj-slider":{"":{position:"relative"}},"fj-touch-right":{"":{position:"absolute"}},"fj-line":{"":{position:"absolute",left:0,right:0}}},Kh=xe("dom"),Yh={name:"CustomSlider",emits:["onChanged","onChangeStart","onChange"],props:{fillValue:{type:Number,default:100},maxValue:{type:Number,default:0},step:{type:Number,default:1},activeColor:{type:String,default:"#2F85FC"},inactiveColor:{type:String,default:"#999999"},blockWidth:{type:Number,default:24},lineHeight:{type:Number,default:8},lineRadius:{type:Number,default:4},blockColor:{type:String,default:"#FFFFFF"},disClick:{type:Boolean,default:!1}},data(){return{lineWidth:0,maxLeft:0,lineLeft:0,curValue:0,sMaxValue:0,sFillValue:0,percentage:0,sBlockWidth:uni.upx2px(this.blockWidth),sLineHeight:uni.upx2px(this.lineHeight),sLineTop:(uni.upx2px(this.blockWidth)-uni.upx2px(this.lineHeight))/2,sLineRadius:uni.upx2px(this.lineRadius),getRectInterval:!1}},watch:{maxValue(e,t){this.sMaxValue=e,this.maxLeft=this.sMaxValue/this.percentage,this.checkMaxLeft()},fillValue(e,t){this.sFillValue=this.fillValue}},methods:{clickLine(e){e.stopPropagation(),!this.disClick&&this.touchmove(e,!0)},envir(e){this.getRectInterval=setTimeout(()=>{Kh.getComponentRect(e.refName,t=>{if(clearTimeout(this.getRectInterval),this.getRectInterval=!1,t&&t.size&&t.size.height!=0){let i=t.size;e.fn({width:i.width,height:i.height,top:i.top,bottom:i.bottom,left:i.left,right:i.right})}else this.envir(e)})},100)},touchstart(e){this.$emit("onChangeStart",this.curValue)},touchmove(e,t){e.stopPropagation();let i;if(t?i=e.changedTouches[0].screenX-this.lineLeft:i=e.touches[0].screenX-this.lineLeft,i<0||i>this.lineWidth)return;let a=Math.ceil(i);a>this.lineWidth&&(a=this.lineWidth),this.curValue=Math.round(a*this.percentage),this.maxLeft=Math.ceil(i),this.checkMaxLeft(),this.$emit("onChange",this.curValue)},touchend(e){if(this.step===1)this.sMaxValue=this.curValue;else{let t=Math.round(this.maxLeft*this.percentage/this.step);this.sMaxValue=t*this.step,this.sFillValue-this.sMaxValue<this.step&&(this.sMaxValue=this.sFillValue),this.maxLeft=this.sMaxValue/this.percentage}M("info","at components/custom-slider/custom-slider.vue:179","m-slider onChanged "+this.curValue),this.$emit("onChanged",this.curValue)},checkMaxLeft(){this.maxLeft>this.lineWidth-this.sBlockWidth?this.maxLeft=this.lineWidth-this.sBlockWidth:this.maxLeft<=4&&(this.maxLeft=0)}},mounted(){this.$nextTick(()=>{this.envir({className:".fj-line",refName:this.$refs["fj-line"],fn:e=>{this.lineWidth=e.width,this.lineLeft=e.left,this.sMaxValue=this.maxValue>0?this.maxValue:0,this.sFillValue=this.fillValue>0?this.fillValue:0,this.percentage=this.sFillValue/this.lineWidth,this.maxLeft=this.sMaxValue/this.percentage}})})},unmounted(){this.getRectInterval&&clearTimeout(this.getRectInterval)}};function Jh(e,t,i,a,n,s){return(0,qe.openBlock)(),(0,qe.createElementBlock)("view",{class:"fj-slider",onTouchend:t[3]||(t[3]=(...r)=>s.clickLine&&s.clickLine(...r)),renderWhole:!0},[(0,qe.createElementVNode)("view",{class:"fj-line",ref:"fj-line",style:(0,qe.normalizeStyle)({background:i.inactiveColor,height:`${n.sLineHeight}px`,top:`${n.sLineTop}px`,borderRadius:`${n.sLineRadius}px`})},null,4),(0,qe.createElementVNode)("view",{class:"fj-line",style:(0,qe.normalizeStyle)({width:`${Math.abs(n.maxLeft)}px`,background:i.activeColor,height:`${n.sLineHeight}px`,top:`${n.sLineTop}px`,borderTopLeftRadius:`${n.sLineRadius}px`,borderBottomLeftRadius:`${n.sLineRadius}px`})},null,4),(0,qe.createElementVNode)("view",{class:"fj-touch-right",onTouchstart:t[0]||(t[0]=(...r)=>s.touchstart&&s.touchstart(...r)),onTouchmove:t[1]||(t[1]=(...r)=>s.touchmove&&s.touchmove(...r)),onTouchend:t[2]||(t[2]=(...r)=>s.touchend&&s.touchend(...r)),style:(0,qe.normalizeStyle)({left:`${n.maxLeft}px`,background:i.blockColor,width:`${n.sBlockWidth}px`,height:`${n.sBlockWidth}px`,borderRadius:`${n.sBlockWidth/2}px`})},null,36)],32)}var Pn=v(Yh,[["render",Jh],["styles",[$h]]]);var Et=ee(ie()),qh={emits:["click"],props:{data:{type:Object,default(){return{text:"",info:[],click:[]}}},fontSize:{type:String,default:"24rpx"},color:{type:String,default(){return getApp().globalData.themeObj.color.title}},selectable:{type:Boolean,default:!1}},data(){return{version:0,nodes:[{name:"div",children:[]}]}},watch:{data(){this.parse()}},methods:{click(e){let t=Array.isArray(this.data.click)?this.data.click[0]:this.data.click;t&&(t.disabled||(e.stopPropagation(),t.action==1?q("/pages/main/user-home",{uid:t.id}):t.action==2?Pt(t.id,t.member,0):t.action==3?wt(0,1):t.action==4?Fi(t.id):t.action==5?Ii(t.url,!1):t.action==6?Ii(t.url,!0):t.action==100?q(t.url):t.action==101&&this.$emit("click")))},parseTextV1(e,t,i,a="",n=""){let s={type:"text",text:`${t?"&nbsp;":""}${e}${i?"&nbsp;":""}`},r="";return a!=""&&(r+=`color:${a};`),n!=""&&(r+=`font-size:${n};`),r!=""&&(s.attrs={style:r}),s},parseDataV1(){let e=[];if(this.data.text=="[x]"){let i=this.data.info[0];this.nodes[0].children=[this.parseTextV1(i.text,!1,!1,i.color)];return}let t=this.data.text.split("[x]");for(let i=0,a=t.length;i<a;i++){let n=t[i];n!=""&&e.push(this.parseTextV1(n,!1,!1,this.color));let s=this.data.info[i];if(s){let r,l;try{y(n)||n.endsWith('"')?r=!1:r=!0;let p=t[i+1];y(p)||p.startsWith('"')||p.startsWith(",")||p.startsWith(".")?l=!1:l=!0}catch(p){r=!0,l=!0}let c="";s.user_info?s.user_info.uid==getApp().pubUser.uid?c=s.self:c=s.nickname:c=s.text,e.push(this.parseTextV1(c,r,l,s.color))}}e.length>1&&(this.nodes[0].children=e)},parseText(e,t="",i=""){let a={type:"text",text:`${e}`},n="";return y(t)||(n+=`color:${t};`),y(i)||(n+=`font-size:${i};`),n!=""&&(a.attrs={style:n}),a},parse(){let e=this.data.text.split(/(\[%\w+%\])/).filter(function(i){return i!==""});if(e.length<=1){this.parseDataV1();return}let t=[];for(let i=0,a=e.length;i<a;i++){let n=e[i];if(n.startsWith("[%")){let r=n.replace(/[\s+,\[%,%\]]/g,""),l=this.data.info[r];if(y(l)||y(l.text))continue;t.push(this.parseText(l.text,l.color,l.fontSize))}else n.startsWith(" ")&&(n=`&nbsp;${n}`),n.endsWith(" ")&&(n=`${n}&nbsp;`),t.push(this.parseText(n,this.color))}t.length>1&&(this.nodes[0].children=t)}},created(){y(this.data.text)||this.parse()}};function Xh(e,t,i,a,n,s){let r=(0,Et.resolveComponent)("rich-text");return(0,Et.openBlock)(),(0,Et.createBlock)(r,{onClick:s.click,nodes:n.nodes,selectable:i.selectable,style:(0,Et.normalizeStyle)({color:i.color,fontSize:i.fontSize})},null,8,["onClick","nodes","selectable","style"])}var It=v(qh,[["render",Xh]]);var z=ee(ie());var Zh={"tran-flex":{"":{flexDirection:"row",alignItems:"center"}},"view-tran":{"":{flexDirection:"row",justifyContent:"center",alignItems:"center"}},"text-a":{"":{fontSize:"20rpx"}},"text-tran":{"":{fontSize:"26rpx",marginLeft:"8rpx"}},"text-end":{"":{color:"#999999",fontSize:"24rpx",marginLeft:"4rpx"}}},Qh={components:{MLine:At},emits:["onTranslateFinish","onTranslateClick"],props:{text:{type:String,default:""},border:{type:Boolean,default:!1},showTran:{type:Boolean,default:!0},showTranContent:{type:Boolean,default:!0},contentTop:{type:Number,default:20},showTranEnd:{type:Boolean,default:!1},bg:{type:[Boolean,String],default:!1},textColor:{type:String,default(){return getApp().globalData.themeObj.color.barBtn}},aColor:{type:String,default:"#FFFFFF"},contentColor:{type:String,default(){return getApp().globalData.themeObj.color.title}},isAuto:{type:Boolean,default:!1},isAutoForce:{type:Boolean,default:!1},translateResult:{type:String,default:""},fromLanguage:{type:String,default:""},apiParams:{type:Object,default(){return{}}},translateSize:{type:String,default:"24rpx"},paddingTop:{type:String,default:"10rpx"},fw:{type:Number,default:0}},data(){return{transStatus:0,tranContent:""}},watch:{text(e){e&&(this.transStatus=0,this.tranContent="",this.executeTranAuto())},translateResult(e){this.transStatus=0,this.tranContent="",this.executeTranAuto()}},computed:{borderStyle(){return this.border?{"border-radius":"4px","padding-left":"10rpx","padding-right":"10rpx","padding-top":this.paddingTop}:{}},viewStyle(){if(this.border){let e=getApp().globalData.themeObj.style==F.LIGHT?"#624A8E":"#7D8288";return{"border-radius":"4px",width:"32rpx",height:"32rpx",background:this.bg||e}}return{opacity:"0.89","border-radius":"2px",width:"26rpx",height:"26rpx",background:this.bg||"#FF4477"}},contentStyle(){let e={marginTop:`${this.contentTop}rpx`,color:this.contentColor,fontSize:this.translateSize};return this.fw>0&&(e["font-weight"]=this.fw),e},tranIconSrc(){return"s/pub/tran_end_1.png"},tranStr(){return this.isAuto?u("autoTranslation"):u("translation")},translateStr(){return u("translate")}},methods:{clickTranEndView(e){(this.isAuto||this.isAutoForce)&&(e&&e.stopPropagation(),gn())},clickThis(e){e&&e.stopPropagation(),this.reqTranslate()&&((this.isAuto||this.isAutoForce)&&this.$emit("onTranslateClick"),ws(!0))},handleTranRes(e){this.transStatus=2,this.showTranContent&&(this.tranContent=e),this.$emit("onTranslateFinish",{text:e})},reqTranslate(){if(y(this.text)||this.transStatus!=0)return!1;if(this.translateResult)return this.handleTranRes(this.translateResult),!0;this.transStatus=1;let e=this.apiParams;return e.target=getApp().globalData.translateKey,e.content=this.text,B.request("/translate/index",e,!1,!0).then(t=>{t.ok==1&&t.data.text&&this.handleTranRes(t.data.text)},t=>{this.transStatus=0}),!0},executeTranAuto(){(this.isAutoForce||this.isAuto&&mn(this.fromLanguage))&&this.$nextTick(()=>{this.reqTranslate()})}},created(){if(!(!this.isAuto&&!this.isAutoForce)&&getApp().globalData.translateAuto){if(this.translateResult){this.transStatus=2,this.tranContent=this.translateResult;return}this.executeTranAuto()}}};function em(e,t,i,a,n,s){let r=A((0,z.resolveDynamicComponent)("l-img"),P),l=(0,z.resolveComponent)("m-line");return(0,z.openBlock)(),(0,z.createElementBlock)("view",{style:(0,z.normalizeStyle)([s.borderStyle,{background:"transparent"}]),renderWhole:!0},[n.transStatus!=2?((0,z.openBlock)(),(0,z.createElementBlock)("view",{key:0,onClick:t[0]||(t[0]=(0,z.withModifiers)((...c)=>s.clickThis&&s.clickThis(...c),["stop"])),class:"tran-flex"},[(0,z.createElementVNode)("view",{class:"view-tran",style:(0,z.normalizeStyle)(s.viewStyle)},[n.transStatus==1?((0,z.openBlock)(),(0,z.createBlock)(r,{key:0,src:"s/pub/tran_load_1.gif",w:"20rpx",h:"20rpx","is-gif":!0})):n.transStatus==0?((0,z.openBlock)(),(0,z.createElementBlock)("u-text",{key:1,class:"text-a",style:(0,z.normalizeStyle)({color:`${i.aColor}`})},"A",4)):(0,z.createCommentVNode)("",!0)],4),i.showTran?((0,z.openBlock)(),(0,z.createElementBlock)("u-text",{key:0,class:"text-tran",style:(0,z.normalizeStyle)({color:i.textColor})},(0,z.toDisplayString)(s.translateStr),5)):(0,z.createCommentVNode)("",!0)])):n.tranContent?((0,z.openBlock)(),(0,z.createElementBlock)("view",{key:1},[(0,z.createVNode)(l),(0,z.createElementVNode)("u-text",{style:(0,z.normalizeStyle)(s.contentStyle)},(0,z.toDisplayString)(n.tranContent),5),i.showTranEnd?((0,z.openBlock)(),(0,z.createElementBlock)("view",{key:0,onClick:t[1]||(t[1]=(...c)=>s.clickTranEndView&&s.clickTranEndView(...c)),class:"tran-flex",style:{"margin-top":"8rpx"}},[(0,z.createVNode)(r,{src:s.tranIconSrc,w:"30rpx",h:"30rpx"},null,8,["src"]),(0,z.createElementVNode)("u-text",{class:"text-end"},(0,z.toDisplayString)(s.tranStr),1)])):(0,z.createCommentVNode)("",!0)])):(0,z.createCommentVNode)("",!0)],4)}var qs=v(Qh,[["render",em],["styles",[Zh]]]);var by=ee(ie());function Xs(e,t,i,a,n=!0){return new Promise(s=>{let r;n?r=`UPDATE tb_msg_sys_v1 SET msg_content = '${me(a)}' WHERE chat_id = ${e} AND chat_type = ${t} AND mtime = ${i}`:r=`UPDATE tb_msg_sys_v1 SET msg_content = '${me(a)}' WHERE chat_id = ${e} AND chat_type = ${t} AND ctime = ${i}`,ye(r).then(l=>{s()})})}var w=ee(ie());var tm={"view-this":{"":{flexDirection:"row",alignItems:"center",position:"relative",marginRight:"8rpx"}},"text-level":{"":{width:"50rpx",lineHeight:"50rpx",textAlign:"center",color:"#FFFFFF",position:"absolute",top:0}}},im={props:{info:{type:Object,default(){return{}}},vipAlways:{type:Boolean,default:!1},levelAlways:{type:Boolean,default:!1},hideVip:{type:Boolean,default:!1}},computed:{show(){return this.info.is_auth||this.info.level>0||this.showVip||this.levelAlways},showVip(){return this.hideVip?!1:this.info.is_vip?this.info.hide_vip?this.vipAlways:!0:!1},showLevel(){return!this.info.hide_level&&(this.info.level>0||this.info.is_auth)?!0:this.levelAlways},levelStr(){let e=this.info.is_auth?1:0;return this.info.level<=0?e:this.info.level},levelSrc(){return this.info.sex==2?"s/pub/level_a.png":"s/pub/level_c.png"},levelSize(){return this.info.level>99?"10rpx":this.info.level>9?"14rpx":"16rpx"},levelWeight(){return this.info.level>99?"bold":"normal"}}};function nm(e,t,i,a,n,s){let r=A((0,w.resolveDynamicComponent)("l-img"),P);return s.show?((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:0,class:"view-this",renderWhole:!0},[s.showLevel?((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:0},[(0,w.createVNode)(r,{src:s.levelSrc,w:"50rpx",h:"50rpx"},null,8,["src"]),(0,w.createElementVNode)("u-text",{class:"text-level",style:(0,w.normalizeStyle)({fontSize:s.levelSize,fontWeight:s.levelWeight})},(0,w.toDisplayString)(s.levelStr),5)])):(0,w.createCommentVNode)("",!0),s.showVip?((0,w.openBlock)(),(0,w.createBlock)(r,{key:1,src:"s/pub/vip_3.png",w:"56rpx",h:"24rpx",style:{"margin-left":"8rpx"}})):(0,w.createCommentVNode)("",!0)])):(0,w.createCommentVNode)("",!0)}var Po=v(im,[["render",nm],["styles",[tm]]]),sm={center:{"":{alignItems:"center",flexDirection:"row"}},"m-l-4":{"":{marginLeft:"8rpx"}},"m-r-4":{"":{marginRight:"8rpx"}}},am={props:{user:{type:Object,default(){return{}}},imgW:{type:Number,default:40},imgH:{type:Number,default:26},fontSize:{type:Number,default:24},color:{type:String,default:""},showName:{type:Boolean,default:!1},showCode:{type:Boolean,default:!0},desc:{type:Boolean,default:!1}},computed:{defClass(){let e={fontSize:`${this.fontSize}rpx`};return y(this.color)?e.color=getApp().globalData.themeObj.color.title:e.color=this.color,e}}};function rm(e,t,i,a,n,s){let r=A((0,w.resolveDynamicComponent)("l-img"),P);return i.user.country_code&&!i.desc?((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:0,class:"center"},[(0,w.createVNode)(r,{src:i.user.country_flag,w:`${i.imgW}rpx`,h:`${i.imgH}rpx`},null,8,["src","w","h"]),i.showCode&&i.user.country_code?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:0,class:"m-l-4",style:(0,w.normalizeStyle)(s.defClass)},(0,w.toDisplayString)(i.user.country_code.toUpperCase()),5)):(0,w.createCommentVNode)("",!0),i.showName&&i.user.country_name?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:1,class:"m-l-4",style:(0,w.normalizeStyle)(s.defClass)},(0,w.toDisplayString)(i.user.country_name),5)):(0,w.createCommentVNode)("",!0)])):i.user.country_code?((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:1,class:"center m-r-4"},[i.showName&&i.user.country_name?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:0,class:"m-r-4",style:(0,w.normalizeStyle)(s.defClass)},(0,w.toDisplayString)(i.user.country_name),5)):(0,w.createCommentVNode)("",!0),i.showCode&&i.user.country_code?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:1,class:"m-r-4",style:(0,w.normalizeStyle)(s.defClass)},(0,w.toDisplayString)(i.user.country_code.toUpperCase()),5)):(0,w.createCommentVNode)("",!0),(0,w.createVNode)(r,{src:i.user.country_flag,w:`${i.imgW}rpx`,h:`${i.imgH}rpx`},null,8,["src","w","h"])])):(0,w.createCommentVNode)("",!0)}var Ho=v(am,[["render",rm],["styles",[sm]]]),om={"user-info":{"":{flexDirection:"row",alignItems:"center"}},"nickname-nvue":{"":{lines:1,textOverflow:"ellipsis",wordWrap:"anywhere"}},"m-r-4":{"":{marginRight:"8rpx"}},"text-official":{"":{lineHeight:"28rpx",backgroundColor:"#34C759",borderRadius:"4rpx",paddingTop:0,paddingRight:"8rpx",paddingBottom:0,paddingLeft:"8rpx",color:"#FFFFFF",fontSize:"20rpx",fontStyle:"italic",fontWeight:"700",marginRight:"8rpx"}}},lm={components:{LImg:P,CountryCode:Ho,LevelVip:Po},props:{info:{type:Object,default(){return{}}},noName:{type:Number,default:0},nameColor:{type:String,default:""},nameSize:{type:String,default:"26rpx"},nameWidth:{type:String,default:"300rpx"},fw:{type:[String,Number],default:"400"},desc:{type:Boolean,default:!1},isAdmin:{type:Number,default:0},showAge:{type:Boolean,default:!0},showAuth:{type:Boolean,default:!0},showCountry:{type:Boolean,default:!1},showCountryCode:{type:Boolean,default:!0},levelAlways:{type:Boolean,default:!1}},computed:{officialStr(){return this.info.auth_status==9?u("official"):""},age(){if(!this.showAge||y(this.info.birthday)||this.info.hide_profile)return"";let e=oi(this.info.birthday);return y(e)||isNaN(e)?"":`${this.noName?"":", "}${e}`},nicknameText(){return pi(this.info,this.isAdmin)},showCountryInfo(){return this.showCountry&&this.info.hide_profile!=1},nicknameColor(){return y(this.nameColor)?getApp().globalData.themeObj.color.title:this.nameColor}}};function cm(e,t,i,a,n,s){let r=A((0,w.resolveDynamicComponent)("level-vip"),Po),l=A((0,w.resolveDynamicComponent)("country-code"),Ho),c=A((0,w.resolveDynamicComponent)("l-img"),P);return(0,w.openBlock)(),(0,w.createElementBlock)("view",{renderWhole:!0},[i.desc?((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:1,class:"user-info",style:{"justify-content":"flex-end"}},[s.officialStr?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:0,class:"text-official"},(0,w.toDisplayString)(s.officialStr),1)):((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:1,class:"user-info"},[i.showAuth&&i.info.auth_status==1?((0,w.openBlock)(),(0,w.createBlock)(c,{key:0,src:"s/pub/verified_1.png",w:"24rpx",h:"24rpx",style:{"margin-right":"8rpx"}})):(0,w.createCommentVNode)("",!0),s.showCountryInfo?((0,w.openBlock)(),(0,w.createBlock)(l,{key:1,user:i.info,color:s.nicknameColor,desc:i.desc,"show-code":i.showCountryCode},null,8,["user","color","desc","show-code"])):(0,w.createCommentVNode)("",!0),(0,w.createVNode)(r,{info:i.info,"vip-always":i.isAdmin==1,"level-always":i.levelAlways,style:{"margin-right":"8rpx"}},null,8,["info","vip-always","level-always"])])),i.noName?(0,w.createCommentVNode)("",!0):((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:2,class:(0,w.normalizeClass)(["nickname-nvue",[s.age?"":"m-r-4"]]),style:(0,w.normalizeStyle)({color:s.nicknameColor,fontSize:i.nameSize,maxWidth:i.nameWidth,fontWeight:i.fw})},(0,w.toDisplayString)(s.nicknameText),7)),s.age?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:3,class:"nickname-nvue",style:(0,w.normalizeStyle)({color:s.nicknameColor,fontSize:i.nameSize,fontWeight:i.fw})},(0,w.toDisplayString)(s.age),5)):(0,w.createCommentVNode)("",!0)])):((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:0,class:"user-info"},[i.noName?(0,w.createCommentVNode)("",!0):((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:0,class:(0,w.normalizeClass)(["nickname-nvue",[s.age?"":"m-r-4"]]),style:(0,w.normalizeStyle)({color:s.nicknameColor,fontSize:i.nameSize,maxWidth:i.nameWidth,fontWeight:i.fw})},(0,w.toDisplayString)(s.nicknameText),7)),s.age?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:1,class:"nickname-nvue m-r-4",style:(0,w.normalizeStyle)({color:s.nicknameColor,fontSize:i.nameSize,fontWeight:i.fw})},(0,w.toDisplayString)(s.age),5)):(0,w.createCommentVNode)("",!0),s.officialStr?((0,w.openBlock)(),(0,w.createElementBlock)("u-text",{key:2,class:"text-official"},(0,w.toDisplayString)(s.officialStr),1)):((0,w.openBlock)(),(0,w.createElementBlock)("view",{key:3,class:"user-info"},[(0,w.createVNode)(r,{info:i.info,"vip-always":i.isAdmin==1,"level-always":i.levelAlways,style:{"margin-right":"8rpx"}},null,8,["info","vip-always","level-always"]),s.showCountryInfo?((0,w.openBlock)(),(0,w.createBlock)(l,{key:0,user:i.info,color:s.nicknameColor,"show-code":i.showCountryCode,style:{"margin-right":"8rpx"}},null,8,["user","color","show-code"])):(0,w.createCommentVNode)("",!0),i.showAuth&&i.info.auth_status==1?((0,w.openBlock)(),(0,w.createBlock)(c,{key:1,src:"s/pub/verified_1.png",w:"24rpx",h:"24rpx",style:{"margin-right":"8rpx"}})):(0,w.createCommentVNode)("",!0)]))]))])}var $t=v(lm,[["render",cm],["styles",[om]]]);var um={emits:["onChoosePicture"],data(){return{moreActions:[],cameraActions:[]}},methods:{onClickActionItem(e){switch(e.key){case"send_photo":this.chooseImage(1,9);break;case"send_video":this.chooseVideo(1);break;case"take_photo":this.chooseImage(2,1);break;case"take_video":this.chooseVideo(2);break}},chooseImage(e,t){Sr(e,t).then(i=>{let a=i.tempFilePaths;for(let n=0,s=a.length;n<s;n++){let r=a[n];uni.getImageInfo({src:r,success:l=>{let c={path:l.path,width:l.width,height:l.height};this.$emit("onChoosePicture",0,c)}})}})},chooseVideo(e){kr(e,!0).then(t=>{let i={path:t.tempFilePath,coverPath:t.coverPath,width:t.width,height:t.height,duration:parseInt(t.duration)||0};this.$emit("onChoosePicture",1,i)})},onPaidMediaListener(e){let t=e.media_type==f.PHOTO?2:3;this.$emit("onChoosePicture",t,e)}},created(){this.moreActions=[{icon:"s/msg/i_album.png",title:u("sendPhoto"),key:"send_photo"},{icon:"s/msg/i_album_video.png",title:u("sendVideo"),key:"send_video"}],this.cameraActions=[{icon:"s/msg/i_camera_photo.png",title:u("takePhoto"),key:"take_photo"},{icon:"s/msg/i_camera_video.png",title:u("takeVideo"),key:"take_video"}]}},dm={center:{"":{alignItems:"center",flexDirection:"row"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"flex-wrap":{"":{flexWrap:"wrap",flexDirection:"row"}},"msg-bar-express":{"":{position:"relative",backgroundColor:"#FFFFFF",height:0}},"expression-bar":{"":{alignItems:"center",flexDirection:"row",justifyContent:"space-between",backgroundColor:"#FFFFFF",paddingTop:"14rpx",paddingRight:"36rpx",paddingBottom:"14rpx",paddingLeft:"36rpx"}},"choose-item":{".expression-bar ":{width:"72rpx",height:"72rpx",position:"relative",marginRight:"40rpx"}},"delete-icon":{".expression-bar ":{width:"60rpx",height:"60rpx"}},line:{".expression-bar ":{height:1,backgroundColor:"#CCCCCC",transform:"scaleY(0.5)",transformOrigin:"50% 100%",opacity:.5}},"emoji-wrap":{"":{paddingTop:"20rpx",paddingRight:10,paddingBottom:0,paddingLeft:10}},"pig-wrap":{"":{paddingTop:0,paddingRight:5,paddingBottom:"10rpx",paddingLeft:5}},"new-tag":{"":{backgroundColor:"#34C759",lineHeight:"24rpx",paddingTop:0,paddingRight:"6rpx",paddingBottom:0,paddingLeft:"6rpx",borderRadius:"12rpx",color:"#FFFFFF",fontSize:"16rpx",position:"absolute",left:"40rpx"}},"expression-from":{"":{height:"20rpx",paddingTop:0,paddingRight:"8rpx",paddingBottom:0,paddingLeft:"8rpx",borderBottomLeftRadius:"4rpx",position:"absolute",right:0,top:0,zIndex:111}},text:{".expression-from ":{fontSize:"16rpx",fontWeight:"600",lineHeight:"20rpx",marginLeft:"4rpx"}}},pm=xe("animation"),hm={name:"MsgBarAction",components:{LImg:P,MIcon:Bn,MView:Dt},emits:["onOpen"],data(){return{defHeight:Math.round(240*getApp().globalData.window.scaleH),originalHeight:0,isAndroid:f.isAndroid,height:0,emojiList:[],pigList:[],masList:[],screenW:getApp().globalData.window.width,emojiW:0,pigW:0,safeAreaBottom:getApp().globalData.window.safeBottom,swiperCurrent:0,delOpacity:.4,barStyle:{},chooseBgStyle:{borderRadius:"16rpx",background:getApp().globalData.themeObj.color.bg3},showNewTag:!1,expressionFrom:"Flaticon"}},watch:{height(e){this.$emit("onOpen",e>0,e)}},computed:{expressionFromStyle(){let e,t;return getApp().globalData.themeObj.style==F.LIGHT?(e="#FFFFFF",t="#CCCCCC"):(e="#999999",t="#333333"),{color:e,bgColor:t}}},methods:{$str:u,clickClose(){this.open(!1)},clickBarImg(e,t){e&&e.stopPropagation(),this.swiperCurrent=t,t==2&&this.showNewTag&&(this.showNewTag=!1,se("show_new_expression_tag_"+getApp().globalData.uid,"1"))},clickDelete(){uni.$emit("event_delete_text")},clickPig(e,t){if(e&&e.stopPropagation(),wi())return;let i={path:t,width:177,height:177};this.$emit("onChooseExpressImg",i)},clickEmoji(e){this.delOpacity<1&&(this.delOpacity=1),uni.$emit("event_add_emoji_text",e)},onSwiperChange(e){this.swiperCurrent=e.detail.current},isShow(){return this.height>0},setHeight(e){this.originalHeight=e,this.isShow()&&this.height!=this.defHeight&&this.open(!0)},parseExpressions(){this.emojiList=["\u{1F600}","\u{1F603}","\u{1F604}","\u{1F601}","\u{1F606}","\u{1F605}","\u{1F602}","\u{1F923}","\uFE0F\u{1F60A}","\u{1F607}","\u{1F642}","\u{1F643}","\u{1F609}","\u{1F60C}","\u{1F60D}","\u{1F970}","\u{1F618}","\u{1F617}","\u{1F619}","\u{1F61A}","\u{1F60B}","\u{1F61B}","\u{1F61D}","\u{1F61C}","\u{1F92A}","\u{1F928}","\u{1F9D0}","\u{1F913}","\u{1F60E}","\u{1F929}","\u{1F973}","\u{1F60F}","\u{1F612}","\u{1F61E}","\u{1F614}","\u{1F61F}","\u{1F615}","\u{1F641}","\uFE0F\u{1F616}","\u{1F62B}","\u{1F629}","\u{1F97A}","\u{1F622}","\u{1F62D}","\u{1F624}","\u{1F620}","\u{1F621}","\u{1F92C}","\u{1F92F}","\u{1F633}","\u{1F975}","\u{1F976}","\u{1F631}","\u{1F628}","\u{1F630}","\u{1F625}","\u{1F613}","\u{1F917}","\u{1F914}","\u{1F92D}","\u{1F92B}","\u{1F925}","\u{1F636}","\u{1F610}"];for(let e=0,t=23;e<t;e++){let i=e+1;this.pigList.push("s/msg/expression/cat/cat_1_"+i+".png")}for(let e=0,t=19;e<t;e++){let i=e+1;this.masList.push("s/msg/expression/mas/mas_"+i+".png")}},open(e,t){this.height=e?this.originalHeight:0,this.isAndroid?this.barStyle={height:`${this.height}px`}:pm.transition(this.$refs.refBarAction,{styles:{height:`${e?this.originalHeight:0}px`},duration:t?1:this.isAndroid?100:300,timingFunction:"ease",needLayout:!0,delay:0})}},created(){this.parseExpressions(),uni.$on("event_bar_action_can_del",e=>{e&&this.delOpacity>=1||(this.delOpacity=e?1:.4)}),this.originalHeight=getApp().globalData.keyboardH,this.originalHeight==0&&(this.originalHeight=this.defHeight),this.emojiW=parseInt((this.screenW-20)/8),this.pigW=parseInt((this.screenW-10)/5),this.showNewTag=!X("show_new_expression_tag_"+getApp().globalData.uid)},unmounted(){uni.$off("event_bar_action_can_del")}};function mm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("m-icon"),c=(0,o.resolveComponent)("m-view"),p=(0,o.resolveComponent)("swiper-item"),h=(0,o.resolveComponent)("swiper");return(0,o.openBlock)(),(0,o.createElementBlock)("view",{ref:"refBarAction",class:"msg-bar-express",style:(0,o.normalizeStyle)(n.barStyle),renderWhole:!0},[(0,o.createVNode)(c,{type:"bg2",style:(0,o.normalizeStyle)([{"flex-direction":"row","align-items":"center","justify-content":"space-between",padding:"14rpx 36rpx"},{width:n.screenW+"px"}]),class:"expression-bar"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{class:"center"},[(0,o.createElementVNode)("view",{onClick:t[1]||(t[1]=g=>s.clickBarImg(g,0)),class:"choose-item center-align",style:(0,o.normalizeStyle)(n.swiperCurrent==0?n.chooseBgStyle:{background:"transparent"})},[(0,o.createVNode)(r,{onClick:t[0]||(t[0]=g=>s.clickBarImg(g,0)),src:"s/msg/bar_new_smile_face.png",needStyle:1,w:"60rpx",h:"60rpx"})],4),(0,o.createElementVNode)("view",{onClick:t[3]||(t[3]=g=>s.clickBarImg(g,1)),class:"choose-item center-align",style:(0,o.normalizeStyle)(n.swiperCurrent==1?n.chooseBgStyle:{background:"transparent"})},[(0,o.createVNode)(r,{onClick:t[2]||(t[2]=g=>s.clickBarImg(g,1)),src:"s/msg/expression/cat/title.png",w:"60rpx",h:"60rpx"})],4),(0,o.createElementVNode)("view",{style:{position:"relative"}},[(0,o.createElementVNode)("view",{onClick:t[5]||(t[5]=g=>s.clickBarImg(g,2)),class:"choose-item center-align",style:(0,o.normalizeStyle)(n.swiperCurrent==2?n.chooseBgStyle:{background:"transparent"})},[(0,o.createVNode)(r,{onClick:t[4]||(t[4]=g=>s.clickBarImg(g,2)),src:"s/msg/expression/mas/title.png",w:"60rpx",h:"60rpx"})],4),n.showNewTag?((0,o.openBlock)(),(0,o.createElementBlock)("u-text",{key:0,class:"new-tag"},(0,o.toDisplayString)(s.$str("new")),1)):(0,o.createCommentVNode)("",!0)])]),(0,o.createElementVNode)("view",{class:"center"},[(0,o.createElementVNode)("view",{onClick:t[6]||(t[6]=(...g)=>s.clickDelete&&s.clickDelete(...g)),class:"center-align delete-icon",style:(0,o.normalizeStyle)({opacity:n.delOpacity})},[(0,o.createVNode)(r,{src:"s/msg/bar_new_msg_del.png",w:"48rpx",h:"48rpx"})],4),n.isAndroid?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,onClick:t[7]||(t[7]=(...g)=>s.clickClose&&s.clickClose(...g)),class:"center-align delete-icon",style:{"margin-left":"16rpx"}},[(0,o.createVNode)(l,{type:"bottom",size:"36rpx"})])):(0,o.createCommentVNode)("",!0)])]),_:1},8,["style"]),(0,o.createVNode)(h,{current:n.swiperCurrent,onChange:s.onSwiperChange,style:(0,o.normalizeStyle)({height:n.originalHeight-50+"px"})},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(p,{class:"swiper-item"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(c,{type:"bg1"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("scroll-view",{scrollY:"true",class:"emoji-wrap",showScrollbar:!1,style:(0,o.normalizeStyle)({height:n.originalHeight-50+"px"})},[(0,o.createElementVNode)("view",{class:"flex-wrap",style:(0,o.normalizeStyle)({paddingBottom:n.safeAreaBottom+"px"})},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.emojiList,(g,_)=>((0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"center-align",onClick:C=>s.clickEmoji(g),key:"e"+_,style:(0,o.normalizeStyle)({width:n.emojiW+"px",height:n.emojiW+"px"})},[(0,o.createElementVNode)("u-text",{style:{"font-size":"60rpx"}},(0,o.toDisplayString)(g),1)],12,["onClick"]))),128))],4)],4)]),_:1})]),_:1}),(0,o.createVNode)(p,{class:"swiper-item"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(c,{type:"bg1"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("scroll-view",{scrollY:"true",class:"pig-wrap",showScrollbar:!1,style:(0,o.normalizeStyle)({height:n.originalHeight-50+"px"})},[(0,o.createElementVNode)("view",{style:{width:"2px","min-height":"10px"}}),(0,o.createElementVNode)("view",{class:"flex-wrap"},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.pigList,(g,_)=>((0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"center-align",onClick:C=>s.clickPig(C,g),key:"p"+_,style:(0,o.normalizeStyle)({width:n.pigW+"px",height:n.pigW+"px"})},[(0,o.createVNode)(r,{onClick:C=>s.clickPig(C,g),src:g,w:n.pigW-14+"px",h:n.pigW-14+"px"},null,8,["onClick","src","w","h"])],12,["onClick"]))),128))])],4),(0,o.createElementVNode)("view",{class:"expression-from center",style:(0,o.normalizeStyle)({background:s.expressionFromStyle.bgColor})},[(0,o.createVNode)(r,{src:"s/msg/expression_from.png",w:"16rpx",h:"16rpx","need-style":1}),(0,o.createElementVNode)("u-text",{class:"text",style:(0,o.normalizeStyle)({color:s.expressionFromStyle.color})},(0,o.toDisplayString)(n.expressionFrom),5)],4)]),_:1})]),_:1}),(0,o.createVNode)(p,{class:"swiper-item"},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(c,{type:"bg1"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("scroll-view",{scrollY:"true",class:"pig-wrap",showScrollbar:!1,style:(0,o.normalizeStyle)({height:n.originalHeight-50+"px"})},[(0,o.createElementVNode)("view",{style:{width:"2px","min-height":"10px"}}),(0,o.createElementVNode)("view",{class:"flex-wrap"},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.masList,(g,_)=>((0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"center-align",onClick:C=>s.clickPig(C,g),key:"m"+_,style:(0,o.normalizeStyle)({width:n.pigW+"px",height:n.pigW+"px"})},[(0,o.createVNode)(r,{onClick:C=>s.clickPig(C,g),src:g,w:n.pigW-20+"px",h:n.pigW-20+"px"},null,8,["onClick","src","w","h"])],12,["onClick"]))),128))])],4),(0,o.createElementVNode)("view",{class:"expression-from center",style:(0,o.normalizeStyle)({background:s.expressionFromStyle.bgColor})},[(0,o.createVNode)(r,{src:"s/msg/expression_from.png",w:"16rpx",h:"16rpx","need-style":1}),(0,o.createElementVNode)("u-text",{class:"text",style:(0,o.normalizeStyle)({color:s.expressionFromStyle.color})},(0,o.toDisplayString)(n.expressionFrom),5)],4)]),_:1})]),_:1})]),_:1},8,["current","onChange","style"])],4)}var gm=v(hm,[["render",mm],["styles",[dm]]]),fm={"msg-bar-audio-content":{"":{height:"96rpx",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},"view-doing":{"":{flexDirection:"row",alignItems:"center",paddingLeft:"30rpx"}},"text-duration":{"":{width:"80rpx",textAlign:"center",fontSize:"28rpx",color:"#333333"}},"view-middle":{"":{height:"96rpx",flexDirection:"row",alignItems:"center",justifyContent:"center",position:"absolute",bottom:0}},"view-scroll-cancel":{"":{flexDirection:"row",alignItems:"center"}},"text-cancel-scroll":{"":{color:"#333333",fontSize:"28rpx",marginRight:"2rpx"}},"text-cancel":{"":{fontSize:"34rpx",color:"#333333",fontWeight:"600"}},"view-preview-middle":{"":{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",height:"80rpx",borderRadius:"40rpx"}},"text-audio-duration":{"":{color:"#333333",fontSize:"28rpx",marginRight:"12rpx",marginLeft:"12rpx"}},"view-record-btn":{"":{height:"100rpx",width:"120rpx",alignItems:"center",justifyContent:"center",flexDirection:"row"}}},Vi=uni.getRecorderManager(),_m={components:{MIcon:Bn,MText:de,CustomSlider:Pn},emits:["onAudioCancel","onAudioFinish"],props:{maxDuration:{type:Number,default:300},onlyVoice:{type:Boolean,default:!1}},data(){return{screenW:getApp().globalData.window.width,showDoing:!0,recordTimer:!1,recordDuration:0,cancelX:getApp().globalData.window.width/2+40,cancelW:getApp().globalData.window.width,touchRightX:0,lastX:0,isCancel:!1,isLock:!1,recordFinishSend:!0,mAudioInner:uni.createInnerAudioContext(),audioPath:"",audioDuration:0,audioDurationPlay:0,audioPlayerTimer:!1,audioSliderValue:0,audioSliderChanging:!1,audioPlayerIcon:"s/msg/audio_play_1.png"}},computed:{getSafeBottom(){return this.onlyVoice?0:getApp().globalData.window.safeBottom},durationStr(){return this.recordDuration<=0?"00:00":tt(this.recordDuration)},playDurationStr(){return this.audioDurationPlay<=0?"00:00":tt(this.audioDurationPlay)},viewBg(){return getApp().globalData.themeObj.color.bg2},viewMiddleBg(){return getApp().globalData.themeObj.color.bg3},sliderActColor(){return getApp().globalData.themeObj.style==F.LIGHT?"#333333":"#FFFFFF"},sliderBgColor(){return getApp().globalData.themeObj.style==F.LIGHT?"#CCCCCC":"rgba(255, 255, 255, 0.1)"}},methods:{$str:u,clickCancel(e){e.stopPropagation(),this.isCancel=!0,this.stopRecord(!1),this.$emit("onAudioCancel")},clickDel(){this.$emit("onAudioCancel")},clickSend(){this.$emit("onAudioFinish",!0,{path:this.audioPath,duration:this.audioDuration})},clickPlay(){this.mAudioInner.paused?(this.mAudioInner.play(),this.handlePlayerInterval()):(this.mAudioInner.pause(),this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer))},onSliderChangeStart(){this.audioSliderChanging=!0},onSliderChanged(e){this.audioSliderChanging=!1;let t=e/100,i=parseInt(this.audioDuration*t);this.audioDurationPlay=i,this.mAudioInner.seek(this.audioDuration*t)},onTouchMoveLeft(e){if(!this.isLock&&!this.isCancel){if(this.lastX!=0){let t=e-this.lastX;this.touchRightX-=t,this.touchRightX<0&&(this.touchRightX=0),this.cancelW+=t}this.lastX=e,e<this.cancelX&&(this.isCancel=!0,this.stopRecord(!1),this.$emit("onAudioCancel"))}},stopRecord(e){this.recordFinishSend=e,this.recordTimer&&clearInterval(this.recordTimer),this.recordTimer=!1,this.recordDuration=0,Vi.stop()},startRecord(){this.$nextTick(()=>{this.startIconDoingAnim(),setTimeout(()=>{this.startBtnAnim()},300),this.startRecordTimer(),Vi.start({duration:this.maxDuration*1e3,format:"aac"})})},startIconDoingAnim(){let e={duration:800};this.$refs.animPoint.step({opacity:.2},e),this.$refs.animPoint.step({opacity:1},e),this.$refs.animPoint.run(()=>{this.startIconDoingAnim()})},startBtnAnim(){this.$refs.animBtn.step({scale:1.3,opacity:0},{duration:1e3}),this.$refs.animBtn.step({scale:1,opacity:1},{duration:1}),this.$refs.animBtn.run(()=>{this.startBtnAnim()})},startRecordTimer(){this.recordTimer||(this.recordTimer=setInterval(()=>{if(this.recordDuration>=this.maxDuration){this.stopRecord(!0);return}this.recordDuration+=1},1e3))},changeAudioLock(){this.isLock=!0,this.touchRightX=0},changeAudioStop(){this.showDoing=!1,this.stopRecord(!1)},initAudioPreview(){this.mAudioInner.src=this.audioPath,this.audioDurationPlay=this.audioDuration},handlePlayerInterval(){this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer),this.audioPlayerTimer=setInterval(()=>{let e=this.mAudioInner.currentTime,t=parseInt(e*100);isNaN(t)||(this.audioDurationPlay=parseInt(e),this.audioSliderChanging||(this.audioSliderValue=parseInt(t/this.audioDuration)))},100)},audioOnEndedListener(e){this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer),this.audioSliderValue=0,this.audioDurationPlay=this.audioDuration,this.audioPlayerIcon="s/msg/audio_play_1.png"},audioOnPlayListener(){this.audioPlayerIcon="s/msg/audio_pause_1.png"},audioOnPauseListener(){this.audioPlayerIcon="s/msg/audio_play_1.png"}},created(){Vi.onStop(e=>{if(this.isCancel)return;M("info","at pagesMsg/coms/msg-bar/msg-bar-audio.vue:244","----> record finish "+JSON.stringify(e));let t=uni.createInnerAudioContext(),i=e.tempFilePath,a=setTimeout(()=>{clearTimeout(a),t.destroy(),this.$emit("onAudioFinish",!1)},2e3);t.src=i,t.onCanplay(()=>{let n=t.duration;clearTimeout(a),M("info","at pagesMsg/coms/msg-bar/msg-bar-audio.vue:258","-----> \u5B8C\u6210\u5F55\u5236 \u65F6\u957F = "+n),t.destroy(),this.recordFinishSend?n<1?this.$emit("onAudioFinish",!1):this.$emit("onAudioFinish",!0,{path:i,duration:Math.round(n)}):(this.audioPath=i,this.audioDuration=Math.round(n),this.initAudioPreview())})}),Vi.onError(e=>{M("error","at pagesMsg/coms/msg-bar/msg-bar-audio.vue:275","----> MsgBarAudio mRecordManager onError "+JSON.stringify(e)),this.$emit("onAudioFinish",!1)}),this.mAudioInner.onEnded(this.audioOnEndedListener),this.mAudioInner.onPlay(this.audioOnPlayListener),this.mAudioInner.onPause(this.audioOnPauseListener)},beforeUnmount(){this.mAudioInner.destroy(),this.recordTimer&&(clearInterval(this.recordTimer),this.isCancel=!0,Vi.stop()),this.audioPlayerTimer&&clearInterval(this.audioPlayerTimer)}};function ym(e,t,i,a,n,s){let r=(0,o.resolveComponent)("m-text"),l=(0,o.resolveComponent)("m-icon"),c=A((0,o.resolveDynamicComponent)("l-img"),P),p=A((0,o.resolveDynamicComponent)("uni-transition"),Ct),h=A((0,o.resolveDynamicComponent)("uni-icons"),ge),g=(0,o.resolveComponent)("CustomSlider");return(0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"msg-bar-audio",style:(0,o.normalizeStyle)({width:`${n.screenW}px`}),renderWhole:!0},[n.showDoing?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"msg-bar-audio-content",style:(0,o.normalizeStyle)({background:s.viewBg})},[(0,o.createElementVNode)("view",{class:"view-middle",style:(0,o.normalizeStyle)({width:`${n.cancelW}px`})},[n.isLock?((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,text:s.$str("cancel"),onClick:s.clickCancel,style:{"font-size":"34rpx","font-weight":"600"}},null,8,["text","onClick"])):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,class:"view-scroll-cancel"},[(0,o.createVNode)(r,{text:s.$str("msg.slideCancel"),style:{"font-size":"28rpx","margin-right":"2rpx"}},null,8,["text"]),(0,o.createVNode)(l,{type:"left",size:"30rpx","mode-type":"title"})]))],4),(0,o.createElementVNode)("view",{class:"view-doing"},[(0,o.createVNode)(p,{ref:"animPoint",show:!0},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(c,{src:"s/msg/audio_point.png",w:"54rpx",h:"54rpx"})]),_:1},512),(0,o.createVNode)(r,{text:s.durationStr,style:{width:"80rpx","text-align":"center","font-size":"28rpx"}},null,8,["text"])]),(0,o.createElementVNode)("view",{style:(0,o.normalizeStyle)({marginRight:`${n.touchRightX}px`}),class:"view-record-btn"},[(0,o.createVNode)(p,{ref:"animBtn",show:!0,style:{"background-image":"linear-gradient(to bottom, #FF0DAD, #FF4B63)",width:"80rpx",height:"80rpx","border-radius":"40rpx"}},null,512),(0,o.createVNode)(c,{src:"s/msg/i_audio_s_1.png",w:"100rpx",h:"100rpx",style:{position:"absolute",top:"0rpx",right:"10rpx"}})],4)],4)):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,class:"msg-bar-audio-content",style:(0,o.normalizeStyle)({background:s.viewBg})},[(0,o.createVNode)(h,{onClick:s.clickDel,type:"trash",size:"52rpx",color:"#FF3232",style:{padding:"10rpx 20rpx 10rpx 30rpx"}},null,8,["onClick"]),(0,o.createElementVNode)("view",{class:"view-preview-middle",style:(0,o.normalizeStyle)({background:s.viewMiddleBg})},[(0,o.createVNode)(c,{onClick:s.clickPlay,src:n.audioPlayerIcon,w:"56rpx",h:"56rpx",style:{padding:"40rpx"}},null,8,["onClick","src"]),(0,o.createVNode)(g,{ref:"audioSlider",style:{flex:"1",height:"24rpx"},"max-value":n.audioSliderValue,"fill-value":100,"active-color":s.sliderActColor,"inactive-color":s.sliderBgColor,"dis-click":!0,blockColor:s.sliderActColor,onOnChangeStart:s.onSliderChangeStart,onOnChanged:s.onSliderChanged},null,8,["max-value","active-color","inactive-color","blockColor","onOnChangeStart","onOnChanged"]),(0,o.createVNode)(r,{text:s.playDurationStr,style:{"font-size":"28rpx","margin-right":"12rpx","margin-left":"12rpx"}},null,8,["text"])],4),(0,o.createVNode)(c,{onClick:s.clickSend,src:"s/msg/send_red.png",w:"56rpx",h:"56rpx",style:{padding:"40rpx 60rpx 40rpx 40rpx"}},null,8,["onClick"])],4)),(0,o.createElementVNode)("view",{style:(0,o.normalizeStyle)([{background:"#FFFFFF"},{height:`${s.getSafeBottom}px`,background:s.viewBg}])},null,4)],4)}var bm=v(_m,[["render",ym],["styles",[fm]]]),xm={"view-lock-open":{"":{width:"76rpx",borderTopLeftRadius:"38rpx",borderTopRightRadius:"38rpx",alignItems:"center"}},"view-top":{"":{width:"76rpx",height:"76rpx",borderRadius:"38rpx",position:"absolute",top:0,left:0}},"view-lock":{"":{width:"32rpx",height:"32rpx",backgroundColor:"#DD524D",borderRadius:"4rpx",marginTop:"22rpx",marginLeft:"22rpx"}}},wm={emits:["onBarAudioLock","onBarAudioLockStop"],data(){return{lockH:uni.upx2px(120),diffHeight:0,viewHeight:uni.upx2px(160),iconUpMargin:uni.upx2px(74),lastY:0,showLock:!1}},methods:{clickStop(){this.showLock&&this.$emit("onBarAudioLockStop")},onTouchMoveUp(e){if(!this.showLock){if(this.lastY!=0){let t=this.lastY-e;this.diffHeight+=t}this.diffHeight>=this.lockH&&(this.diffHeight=this.lockH,this.viewHeight=0,this.iconUpMargin=0,this.showLock=!0,this.$emit("onBarAudioLock")),this.lastY=e}}},computed:{viewBg(){let e=getApp().globalData.themeObj;return e.style==F.LIGHT?e.color.bg2:e.color.bg3}}};function Cm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("uni-icons"),ge),l=A((0,o.resolveDynamicComponent)("l-img"),P);return(0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"msg-bar-audio-lock",onClick:t[0]||(t[0]=(...c)=>s.clickStop&&s.clickStop(...c)),renderWhole:!0},[(0,o.createElementVNode)("view",{class:"view-lock-open",style:(0,o.normalizeStyle)({height:`${n.viewHeight}px`,background:s.viewBg})},[(0,o.createVNode)(r,{type:"top",size:"30rpx",color:"#333333",style:(0,o.normalizeStyle)({marginTop:`${n.iconUpMargin}px`})},null,8,["style"])],4),(0,o.createElementVNode)("view",{class:"view-top",style:(0,o.normalizeStyle)({background:s.viewBg})},[n.showLock?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"view-lock"})):((0,o.openBlock)(),(0,o.createBlock)(l,{key:1,src:"s/msg/audio_lock.png",w:"54rpx",h:"54rpx",style:{"margin-top":"10rpx","margin-left":"11rpx"}}))],4),(0,o.createElementVNode)("view",{style:(0,o.normalizeStyle)({height:`${n.diffHeight}px`})},null,4)])}var Sm=v(wm,[["render",Cm],["styles",[xm]]]),km={"msg-bar":{"":{position:"relative"}},center:{"":{alignItems:"center",flexDirection:"row"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"msg-bar-call":{"":{marginBottom:"20rpx"}},"call-item":{".msg-bar-call ":{marginRight:"20rpx",backgroundColor:"#44355E",borderRadius:"16rpx",paddingTop:"12rpx",paddingRight:"16rpx",paddingBottom:"12rpx",paddingLeft:"16rpx",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.08)"}},"call-title":{".msg-bar-call ":{color:"#FFFFFF",fontSize:"24rpx",marginLeft:"16rpx"}},"place-item":{".msg-bar-call ":{width:"28rpx",height:"2rpx"}},"msg-bar-view":{"":{flexDirection:"row",justifyContent:"space-between",paddingTop:"12rpx",paddingRight:0,paddingBottom:"12rpx",paddingLeft:0}},img:{".msg-bar-view ":{paddingTop:"14rpx",paddingRight:"10rpx",paddingBottom:"14rpx",paddingLeft:"10rpx"}},"view-camera":{".msg-bar-view ":{width:"80rpx",height:"80rpx",borderRadius:"40rpx"}},"img-send":{".msg-bar-view ":{paddingTop:"12rpx",paddingRight:"20rpx",paddingBottom:"12rpx",paddingLeft:"20rpx"}},"msg-bar-middle":{"":{flex:1,position:"relative",borderRadius:"40rpx",paddingTop:"20rpx",paddingRight:"82rpx",paddingBottom:"20rpx",paddingLeft:"26rpx"}},"input-bar":{".msg-bar-middle ":{lineHeight:40,fontSize:14,flex:1}},expression:{".msg-bar-middle ":{position:"absolute",right:"20rpx",top:"12rpx"}},"audio-tip":{"":{borderRadius:"8rpx",lineHeight:"28rpx",paddingTop:"14rpx",paddingRight:"10rpx",paddingBottom:"14rpx",paddingLeft:"16rpx"}},tip:{".audio-tip ":{color:"#FFFFFF",fontSize:"20rpx",marginRight:"10rpx"}},"mute-mask":{"":{position:"absolute",bottom:0,zIndex:11111}}},Am=xe("dom"),Uo=uni.upx2px(172),Tm=uni.upx2px(112),Go=uni.upx2px(90),Hn=getApp().globalData.window,vm={name:"MsgBar",components:{LImg:P,MText:de,ActionSheet:Ui,MsgBarAction:gm,MsgBarAudio:bm,MsgBarAudioLock:Sm},mixins:[um],emits:["onSend","onRecordFinish","onActionOpen","onInputLineChange"],props:{chatType:{type:[Number,String],default:1},actionId:{type:[Number,String],default:0},onlyVoice:{type:Boolean,default:!1},hideVoice:{type:Boolean,default:!1},userInfo:{type:Object,default(){return{}}},muteMaskType:{type:Number,default:0},hideBarAction:{type:Boolean,default:!1}},data(){return{isAndroid:f.isAndroid,width:Hn.width,safeBottom:0,cursorSpacing:uni.upx2px(36),text:"",inputColor:getApp().globalData.themeObj.color.title,isKeyboardOpen:!1,needOpenAction:!1,showExpression:!0,showSend:!1,sendWidth:0,micWidth:this.hideVoice?Go:Uo,emojiIndexList:[],audioShow:!1,audioLockShow:!1,audioLockBottom:uni.upx2px(104)+Hn.safeBottom,isAudioLock:!1,audioTouchTime:0,audioBarShowTimer:!1,audioTipSize:{},hasShowAudioTip:!1,inputAdjustPosition:!0,placeholderStyle:"color: "+getApp().globalData.themeObj.color.placeholder,msgBarActionHeight:0}},computed:{viewBarBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#F9FAFD":getApp().globalData.themeObj.color.bg2},viewBarMiddleStyle(){let e={},t=getApp().globalData.themeObj.style==F.LIGHT?1:.2,i=getApp().globalData.themeObj.style==F.LIGHT?"#EEEEEE":"transparent";return e.background="rgba(255, 255, 255, "+t+")",e.border="2rpx solid "+i,e},viewCameraStyle(){let e={},t=getApp().globalData.themeObj.style==F.LIGHT?1:.1,i=getApp().globalData.themeObj.style==F.LIGHT?"#EEEEEE":"transparent";return e.background="rgba(255, 255, 255, "+t+")",e.border="2rpx solid "+i,e},viewMuteMaskHeight(){return this.safeBottom+this.msgBarActionHeight+uni.upx2px(104)},muteMaskText(){return this.muteMaskType<=0?"":this.muteMaskType==1?u("msg.mutedYouTip"):u("msg.mutedAllTip")}},methods:{$str:u,clickAudioTipClose(){this.hasShowAudioTip&&(this.hasShowAudioTip=!1,this.$refs.audioTipPop.close())},clickBarCamera(){this.checkCanContact()||(this.isKeyboardOpen&&uni.hideKeyboard(),this.$refs.popCamera.open())},clickBarAlbum(){this.checkCanContact()||(this.isKeyboardOpen&&uni.hideKeyboard(),this.$refs.popAlbum.open())},clickKeyboard(){this.$nextTick(()=>{this.$refs.input.focus()})},clickExpression(){if(this.$refs.msgBarAction.isShow())this.isKeyboardOpen?(uni.hideKeyboard(),this.showExpression=!1):(this.$refs.input.focus(),this.showExpression=!0);else{if(this.showExpression=!1,this.isKeyboardOpen){this.needOpenAction=!0,uni.hideKeyboard();return}this.$refs.msgBarAction.open(!0)}},clickSend(e){e&&e.stopPropagation(),!this.checkCanContact()&&this.handleSend()},checkCanContact(){if(wi()||Hi(this.userInfo))return!0},showAudioTip(){this.hasShowAudioTip||Am.getComponentRect(this.$refs.audio,e=>{e&&e.size&&(this.audioTipSize=e.size,this.hasShowAudioTip=!0,this.$refs.audioTipPop.open())})},onClickOther(){this.clickAudioTipClose()},onInputFocus(){this.showExpression=!0},onLineChange(e){e&&e.detail&&e.detail.height&&this.$emit("onInputLineChange",e.detail.height,e.detail.lineCount)},onInputChange(e){this.text&&this.showSend||(this.text?(this.micWidth=0,this.sendWidth=Tm,this.showSend=!0):(this.showSend=!1,this.micWidth=this.hideVoice?Go:Uo,this.sendWidth=0),uni.$emit("event_bar_action_can_del",this.showSend))},onChooseExpressImg(e){this.$emit("onChooseExpressImg",e)},onActionOpen(e,t){this.msgBarActionHeight=t,e||(this.showExpression=!0),this.$emit("onActionOpen",e,t),this.safeBottom=e?0:Hn.safeBottom},onKeyboardChange(e){e.height>0?(this.isKeyboardOpen=!0,this.$refs.msgBarAction.setHeight(e.height)):(this.isKeyboardOpen=!1,this.needOpenAction&&(this.needOpenAction=!1,this.$refs.msgBarAction.open(!0,!0)),this.$refs.input.blur())},onKeyboardHeightChanged(e){e.detail.height>0||this.$refs.msgBarAction.isShow()||(this.showExpression=!0)},onAudioTouch(){if(this.checkCanContact())return;if(this.isKeyboardOpen||this.$refs.msgBarAction.isShow()){uni.hideKeyboard(),this.$refs.msgBarAction.open(!1);return}if(!Bi(j.MICROPHONE)){_n(j.MICROPHONE);return}this.isAudioLock=!1,this.audioTouchTime=new Date().getTime(),this.audioBarShowTimer=setTimeout(()=>{uni.vibrateShort({}),this.audioShow=!0,this.audioLockShow=!0},400)},onAudioTouchMove(e){let t=this.$refs.barAudio;if(t){let a=e.changedTouches[0].screenX.toFixed(2);t.onTouchMoveLeft(a)}let i=this.$refs.audioLock;if(i){let a=e.changedTouches[0].screenY.toFixed(2);i.onTouchMoveUp(a)}},onAudioTouchEnd(){this.endAudioTouch(!0)},onAudioTouchCancel(){this.endAudioTouch(!1)},onBarAudioLock(){this.isAudioLock=!0,this.$refs.barAudio.changeAudioLock()},onBarAudioLockStop(){this.audioLockShow=!1,this.$refs.barAudio.changeAudioStop()},onBarAudioAnimChange(e){!e||!e.detail||this.$refs.barAudio.startRecord()},onBarAudioCancel(){this.audioShow=!1,this.audioLockShow=!1},onBarAudioFinish(e,t){this.onBarAudioCancel(),e&&this.$emit("onRecordFinish",t)},endAudioTouch(e){if(this.isAudioLock)return;if(new Date().getTime()-this.audioTouchTime<600){this.showAudioTip(),clearTimeout(this.audioBarShowTimer),this.audioShow=!1,this.audioLockShow=!1,this.audioBarShowTimer=!1,this.$refs.barAudio&&this.$refs.barAudio.stopRecord(!1);return}this.$refs.barAudio?this.$refs.barAudio.stopRecord(e):this.onBarAudioCancel()},hide(){this.isKeyboardOpen&&uni.hideKeyboard(),this.hideAction()},hideAction(){this.showExpression=!0,this.$refs.msgBarAction.open(!1)},handleSend(){if(this.text==null||this.text=="")return;if(this.text.trim()==""){Ee(u("tips"),u("msg.msgNullTip"),"",u("gotIt"));return}this.$emit("onSend",this.text),this.text="",this.onInputChange()},focus(){this.$refs.input.focus()},setInputAdjustPosition(e){this.inputAdjustPosition!=e&&(this.inputAdjustPosition=e)},setText(e){this.text+=e,this.onInputChange()}},created(){var e=this;this.onlyVoice||(this.safeBottom=Hn.safeBottom),uni.onKeyboardHeightChange(this.onKeyboardChange),uni.$on("event_add_emoji_text",function(t){e.text=e.text+t,e.emojiIndexList.push(e.text.length),e.onInputChange({detail:{value:e.text}})}),uni.$on("event_delete_text",function(){let t=e.text.length;if(t<=0)return;let i=e.emojiIndexList.indexOf(t);i!=-1?(e.emojiIndexList.splice(i,1),e.text=e.text.substring(0,t-2)):e.text=e.text.substring(0,t-1),e.onInputChange({detail:{value:e.text}})})},unmounted(){uni.offKeyboardHeightChange(this.onKeyboardChange),uni.$off("event_add_emoji_text"),uni.$off("event_delete_text")}};function Dm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("msg-bar-audio"),c=A((0,o.resolveDynamicComponent)("uni-transition"),Ct),p=(0,o.resolveComponent)("MsgBarAudioLock"),h=(0,o.resolveComponent)("msg-bar-action"),g=A((0,o.resolveDynamicComponent)("action-sheet"),Ui),_=A((0,o.resolveDynamicComponent)("custom-popover"),pt),C=(0,o.resolveComponent)("m-text");return(0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"msg-bar",style:(0,o.normalizeStyle)({width:`${n.width}px`}),renderWhole:!0},[(0,o.renderSlot)(e.$slots,"default"),i.hideBarAction?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"msg-bar-view",style:(0,o.normalizeStyle)({background:s.viewBarBg})},[(0,o.createElementVNode)("view",{style:{padding:"0 12rpx"}},[(0,o.createElementVNode)("view",{class:"center-align view-camera",style:(0,o.normalizeStyle)(s.viewCameraStyle)},[i.onlyVoice?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,needStyle:1,onClick:s.clickBarCamera,src:"s/msg/bar_new_camera.png",w:"52rpx",h:"52rpx"},null,8,["onClick"]))],4)]),i.onlyVoice?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,class:"msg-bar-middle",style:(0,o.normalizeStyle)(s.viewBarMiddleStyle)},null,4)):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"msg-bar-middle",style:(0,o.normalizeStyle)(s.viewBarMiddleStyle)},[(0,o.createElementVNode)("u-textarea",{ref:"input",modelValue:n.text,onInput:[t[0]||(t[0]=b=>n.text=b.detail.value),t[2]||(t[2]=(...b)=>s.onInputChange&&s.onInputChange(...b))],adjustPosition:n.inputAdjustPosition,cursorSpacing:n.cursorSpacing,autoHeight:!0,maxlength:-1,showConfirmBar:!1,disableDefaultPadding:!0,onFocus:t[1]||(t[1]=(...b)=>s.onInputFocus&&s.onInputFocus(...b)),onKeyboardheightchange:t[3]||(t[3]=(...b)=>s.onKeyboardHeightChanged&&s.onKeyboardHeightChanged(...b)),onLinechange:t[4]||(t[4]=(...b)=>s.onLineChange&&s.onLineChange(...b)),style:(0,o.normalizeStyle)({color:this.inputColor}),placeholderStyle:n.placeholderStyle,placeholder:s.$str("message")+"...",class:"input-bar"},null,44,["modelValue","adjustPosition","cursorSpacing","placeholderStyle","placeholder"]),(0,o.createElementVNode)("view",{class:"expression"},[n.showExpression?((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,onClick:s.clickExpression,needStyle:1,src:"s/msg/bar_new_smile_face.png",w:"52rpx",h:"52rpx"},null,8,["onClick"])):((0,o.openBlock)(),(0,o.createBlock)(r,{key:1,onClick:s.clickKeyboard,needStyle:1,src:"s/msg/bar_new_keyboard.png",w:"52rpx",h:"52rpx"},null,8,["onClick"]))])],4)),i.onlyVoice?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:2,style:(0,o.normalizeStyle)({width:`${n.sendWidth}px`})},[n.isAndroid||n.showSend?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,onClick:t[5]||(t[5]=(...b)=>s.clickSend&&s.clickSend(...b)),class:"img-send"},[(0,o.createVNode)(r,{onClick:s.clickSend,src:"s/msg/send_red.png",w:"56rpx",h:"56rpx",fade:!1},null,8,["onClick"])])):(0,o.createCommentVNode)("",!0)],4)),(0,o.createElementVNode)("view",{style:(0,o.normalizeStyle)({width:`${n.micWidth}px`})},[(0,o.createElementVNode)("view",{class:"center"},[i.onlyVoice?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,class:"center img"},[(0,o.createElementVNode)("view",{style:{width:"52rpx"}})])):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"center img",style:{"margin-left":"14rpx"}},[(0,o.createVNode)(r,{onClick:s.clickBarAlbum,needStyle:1,src:"s/msg/bar_new_album.png",w:"52rpx",h:"52rpx"},null,8,["onClick"])])),i.hideVoice?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:2,onTouchstart:t[6]||(t[6]=(...b)=>s.onAudioTouch&&s.onAudioTouch(...b)),onTouchmove:t[7]||(t[7]=(0,o.withModifiers)((...b)=>s.onAudioTouchMove&&s.onAudioTouchMove(...b),["stop","prevent"])),onTouchend:t[8]||(t[8]=(...b)=>s.onAudioTouchEnd&&s.onAudioTouchEnd(...b)),onTouchcancel:t[9]||(t[9]=(...b)=>s.onAudioTouchCancel&&s.onAudioTouchCancel(...b)),class:"img"},[(0,o.createVNode)(r,{ref:"audio",src:"s/msg/bar_new_microphone.png",needStyle:1,w:"52rpx",h:"52rpx"},null,512)],32))])],4)],4)),(0,o.createElementVNode)("view",{style:(0,o.normalizeStyle)({height:n.safeBottom+"px",background:s.viewBarBg})},null,4),(0,o.createVNode)(c,{show:n.audioShow,duration:300,"mode-class":"slide-right",onChange:s.onBarAudioAnimChange,style:{position:"absolute",bottom:"0"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(l,{ref:"barAudio",onlyVoice:i.onlyVoice,onOnAudioCancel:s.onBarAudioCancel,onOnAudioFinish:s.onBarAudioFinish},null,8,["onlyVoice","onOnAudioCancel","onOnAudioFinish"])]),_:1},8,["show","onChange"]),(0,o.createVNode)(c,{style:(0,o.normalizeStyle)([{bottom:`${n.audioLockBottom}px`},{position:"fixed",right:"20rpx"}]),show:n.audioLockShow,"mode-class":"slide-bottom",duration:300},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(p,{ref:"audioLock",onOnBarAudioLock:s.onBarAudioLock,onOnBarAudioLockStop:s.onBarAudioLockStop},null,8,["onOnBarAudioLock","onOnBarAudioLockStop"])]),_:1},8,["style","show"]),(0,o.createVNode)(h,{ref:"msgBarAction",onOnChooseExpressImg:s.onChooseExpressImg,onOnOpen:s.onActionOpen},null,8,["onOnChooseExpressImg","onOnOpen"]),(0,o.createVNode)(g,{ref:"popAlbum",onOnClickActionItem:e.onClickActionItem,"show-warn-media":!0,actions:e.moreActions},null,8,["onOnClickActionItem","actions"]),(0,o.createVNode)(g,{ref:"popCamera",onOnClickActionItem:e.onClickActionItem,"show-warn-media":!0,actions:e.cameraActions},null,8,["onOnClickActionItem","actions"]),(0,o.createVNode)(_,{ref:"audioTipPop",size:n.audioTipSize,"bg-color":"#6A607C","min-margin":"10","triangle-is-top":!1,onOnClickOther:s.onClickOther},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{class:"center audio-tip"},[(0,o.createElementVNode)("u-text",{class:"tip"},(0,o.toDisplayString)(s.$str("msg.holdTalkGoSend")),1),(0,o.createVNode)(r,{onClick:s.clickAudioTipClose,h:"28rpx",src:"s/msg/close_white.png",w:"28rpx"},null,8,["onClick"])])]),_:1},8,["size","onOnClickOther"]),i.muteMaskType>0?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,onClick:b=>!1,style:(0,o.normalizeStyle)({width:`${n.width}px`,height:`${s.viewMuteMaskHeight}px`,background:s.viewBarBg}),class:"mute-mask"},[(0,o.createElementVNode)("view",{class:"center-align",style:(0,o.normalizeStyle)({height:`${s.viewMuteMaskHeight-n.safeBottom}px`})},[(0,o.createVNode)(r,{needStyle:1,src:"s/msg/msg_muted.png",w:"42rpx",h:"40rpx",style:{"margin-right":"10rpx"}}),(0,o.createVNode)(C,{type:"desc",text:s.muteMaskText,style:{"font-size":"32rpx"}},null,8,["text"])],4)],4)):(0,o.createCommentVNode)("",!0)],4)}var jo=v(vm,[["render",Dm],["styles",[km]]]),Lm={"view-scroll":{"":{flexDirection:"row",height:"84rpx"}},"place-item":{"":{width:"20rpx",height:"2rpx"}},"call-item":{"":{alignItems:"center",flexDirection:"row",marginRight:"16rpx",borderRadius:"8rpx",paddingTop:0,paddingRight:"16rpx",paddingBottom:0,paddingLeft:"16rpx",height:"68rpx",backgroundColor:"#FFFFFF"}},"text-title":{"":{color:"#333333",fontSize:"30rpx",marginLeft:"8rpx"}}},Em={components:{MText:de,MView:Dt},emits:["clickGift","clickUser","clickClub","clickGiftAsk","clickCallVideo","clickCallAudio","clickWords"],props:{showGift:{type:[Boolean,Number],default:!1},showGiftAsk:{type:[Boolean,Number],default:!1},showCallVideo:{type:Boolean,default:!1},showCallAudio:{type:[Boolean,Number],default:!1},comWords:{type:String,default:""},userInfo:{type:Object,default(){return{}}},showCooperation:{type:[Boolean,Number],default:!1},showFeedback:{type:Boolean,default:!1},showUser:{type:Boolean,default:!0},showClub:{type:Boolean,default:!0}},data(){return{sW:getApp().globalData.window.width}},computed:{showCallAction(){return getApp().globalData.appCRE}},methods:{$str:u,clickCooperate(){this.$emit("clickCooperate")},clickFeedback(){q("/pagesPub/set/feedback")},clickGift(){this.checkCanContact()||this.$emit("clickGift")},clickUser(){this.checkCanContact()||this.$emit("clickUser")},clickClub(){this.checkCanContact()||this.$emit("clickClub")},clickGiftAsk(){this.checkCanContact()||this.$emit("clickGiftAsk")},clickCallVideo(){this.$emit("clickCallVideo")},clickCallAudio(){this.$emit("clickCallAudio")},clickWords(){this.$emit("clickWords")},checkCanContact(){return!!(wi()||Hi(this.userInfo))}}};function Im(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("m-text"),c=(0,o.resolveComponent)("m-view");return(0,o.openBlock)(),(0,o.createElementBlock)("scroll-view",{scrollX:"true",class:"view-scroll",showScrollbar:!1,style:(0,o.normalizeStyle)({width:`${n.sW}px`}),renderWhole:!0},[(0,o.createElementVNode)("view",{class:"place-item"}),i.showCooperation?((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,onClick:s.clickCooperate,type:"bg2",style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/cooperate_love_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("msg.noticeCooperation"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),i.showFeedback?((0,o.openBlock)(),(0,o.createBlock)(c,{key:1,onClick:s.clickFeedback,type:"bg2",style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/notice_feedback_3.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("feedback"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),i.comWords?((0,o.openBlock)(),(0,o.createBlock)(c,{key:2,onClick:s.clickWords,type:"bg2",style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(l,{text:i.comWords,style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),i.showGiftAsk?((0,o.openBlock)(),(0,o.createBlock)(c,{key:3,onClick:s.clickGiftAsk,type:"bg2",style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/bar_a_gift_ask_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("msg.askForGift"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),i.showGift?((0,o.openBlock)(),(0,o.createBlock)(c,{key:4,onClick:s.clickGift,type:"bg2",style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/bar_a_gift_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("gift"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),s.showCallAction&&i.showCallAudio?((0,o.openBlock)(),(0,o.createBlock)(c,{key:5,onClick:s.clickCallAudio,style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/bar_a_audio_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("audioChat"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),s.showCallAction&&i.showCallVideo?((0,o.openBlock)(),(0,o.createBlock)(c,{key:6,onClick:s.clickCallVideo,style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/bar_a_video_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("videoChat"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),i.showUser?((0,o.openBlock)(),(0,o.createBlock)(c,{key:7,onClick:s.clickUser,style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/bar_a_user_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("users"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0),i.showClub?((0,o.openBlock)(),(0,o.createBlock)(c,{key:8,onClick:s.clickClub,style:{"align-items":"center","flex-direction":"row","margin-right":"16rpx","border-radius":"8rpx",padding:"0 16rpx",height:"68rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{src:"s/msg/bar_a_club_2.png",w:"30rpx",h:"30rpx"}),(0,o.createVNode)(l,{text:s.$str("clubs"),style:{"font-size":"30rpx","margin-left":"8rpx"}},null,8,["text"])]),_:1},8,["onClick"])):(0,o.createCommentVNode)("",!0)],4)}var Vo=v(Em,[["render",Im],["styles",[Lm]]]),Rm={center:{"":{flexDirection:"row",alignItems:"center"}},"center-align":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"center-between":{"":{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},"view-reply":{"":{height:"88rpx"}},"left-line":{"":{width:"4rpx",height:"88rpx"}},"view-content":{"":{flex:1,paddingLeft:"24rpx"}},"view-img":{"":{width:"72rpx",height:"72rpx",position:"relative"}}},Mm={emits:["onClickMsgBarReplyClose"],components:{LImg:P,UniIcons:ge,MText:de},props:{data:{type:Object,default(){return{}}}},data(){return{contentColor:getApp().globalData.themeObj.color.desc,nickname:"",content:"",imgInfo:""}},watch:{data:function(e,t){this.parseData(e)}},computed:{viewBg(){let e=getApp().globalData.themeObj,t=e.style==F.LIGHT?"bg2":"bg3";return e.color[t]},leftLineBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#1E5148":"#D7F2C9"},contentW(){let e=getApp().globalData.window.width,t=4+48+36+24+16;return this.imgInfo&&(t+=92),e-uni.upx2px(t)},imgRadius(){return this.data.msg_type==f.M_GIFT_ASK||this.data.msg_type==f.M_GIFT?"0":"8rpx"},closeColor(){return getApp().globalData.themeObj.style==F.LIGHT?"#C5C5C5":"#8E8E8E"}},methods:{clickClose(){this.$emit("onClickMsgBarReplyClose")},parseData(e){e.chat_type==f.M_CHAT_ASS?e.chat_id==f.SYSTEM_ID&&e.send_uid!=getApp().globalData.uid?this.nickname=u("customerService"):e.chat_id!=f.SYSTEM_ID&&e.send_uid!=e.chat_id?this.nickname=u("customerService"):this.nickname=e.user.nickname:this.nickname=e.user.nickname,this.content=In(e),this.imgInfo=Rn(e)}},created(){this.parseData(this.data)}};function Om(e,t,i,a,n,s){let r=(0,o.resolveComponent)("m-text"),l=A((0,o.resolveDynamicComponent)("l-img"),P),c=A((0,o.resolveDynamicComponent)("uni-icons"),ge);return(0,o.openBlock)(),(0,o.createElementBlock)("view",{style:(0,o.normalizeStyle)({background:s.viewBg}),class:"view-reply center",renderWhole:!0},[(0,o.createElementVNode)("view",{class:"left-line",style:(0,o.normalizeStyle)({background:s.leftLineBg})},null,4),(0,o.createElementVNode)("view",{class:"view-content center-between"},[(0,o.createElementVNode)("view",null,[(0,o.createVNode)(r,{text:n.nickname,style:{"font-weight":"600","font-size":"24rpx","line-height":"34rpx"}},null,8,["text"]),(0,o.createVNode)(r,{text:n.content,type:"tip",style:(0,o.normalizeStyle)([{width:`${s.contentW}px`},{"font-size":"20rpx","margin-top":"8rpx","line-break":"28rpx",lines:"1",overflow:"hidden","text-overflow":"ellipsis"}])},null,8,["text","style"])]),(0,o.createElementVNode)("view",{class:"center",style:(0,o.normalizeStyle)({marginLeft:n.imgInfo?"20rpx":0})},[n.imgInfo&&n.imgInfo.small_url?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"view-img center-align"},[(0,o.createVNode)(l,{src:n.imgInfo.small_url,w:"72rpx",h:"72rpx",radius:s.imgRadius},null,8,["src","radius"]),n.imgInfo.media_type==2?((0,o.openBlock)(),(0,o.createBlock)(l,{key:0,src:"s/pub/play_video.png",w:"24rpx",h:"24rpx",style:{position:"absolute"}})):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(c,{onClick:s.clickClose,type:"clear",color:s.closeColor,size:"36rpx",style:{padding:"24rpx"}},null,8,["onClick","color"])],4)])],4)}var zo=v(Mm,[["render",Om],["styles",[Rm]]]),Xe={methods:{showLoading(){this.$refs.msgUser.loadingShow()},hideLoading(e){this.$refs.msgUser.loadingHide(e)},showFail(){this.$refs.msgUser.failShow()},hideFail(){this.$refs.msgUser.failHide()},showIncome(e){this.$refs.msgUser.setIncomeVal(e)},checkStopClick(e){return this.$refs.msgUser.isStopClick==1?(this.$refs.msgUser.isStopClick=0,e.stopPropagation(),!0):!1}}},Fm={center:{"":{alignItems:"center",flexDirection:"row"}},"flex-start":{"":{justifyContent:"flex-start"}},"flex-end":{"":{justifyContent:"flex-end"}},container:{"":{paddingTop:0,paddingRight:10,paddingBottom:0,paddingLeft:10,alignItems:"flex-start",flexDirection:"row"}},nickname:{".container ":{fontSize:"24rpx",lineHeight:"28rpx"}},"view-income":{"":{marginRight:"6rpx",marginTop:"4rpx"}},"text-income":{".view-income ":{fontSize:"24rpx",color:"#FF953F",marginLeft:"8rpx",marginRight:"2rpx",lineHeight:"34rpx"}},"admin-del-str":{"":{color:"#FF0000",fontSize:"24rpx"}}},Wo=xe("dom"),Nm={components:{AvatarImg:Gi},props:{data:{type:Object,default(){return{}}},user:{type:Object,default(){return{avatar:""}}},isSend:{type:Boolean,default:!1},chatType:{type:[Number,String],default:0},index:{type:Number,default:-1},listType:{type:Number,default:1},avatarMarginTop:{type:String,default:"0rpx"},readTime:{type:[Number,String],default:0}},data(){return{maxWidth:getApp().globalData.window.width-20-6-uni.upx2px(32),showLoading:!1,isStopClick:0,incomeVal:0}},computed:{readHookColor(){if(this.readTime<=0)return"";let e=this.data.mtime.toString();return e.length<16&&(e=Number(e)*1e3),this.readTime>=e?"#1485FB":"#BFC6D0"},sendStatusSrc(){return this.data.msg_status==et.FAIL?"s/pub/i-error.png":this.data.isAdmin&&this.data.msg_status==et.SEND_HIDE?"s/msg/msg_hide.png":""},receiveStatusSrc(){return this.data.isAdmin?this.data.msg_status==et.FAIL?"s/pub/i-error.png":this.data.msg_status==et.SEND_HIDE?"s/msg/msg_hide.png":"":""},statusStr(){if(!this.data.isAdmin)return"";if(this.data.msg_status==et.KEFU_DEL)return je("deleted");if(this.data.is_del)return je("deleted")},checkIncomeVal(){if(this.data.isAdmin)return!1;let e=re(this.data.msg_content);return e&&e.income&&e.income_uid==getApp().globalData.uid&&!e.income_hide?(this.incomeVal=e.income,!0):!1}},methods:{clickAvatar(e){if(this.data.chat_type==f.M_CHAT_ASS){if(this.data.chat_id==f.SYSTEM_ID||!bn())return;let t=this.data.isSend?this.data.send_uid:this.data.chat_id;Fi(t);return}if(!this.data.msg_id)if(e.stopPropagation(),uni.hideKeyboard(),this.isSend||this.data.chat_type==f.M_CHAT_PRI)q("/pages/main/user-home",{uid:this.user.uid});else{let t=`avatar-${this.data.chat_id}-${this.data.ctime}`;Wo.getComponentRect(this.$refs[t],i=>{i&&i.size&&uni.$emit("event_avatar_popover",{size:i.size,data:this.data})})}},clickFail(e){e.stopPropagation(),!(this.data.msg_type==f.M_TEXT&&this.data.content.sensitive_type)&&uni.$emit("event_msg_fail_click",this.data,this.index,this.listType)},onLongPress(e){if(e.stopPropagation(),this.data.msg_id)return;this.isStopClick=1;let t=`msg-${this.data.chat_id}-${this.data.ctime}`;Wo.getComponentRect(this.$refs[t],i=>{i&&i.size&&uni.$emit("event_msg_popover",{size:i.size,data:this.data,listType:this.listType,index:this.index})})},loadingShow(){this.showLoading=!0},loadingHide(e){this.data.mtime=e,this.showLoading=!1},failShow(){this.data.msg_status=1},failHide(){this.data.msg_status=0},setStopClick(e){this.isStopClick=e},setIncomeVal(e){this.incomeVal=e},isMsgStatusHide(){return this.data.isAdmin&&this.data.msg_status==2}},updated(){},created(){}};function Bm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("u-base-info"),$t),l=A((0,o.resolveDynamicComponent)("uni-icons"),ge),c=A((0,o.resolveDynamicComponent)("uni-load-more"),Gt),p=A((0,o.resolveDynamicComponent)("l-img"),P),h=A((0,o.resolveDynamicComponent)("avatar-img"),Gi);return(0,o.openBlock)(),(0,o.createElementBlock)("view",{style:{position:"relative"},renderWhole:!0},[i.isSend?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"container flex-end"},[(0,o.createElementVNode)("view",{style:{"margin-right":"6px"}},[i.chatType==2?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,style:{height:"50rpx","margin-top":"-6rpx","flex-direction":"row-reverse","align-items":"center"}},[(0,o.createVNode)(r,{info:i.user,showCountry:!0,desc:!0,nameColor:"#999999",nameSize:"24rpx"},null,8,["info"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("view",{class:"center",style:{"justify-content":"flex-end"}},[i.readTime>0?((0,o.openBlock)(),(0,o.createBlock)(l,{key:0,type:"checkmarkempty",size:"40rpx",color:s.readHookColor,style:{"margin-right":"8rpx"}},null,8,["color"])):(0,o.createCommentVNode)("",!0),s.statusStr?((0,o.openBlock)(),(0,o.createElementBlock)("u-text",{key:1,class:"admin-del-str",style:{"margin-right":"20rpx"}},(0,o.toDisplayString)(s.statusStr),1)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("view",null,[(0,o.createElementVNode)("view",{onLongpress:t[1]||(t[1]=(...g)=>s.onLongPress&&s.onLongPress(...g)),ref:"msg-"+i.data.chat_id+"-"+i.data.ctime,style:(0,o.normalizeStyle)({maxWidth:n.maxWidth+"px"}),class:"center flex-end"},[(0,o.createElementVNode)("view",null,[n.showLoading?((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,style:{height:"30px","margin-right":"10rpx"},status:"loading",iconSize:17})):(0,o.createCommentVNode)("",!0),s.sendStatusSrc?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,onClick:t[0]||(t[0]=(...g)=>s.clickFail&&s.clickFail(...g)),style:{padding:"10rpx"}},[(0,o.createVNode)(p,{src:s.sendStatusSrc,w:"32rpx",h:"32rpx"},null,8,["src"])])):(0,o.createCommentVNode)("",!0)]),(0,o.renderSlot)(e.$slots,"default",{style:"flex:1"})],36),n.incomeVal||s.checkIncomeVal?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"center flex-end view-income"},[(0,o.createVNode)(p,{src:"s/my/i_coins.png",w:"22rpx",h:"22rpx"}),(0,o.createElementVNode)("u-text",{class:"text-income"},"+ "+(0,o.toDisplayString)(n.incomeVal),1),(0,o.createVNode)(p,{src:"s/pub/income_up_1.png",w:"14rpx",h:"34rpx"})])):(0,o.createCommentVNode)("",!0)])])]),(0,o.createVNode)(h,{ref:"avatar-"+i.data.chat_id+"-"+i.data.ctime,user:i.user,onClick:s.clickAvatar,w:"76rpx",h:"76rpx","place-w":"66rpx","place-font-size":!1,radius:"38rpx","from-admin":i.data.isAdmin,style:(0,o.normalizeStyle)({marginTop:i.avatarMarginTop})},null,8,["user","onClick","from-admin","style"])])):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,class:"container flex-start"},[(0,o.createVNode)(h,{ref:"avatar-"+i.data.chat_id+"-"+i.data.ctime,user:i.user,onClick:s.clickAvatar,w:"76rpx",h:"76rpx","place-w":"66rpx","place-font-size":!1,radius:"38rpx","from-admin":i.data.isAdmin,style:(0,o.normalizeStyle)({marginTop:i.avatarMarginTop})},null,8,["user","onClick","from-admin","style"]),(0,o.createElementVNode)("view",{style:{"margin-left":"6px"}},[i.chatType==2?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,style:{height:"50rpx","margin-top":"-6rpx"},class:"center"},[(0,o.createVNode)(r,{info:i.user,showCountry:!0,nameColor:"#999999",nameSize:"24rpx",style:{"margin-top":"-8rpx"}},null,8,["info"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("view",{class:"center"},[(0,o.createElementVNode)("view",{onLongpress:t[2]||(t[2]=(...g)=>s.onLongPress&&s.onLongPress(...g)),ref:"msg-"+i.data.chat_id+"-"+i.data.ctime,style:(0,o.normalizeStyle)({maxWidth:n.maxWidth+"px"}),class:"center flex-start"},[(0,o.renderSlot)(e.$slots,"default")],36),(0,o.createElementVNode)("view",{class:"center"},[s.statusStr?((0,o.openBlock)(),(0,o.createElementBlock)("u-text",{key:0,class:"admin-del-str",style:{"margin-left":"20rpx"}},(0,o.toDisplayString)(s.statusStr),1)):(0,o.createCommentVNode)("",!0),s.receiveStatusSrc?((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,src:s.receiveStatusSrc,w:"32rpx",h:"32rpx",style:{"margin-left":"12rpx"}},null,8,["src"])):(0,o.createCommentVNode)("",!0)])])])]))])}var Pe=v(Nm,[["render",Bm],["styles",[Fm]]]),Pm={center:{"":{flexDirection:"row",alignItems:"center"}},"center-align":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},text:{"":{fontSize:"32rpx",lineHeight:"42rpx"}},"text-p":{"":{paddingTop:"18rpx",paddingRight:"20rpx",paddingBottom:"18rpx",paddingLeft:"20rpx"}},"text-p-tran":{"":{paddingTop:"18rpx",paddingRight:"20rpx",paddingBottom:0,paddingLeft:"20rpx"}},"view-send":{"":{paddingLeft:"26rpx"}},content:{".view-send ":{borderTopLeftRadius:"8rpx",borderTopRightRadius:0,borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx",boxShadow:"0 1 0 0 rgba(0, 0, 0, 0.04)"},".view-receive ":{borderTopLeftRadius:0,borderTopRightRadius:"8rpx",borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}},"view-receive":{"":{paddingRight:"26rpx"}},"view-tran-end":{".view-receive ":{justifyContent:"flex-end",marginBottom:"12rpx",marginTop:"8rpx"},"":{paddingTop:0,paddingRight:"20rpx",paddingBottom:0,paddingLeft:"18rpx",flexDirection:"row",alignItems:"center",marginBottom:"12rpx",marginTop:"8rpx"}},"text-tran":{"":{fontSize:"18rpx",marginLeft:"4rpx"}},"reply-send":{"":{borderTopLeftRadius:"8rpx",borderTopRightRadius:0,borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}},"reply-line":{".reply-send ":{borderTopLeftRadius:100,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:100},".reply-receive ":{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:100},".reply-view ":{width:2,height:44}},"reply-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"8rpx",borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}},"reply-view":{"":{height:44,marginTop:4,marginRight:4,marginBottom:0,marginLeft:4}},"reply-content":{".reply-view ":{paddingTop:0,paddingRight:8,paddingBottom:0,paddingLeft:8}},"view-img":{".reply-view ":{position:"relative",width:36,height:36}}},Hm={emits:["onClickTextReplyContent"],components:{MLine:At,TranslateIcon:qs,MText:de,MsgUser:Pe},mixins:[Xe],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},data(){return{maxWidth:getApp().globalData.window.width-130,tranContent:"",rich:!1,tranOriText:"",translateAuto:!1,translateAutoForce:!1,translateResult:""}},computed:{transStyle(){return this.data.isSend?{left:0}:{right:0}},tranColor(){return getApp().globalData.themeObj.style==F.LIGHT?this.data.isSend?"rgba(0, 0, 0, 0.3)":"#999999":"rgba(255, 255, 255, 0.4)"},tranAColor(){return getApp().globalData.themeObj.color.bg1_1},tranApiParams(){let e;return this.data.room_id?e=ai.CALL:this.data.chat_type==f.M_CHAT_PRI?e=ai.MSG_PRI:this.data.chat_type==f.M_CHAT_CLUB?e=ai.MSG_CLUB:this.data.chat_type==f.M_CHAT_ASS?e=ai.MSG_KEFU:e=ai.MSG_SYS,{from_uid:this.data.chat_type==2?this.data.chat_id:this.data.send_uid,chat_type:this.data.chat_type,key:this.data.mtime,from_type:e}},richStyle(){let e={"max-width":this.maxWidth+"px"};return this.data.isSend?e["border-top-left-radius"]="16rpx":e["border-top-right-radius"]="16rpx",e},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?this.data.isSend?"#E1FFC3":"#FFFFFF":this.data.isSend?"#1E5148":"#313131"},replyLineStyle(){let e,t;return getApp().globalData.themeObj.style==F.LIGHT?(e="#1E5148",t=this.data.isSend?"#D7F2C9":getApp().globalData.themeObj.color.bg3):(e="#D7F2C9",t=this.data.isSend?"#1B4941":getApp().globalData.themeObj.color.bg2),{lineBg:e,contentBg:t}},replyTextW(){let e=26;return this.data.content.reply.img&&(e+=46),this.maxWidth-e}},methods:{$str:u,clickReplyContent(){this.$emit("onClickTextReplyContent",this.data.content.reply)},onTranslateFinish(e){if(!e.text)return;if(this.tranContent=e.text,this.data.isAdmin){if(this.data.chat_type==f.M_CHAT_ASS){let a=this.data.content;a.tran_text=e.text;let n=JSON.stringify(a);this.data.mtime.toString().length==16?Xs(this.data.chat_id,this.data.chat_type,this.data.mtime,n,!0):Xs(this.data.chat_id,this.data.chat_type,this.data.ctime,n,!1)}return}let t=this.data.content;t.tran_text=e.text;let i=JSON.stringify(t);this.data.mId?nt(this.data.chat_id,this.data.chat_type,0,i,this.data.mId,!1):this.data.mtime.toString().length==16?nt(this.data.chat_id,this.data.chat_type,this.data.mtime,i,0,!1):nt(this.data.chat_id,this.data.chat_type,this.data.ctime,i,0,!0)},onTranslateClick(){uni.$emit("event_translate_auto_open",this.data.chat_id,this.data.ctime)},onTranslateOpen(e,t){!this.data.isAdmin&&this.data.isSend||this.data.chat_id==e&&(this.data.ctime<=t||this.$refs.translateIcon&&this.$refs.translateIcon.reqTranslate())},clickTranslateStr(e){e&&e.stopPropagation(),gn()}},created(){if(this.data.content.text){let e=this.data.content.text;for(let t=0,i=this.data.content.info.length;t<i;t++)this.data.content.info[t].color="#0091FF",e=e.replace("[x]",this.data.content.info[t].text);this.tranOriText=e,this.rich={text:this.data.content.text,info:this.data.content.info,click:[this.data.content.click]}}else this.tranOriText=this.data.content.content;if(this.data.content.tran_text&&(this.translateResult=this.data.content.tran_text,getApp().globalData.translateAuto)){this.tranContent=this.data.content.tran_text;return}this.data.isAdmin?(this.translateAuto=this.data.chat_type==f.M_CHAT_ASS&&!this.data.isSend,this.translateAutoForce=this.data.chat_type==f.M_CHAT_ASS&&!this.data.isSend):(this.translateAuto=!this.data.isSend,this.translateAutoForce=!1),uni.$on("event_translate_auto_open",this.onTranslateOpen)},beforeUnmount(){uni.$off("event_translate_auto_open",this.onTranslateOpen)}};function Um(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("m-text"),c=A((0,o.resolveDynamicComponent)("rich-content"),It),p=(0,o.resolveComponent)("m-line"),h=A((0,o.resolveDynamicComponent)("translate-icon"),qs),g=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(g,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{class:(0,o.normalizeClass)([i.data.isSend?"view-send":"view-receive"])},[(0,o.createElementVNode)("view",{class:"content",style:(0,o.normalizeStyle)({background:s.viewBg})},[i.data.content.reply?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,onClick:t[0]||(t[0]=(..._)=>s.clickReplyContent&&s.clickReplyContent(..._)),onLongpress:t[1]||(t[1]=()=>{}),class:(0,o.normalizeClass)(["reply-view center",[i.data.isSend?"reply-send":"reply-receive"]]),style:(0,o.normalizeStyle)({background:s.replyLineStyle.contentBg,maxWidth:`${n.maxWidth}px`})},[(0,o.createElementVNode)("view",{class:"reply-line",style:(0,o.normalizeStyle)({background:s.replyLineStyle.lineBg})},null,4),(0,o.createElementVNode)("view",{class:"reply-content center"},[i.data.content.reply.img?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"center-align view-img",style:{"margin-right":"10px"}},[(0,o.createVNode)(r,{src:i.data.content.reply.img.small_url,w:"36px",h:"36px",radius:"4px"},null,8,["src"]),i.data.content.reply.img.media_type==2?((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,src:"s/pub/play_video.png",w:"24rpx",h:"24rpx",style:{position:"absolute"}})):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("view",null,[(0,o.createVNode)(l,{text:i.data.content.reply.nickname,style:(0,o.normalizeStyle)([{maxWidth:`${s.replyTextW}px`},{"font-size":"24rpx","font-weight":"600","line-height":"28rpx",lines:"1",overflow:"hidden","text-overflow":"ellipsis"}])},null,8,["text","style"]),(0,o.createVNode)(l,{text:i.data.content.reply.content,type:"tip",style:(0,o.normalizeStyle)([{maxWidth:`${s.replyTextW}px`},{"font-size":"20rpx","line-height":"24rpx",lines:"1",overflow:"hidden","text-overflow":"ellipsis","margin-top":"12rpx"}])},null,8,["text","style"])])])],38)):(0,o.createCommentVNode)("",!0),i.data.content.content?((0,o.openBlock)(),(0,o.createBlock)(l,{key:1,text:i.data.content.content,style:(0,o.normalizeStyle)([{"font-size":"32rpx","line-height":"42rpx",padding:"18rpx 20rpx"},{"max-width":n.maxWidth+"px"}])},null,8,["text","style"])):n.rich?((0,o.openBlock)(),(0,o.createBlock)(c,{key:2,data:n.rich,"font-size":"30rpx",style:(0,o.normalizeStyle)([{"text-align":"left","background-color":"transparent","line-height":"42rpx",padding:"0 20rpx","margin-top":"24rpx","margin-bottom":"24rpx"},s.richStyle])},null,8,["data","style"])):(0,o.createCommentVNode)("",!0),n.tranContent?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:3},[(0,o.createVNode)(p,{style:{margin:"0 20rpx"}}),(0,o.createVNode)(l,{text:n.tranContent,style:(0,o.normalizeStyle)([{"max-width":n.maxWidth+"px"},{"font-size":"32rpx","line-height":"42rpx",padding:"18rpx 20rpx 0"}])},null,8,["text","style"]),(0,o.createElementVNode)("view",{onClick:t[2]||(t[2]=(..._)=>s.clickTranslateStr&&s.clickTranslateStr(..._)),class:"view-tran-end"},[(0,o.createVNode)(r,{src:"s/pub/tran_action.png",needStyle:1,w:"26rpx",h:"24rpx"}),(0,o.createElementVNode)("u-text",{class:"text-tran",style:(0,o.normalizeStyle)({color:s.tranColor})},(0,o.toDisplayString)(s.$str("autoTranslation")),5)])])):(0,o.createCommentVNode)("",!0)],4),n.tranContent?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(h,{key:0,ref:"translateIcon",onOnTranslateFinish:s.onTranslateFinish,onOnTranslateClick:s.onTranslateClick,isAuto:!0,border:!0,showTran:!1,showTranContent:!1,text:n.tranOriText,"is-auto":n.translateAuto,"is-auto-force":n.translateAutoForce,"translate-result":n.translateResult,"from-language":i.data.user&&i.data.user.language,"api-params":s.tranApiParams,style:(0,o.normalizeStyle)([[s.transStyle],{position:"absolute",bottom:"0"}]),aColor:s.tranAColor},null,8,["onOnTranslateFinish","onOnTranslateClick","text","is-auto","is-auto-force","translate-result","from-language","api-params","style","aColor"]))],2)]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var $o=v(Hm,[["render",Um],["styles",[Pm]]]),Gm={center:{"":{alignItems:"center",flexDirection:"row"}},"center-between":{"":{alignItems:"center",flexDirection:"row",justifyContent:"space-between"}},"gift-count":{"":{fontSize:"52rpx",color:"#FF4477",lineHeight:"62rpx",fontWeight:"700",fontStyle:"italic"}},view:{"":{width:"472rpx"}},"view-send":{"":{borderTopLeftRadius:"16rpx",borderTopRightRadius:0,borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-content":{"":{marginTop:"10rpx",marginRight:"10rpx",marginBottom:"10rpx",marginLeft:"10rpx"}},"view-content-send":{"":{borderTopLeftRadius:"16rpx",borderTopRightRadius:0,borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-content-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"f-10":{"":{fontSize:"20rpx"}},"c-red":{"":{color:"#FF4477"}},"p-tb-14":{"":{paddingTop:"28rpx",paddingBottom:"28rpx"}},line:{"":{marginTop:"8rpx",marginRight:"16rpx",marginBottom:0,marginLeft:"16rpx",height:"2rpx",transform:"scaleY(0.5)",opacity:.2}},"text-tip":{"":{flex:1,paddingTop:"10rpx",paddingRight:"16rpx",paddingBottom:"10rpx",paddingLeft:"16rpx"}},"gift-price":{"":{color:"#FFAA0D",fontSize:"24rpx",marginRight:"2rpx",lineHeight:"24rpx"}},"gift-title":{"":{maxWidth:"250rpx",lineHeight:"48rpx"}},"text-rob":{"":{width:"80rpx",lineHeight:"40rpx",borderRadius:"6rpx",fontSize:"18rpx",textAlign:"center",backgroundColor:"#FB6160",color:"#FFFFFF"}}},Wm={components:{MLine:At,MText:de,RichContent:It,LImg:P,MsgUser:Pe},mixins:[Xe],emits:["clickSignGift"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},data(){return{isNeedSignGift:!1,getStatus:this.data.content.status||0,showRobBtn:!1}},computed:{totalMoney(){return this.data.content.price*this.data.content.number},tipStr(){let e=this.data.content;if(e.from_type==_e.GAME)return u("msg.gameFromCenter");if(e.from_type==_e.CLUB||e.from_type==_e.GRAB){if(this.data.isSend){if(e.from_type==_e.GRAB)return u("msg.clubGiftSendRob",{gift_name:e.title,hour:6});if(e.to_uid==0)return u("msg.clubGiftSendToAll",{gift_name:e.title});let t={gift_name:e.title,nickname:e.to_user_info.nickname,other_str:fs(e.to_user_info.sex)};return u("msg.clubGiftSendToOne",t)}return 1}return e.from_type==_e.CALL?this.data.isSend?e.call_type==rt.VIDEO?u("msg.giftSendInVideoChat"):u("msg.giftSendInAudioChat"):e.call_type==rt.VIDEO?u("msg.giftFromVideoCall"):u("msg.giftFromAudioCall"):this.data.isSend?u("msg.giftSendSignTips",{nickname:fs(2),hour:6}):(this.isNeedSignGift=!0,u("msg.giftClickHereToReceive"))},tipsRich(){let e=this.data.content,t,i;return i={nickname:this.pRInfo(pi(this.data.user))},e.from_type==_e.GRAB?t=e.number>1?u("msg.clubGiftSomeoneS"):u("msg.clubGiftSomeone"):e.to_uid==getApp().globalData.uid?t=e.number>1?u("msg.clubGiftToYouS"):u("msg.clubGiftToYou"):e.to_uid==0?t=e.number>1?u("msg.clubGiftToEveryoneS"):u("msg.clubGiftToEveryone"):(t=e.number>1?u("msg.clubGiftToOtherS"):u("msg.clubGiftToOther"),i.to_name=this.pRInfo(e.to_user_info.nickname)),{text:t,info:i}},robStr(){return this.getStatus===2?u("overdue"):this.getStatus===3?u("over"):this.data.content.from_type==_e.GRAB||this.data.content.to_uid==0?this.getStatus==1?u("msg.giftRobbed"):u("rob"):this.getStatus==1?u("received"):u("receive")},playSrc(){return this.data.content.svga_url?"s/msg/gift_play_def.png":""},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":getApp().globalData.themeObj.color.bg3},viewBorder(){return getApp().globalData.themeObj.style==F.LIGHT?this.data.isSend?"1px solid #FFBD9D":"1px solid #FF94D8":this.data.isSend?"1px solid rgba(255, 225, 206, 0.2)":"1px solid rgba(255, 211, 238, 0.2)"},viewLineBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#000000":"#FFFFFF"}},methods:{$str:u,clickSignGift(e){this.checkStopClick(e)||this.isNeedSignGift&&this.$emit("clickSignGift",this.data)},clickGift(e){this.checkStopClick(e)||bi(this.data.content,!0)},clickRob(){if(this.getStatus==3){this.showRobOverAlert();return}if(!this.showRobBtn){Ee(u("tips"),u("msg.giftRobReceiveOnly",{nickname:this.data.content.to_user_info.nickname}),"",u("gotIt"));return}if(this.getStatus)return;this.getStatus=1;let e={chat_id:this.data.chat_id,from_type:this.data.content.from_type,mtime:this.data.mtime};this.data.content.record_id&&(e.record_id=this.data.content.record_id),B.request("/chat/gift/receive",e,!1,!0).then(t=>{M("error","at pagesMsg/coms/msg-gift/msg-gift.vue:209","dasdasdasda ok "+JSON.stringify(t)),t.ok==1?t.data&&t.data.status==2?(this.setGetStatus(2),this.getStatus=2,Ee(u("tips"),u("msg.clubGiftExpired",{gift_name:this.data.content.title}),"",u("gotIt"))):this.setGetStatus(1):t.ok==2&&(this.setGetStatus(3),this.getStatus=3,this.showRobOverAlert())},t=>{M("error","at pagesMsg/coms/msg-gift/msg-gift.vue:224","dasdasdasda "+JSON.stringify(t)),ut(u("tryAgainLater")),this.getStatus=0})},pRInfo(e){return{text:e,color:"#0091FF"}},setGetStatus(e){let t=JSON.parse(this.data.msg_content);t.status=e,nt(this.data.chat_id,this.data.chat_type,this.data.mtime,JSON.stringify(t),0,!1)},showRobOverAlert(){Ee(u("tips"),u("msg.giftRobbedOverTips",{gift_name:this.data.content.title}),"",u("gotIt"))}},created(){this.data.content.from_type==_e.CLUB&&this.data.content.to_uid!=0&&this.data.content.to_uid!=getApp().globalData.uid?this.showRobBtn=!1:this.showRobBtn=!0}};function jm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("m-text"),c=A((0,o.resolveDynamicComponent)("rich-content"),It),p=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(p,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[i.data.isSend?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,class:"center"},[(0,o.createElementVNode)("u-text",{class:"gift-count",style:{"margin-right":"16rpx"}},"x"+(0,o.toDisplayString)(i.data.content.number),1),(0,o.createElementVNode)("view",{class:"view view-send",style:(0,o.normalizeStyle)({background:s.viewBg})},[(0,o.createVNode)(r,{src:"s/msg/gift_x_1.png",w:"180rpx",h:"156rpx",style:{position:"absolute",top:"0",right:"0"}}),(0,o.createElementVNode)("view",{class:"view-content view-content-send",style:(0,o.normalizeStyle)({border:s.viewBorder})},[(0,o.createElementVNode)("view",{class:"center",style:{"padding-top":"20rpx","padding-bottom":"20rpx"}},[(0,o.createElementVNode)("view",{style:{"margin-left":"36rpx"}},[(0,o.createVNode)(r,{onClick:s.clickGift,src:i.data.content.icon,"use-cache":!0,w:"100rpx",h:"100rpx"},null,8,["onClick","src"]),s.playSrc?((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,"need-style":1,onClick:s.clickGift,src:s.playSrc,w:"24rpx",h:"24rpx",style:{position:"absolute",bottom:"0",right:"0"}},null,8,["onClick","src"])):(0,o.createCommentVNode)("",!0)]),(0,o.createElementVNode)("view",{style:{"margin-left":"40rpx"}},[(0,o.createVNode)(l,{text:i.data.content.title,style:{lines:"1","text-overflow":"ellipsis","max-width":"250rpx","line-height":"48rpx","font-size":"34rpx","font-weight":"600"}},null,8,["text"]),(0,o.createElementVNode)("view",{class:"center",style:{"margin-top":"14rpx"}},[(0,o.createVNode)(l,{type:"coin",text:i.data.content.price,style:{"font-size":"24rpx","margin-right":"2rpx","line-height":"24rpx"}},null,8,["text"]),(0,o.createVNode)(r,{src:"s/coin/icon_coin1.png",w:"24rpx",h:"24rpx"})])])]),(0,o.createElementVNode)("view",{class:"line",style:(0,o.normalizeStyle)({background:s.viewLineBg})},null,4),(0,o.createVNode)(l,{text:s.tipStr,style:{"font-size":"20rpx",flex:"1",padding:"10rpx 16rpx"}},null,8,["text"])],4)],4)])):((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:1,class:"center"},[(0,o.createElementVNode)("view",{class:"view view-receive",style:(0,o.normalizeStyle)({background:s.viewBg})},[(0,o.createVNode)(r,{src:"s/msg/gift_x_w.png",w:"180rpx",h:"156rpx",style:{position:"absolute",top:"0",left:"0"}}),(0,o.createElementVNode)("view",{class:"view-content view-content-receive",style:(0,o.normalizeStyle)({border:s.viewBorder})},[(0,o.createElementVNode)("view",{class:"center",style:{"justify-content":"flex-end","padding-top":"20rpx","padding-bottom":"20rpx"}},[(0,o.createElementVNode)("view",{style:{"margin-right":"40rpx"}},[(0,o.createVNode)(l,{text:i.data.content.title,style:{lines:"1","text-overflow":"ellipsis","max-width":"250rpx","line-height":"48rpx","font-size":"34rpx","font-weight":"600"}},null,8,["text"]),(0,o.createElementVNode)("view",{class:"center",style:{"margin-top":"14rpx","justify-content":"flex-end"}},[(0,o.createVNode)(l,{type:"coin",text:i.data.content.price,style:{"font-size":"24rpx","margin-right":"2rpx","line-height":"24rpx"}},null,8,["text"]),(0,o.createVNode)(r,{src:"s/coin/icon_coin1.png",w:"24rpx",h:"24rpx"})])]),(0,o.createElementVNode)("view",{style:{"margin-right":"36rpx"}},[(0,o.createVNode)(r,{onClick:s.clickGift,src:i.data.content.icon,"use-cache":!0,w:"100rpx",h:"100rpx"},null,8,["onClick","src"]),s.playSrc?((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,"need-style":1,onClick:s.clickGift,src:s.playSrc,w:"24rpx",h:"24rpx",style:{position:"absolute",bottom:"0",right:"0"}},null,8,["onClick","src"])):(0,o.createCommentVNode)("",!0)])]),(0,o.createElementVNode)("view",{class:"line",style:(0,o.normalizeStyle)({background:s.viewLineBg})},null,4),s.tipStr==1?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:0,onClick:t[0]||(t[0]=(...h)=>s.clickRob&&s.clickRob(...h)),class:"center-between text-tip"},[(0,o.createVNode)(c,{data:s.tipsRich,color:"#FF4477",style:(0,o.normalizeStyle)({width:n.showRobBtn?"330rpx":"420rpx",background:s.viewBg})},null,8,["data","style"]),n.showRobBtn?((0,o.openBlock)(),(0,o.createElementBlock)("u-text",{key:0,class:"text-rob",style:(0,o.normalizeStyle)({opacity:n.getStatus?"0.4":"1"})},(0,o.toDisplayString)(s.robStr),5)):(0,o.createCommentVNode)("",!0)])):((0,o.openBlock)(),(0,o.createElementBlock)("u-text",{key:1,onClick:t[1]||(t[1]=(...h)=>s.clickSignGift&&s.clickSignGift(...h)),class:"f-10 c-red text-tip"},(0,o.toDisplayString)(s.tipStr),1))],4)],4),(0,o.createElementVNode)("u-text",{class:"gift-count",style:{"margin-left":"16rpx"}},"x"+(0,o.toDisplayString)(i.data.content.number),1)]))]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var Ko=v(Wm,[["render",jm],["styles",[Gm]]]),Vm={components:{MsgUser:Pe},mixins:[Xe],emits:["clickPicture"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},computed:{getWH(){let e=this.data.content;return Bt(e.image_width,e.image_height,200)},border(){return getApp().globalData.themeObj.style==F.LIGHT?"1px solid #EEEEEE":"1px solid #333333"}},methods:{clickPicture(e){this.checkStopClick(e)||this.$emit("clickPicture",this.data)}}};function zm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(l,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{onClick:s.clickPicture,src:i.data.content.small_url,w:s.getWH[0]+"px",h:s.getWH[1]+"px",radius:"16rpx",border:s.border,"place-w":s.getWH[0]-10+"px","place-type":2},null,8,["onClick","src","w","h","border","place-w"])]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var Yo=v(Vm,[["render",zm]]),$m={"msg-video":{"":{position:"relative",alignItems:"center",justifyContent:"center"}},"video-duration":{"":{color:"#FFFFFF",position:"absolute",bottom:0,right:0,paddingTop:"10rpx",paddingRight:"10rpx",paddingBottom:"10rpx",paddingLeft:"10rpx",fontSize:"24rpx"}}},Km={components:{MsgUser:Pe},mixins:[Xe],emits:["clickVideo"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},computed:{getWH(){let e=this.data.content;return Bt(e.width,e.height,200)},getDuration(){return tt(Math.round(this.data.content.duration))},border(){return getApp().globalData.themeObj.style==F.LIGHT?"1px solid #EEEEEE":"1px solid #333333"}},methods:{clickVideo(e){this.checkStopClick(e)||(e.stopPropagation(),this.$emit("clickVideo",this.data))}}};function Ym(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(l,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{onClick:t[0]||(t[0]=(...c)=>s.clickVideo&&s.clickVideo(...c)),class:"msg-video",style:(0,o.normalizeStyle)({width:s.getWH[0]+"px",height:s.getWH[1]+"px"})},[(0,o.createVNode)(r,{onClick:s.clickVideo,src:i.data.content.small_url,w:s.getWH[0]+"px",h:s.getWH[1]+"px","place-w":s.getWH[0]-10+"px","place-type":2,radius:"16rpx",border:s.border},null,8,["onClick","src","w","h","place-w","border"]),(0,o.createVNode)(r,{onClick:s.clickVideo,src:"s/pub/play_video.png",w:"56rpx",h:"56rpx",style:{position:"absolute"}},null,8,["onClick"]),(0,o.createElementVNode)("u-text",{class:"video-duration"},(0,o.toDisplayString)(s.getDuration),1)],4)]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var Jo=v(Km,[["render",Ym],["styles",[$m]]]),Jm={components:{MText:de,MsgUser:Pe},props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},computed:{viewStyle(){let e="";getApp().globalData.themeObj.style==F.LIGHT?e="#FFFFFF":e=this.data.isSend?"#1E5148":"#313131";let t={maxWidth:getApp().globalData.window.width-138+"px",background:e,padding:"24rpx",fontSize:"28rpx"};return t["border-radius"]=this.data.isSend?"16rpx 0 16rpx 16rpx":"16rpx 16rpx 16rpx",t}},data(){return{contentWidth:getApp().globalData.window.width-138}},methods:{$str:u}};function qm(e,t,i,a,n,s){let r=(0,o.resolveComponent)("m-text"),l=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(l,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{text:s.$str("msg.notSupport"),style:(0,o.normalizeStyle)(s.viewStyle)},null,8,["text","style"])]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var qo=v(Jm,[["render",qm]]),Xm={text:{"":{textAlign:"center",fontSize:"24rpx",marginTop:0,marginRight:"36rpx",marginBottom:0,marginLeft:"36rpx"}},center:{"":{flexDirection:"row",alignItems:"center"}},"level-center":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},"view-invite":{"":{alignItems:"center",marginTop:15}},tip:{".view-invite ":{flexDirection:"row",alignItems:"center"}},invite:{".view-invite ":{height:"80rpx",borderRadius:"16rpx",borderWidth:1,borderStyle:"solid",borderColor:"rgba(255,255,255,0.2)",paddingTop:0,paddingRight:"64rpx",paddingBottom:0,paddingLeft:"64rpx"}},"text-view-detail":{"":{textAlign:"center",color:"#FF4477",fontSize:"24rpx",marginRight:"4rpx"}}},Zm={name:"MsgNotice",components:{MView:Dt,MIcon:Bn,MText:de,MLine:At,UniIcons:ge,RichContent:It},props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:-1},clubDisband:{type:[String,Number],default:0},clubTag:{type:[String,Number],default:0},isClubAdmin:{type:[Boolean,Number],default:!1}},data(){return{sWC:getApp().globalData.window.width-uni.upx2px(72),rich:{text:"",info:[],click:[]},textContent:"",hasInvite:!1,hasViewDetail:!1}},watch:{clubDisband(e,t){this.handleDisbandOpenClub(e)},isClubAdmin(){this.data.chat_type!=f.M_CHAT_CLUB||this.data.content.key!=1||(this.hasInvite=this.checkShowInvite())}},computed:{textColor(){return getApp().globalData.themeObj.color.desc},viewRichBg(){return getApp().globalData.themeObj.color.bg1},isLanguageArabic(){return getApp().globalData.languageKey=="ar"},textAlign(){return this.rich.isLong?this.isLanguageArabic?"right":"left":"center"}},methods:{$str:u,clickInvite(){let e={from_type:2,club_id:this.data.club.club_id,tag:this.clubTag};q("/pagesPub/user/user-list",e)},clickViewDetail(){Pt(this.data.club.club_id,1,0)},checkShowInvite(){return this.data.club.club_uid==getApp().globalData.uid?!0:this.isClubAdmin?this.clubTag!=ja.MANAGE_GIRL:!1},handleDisbandOpenClub(e){if(!([ae.JOIN,ae.INVITE_JOIN,ae.CREATE].indexOf(this.data.content.key)!=-1))return;this.rich.click[0]&&this.rich.click[0].action==2&&e&&(this.rich.click[0].disabled=1)},parseContent(){let e=this.data.content;if(e.text){this.rich=e;return}if(e.content){this.textContent=e.content;return}let t="";if(this.data.chat_type==f.M_CHAT_PRI?t=Do(e):t=vo(e,this.data.target_user,this.data.club),typeof t=="string"?this.textContent=t:this.rich=t,this.data.chat_type==f.M_CHAT_CLUB)try{e.key==1?this.hasInvite=this.checkShowInvite():e.key==ae.SET_MANAGER&&(this.hasViewDetail=this.data.content.status==1&&this.data.content.uid==getApp().globalData.uid)}catch(i){}}},created(){this.parseContent(),this.data.chat_type==f.M_CHAT_CLUB&&this.data.club&&this.handleDisbandOpenClub(this.data.club.is_disband)}};function Qm(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("rich-content"),It),l=(0,o.resolveComponent)("m-line"),c=(0,o.resolveComponent)("m-text"),p=(0,o.resolveComponent)("m-icon"),h=(0,o.resolveComponent)("m-view"),g=A((0,o.resolveDynamicComponent)("uni-icons"),ge);return(0,o.openBlock)(),(0,o.createElementBlock)("view",{renderWhole:!0},[n.textContent?((0,o.openBlock)(),(0,o.createElementBlock)("u-text",{key:0,class:"text",style:(0,o.normalizeStyle)({color:s.textColor})},(0,o.toDisplayString)(n.textContent),5)):((0,o.openBlock)(),(0,o.createBlock)(r,{key:1,data:n.rich,"font-size":"24rpx",color:s.textColor,style:(0,o.normalizeStyle)([{margin:"0 36rpx","line-height":"34rpx"},{"text-align":s.textAlign,background:s.viewRichBg}])},null,8,["data","color","style"])),n.hasInvite&&i.clubDisband!=1?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:2,class:"view-invite"},[(0,o.createElementVNode)("view",{class:"tip",style:(0,o.normalizeStyle)({width:`${n.sWC}px`})},[(0,o.createVNode)(l,{style:{flex:"1"}}),(0,o.createVNode)(c,{text:s.$str("msg.clubInviteMember"),type:"desc",style:{margin:"0 16rpx","font-size":"28rpx"}},null,8,["text"]),(0,o.createVNode)(l,{style:{flex:"1"}})],4),(0,o.createVNode)(h,{type:"bg2",style:{"margin-top":"30rpx"}},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{onClick:t[0]||(t[0]=(..._)=>s.clickInvite&&s.clickInvite(..._)),class:"center invite"},[(0,o.createVNode)(p,{type:"plusempty",size:"24rpx",modeType:"title"}),(0,o.createVNode)(c,{text:s.$str("invite"),style:{"font-size":"28rpx","margin-left":"8rpx"}},null,8,["text"])])]),_:1})])):n.hasViewDetail?((0,o.openBlock)(),(0,o.createElementBlock)("view",{key:3,onClick:t[1]||(t[1]=(..._)=>s.clickViewDetail&&s.clickViewDetail(..._)),class:"level-center",style:{padding:"4rpx"}},[(0,o.createElementVNode)("u-text",{class:"text-view-detail"},(0,o.toDisplayString)(s.$str("viewDetails")),1),(0,o.createVNode)(g,{type:"right",size:"24rpx",color:"#FF4477"})])):(0,o.createCommentVNode)("",!0)])}var Xo=v(Zm,[["render",Qm],["styles",[Xm]]]),eg={"msg-notice-sys":{"":{borderRadius:"8rpx",marginTop:0,marginRight:"20rpx",marginBottom:0,marginLeft:"20rpx",paddingTop:"16rpx",paddingRight:"16rpx",paddingBottom:"16rpx",paddingLeft:"16rpx"}}},tg={name:"MsgNoticeSys",components:{MText:de,RichContent:It},props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1}},data(){return{rich:{text:"",info:[],click:[]},textContent:""}},computed:{viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":"#313131"}},methods:{parseContent(){let e=this.data.content;if(e.text){this.rich=e;return}if(e.content){this.textContent=e.content;return}this.textContent=u("unknownMessage")}},created(){this.parseContent()}};function ig(e,t,i,a,n,s){let r=(0,o.resolveComponent)("m-text"),l=A((0,o.resolveDynamicComponent)("rich-content"),It);return(0,o.openBlock)(),(0,o.createElementBlock)("view",{class:"msg-notice-sys",style:(0,o.normalizeStyle)({background:s.viewBg}),renderWhole:!0},[i.data.content.title?((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,text:i.data.content.title,style:{"font-size":"28rpx","font-weight":"500","margin-bottom":"12rpx"}},null,8,["text"])):(0,o.createCommentVNode)("",!0),n.textContent?((0,o.openBlock)(),(0,o.createBlock)(r,{key:1,type:"desc",text:n.textContent,style:{"font-size":"20rpx"}},null,8,["text"])):((0,o.openBlock)(),(0,o.createBlock)(l,{key:2,data:n.rich,"font-size":"24rpx",style:{"background-color":"transparent"}},null,8,["data"]))],4)}var Zo=v(tg,[["render",ig],["styles",[eg]]]),ng={"view-send":{"":{borderTopLeftRadius:"16rpx",borderTopRightRadius:0,borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-content":{"":{width:"472rpx",paddingTop:"20rpx",paddingRight:"24rpx",paddingBottom:"20rpx",paddingLeft:"24rpx",backgroundColor:"#FFFFFF"}},"view-user":{"":{flexDirection:"column",justifyContent:"space-between",height:"96rpx",marginLeft:"20rpx"}},"def-line":{"":{transform:"scaleY(0.5)",width:"420rpx",marginTop:"20rpx",height:"2rpx",opacity:.1}}},sg={components:{MText:de,UBaseInfo:$t,MsgUser:Pe},mixins:[Xe],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},data(){return{user:{}}},computed:{nameWidth(){let e=44;return this.user.level>0&&(e+=56),this.user.is_vip&&(e+=42),uni.upx2px(300)-uni.upx2px(e)},recommendStr(){return this.data.chat_type==2?u("msg.recommendUserToEvery"):u("msg.recommendUserToYou")},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":getApp().globalData.themeObj.color.bg3},viewLineBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#000000":"#FFFFFF"}},methods:{$str:u,clickUser(e){this.checkStopClick(e)||(e.stopPropagation(),this.data.isAdmin==1?Fi(this.data.content.uid):q("/pages/main/user-home",{uid:this.data.content.uid}))}},created(){this.data.content.uid==getApp().pubUser.uid?this.user=getApp().pubUser:this.user=this.data.target_user[this.data.content.uid]||this.data.content}};function ag(e,t,i,a,n,s){let r=(0,o.resolveComponent)("m-text"),l=A((0,o.resolveDynamicComponent)("l-img"),P),c=A((0,o.resolveDynamicComponent)("u-base-info"),$t),p=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(p,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{onClick:t[0]||(t[0]=(...h)=>s.clickUser&&s.clickUser(...h)),class:(0,o.normalizeClass)(["view-content",[i.data.isSend?"view-send":"view-receive"]]),style:(0,o.normalizeStyle)({background:s.viewBg})},[(0,o.createVNode)(r,{text:s.recommendStr,style:{"font-size":"24rpx"}},null,8,["text"]),(0,o.createElementVNode)("view",{style:{"flex-direction":"row","margin-top":"16rpx"}},[(0,o.createVNode)(l,{src:n.user.avatar,w:"96rpx",h:"96rpx",radius:"8rpx"},null,8,["src"]),(0,o.createElementVNode)("view",{class:"view-user"},[(0,o.createVNode)(c,{info:n.user,"name-width":`${s.nameWidth}px`},null,8,["info","name-width"]),(0,o.createVNode)(r,{text:s.$str("id")+": "+n.user.uid,style:{"font-size":"24rpx",opacity:".7"}},null,8,["text"])])]),(0,o.createElementVNode)("view",{class:"def-line",style:(0,o.normalizeStyle)({background:s.viewLineBg})},null,4),(0,o.createVNode)(r,{text:s.$str("userCard"),style:{"font-size":"20rpx",opacity:".7","margin-top":"12rpx"}},null,8,["text"])],6)]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var Qo=v(sg,[["render",ag],["styles",[ng]]]),rg={"view-send":{"":{borderTopLeftRadius:"16rpx",borderTopRightRadius:0,borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-content":{"":{width:"472rpx",paddingTop:"20rpx",paddingRight:"24rpx",paddingBottom:"20rpx",paddingLeft:"24rpx"}},"view-club":{"":{flexDirection:"column",justifyContent:"space-between",height:"96rpx",marginLeft:"20rpx"}},"def-line":{"":{transform:"scaleY(0.5)",width:"420rpx",marginTop:"20rpx",height:"2rpx",opacity:.1}}},og={components:{MText:de,MsgUser:Pe},mixins:[Xe],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},computed:{recommendStr(){return this.data.chat_type==2?u("msg.recommendToEvery"):u("msg.recommendToYou")},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":getApp().globalData.themeObj.color.bg3},viewLineBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#000000":"#FFFFFF"}},methods:{$str:u,clickClub(e){this.checkStopClick(e)||(e&&e.stopPropagation(),bn()==1?q(Ot.adminClubInfo,{club_id:this.data.content.club_id}):Pt(this.data.content.club_id))}}};function lg(e,t,i,a,n,s){let r=(0,o.resolveComponent)("m-text"),l=A((0,o.resolveDynamicComponent)("l-img"),P),c=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(c,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("view",{onClick:t[0]||(t[0]=(...p)=>s.clickClub&&s.clickClub(...p)),class:(0,o.normalizeClass)(["view-content",[i.data.isSend?"view-send":"view-receive"]]),style:(0,o.normalizeStyle)({background:s.viewBg})},[(0,o.createVNode)(r,{text:s.recommendStr,style:{"font-size":"24rpx"}},null,8,["text"]),(0,o.createElementVNode)("view",{style:{"flex-direction":"row","margin-top":"16rpx"}},[(0,o.createVNode)(l,{src:i.data.content.club_logo,w:"96rpx",h:"96rpx",radius:"8rpx"},null,8,["src"]),(0,o.createElementVNode)("view",{class:"view-club"},[(0,o.createVNode)(r,{text:i.data.content.club_name,style:{"font-size":"28rpx","font-weight":"500",lines:"1","text-overflow":"ellipsis",width:"300rpx"}},null,8,["text"]),(0,o.createVNode)(r,{text:i.data.content.intro,style:{"font-size":"24rpx",opacity:"0.7",lines:"1","text-overflow":"ellipsis",width:"300rpx"}},null,8,["text"])])]),(0,o.createElementVNode)("view",{class:"def-line",style:(0,o.normalizeStyle)({background:s.viewLineBg})},null,4),(0,o.createVNode)(r,{text:s.$str("clubCard"),style:{"font-size":"20rpx","margin-top":"12rpx",opacity:".7"}},null,8,["text"])],6)]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var el=v(og,[["render",lg],["styles",[rg]]]),cg={components:{MsgUser:Pe},mixins:[Xe],emits:["clickPicture"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1},readTime:{type:[String,Number],default:0}},computed:{getWH(){let e=this.data.content;return Bt(e.image_width,e.image_height)}},methods:{clickPicture(e){if(this.checkStopClick(e))return;let t=this.data.content.path,i=nn(!1,t,t);ui([i],0,0)}}};function ug(e,t,i,a,n,s){let r=A((0,o.resolveDynamicComponent)("l-img"),P),l=(0,o.resolveComponent)("msg-user");return(0,o.openBlock)(),(0,o.createBlock)(l,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType,"read-time":i.readTime},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(r,{onClick:s.clickPicture,src:i.data.content.path,w:s.getWH[0]+"px",h:s.getWH[1]+"px",radius:"8rpx"},null,8,["onClick","src","w","h"])]),_:1},8,["data","chat-type","user","is-send","index","list-type","read-time"])}var tl=v(cg,[["render",ug]]);var Z=ee(ie());var dg={"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"send-voice":{"":{borderTopLeftRadius:"8rpx",borderTopRightRadius:0,borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}},"receive-voice":{"":{borderTopLeftRadius:0,borderTopRightRadius:"8rpx",borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}},"unread-point":{"":{width:"16rpx",height:"16rpx",borderRadius:"8rpx",backgroundColor:"#FF4545",marginLeft:"8rpx"}},"view-voice":{"":{alignItems:"center",flexDirection:"row"}},"view-content":{"":{alignItems:"center",flexDirection:"row",width:"400rpx",height:"76rpx"}},"text-duration":{"":{paddingTop:0,paddingRight:"24rpx",paddingBottom:0,paddingLeft:"26rpx",textAlign:"center",fontSize:"28rpx",lineHeight:"40rpx"}}},pg={components:{MText:de,MsgUser:Pe,CustomSlider:Pn},mixins:[Xe],emits:["clickMsgVoice","onMsgVoiceChange"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1}},data(){return{iconPlay:"s/msg/audio_msg_play.png",sliderValue:0,curDuration:this.data.content.voice_duration,sliderH:uni.upx2px(24)}},computed:{durationStr(){return this.curDuration<=0?"00:00":tt(this.curDuration)},sliderActColor(){return getApp().globalData.themeObj.style==F.LIGHT?"#333333":"#FFFFFF"},sliderBgColor(){return getApp().globalData.themeObj.style==F.LIGHT?"rgba(0, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?this.data.isSend?"#E1FFC3":"#FFFFFF":this.data.isSend?"#1E5148":"#313131"}},methods:{clickVoice(e){e&&e.stopPropagation(),bs(()=>{this.checkStopClick(e)||(M("log","at pagesMsg/coms/msg-voice/msg-voice.vue:80","\u70B9\u51FB\u64AD\u653E\u8BED\u97F3 clickVoice \u6267\u884C ----> "),this.$emit("clickMsgVoice",this.data,this.curDuration==this.data.content.voice_duration?0:this.curDuration))},500,"msg-voice-click")},changeDuration(e,t){e==-1&&(e=this.data.content.voice_duration),this.curDuration=e,this.sliderValue=parseInt(t/this.data.content.voice_duration)},changeIcon(e){this.iconPlay=`s/msg/audio_msg_${e?"pause":"play"}.png`},onSliderChangeStart(){this.$emit("onMsgVoiceChange",!1,this.curDuration,this.data)},onSliderChanged(e){let t=e/100;this.curDuration=Math.round(this.data.content.voice_duration*t),this.$emit("onMsgVoiceChange",!0,this.curDuration,this.data)}}};function hg(e,t,i,a,n,s){let r=A((0,Z.resolveDynamicComponent)("l-img"),P),l=(0,Z.resolveComponent)("CustomSlider"),c=(0,Z.resolveComponent)("m-text"),p=(0,Z.resolveComponent)("msg-user");return(0,Z.openBlock)(),(0,Z.createBlock)(p,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType},{default:(0,Z.withCtx)(()=>[(0,Z.createElementVNode)("view",{class:"view-voice",onClick:t[1]||(t[1]=(...h)=>s.clickVoice&&s.clickVoice(...h))},[(0,Z.createElementVNode)("view",{class:(0,Z.normalizeClass)(["view-content",[i.data.isSend?"send-voice":"receive-voice"]]),style:(0,Z.normalizeStyle)({background:s.viewBg})},[(0,Z.createElementVNode)("view",{onClick:t[0]||(t[0]=(...h)=>s.clickVoice&&s.clickVoice(...h)),class:"center-align",style:{width:"66rpx",height:"68rpx"}},[(0,Z.createVNode)(r,{onClick:s.clickVoice,src:n.iconPlay,needStyle:1,w:"26rpx",h:"26rpx"},null,8,["onClick","src"])]),(0,Z.createVNode)(l,{ref:"audioSlider",style:(0,Z.normalizeStyle)([{flex:"1"},{height:`${n.sliderH}px`}]),"max-value":n.sliderValue,"fill-value":100,"active-color":s.sliderActColor,"inactive-color":s.sliderBgColor,"dis-click":!0,blockColor:s.sliderActColor,"line-height":4,onOnChangeStart:s.onSliderChangeStart,onOnChanged:s.onSliderChanged},null,8,["style","max-value","active-color","inactive-color","blockColor","onOnChangeStart","onOnChanged"]),(0,Z.createVNode)(c,{text:s.durationStr,style:{padding:"0 24rpx 0 26rpx","text-align":"center","font-size":"28rpx","line-height":"40rpx"}},null,8,["text"])],6),!i.data.isSend&&i.data.content.voice_unread==0?((0,Z.openBlock)(),(0,Z.createElementBlock)("view",{key:0,class:"unread-point"})):(0,Z.createCommentVNode)("",!0)])]),_:1},8,["data","chat-type","user","is-send","index","list-type"])}var il=v(pg,[["render",hg],["styles",[dg]]]),mg={"msg-recharge":{"":{borderRadius:4,marginTop:0,marginRight:"20rpx",marginBottom:0,marginLeft:"20rpx"}},"text-tip":{"":{fontSize:"24rpx",paddingTop:"20rpx",paddingRight:"16rpx",paddingBottom:0,paddingLeft:"16rpx"}},"text-recharge":{"":{color:"#FF953F",fontSize:"24rpx",paddingTop:"20rpx",paddingRight:"16rpx",paddingBottom:"20rpx",paddingLeft:"16rpx",textDecoration:"underline"}}},gg={components:{MText:de},props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1}},computed:{tipStr(){return this.data.content.tips?this.data.content.tips:this.data.content.type==2?u("rulesMsgSendTip"):this.data.content.type==1?this.data.chat_type==2?u("msg.clubSendConsumeCoinTips",{number:ri(this.data.content.coins||1)}):u("msg.sendMsgAfterRechargeTips",{whom:Ve(this.data.user.sex)}):""},actionStr(){return this.data.content.type==2?u("rulesOfPlatform"):u("rechargeNow")},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":getApp().globalData.themeObj.color.bg3}},methods:{$str:u,clickTipStr(){this.data.content.type==2&&this.openRule()},clickAction(){this.data.content.type==1?wt(0,1):this.data.content.type==2&&this.openRule()},openRule(){q("/pagesPub/agreement/platform-rules")}}};function fg(e,t,i,a,n,s){let r=(0,Z.resolveComponent)("m-text");return(0,Z.openBlock)(),(0,Z.createElementBlock)("view",{class:"msg-recharge",style:(0,Z.normalizeStyle)({background:s.viewBg}),renderWhole:!0},[(0,Z.createVNode)(r,{onClick:s.clickTipStr,text:s.tipStr,style:{"font-size":"24rpx",padding:"20rpx 16rpx 0 16rpx"}},null,8,["onClick","text"]),(0,Z.createElementVNode)("u-text",{onClick:t[0]||(t[0]=(...l)=>s.clickAction&&s.clickAction(...l)),class:"text-recharge"},(0,Z.toDisplayString)(s.actionStr),1)],4)}var nl=v(gg,[["render",fg],["styles",[mg]]]);var Ze=ee(ie()),_g={"view-info":{"":{height:"40rpx",flexDirection:"row",alignItems:"center",borderRadius:"4rpx"}},point:{"":{width:"14rpx",height:"14rpx",borderRadius:"8rpx",marginRight:"4rpx"}},text:{"":{fontSize:"22rpx",lineHeight:"40rpx",fontWeight:"600"}}},yg={components:{MText:de},props:{status:{type:Number,default:0},upTime:{type:[Number,String],default:0}},data(){return{}},computed:{colorVal(){return getApp().globalData.themeObj.style==F.LIGHT?this.status==1?"#34C759":this.status==2?"#FF9537":"#999999":this.status==1?"#2A9F47":this.status==2?"#CC7732":"#666666"},onlineStr(){return this.status==1?u("available"):this.status==2?u("chatting"):this.status==3?u("anchorSet.rest"):this.upTime==0?u("time.daysAgo",{number:"3"}):lr(this.upTime)}},methods:{}};function bg(e,t,i,a,n,s){let r=(0,Ze.resolveComponent)("m-text");return(0,Ze.openBlock)(),(0,Ze.createElementBlock)("view",{class:"view-info",renderWhole:!0},[(0,Ze.createElementVNode)("view",{class:"point",style:(0,Ze.normalizeStyle)({background:s.colorVal})},null,4),(0,Ze.createVNode)(r,{type:"tip",text:s.onlineStr,style:{"font-size":"24rpx"}},null,8,["text"])])}var Zs=v(yg,[["render",bg],["styles",[_g]]]);var He=ee(ie()),xg={text:{"":{color:"#333333"}},"text-small":{"":{fontSize:"32rpx",fontWeight:"600"}},"text-big":{"":{fontSize:"80rpx",fontWeight:"800"}}},wg={emits:[],props:{sizeType:{type:Number,default:1},gameInfo:{type:Object,default(){return{}}},draw:{type:Boolean,default:!1}},data(){return{number:1,timer:!1,isDrawing:0,resNumber:0}},watch:{gameInfo:{handler(e,t){ar(e)||typeof t!="undefined"&&e.status==t.status||(M("error","at pagesGame/coms/lottery-number.vue:42","lottery-number watch "+JSON.stringify(e)),e.status==0?this.reset():e.status==1?this.startDrawing():this.showLuckNumber(e.result))},immediate:!0,deep:!0},draw:{handler(e,t){e&&this.startDrawing()}}},computed:{textClass(){return this.sizeType==1?"text-small":"text-big"},imgW(){return this.sizeType==1?"36rpx":"72rpx"}},methods:{clearTimer(){this.timer&&(clearInterval(this.timer),this.timer=!1)},startDrawing(){this.isDrawing=1,this.clearTimer(),this.timer=setInterval(()=>{let e=rr(0,9);e==this.number&&(e=e+1>9?8:e+1),this.number=e},100)},showLuckNumber(e){this.isDrawing=2,this.clearTimer(),this.resNumber=e},reset(){this.clearTimer(),this.isDrawing=0}},created(){},unmounted(){this.clearTimer()}};function Cg(e,t,i,a,n,s){let r=A((0,He.resolveDynamicComponent)("l-img"),P);return(0,He.openBlock)(),(0,He.createElementBlock)("view",{renderWhole:!0},[n.isDrawing==0?((0,He.openBlock)(),(0,He.createBlock)(r,{key:0,src:"s/game/lottery-def-1.png",w:s.imgW,h:s.imgW},null,8,["w","h"])):((0,He.openBlock)(),(0,He.createElementBlock)("u-text",{key:1,class:(0,He.normalizeClass)(["text",[s.textClass]])},(0,He.toDisplayString)(n.isDrawing==1?n.number:n.resNumber),3))])}var sl=v(wg,[["render",Cg],["styles",[xg]]]);var te=ee(ie());var Sg={"center-column":{"":{flexDirection:"column",alignItems:"center"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"confirm-pop":{"":{paddingTop:"20rpx",paddingRight:"40rpx",paddingBottom:"40rpx",paddingLeft:"40rpx",backgroundColor:"#FFFFFF",borderRadius:"16rpx"}},"gift-title":{".confirm-pop ":{fontSize:"34rpx",lineHeight:"48rpx",fontWeight:"600",marginTop:"10rpx",textAlign:"center"}},price:{".confirm-pop ":{fontSize:"24rpx",color:"#FFAA0D",marginRight:"4rpx"}},"reminder-text":{".confirm-pop ":{fontSize:"24rpx",marginLeft:"8rpx",lineHeight:"24rpx"}},"send-btn":{".confirm-pop ":{color:"#FFFFFF",fontSize:"28rpx",height:"88rpx",marginTop:"36rpx",borderRadius:"16rpx",lineHeight:"88rpx",textAlign:"center",backgroundImage:"linear-gradient(to right, #FF00BD, #FF5954)"}}},kg={components:{LImg:P,UniPopup:St},emits:["onSendGift","onClickCancel"],data(){return{data:{content:{}},textNodes:"",popWidth:getApp().globalData.window.width-80,btnWidth:getApp().globalData.window.width-120,status:1,reminderIcon:"s/msg/no_reminder_s_1.png"}},computed:{},methods:{$str:u,clickPop(e){e.stopPropagation()},clickCancel(){this.$emit("onClickCancel"),this.$refs.confirmSendPop.close()},clickSend(){this.data.content.count=1,this.$emit("onSendGift",this.data.content),this.$refs.confirmSendPop.close(),this.status==1&&se("send_ask_gift_status",this.status)},clickNotReminder(){this.status==0?(this.status=1,this.reminderIcon="s/msg/no_reminder_s_1.png"):(this.status=0,this.reminderIcon="s/msg/no_reminder_n_1.png")},parseNodes(){let e=this.data.content.price>1?u("coinsLower"):u("coinLower");return[{name:"div",children:[{type:"text",text:u("msg.giftWorth")},{type:"text",text:"&nbsp;"+this.data.content.price,attrs:{style:"color: #FFAA0D;"}},{type:"text",text:"&nbsp;"+e+". "+u("msg.giftSureToGiveAway")+"?"}]}]},open(e){this.data=e,this.textNodes=this.parseNodes(),this.$nextTick(()=>{this.$refs.confirmSendPop.open()})}}};function Ag(e,t,i,a,n,s){let r=A((0,te.resolveDynamicComponent)("l-img"),P),l=(0,te.resolveComponent)("rich-text"),c=A((0,te.resolveDynamicComponent)("uni-popup"),St);return(0,te.openBlock)(),(0,te.createBlock)(c,{"is-mask-click":!1,"mask-click":!1,mode:"center",ref:"confirmSendPop"},{default:(0,te.withCtx)(()=>[(0,te.createElementVNode)("view",{onClick:t[2]||(t[2]=(...p)=>s.clickPop&&s.clickPop(...p))},[(0,te.createElementVNode)("view",{style:(0,te.normalizeStyle)({width:`${n.popWidth}px`}),class:"confirm-pop center-column"},[(0,te.createVNode)(r,{src:n.data.content.icon,h:"144rpx",w:"144rpx"},null,8,["src"]),(0,te.createElementVNode)("u-text",{class:"gift-title"},(0,te.toDisplayString)(n.data.content.title),1),(0,te.createElementVNode)("view",{class:"center-align",style:{"margin-top":"10rpx"}},[(0,te.createElementVNode)("u-text",{class:"price"},(0,te.toDisplayString)(n.data.content.price),1),(0,te.createVNode)(r,{h:"18rpx",src:"s/my/i_coins.png",w:"18rpx"})]),(0,te.createVNode)(l,{nodes:n.textNodes,style:{"align-items":"center","flex-direction":"row","justify-content":"center","font-size":"30rpx","text-align":"center","margin-top":"32rpx","background-color":"transparent"}},null,8,["nodes"]),(0,te.createElementVNode)("view",{onClick:t[0]||(t[0]=(...p)=>s.clickNotReminder&&s.clickNotReminder(...p)),class:"center-align",style:{"margin-top":"36rpx"}},[(0,te.createVNode)(r,{src:n.reminderIcon,h:"24rpx",w:"24rpx"},null,8,["src"]),(0,te.createElementVNode)("u-text",{class:"reminder-text"},(0,te.toDisplayString)(s.$str("noMoreReminder")),1)]),(0,te.createElementVNode)("u-text",{style:(0,te.normalizeStyle)({width:`${n.btnWidth}px`}),onClick:t[1]||(t[1]=(...p)=>s.clickSend&&s.clickSend(...p)),class:"send-btn"},(0,te.toDisplayString)(s.$str("send")),5)],4),(0,te.createElementVNode)("view",{class:"center-align",style:{"margin-top":"48rpx"}},[(0,te.createVNode)(r,{onClick:s.clickCancel,h:"72rpx",src:"s/msg/close_white.png",w:"72rpx"},null,8,["onClick"])])])]),_:1},512)}var al=v(kg,[["render",Ag],["styles",[Sg]]]);var Pb=ee(Kn());var Tg=xe("dom"),vg={mixins:[Bo],data(){return{chatId:0,chatType:f.M_CHAT_PRI,user:{},msgHasMore:!0,moreActions:[],userAlbum:[],gameInfo:!1,isAuth:fe(),barComWords:"",showCall:!1,showGift:!1,giftFromType:_e.MSG,giftIsAsk:!1,translateAuto:!1,useBg1_1:!1,refreshUser:!1,hideOnline:!0,initFinish:void 0,hasNoReply:void 0,isSaveCheatMsg:!1,titleMaxWidth:getApp().globalData.window.width-100,webview:null}},methods:{$str:u,clickTitle(){uni.hideKeyboard(),hn(this.chatId)},clickBarGiftAsk(){this.giftIsAsk=!0,this.$nextTick(()=>{this.$refs.giftSheet.open(this.chatId)})},clickBarWords(){le.sendText(this.chatId,this.barComWords),this.barComWords=""},clickSignGift(){this.$refs.msgBar.focus()},clickCall(e){let t=this.user.video?this.user.video:"";io(e,this.user,t,un.MSG),e==1&&qr("chat_click",!0,!0)},changeBlack(e){this.user.is_black=e},changeMsgBarScroll(){let e=fe();this.user.is_auth&&e||(this.showCall=!0,this.showGift=!0,ko(this.chatId,this.chatType,getApp().pubUser.uid).then(t=>{!e&&t<=0&&(this.barComWords="Hi, baby \u{1F60D}")}),this.$nextTick(()=>{this.scrollBottom()}))},getAge(e){return y(e.birthday)?"":" "+oi(e.birthday)},resend(e){le.resend(e)},receiveMsg(e){e.chat_id!=this.chatId||e.chat_type!=this.chatType||(this.addMsg(e,this.user),this.handleShowNoReplyNotice())},sendMsg(e,t=!0){this.addMsg(e,this.user,()=>{t&&this.$refs[`msg${e.ctime}`][0].showLoading()})},sendMsgFinishAfter(e,t){getApp().globalData.s.commit("message/addSendCount")},addMsgFirst(){let e=K.parseSendData(this.chatId,f.M_CHAT_PRI,1e4,""),t=getApp().getCTime();e.ctime=t,e.mtime=t*1e3,e.send_uid=1;let i=K.parseItem(e,this.user);this.messageNone?this.addList.push(i):this.historyList.push(i)},addMsgReport(){let e={title:u("msg.attention"),content:`${u("msg.chatTipDef")}
${u("msg.chatPriReportTip",{him:Ve(this.user.sex)})}`},t;this.historyList.length<=0?t=getApp().getCTime():t=this.historyList[this.historyList.length-1].ctime;let i=K.parseSendData(this.chatId,f.M_CHAT_PRI,f.M_NOTICE_SYS,JSON.stringify(e));i.ctime=t,i.mtime=t;let a=K.parseItem(i,this.user);this.messageNone?this.addList.push(a):this.historyList.push(a)},handleExtra(e){typeof e.game_id!="undefined"&&(this.gameInfo=e)},onSend(e){this.clearReplyMsgData(),le.sendText(this.chatId,e)},onSendGift(e){le.sendGift(this.chatId,e)},onSendAskGift(e){le.sendAskGift(this.chatId,e)},onRecordFinishNext(e){!e||!e.path||!e.duration||le.sendVoice(this.chatId,e.path,e.duration)},onChoosePicture(e,t){e==0?le.sendPicture(this.chatId,t.path,t.width,t.height):e==1?le.sendVideo(this.chatId,t.path,t.coverPath,t.width,t.height,t.duration):e==2?le.sendPaidPhoto(this.chatId,t.url,t.width,t.height,t.content):e==3&&le.sendPaidVideo(this.chatId,t.url,t.cover_url,t.width,t.height,t.duration,t.content)},onChooseExpressImg(e){le.sendExpressionImg(this.chatId,e.path,e.width,e.height)},onClickSendAsk(e){if(X("send_ask_gift_status")){e.content.count=1,this.onSendGift(e.content);return}this.$refs.sendAskGiftPop.open(e)},onClickActionItem(e){e.key=="black"?Tr(this.user.uid,this.user.is_black,()=>{this.user.is_black=!this.user.is_black}):e.key=="report"&&q("/pagesPub/my/report",{type:1,targetId:this.user.uid})},onKeyboardChangeNext(e){},onActionOpenNext(e,t){},onLoadMore(){return Ge(this,null,function*(){this.messageNone||this.msgHasMore&&(yield this.loadMessage(),this.$nextTick(()=>{this.$refs.msgList.resetLoadmore(),this.msgHasMore||(this.addMsgTimeByFirst(),this.addMsgReport(),this.addMsgFirst())}))})},refreshMessage(){return Ge(this,null,function*(){this.indexCTime=0,this.indexMTime=0,this.addList=[],this.historyList=[],this.messageNone=1,yield this.loadMessage()})},handleShowNoReplyNotice(){fe()&&vr(this.user)&&this.hasNoReply!=!1&&this.initFinish!=null&&(this.isSaveCheatMsg||(this.isSaveCheatMsg=!0,xi(this.chatId,this.chatType).then(e=>{if(!e){this.isSaveCheatMsg=!1;return}if([f.M_NOTICE,f.M_CALL].indexOf(e.msg_type)!=-1){this.isSaveCheatMsg=!1;return}let i=e.remark;if(i){let c=re(i);this.hasNoReply=c.no_reply_notice!=1}else this.hasNoReply=!0;if(!(this.hasNoReply&&e.send_uid==this.chatId)){this.isSaveCheatMsg=!1;return}let n=re(e.msg_content),s={key:si.NOT_CHEAT_USER,income:n.income,income_uid:n.income_uid,can_sign:n.can_sign},r=K.parseSendData(this.chatId,f.M_CHAT_PRI,f.M_NOTICE,JSON.stringify(s));r.mtime=e.mtime+1,r.ctime=e.ctime+1,r.remark=JSON.stringify({no_reply_notice:1}),this.addMsg(r,this.user);let l={chat_id:this.chatId,chat_type:this.chatType,data:{msg_content:JSON.stringify({key:si.NOT_CHEAT_USER}),msg_type:f.M_NOTICE}};B.request("/chat/msg/send",l).then(c=>{c&&c.ok==1&&(r.mtime=c.data.mtime,zt(r,!1).then(()=>{this.isSaveCheatMsg=!1}))})})))},loadMessage(){return Ge(this,null,function*(){let e=yield le.getList(this.chatId,this.chatType,this.indexCTime,this.indexMTime);this.indexCTime==0&&!e.hasMore?this.messageNone=1:this.messageNone=0,this.indexCTime=e.ctime,this.indexMTime=e.mtime,this.msgHasMore=e.hasMore;let t=[];if(this.messageNone){if(this.addMsgFirst(),this.addMsgReport(),e.rows.length>0){let i=e.rows[e.rows.length-1];t.push(K.parseMsgTime(i?i.ctime:new Date().getTime()))}for(let i=e.forLen-1,a=0;i>=a;i--)this.parseMsgItem(t,e.rows[i],2,i);this.addList=[...this.addList,...t],this.translateAuto&&e.rows.length>0&&this.addMsgTranslateTip(!0,!0),this.$nextTick(()=>{this.scrollBottom(),this.showMask=!1})}else{this.showMask=!1;for(let i=0,a=e.forLen;i<a;i++)this.parseMsgItem(t,e.rows[i],1,i);this.$nextTick(()=>{this.historyList=[...this.historyList,...t],this.translateAuto&&this.addMsgTranslateTip(!0,!0)})}return e.rows})},setOnlineStatusPoint(e){Tg.getComponentRect(this.$refs.titleText,t=>{if(t&&t.size){let i=getApp().globalData.window.width,a=parseInt(t.size.width);a>this.titleMaxWidth&&(a=this.titleMaxWidth);let n=a+(i-a)/2+4;hr(e,n,this.webview)}})},setWebview(){let e=getCurrentPages(),t=e[e.length-1];this.webview=t.$getAppWebview()},parseData(e){try{let t=e.user_info;this.hideOnline=t.hide_online==1,e.send_alert_tips&&(t.send_alert_tips=e.send_alert_tips),e.send_limit_level&&(t.send_limit_level=e.send_limit_level),y(e.album)||(this.userAlbum=e.album),this.initData(t),this.$refs.msgFirst&&this.$refs.msgFirst[0].setUser(this.user)}catch(t){M("error","at pagesMsg/pri/chat-pri.mixin.js:348",`parse chat pri ${this.chatId} data error`)}},initData(e){e.small_avatar&&(e.avatar=e.small_avatar),this.user=e,this.navBarTitle=pi(e);let t=this.getAge(e);t&&(this.navBarTitle=this.navBarTitle+","+t)},initView(){return new Promise(e=>{B.request("/chat/msg/detail",{chat_id:this.chatId}).then(t=>{this.translateAuto=mn(t.data.user_info.language),this.parseData(t.data),Xa("chat_pri_data",t.data,this.chatId),e();let i=JSON.parse(JSON.stringify(t.data.user_info));i.small_avatar&&(i.avatar=i.small_avatar),Vt(i,!0).then(()=>{if(this.refreshUser){let a={user:i,chat_id:this.chatId,chat_type:f.M_CHAT_PRI};uni.$emit("event_refresh_index_item_info",a)}}),this.initFinish=!0,this.handleShowNoReplyNotice(),this.setOnlineStatusPoint(i.online_status)})})},initUser(e){return typeof e=="object"&&(this.navBarTitle=e.nickname+this.getAge(e)),new Promise(t=>{Tn(this.chatId,!1).then(i=>{i&&this.initData(i),t()})})}},onNavigationBarButtonTap(){let e=this.user.is_black?u("unblock"):u("block");this.moreActions=[{key:"black",title:e},{key:"report",title:u("report")}],this.$nextTick(()=>{this.$refs.moreAction.open()})},onShow(){this.clearIndexUnread()},onReady(){this.initTitle()},onUnload(){uni.offKeyboardHeightChange(this.onKeyboardChange),uni.$off("event_msg_popover",this.onMsgItemPopListener),uni.$off("event_msg_fail_click",this.clickFail),uni.$off("event_chat_pri",this.receiveMsg),uni.$off("event_sync_finish_index",this.handleSyncFinish),uni.$off("event_change_black",this.changeBlack),uni.$emit("event_message_pri_close")},onLoad(e){this.chatId=e.uid,e.refreshUser&&(this.refreshUser=e.refreshUser),this.getOpenerEventChannel().on("priData",t=>{let i=t.user;this.initUser(i).then(()=>{let a=hs("chat_pri_data",this.chatId);return a&&this.parseData(a),this.initView(),En(this.chatId,this.chatType)}).then(()=>this.loadMessage()).then(()=>{this.changeMsgBarScroll(),t.extra&&this.handleExtra(t.extra)})}),this.setWebview(),le.sendMsg=this.sendMsg,le.sendMsgFinish=this.sendMsgFinish,le.sendMsgBefore=this.sendMsgBefore,uni.onKeyboardHeightChange(this.onKeyboardChange),uni.$on("event_msg_popover",this.onMsgItemPopListener),uni.$on("event_msg_fail_click",this.clickFail),uni.$on("event_chat_pri",this.receiveMsg),uni.$on("event_sync_finish_index",this.handleSyncFinish),uni.$on("event_change_black",this.changeBlack)}},Dg={center:{"":{alignItems:"center",flexDirection:"row"}},"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"msg-first":{"":{position:"relative",paddingTop:10,paddingRight:10,paddingBottom:10,paddingLeft:10,borderRadius:"8rpx",marginLeft:10}},"fee-cover":{"":{position:"absolute",opacity:.96,borderRadius:"8rpx",backgroundImage:"linear-gradient(to right, #FF95E4, #FF9A97)",top:0,left:0}},"more-text":{".fee-cover ":{color:"#FFFFFF",fontSize:"24rpx"}},"user-info":{"":{paddingTop:"18rpx"}},pos:{"":{position:"absolute",top:0,left:0}}},Lg={name:"MsgFirst",components:{MView:Dt,OnlineBlock:Zs,AvatarImg:Gi,UniIcons:ge,LImg:P,UBaseInfo:$t},props:{width:{type:Number,default:0},info:{type:[Object,Boolean],default:!1},album:{type:Array,default(){return[]}},hideOnline:{type:Boolean,default:!1}},data(){return{user:this.info,videoFlag:f.VIDEO,albumArr:[],hasMore:!1}},computed:{getImgWH(){let e=parseInt((this.width-58)/4),t=e*1.325,i=(e-25)/2,a=(t-25)/2;return[e,t,i,a]},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":"#313131"},viewFeeCoverBg(){return getApp().globalData.themeObj.style==F.LIGHT?"linear-gradient(to right, #FF95E4, #FF9A97)":"linear-gradient(to right, #80025E, #802C2C)"}},watch:{album(){this.parseAlbum()}},methods:{$str:u,clickUser(){q("/pages/main/user-home",{uid:this.user.uid})},parseAlbum(){if(this.albumArr=[],y(this.album)){this.albumArr.push({small_url:Sn(this.user),media_type:1});return}let e=this.album.length;if(e<=4){this.albumArr=this.album;return}this.hasMore=!0;for(let t=0;t<e;t++)t<=3&&this.albumArr.push(this.album[t])},setUser(e){this.user=e,this.parseAlbum()}},created(){this.parseAlbum()}};function Eg(e,t,i,a,n,s){let r=A((0,d.resolveDynamicComponent)("l-img"),P),l=A((0,d.resolveDynamicComponent)("uni-icons"),ge),c=A((0,d.resolveDynamicComponent)("u-base-info"),$t),p=A((0,d.resolveDynamicComponent)("online-block"),Zs);return(0,d.openBlock)(),(0,d.createElementBlock)("view",{onClick:t[0]||(t[0]=(...h)=>s.clickUser&&s.clickUser(...h)),class:"msg-first user-album",style:(0,d.normalizeStyle)({width:`${i.width-20}px`,background:s.viewBg}),renderWhole:!0},[n.albumArr.length>0?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:0,class:"center"},[((0,d.openBlock)(!0),(0,d.createElementBlock)(d.Fragment,null,(0,d.renderList)(n.albumArr,(h,g)=>((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:"a"+g,style:(0,d.normalizeStyle)({marginRight:g<3?"6px":0})},[(0,d.createVNode)(r,{src:h.small_url,w:`${s.getImgWH[0]}px`,h:`${s.getImgWH[1]}px`,radius:"8rpx","place-w":`${s.getImgWH[0]-10}px`,"place-type":2},null,8,["src","w","h","place-w"]),h.media_type==n.videoFlag?((0,d.openBlock)(),(0,d.createBlock)(r,{key:0,src:"s/user/video_play.png",w:"25px",h:"25px",style:(0,d.normalizeStyle)([{position:"absolute"},{marginLeft:`${s.getImgWH[2]}px`,marginTop:`${s.getImgWH[3]}px`}])},null,8,["style"])):(0,d.createCommentVNode)("",!0),h.check_price>0||n.hasMore&&g==3?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:1,class:"fee-cover center-align",style:(0,d.normalizeStyle)({width:`${s.getImgWH[0]}px`,height:`${s.getImgWH[1]}px`,background:s.viewFeeCoverBg})},[g==3&&n.hasMore?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:0,style:{"flex-direction":"row"}},[(0,d.createElementVNode)("u-text",{class:"more-text"},(0,d.toDisplayString)(s.$str("more")),1),(0,d.createVNode)(l,{type:"right",size:"12px",color:"#FFFFFF"})])):((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:1,style:(0,d.normalizeStyle)({width:`${s.getImgWH[0]}px`,height:`${s.getImgWH[1]}px`}),class:"pos"},[(0,d.createVNode)(r,{src:"s/user/media_fee_bg.png",w:`${s.getImgWH[0]}px`,h:`${s.getImgWH[1]}px`,radius:"8rpx"},null,8,["w","h"]),(0,d.createVNode)(r,{src:h.media_type==1?"s/anchor/i_fee_photo2.png":"s/anchor/i_fee_video2.png",w:"32rpx",h:"32rpx",style:{position:"absolute",top:"10rpx",left:"10rpx"}},null,8,["src"])],4))],4)):(0,d.createCommentVNode)("",!0)],4))),128))])):(0,d.createCommentVNode)("",!0),(0,d.createElementVNode)("view",{class:"center user-info"},[(0,d.createVNode)(c,{info:n.user,nameWidth:"350rpx","show-country":!0,fw:500},null,8,["info"]),i.hideOnline?(0,d.createCommentVNode)("",!0):((0,d.openBlock)(),(0,d.createBlock)(p,{key:0,status:n.user.online_status,"up-time":n.user.uptime},null,8,["status","up-time"]))])],4)}var Ig=v(Lg,[["render",Eg],["styles",[Dg]]]),Rg={"call-bg":{"":{paddingTop:0,paddingRight:"20rpx",paddingBottom:0,paddingLeft:"20rpx",height:"76rpx",flexDirection:"row",alignItems:"center"}},"call-bg-send":{"":{textAlign:"right",borderTopLeftRadius:"8rpx",borderTopRightRadius:0,borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}},"call-bg-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"8rpx",borderBottomRightRadius:"8rpx",borderBottomLeftRadius:"8rpx"}}},Mg={components:{MText:de,MsgUser:Pe},props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1}},computed:{callIcon(){return this.data.content.call_type==rt.VIDEO?"s/msg/call_video_l.png":"s/msg/call_voice_l_1.png"},callStr(){return Lo(this.data.content.call_status,this.data.isSend,this.data.target_user.sex,this.data.content.duration)},sendIconStyle(){return this.data.content.call_type==rt.VIDEO?{transform:"rotate(180deg)"}:{}},contentBg(){return getApp().globalData.themeObj.style==F.LIGHT?this.data.isSend?"#E1FFC3":"#FFFFFF":this.data.isSend?"#1E5148":"#313131"}}};function Og(e,t,i,a,n,s){let r=(0,d.resolveComponent)("m-text"),l=A((0,d.resolveDynamicComponent)("l-img"),P),c=(0,d.resolveComponent)("msg-user");return(0,d.openBlock)(),(0,d.createBlock)(c,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType},{default:(0,d.withCtx)(()=>[i.data.isSend?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:0,class:"call-bg call-bg-send",style:(0,d.normalizeStyle)({background:s.contentBg})},[(0,d.createVNode)(r,{text:s.callStr,style:{"font-size":"30rpx","margin-right":"20rpx"}},null,8,["text"]),(0,d.createVNode)(l,{src:s.callIcon,needStyle:1,w:"40rpx",h:"40rpx",style:(0,d.normalizeStyle)(s.sendIconStyle)},null,8,["src","style"])],4)):((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:1,class:"call-bg call-bg-receive",style:(0,d.normalizeStyle)({background:s.contentBg})},[(0,d.createVNode)(l,{src:s.callIcon,needStyle:1,w:"40rpx",h:"40rpx"},null,8,["src"]),(0,d.createVNode)(r,{text:s.callStr,style:{"font-size":"30rpx","margin-left":"20rpx"}},null,8,["text"])],4))]),_:1},8,["data","chat-type","user","is-send","index","list-type"])}var Fg=v(Mg,[["render",Og],["styles",[Rg]]]),Ng={center:{"":{alignItems:"center",flexDirection:"row"}},"center-between":{"":{alignItems:"center",flexDirection:"row",justifyContent:"space-between"}},view:{"":{width:"472rpx"}},"view-send":{"":{borderTopLeftRadius:"16rpx",borderTopRightRadius:0,borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-receive":{"":{borderTopLeftRadius:0,borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-content":{"":{marginTop:"10rpx",marginRight:"10rpx",marginBottom:"10rpx",marginLeft:"10rpx"}},"view-content-send":{"":{borderWidth:1,borderStyle:"solid",borderColor:"#6A3AB6",borderTopLeftRadius:"16rpx",borderTopRightRadius:0,borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"view-content-receive":{"":{borderWidth:1,borderStyle:"solid",borderColor:"#FF94D8",borderTopLeftRadius:0,borderTopRightRadius:"16rpx",borderBottomRightRadius:"16rpx",borderBottomLeftRadius:"16rpx"}},"f-12":{"":{fontSize:"24rpx"}},"f-17":{"":{fontSize:"34rpx",fontWeight:"600"}},"c-white":{"":{color:"#FFFFFF"}},"c-black":{"":{color:"#333333"}},"c-pink":{"":{color:"#FF2D96"}},line:{"":{marginTop:0,marginRight:"16rpx",marginBottom:0,marginLeft:"16rpx",height:"2rpx",transform:"scaleY(0.5)",opacity:.2}},"text-tip":{"":{flex:1,marginTop:"10rpx",marginRight:"16rpx",marginBottom:"10rpx",marginLeft:"16rpx"}},"text-want":{"":{width:"270rpx",marginLeft:"16rpx",marginRight:"16rpx"}},"view-send-gift":{"":{alignItems:"center",flexDirection:"row",justifyContent:"flex-end",marginTop:"10rpx",marginRight:"16rpx",marginBottom:"10rpx",marginLeft:"16rpx"}},"text-price":{".view-send-gift ":{color:"#FFB000",fontSize:"22rpx",marginRight:"4rpx"}},"btn-send":{".view-send-gift ":{fontSize:"24rpx",marginLeft:"16rpx",color:"#FFFFFF",backgroundImage:"linear-gradient(to right, #FF00BD, #FF5954)",borderRadius:"10rpx",paddingTop:0,paddingRight:"10rpx",paddingBottom:0,paddingLeft:"10rpx",lineHeight:"48rpx"}}},Bg={components:{MText:de,MsgUser:Pe},mixins:[Xe],emits:["onClickSendAsk"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1}},data(){return{}},computed:{getAskText(){return this.data.content.content||u("msg.giftAskText")},sendAskStr(){return u("msg.giftAskedOtherFor",{whom:Ve(this.data.target_user?this.data.target_user.sex:1)})},giveStr(){return`${u("give")} ${Ve(this.data.user.sex)}`},viewBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#FFFFFF":getApp().globalData.themeObj.color.bg3},viewBorder(){return getApp().globalData.themeObj.style==F.LIGHT?this.data.isSend?"1px solid #FFBD9D":"1px solid #FF94D8":this.data.isSend?"1px solid rgba(255, 225, 206, 0.2)":"1px solid rgba(255, 211, 238, 0.2)"},viewLineBg(){return getApp().globalData.themeObj.style==F.LIGHT?"#000000":"#FFFFFF"}},methods:{$str:u,clickSendGift(){this.data.content.from_ask=1,this.$emit("onClickSendAsk",this.data)}}};function Pg(e,t,i,a,n,s){let r=A((0,d.resolveDynamicComponent)("l-img"),P),l=(0,d.resolveComponent)("m-text"),c=(0,d.resolveComponent)("msg-user");return(0,d.openBlock)(),(0,d.createBlock)(c,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType},{default:(0,d.withCtx)(()=>[i.data.isSend?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:0,class:"view view-send",style:(0,d.normalizeStyle)({background:s.viewBg})},[(0,d.createVNode)(r,{src:"s/msg/gift_x_1.png",w:"180rpx",h:"156rpx",style:{position:"absolute",top:"0",right:"0"}}),(0,d.createElementVNode)("view",{class:"view-content view-content-send",style:(0,d.normalizeStyle)({border:s.viewBorder})},[(0,d.createElementVNode)("view",{class:"center",style:{"padding-top":"24rpx","padding-bottom":"24rpx"}},[(0,d.createVNode)(r,{src:i.data.content.icon,"use-cache":!0,w:"100rpx",h:"100rpx",style:{"margin-left":"16rpx"}},null,8,["src"]),(0,d.createElementVNode)("view",{style:{"margin-left":"40rpx"}},[(0,d.createVNode)(l,{text:s.sendAskStr,style:{"font-size":"24rpx"}},null,8,["text"]),(0,d.createVNode)(l,{text:i.data.content.title,style:{"font-size":"34rpx"}},null,8,["text"])])]),(0,d.createElementVNode)("view",{class:"line",style:(0,d.normalizeStyle)({background:s.viewLineBg})},null,4),(0,d.createVNode)(l,{text:s.getAskText,style:{flex:"1",margin:"10rpx 16rpx","font-size":"24rpx"}},null,8,["text"])],4)],4)):((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:1,class:"view view-receive",style:(0,d.normalizeStyle)({background:s.viewBg})},[(0,d.createVNode)(r,{src:"s/msg/gift_x_w.png",w:"180rpx",h:"156rpx",style:{position:"absolute",top:"0",left:"0"}}),(0,d.createElementVNode)("view",{class:"view-content view-content-receive",style:(0,d.normalizeStyle)({border:s.viewBorder})},[(0,d.createElementVNode)("view",{class:"center",style:{"padding-top":"24rpx","padding-bottom":"24rpx"}},[(0,d.createVNode)(l,{text:s.$str("msg.giftAskText"),style:{"font-size":"24rpx",width:"270rpx","margin-left":"40rpx","margin-right":"16rpx"}},null,8,["text"]),(0,d.createVNode)(r,{src:i.data.content.icon,"use-cache":!0,w:"100rpx",h:"100rpx"},null,8,["src"])]),(0,d.createElementVNode)("view",{class:"line",style:(0,d.normalizeStyle)({background:s.viewLineBg})},null,4),(0,d.createElementVNode)("view",{class:"view-send-gift",style:{"margin-top":"16rpx"}},[(0,d.createElementVNode)("view",{class:"center"},[(0,d.createVNode)(l,{type:"coin",text:i.data.content.price,style:{"font-size":"22rpx","margin-right":"4rpx"}},null,8,["text"]),(0,d.createVNode)(r,{src:"s/my/i_coins.png",w:"18rpx",h:"18rpx"})]),(0,d.createElementVNode)("u-text",{onClick:t[0]||(t[0]=(...p)=>s.clickSendGift&&s.clickSendGift(...p)),class:"btn-send"},(0,d.toDisplayString)(s.giveStr),1)])],4)],4))]),_:1},8,["data","chat-type","user","is-send","index","list-type"])}var Hg=v(Bg,[["render",Pg],["styles",[Ng]]]),Ug={"center-align":{"":{alignItems:"center",flexDirection:"row",justifyContent:"center"}},"paid-cover":{"":{top:0,position:"absolute",flexDirection:"column",alignItems:"center",justifyContent:"center"}},"fee-bg":{"":{backgroundColor:"rgba(50,29,106,0.96)"}},"fee-bg-none":{"":{backgroundColor:"rgba(0,0,0,0)"}},"paid-video-cover":{"":{alignItems:"center",flexDirection:"row",top:0,position:"absolute",borderRadius:"16rpx",justifyContent:"center",backgroundColor:"rgba(0,0,0,0)"}},price:{"":{color:"#FF953F",fontSize:"20rpx",lineHeight:"26rpx",textAlign:"center"},".paid-cover ":{marginTop:"8rpx"}},"radius-16":{"":{borderBottomLeftRadius:"16rpx",borderBottomRightRadius:"16rpx",borderTopLeftRadius:"16rpx",borderTopRightRadius:"16rpx"}},"split-line":{"":{height:"2rpx",opacity:.1,transform:"scaleY(0.5)",transformOrigin:"50% 100%",backgroundColor:"#FFFFFF",marginTop:"-2rpx"}},"checked-wrap":{"":{height:"48rpx",alignItems:"center",flexDirection:"row",justifyContent:"space-between",backgroundImage:"linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.5))"}},"checked-price":{".checked-wrap ":{alignItems:"center",flexDirection:"row",marginLeft:"8rpx"}},duration:{".checked-wrap ":{fontSize:"20rpx",color:"#FFFFFF",marginRight:"8rpx"}},"view-content":{"":{borderRadius:"16rpx"}},"text-content":{"":{borderBottomLeftRadius:"16rpx",borderBottomRightRadius:"16rpx",borderTopLeftRadius:0,borderTopRightRadius:0,color:"#FFFFFF",paddingTop:"14rpx",paddingRight:"20rpx",paddingBottom:"14rpx",paddingLeft:"20rpx",fontSize:"20rpx",lines:2,lineHeight:"26rpx",overflow:"hidden",textOverflow:"ellipsis"}},"bottom-text":{"":{position:"absolute",bottom:"-2rpx"}}},Gg={components:{MsgUser:Pe},mixins:[Xe],emits:["clickPaidPicture"],props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1},listType:{type:Number,default:1}},data(){return{price:this.data.msg_type==f.M_PAID_PHOTO?getApp().globalData.feePhotoPrice:getApp().globalData.feeVideoPrice,checkStatus:this.data.content.check_status||this.data.isSend?1:0}},computed:{getIconMTop(){return this.data.content.content?"-56rpx":0},getWH(){let e=this.data.content,t=[];return e.cover_url?t=Bt(e.width,e.height,200):t=Bt(e.image_width,e.image_height,200),t[1]<uni.upx2px(246)&&(t[1]=uni.upx2px(246)),t},getPaidIcon(){return this.data.content.media_type==f.PHOTO?"s/anchor/i_fee_photo2.png":"s/anchor/i_fee_video2.png"},getDuration(){return y(this.data.content.duration)?"":tt(Math.round(this.data.content.duration))},lockImg(){return this.data.isSend||this.checkStatus==0?"s/anchor/paid_lock.png":"s/msg/dollar_w.png"}},methods:{$str:u,clickPicture(e){this.checkStopClick(e)||(e&&e.stopPropagation(),this.data.isSend||this.data.content.check_status==1||this.data.isAdmin==1?this.$emit("clickPaidPicture",this.data):this.checkFree())},checkFree(){if(this.checkStatus==1){this.openPreview();return}if(!di(this.price))return;if(X("check_paid_photo_status_"+getApp().globalData.uid))this.reqCheck();else{let t={onFeeMediaDialogListener:this.onFeeMediaDialogListener},i=JSON.parse(JSON.stringify(this.data.content));i.media_type==f.PHOTO&&(i.url=i.small_url),ce("/pagesDialog/paid-photo",{uid:this.data.chat_id,fromType:2},"paidAlbumsData",i,t)}},onFeeMediaDialogListener(){this.reqCheck()},reqCheck(){let e={chat_id:this.data.chat_id,media_id:this.data.content.media_id,mtime:this.data.mtime};B.request("/chat/album/view",e,!0).then(t=>{this.openPreview(),this.checkStatus=1,Co(this.data.chat_id,this.data.chat_type,e.mtime,0,!1).then(i=>{let a=JSON.parse(i.msg_content);a.check_status=1,nt(this.data.chat_id,this.data.chat_type,0,JSON.stringify(a),i.id,!1)})})},openPreview(){ui([fn(this.data,this.data.content)],0,0)}},created(){}};function Wg(e,t,i,a,n,s){let r=A((0,d.resolveDynamicComponent)("l-img"),P),l=(0,d.resolveComponent)("msg-user");return(0,d.openBlock)(),(0,d.createBlock)(l,{ref:"msgUser",data:i.data,"chat-type":i.data.chat_type,user:i.data.user,"is-send":i.data.isSend,index:i.index,"list-type":i.listType},{default:(0,d.withCtx)(()=>[(0,d.createElementVNode)("view",{onClick:t[0]||(t[0]=(...c)=>s.clickPicture&&s.clickPicture(...c)),style:(0,d.normalizeStyle)({width:`${s.getWH[0]}px`,height:`${s.getWH[1]}px`}),class:"view-content"},[n.checkStatus==0?((0,d.openBlock)(),(0,d.createBlock)(r,{key:0,onClick:s.clickPicture,src:i.data.content.small_url||i.data.content.cover_url,w:`${s.getWH[0]}px`,h:`${s.getWH[1]}px`,radius:"16rpx"},null,8,["onClick","src","w","h"])):(0,d.createCommentVNode)("",!0),n.checkStatus==0?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:1,class:(0,d.normalizeClass)([[i.data.content.content?"":"center-align"],"paid-cover fee-bg radius-16"]),style:(0,d.normalizeStyle)({width:`${s.getWH[0]}px`,height:`${s.getWH[1]}px`})},[(0,d.createVNode)(r,{src:"s/user/media_fee_bg.png",w:`${s.getWH[0]}px`,h:`${s.getWH[1]}px`,radius:"16rpx",style:{position:"absolute",top:"0",left:"0"}},null,8,["w","h"]),(0,d.createVNode)(r,{src:s.getPaidIcon,style:(0,d.normalizeStyle)({marginTop:s.getIconMTop}),onClick:s.clickPicture,h:"64rpx",w:"64rpx"},null,8,["src","style","onClick"]),(0,d.createElementVNode)("u-text",{class:"price"},(0,d.toDisplayString)(i.data.content.price)+" "+(0,d.toDisplayString)(s.$str("coinsLower")),1)],6)):n.checkStatus==1?((0,d.openBlock)(),(0,d.createBlock)(r,{key:2,onClick:s.clickPicture,src:i.data.content.small_url||i.data.content.cover_url,w:`${s.getWH[0]}px`,h:`${s.getWH[1]}px`,radius:"16rpx",style:{position:"absolute",top:"0",left:"0"}},null,8,["onClick","src","w","h"])):(0,d.createCommentVNode)("",!0),n.checkStatus==1?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:3,style:(0,d.normalizeStyle)({width:`${s.getWH[0]}px`,height:`${s.getWH[1]}px`}),class:"paid-video-cover"},[i.data.content.media_type==2?((0,d.openBlock)(),(0,d.createBlock)(r,{key:0,onClick:s.clickPicture,h:"56rpx",src:"s/anchor/video_play.png",style:{"margin-top":"-28rpx"},w:"56rpx"},null,8,["onClick"])):(0,d.createCommentVNode)("",!0)],4)):(0,d.createCommentVNode)("",!0),(0,d.createElementVNode)("view",{class:"bottom-text radius-16"},[n.checkStatus==1?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:0,style:(0,d.normalizeStyle)({width:`${s.getWH[0]}px`}),class:"checked-wrap"},[(0,d.createElementVNode)("view",{class:"checked-price"},[(0,d.createVNode)(r,{onClick:s.clickPicture,src:s.lockImg,w:"26rpx",h:"24rpx"},null,8,["onClick","src"]),(0,d.createElementVNode)("u-text",{class:"price"},(0,d.toDisplayString)(n.price)+" "+(0,d.toDisplayString)(s.$str("coinsLower")),1)]),i.data.msg_type==26?((0,d.openBlock)(),(0,d.createElementBlock)("u-text",{key:0,class:"duration"},(0,d.toDisplayString)(s.getDuration),1)):(0,d.createCommentVNode)("",!0)],4)):(0,d.createCommentVNode)("",!0),i.data.content.content?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:1,class:"split-line"})):(0,d.createCommentVNode)("",!0),i.data.content.content?((0,d.openBlock)(),(0,d.createElementBlock)("u-text",{key:2,style:(0,d.normalizeStyle)({width:`${s.getWH[0]}px`,background:n.checkStatus==1?"#321D6A":""}),class:"text-content"},(0,d.toDisplayString)(i.data.content.content),5)):(0,d.createCommentVNode)("",!0)])],4)]),_:1},8,["data","chat-type","user","is-send","index","list-type"])}var jg=v(Gg,[["render",Wg],["styles",[Ug]]]),Vg={"center-align":{"":{flexDirection:"row",alignItems:"center",justifyContent:"center"}},container:{"":{backgroundColor:"#FFFFFF",paddingTop:"30rpx",paddingRight:0,paddingBottom:"30rpx",paddingLeft:0,borderRadius:"112rpx",marginTop:0,marginRight:15,marginBottom:0,marginLeft:15}}},zg={props:{data:{type:Object,default(){return{}}},index:{type:Number,default:-1}},data(){return{bgW:getApp().globalData.window.width-84,bgUrl:""}},computed:{getSideDis(){return 27+this.bgW*.193},getAvatar(){let e=this.data.user,t=this.data.target_user,i=e.small_avatar||e.avatar,a=t.small_avatar||t.avatar;return e.is_auth?[a,i]:[i,a]}},created(){this.bgUrl=this.data.content.type==6?"s/game/game_match_success_bg.png":"s/msg/match_success_bg.png"}};function $g(e,t,i,a,n,s){let r=A((0,d.resolveDynamicComponent)("l-img"),P);return(0,d.openBlock)(),(0,d.createElementBlock)("view",{class:"container center-align",renderWhole:!0},[(0,d.createVNode)(r,{w:`${n.bgW}px`,h:"166rpx",src:n.bgUrl},null,8,["w","src"]),(0,d.createVNode)(r,{src:s.getAvatar[0],style:(0,d.normalizeStyle)([{left:`${s.getSideDis}px`},{position:"absolute",bottom:"30rpx","z-index":"11"}]),h:"88rpx",radius:"44rpx",w:"88rpx"},null,8,["src","style"]),(0,d.createVNode)(r,{src:s.getAvatar[1],style:(0,d.normalizeStyle)([{right:`${s.getSideDis}px`},{position:"absolute",bottom:"30rpx","z-index":"11"}]),h:"88rpx",radius:"44rpx",w:"88rpx"},null,8,["src","style"])])}var Kg=v(zg,[["render",$g],["styles",[Vg]]]),Yg={"center-align":{"":{alignItems:"center",justifyContent:"center",flexDirection:"row"}},"level-center":{"":{alignItems:"center",flexDirection:"row"}},"msg-list":{"":{flex:1}},"rotate-list":{"":{transform:"rotate(180deg)"}},"loading-more":{"":{flex:1,alignItems:"center",justifyContent:"center",flexDirection:"row",height:40}},"mask-view":{"":{position:"absolute",top:0}},"lottery-view":{"":{position:"absolute",right:"20rpx",bottom:"320rpx"}},"msg-def":{"":{opacity:1,transitionProperty:"opacity",transitionDuration:500,transitionTimingFunction:"ease-out"}},"reply-flashing":{"":{opacity:.2}},"title-text":{"":{fontSize:17,height:1,position:"absolute",bottom:0,opacity:0,lines:1,overflow:"hidden",textOverflow:"ellipsis"}},"@TRANSITION":{"msg-def":{property:"opacity",duration:500,timingFunction:"ease-out"}}},Jg={components:{MsgBar:jo,MsgBarScroll:Vo,MsgText:$o,MsgGift:Ko,MsgVoice:il,MsgPicture:Yo,MsgVideo:Jo,MsgUnkonwn:qo,MsgFirst:Ig,MsgNotice:Xo,MsgNoticeSys:Zo,MsgCall:Fg,MsgRecharge:nl,MsgUser:Pe,MsgGiftAsk:Hg,MsgPaidPhoto:jg,MsgRecommendUser:Qo,MsgRecommendClub:el,MsgExpression:tl,MsgItemPop:No,NoticeView:Vs,GiftSheet:js,LotteryView:sl,MsgMatchSuccess:Kg,SendAskGiftPop:al,GPageMeta:Ns,MText:de,MsgBarReply:zo,CallEvaluate:zs},mixins:[uo,Hr,vg,Fo]};function qg(e,t,i,a,n,s){let r=A((0,d.resolveDynamicComponent)("g-page-meta"),Ns),l=(0,d.resolveComponent)("m-text"),c=(0,d.resolveComponent)("MsgText"),p=(0,d.resolveComponent)("MsgVoice"),h=(0,d.resolveComponent)("msg-picture"),g=(0,d.resolveComponent)("msg-gift"),_=(0,d.resolveComponent)("msg-notice"),C=(0,d.resolveComponent)("msg-call"),b=(0,d.resolveComponent)("msg-video"),N=(0,d.resolveComponent)("msg-gift-ask"),L=(0,d.resolveComponent)("msg-notice-sys"),O=(0,d.resolveComponent)("msg-expression"),W=(0,d.resolveComponent)("msg-recommend-user"),Y=(0,d.resolveComponent)("msg-recommend-club"),D=(0,d.resolveComponent)("msg-paid-photo"),J=(0,d.resolveComponent)("msg-recharge"),Me=(0,d.resolveComponent)("msg-match-success"),st=(0,d.resolveComponent)("msg-first"),ke=(0,d.resolveComponent)("msg-unkonwn"),Ue=A((0,d.resolveDynamicComponent)("uni-load-more"),Gt),ze=(0,d.resolveComponent)("msg-bar-scroll"),Kt=(0,d.resolveComponent)("msg-bar-reply"),Yt=(0,d.resolveComponent)("msg-bar"),Jt=(0,d.resolveComponent)("msg-item-pop"),Si=(0,d.resolveComponent)("send-ask-gift-pop"),Gn=A((0,d.resolveDynamicComponent)("action-sheet"),Ui),gt=(0,d.resolveComponent)("lottery-view"),zi=A((0,d.resolveDynamicComponent)("gift-sheet"),js),Wn=A((0,d.resolveDynamicComponent)("notice-view"),Vs),jn=A((0,d.resolveDynamicComponent)("call-evaluate"),zs);return(0,d.openBlock)(),(0,d.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,d.createVNode)(r,{title:e.navBarTitle},null,8,["title"]),(0,d.createElementVNode)("view",{style:(0,d.normalizeStyle)([{height:`${e.viewHeight}px`},e.pageBg])},[(0,d.createElementVNode)("list",{onClick:t[1]||(t[1]=(...x)=>e.clickMsgList&&e.clickMsgList(...x)),ref:"msgList",class:(0,d.normalizeClass)(["msg-list",[e.classRotate]]),showScrollbar:!1,loadmoreoffset:20,offsetAccuracy:10,onLoadmore:t[2]||(t[2]=(...x)=>e.onLoadMore&&e.onLoadMore(...x)),scrollable:e.scrollable},[(0,d.createElementVNode)("cell",{ref:"cellLast",style:(0,d.normalizeStyle)({width:`${e.sw}px`,height:`${e.itemHeightFirst}px`})},null,4),(0,d.createElementVNode)("cell",null,[(0,d.createElementVNode)("list",{showScrollbar:!1,scrollable:!1,class:(0,d.normalizeClass)([e.classRotate])},[((0,d.openBlock)(!0),(0,d.createElementBlock)(d.Fragment,null,(0,d.renderList)(e.addList,(x,Q)=>((0,d.openBlock)(),(0,d.createElementBlock)("cell",{key:"key"+x.ctime,ref_for:!0,ref:"cell"+x.mtime,onClick:t[0]||(t[0]=(...ea)=>e.clickMsgList&&e.clickMsgList(...ea)),style:{"padding-bottom":"28rpx"},class:(0,d.normalizeClass)(["msg-def",[e.replyMsgMtime==x.mtime?"reply-flashing":""]])},[x.msg_type==1e3?((0,d.openBlock)(),(0,d.createBlock)(l,{key:0,type:"desc",text:x.showTime,style:{"font-size":"24rpx","text-align":"center"}},null,8,["text"])):x.msg_type==1?((0,d.openBlock)(),(0,d.createBlock)(c,{key:1,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2,onOnClickTextReplyContent:e.onClickTextReplyContent},null,8,["data","index","onOnClickTextReplyContent"])):x.msg_type==2?((0,d.openBlock)(),(0,d.createBlock)(p,{key:2,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2,onClickMsgVoice:e.clickMsgVoice,onOnMsgVoiceChange:e.onMsgVoiceChange},null,8,["data","index","onClickMsgVoice","onOnMsgVoiceChange"])):x.msg_type==3?((0,d.openBlock)(),(0,d.createBlock)(h,{key:3,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2,onClickPicture:e.clickPicture},null,8,["data","index","onClickPicture"])):x.msg_type==5?((0,d.openBlock)(),(0,d.createBlock)(g,{key:4,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2,onClickSignGift:e.clickSignGift},null,8,["data","index","onClickSignGift"])):x.msg_type==6?((0,d.openBlock)(),(0,d.createBlock)(_,{key:5,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==8?((0,d.openBlock)(),(0,d.createBlock)(C,{key:6,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==18?((0,d.openBlock)(),(0,d.createBlock)(b,{key:7,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2,onClickVideo:e.clickPicture},null,8,["data","index","onClickVideo"])):x.msg_type==21?((0,d.openBlock)(),(0,d.createBlock)(N,{key:8,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2,targetUser:e.user,onOnClickSendAsk:e.onClickSendAsk},null,8,["data","index","targetUser","onOnClickSendAsk"])):x.msg_type==22?((0,d.openBlock)(),(0,d.createBlock)(L,{key:9,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==23?((0,d.openBlock)(),(0,d.createBlock)(O,{key:10,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickPicture:e.clickPicture,listType:2},null,8,["data","index","onClickPicture"])):x.msg_type==11?((0,d.openBlock)(),(0,d.createBlock)(W,{key:11,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==12?((0,d.openBlock)(),(0,d.createBlock)(Y,{key:12,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==25||x.msg_type==26?((0,d.openBlock)(),(0,d.createBlock)(D,{key:13,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickPaidPicture:e.clickPicture,listType:2},null,8,["data","index","onClickPaidPicture"])):x.msg_type==1001?((0,d.openBlock)(),(0,d.createBlock)(J,{key:14,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==27?((0,d.openBlock)(),(0,d.createBlock)(Me,{key:15,data:x,index:Q,listType:2},null,8,["data","index"])):x.msg_type==1e4?((0,d.openBlock)(),(0,d.createBlock)(st,{key:16,ref_for:!0,ref:"msgFirst",data:x,index:Q,width:e.sw,info:x.user,album:e.userAlbum,"hide-online":e.hideOnline},null,8,["data","index","width","info","album","hide-online"])):((0,d.openBlock)(),(0,d.createBlock)(ke,{key:17,data:x,listType:2},null,8,["data"]))],2))),128))],2)]),((0,d.openBlock)(!0),(0,d.createElementBlock)(d.Fragment,null,(0,d.renderList)(e.historyList,(x,Q)=>((0,d.openBlock)(),(0,d.createElementBlock)("cell",{key:"cell"+x.ctime,ref_for:!0,ref:"cell"+x.mtime,style:{"padding-bottom":"28rpx"},class:(0,d.normalizeClass)(["msg-def",[e.classRotate,e.replyMsgMtime==x.mtime?"reply-flashing":""]])},[x.msg_type==1e3?((0,d.openBlock)(),(0,d.createBlock)(l,{key:0,type:"desc",text:x.showTime,style:{"font-size":"24rpx","text-align":"center"}},null,8,["text"])):x.msg_type==1?((0,d.openBlock)(),(0,d.createBlock)(c,{key:1,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onOnClickTextReplyContent:e.onClickTextReplyContent},null,8,["data","index","onOnClickTextReplyContent"])):x.msg_type==2?((0,d.openBlock)(),(0,d.createBlock)(p,{key:2,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickMsgVoice:e.clickMsgVoice,onOnMsgVoiceChange:e.onMsgVoiceChange},null,8,["data","index","onClickMsgVoice","onOnMsgVoiceChange"])):x.msg_type==3?((0,d.openBlock)(),(0,d.createBlock)(h,{key:3,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickPicture:e.clickPicture},null,8,["data","index","onClickPicture"])):x.msg_type==5?((0,d.openBlock)(),(0,d.createBlock)(g,{key:4,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickSignGift:e.clickSignGift},null,8,["data","index","onClickSignGift"])):x.msg_type==6?((0,d.openBlock)(),(0,d.createBlock)(_,{key:5,data:x,index:Q},null,8,["data","index"])):x.msg_type==8?((0,d.openBlock)(),(0,d.createBlock)(C,{key:6,data:x,index:Q},null,8,["data","index"])):x.msg_type==18?((0,d.openBlock)(),(0,d.createBlock)(b,{key:7,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickVideo:e.clickPicture},null,8,["data","index","onClickVideo"])):x.msg_type==21?((0,d.openBlock)(),(0,d.createBlock)(N,{key:8,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,targetUser:e.user,onOnClickSendAsk:e.onClickSendAsk},null,8,["data","index","targetUser","onOnClickSendAsk"])):x.msg_type==22?((0,d.openBlock)(),(0,d.createBlock)(L,{key:9,data:x,index:Q},null,8,["data","index"])):x.msg_type==23?((0,d.openBlock)(),(0,d.createBlock)(O,{key:10,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickPicture:e.clickPicture},null,8,["data","index","onClickPicture"])):x.msg_type==11?((0,d.openBlock)(),(0,d.createBlock)(W,{key:11,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q},null,8,["data","index"])):x.msg_type==12?((0,d.openBlock)(),(0,d.createBlock)(Y,{key:12,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q},null,8,["data","index"])):x.msg_type==25||x.msg_type==26?((0,d.openBlock)(),(0,d.createBlock)(D,{key:13,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q,onClickPaidPicture:e.clickPicture},null,8,["data","index","onClickPaidPicture"])):x.msg_type==1001?((0,d.openBlock)(),(0,d.createBlock)(J,{key:14,ref_for:!0,ref:"msg"+x.ctime,data:x,index:Q},null,8,["data","index"])):x.msg_type==27?((0,d.openBlock)(),(0,d.createBlock)(Me,{key:15,data:x,index:Q},null,8,["data","index"])):x.msg_type==1e4?((0,d.openBlock)(),(0,d.createBlock)(st,{key:16,ref_for:!0,ref:"msgFirst",data:x,index:Q,width:e.sw,info:x.user,album:e.userAlbum,"hide-online":e.hideOnline},null,8,["data","index","width","info","album","hide-online"])):((0,d.openBlock)(),(0,d.createBlock)(ke,{key:17,data:x},null,8,["data"]))],2))),128)),(0,d.createElementVNode)("cell",{style:(0,d.normalizeStyle)({width:`${e.sw}px`,height:`${e.changeHBottom}px`})},null,4),(0,d.createElementVNode)("cell",{ref:"cellNew",style:(0,d.normalizeStyle)({width:`${e.sw}px`,height:`${e.itemHeightLast}px`})},null,4),e.msgHasMore?((0,d.openBlock)(),(0,d.createElementBlock)("cell",{key:0},[(0,d.createElementVNode)("view",{class:(0,d.normalizeClass)(["center-align loading-more",[e.classRotate]])},[(0,d.createVNode)(Ue,{style:{height:"30px"},showText:!1,status:"loading",iconSize:14,color:"#333333"})],2)])):(0,d.createCommentVNode)("",!0)],42,["scrollable"]),(0,d.createVNode)(Yt,{ref:"msgBar",chatType:e.chatType,actionId:e.chatId,userInfo:e.user,onOnSend:e.onSend,onOnChoosePicture:e.onChoosePicture,onOnInputLineChange:e.onInputLineChange,onOnSendGift:e.onSendGift,onOnSendAskGift:e.onSendAskGift,onOnChooseExpressImg:e.onChooseExpressImg,onOnRecordFinish:e.onRecordFinish,onOnActionOpen:e.onActionOpen,onOnGiftSheetChange:e.onGiftSheetChange},{default:(0,d.withCtx)(()=>[(0,d.createElementVNode)("view",{ref:"refBarSlot",style:(0,d.normalizeStyle)({height:`${e.barSlotHeight}px`})},[(0,d.createVNode)(ze,{showGift:e.showGift&&!e.isAuth,showGiftAsk:e.showGift&&e.isAuth,showCallAudio:e.showCall,showCallVideo:e.showCall,comWords:e.barComWords,userInfo:e.user,onClickGift:e.clickBarGift,onClickGiftAsk:e.clickBarGiftAsk,onClickUser:e.clickBarUser,onClickClub:e.clickBarClub,onClickCallVideo:t[3]||(t[3]=x=>e.clickCall(1)),onClickCallAudio:t[4]||(t[4]=x=>e.clickCall(2)),onClickWords:e.clickBarWords},null,8,["showGift","showGiftAsk","showCallAudio","showCallVideo","comWords","userInfo","onClickGift","onClickGiftAsk","onClickUser","onClickClub","onClickWords"]),e.replyMsgData?((0,d.openBlock)(),(0,d.createBlock)(Kt,{key:0,data:e.replyMsgData,onOnClickMsgBarReplyClose:e.onClickMsgBarReplyClose},null,8,["data","onOnClickMsgBarReplyClose"])):(0,d.createCommentVNode)("",!0)],4)]),_:1},8,["chatType","actionId","userInfo","onOnSend","onOnChoosePicture","onOnInputLineChange","onOnSendGift","onOnSendAskGift","onOnChooseExpressImg","onOnRecordFinish","onOnActionOpen","onOnGiftSheetChange"]),e.showMask?((0,d.openBlock)(),(0,d.createElementBlock)("view",{key:0,class:"mask-view",style:(0,d.normalizeStyle)([{width:e.sw+"px",height:e.viewHeight-e.msgBarHeight-e.barSlotHeight+"px"},e.pageBg])},null,4)):(0,d.createCommentVNode)("",!0),(0,d.createVNode)(Jt,{ref:"msgItemPop",onOnMsgItemPopDel:e.onMsgItemPopDel,onOnMsgItemPopReply:e.onMsgItemPopReply},null,8,["onOnMsgItemPopDel","onOnMsgItemPopReply"]),(0,d.createVNode)(Si,{ref:"sendAskGiftPop",onOnSendGift:e.onSendGift},null,8,["onOnSendGift"]),(0,d.createVNode)(Gn,{ref:"moreAction",actions:e.moreActions,onOnClickActionItem:e.onClickActionItem},null,8,["actions","onOnClickActionItem"]),e.gameInfo?((0,d.openBlock)(),(0,d.createBlock)(gt,{key:1,"game-info":e.gameInfo,class:"lottery-view"},null,8,["game-info"])):(0,d.createCommentVNode)("",!0),(0,d.createVNode)(zi,{ref:"giftSheet",fromType:e.giftFromType,isAsk:e.giftIsAsk,onOnSendGift:e.onSendGift,onOnSendAskGift:e.onSendAskGift,onOnChange:e.onGiftSheetChange},null,8,["fromType","isAsk","onOnSendGift","onOnSendAskGift","onOnChange"]),(0,d.createVNode)(Wn,{id:"/pagesMsg/pri/chat"}),(0,d.createVNode)(jn,{id:"/pagesMsg/pri/chat"}),(0,d.createElementVNode)("u-text",{ref:"titleText",class:"title-text",style:(0,d.normalizeStyle)({maxWidth:`${e.titleMaxWidth}px`})},(0,d.toDisplayString)(e.navBarTitle),5)],4)])}var Un=v(Jg,[["render",qg],["styles",[Yg]]]);var Qs=plus.webview.currentWebview();if(Qs){let e=parseInt(Qs.id),t="pagesMsg/pri/chat",i={};try{i=JSON.parse(Qs.__query__)}catch(n){}Un.mpType="page";let a=Vue.createPageApp(Un,{$store:getApp({allowDefault:!0}).$store,__pageId:e,__pagePath:t,__pageQuery:i});a.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...Un.styles||[]])),a.mount("#root")}})();
/*!
  * @intlify/shared v9.1.9
  * (c) 2021 kazuya kawaguchi
  * Released under the MIT License.
  */
/*!
  * @intlify/message-resolver v9.1.9
  * (c) 2021 kazuya kawaguchi
  * Released under the MIT License.
  */
/*!
  * @intlify/runtime v9.1.9
  * (c) 2021 kazuya kawaguchi
  * Released under the MIT License.
  */
/*!
  * @intlify/message-compiler v9.1.9
  * (c) 2021 kazuya kawaguchi
  * Released under the MIT License.
  */
/*!
  * @intlify/core-base v9.1.9
  * (c) 2021 kazuya kawaguchi
  * Released under the MIT License.
  */
/*!
  * vue-i18n v9.1.9
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */
