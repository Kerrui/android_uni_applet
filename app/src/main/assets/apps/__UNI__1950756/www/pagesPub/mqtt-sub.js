"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var Z=Object.create;var V=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var tt=Object.getOwnPropertyNames;var et=Object.getPrototypeOf,ot=Object.prototype.hasOwnProperty;var nt=(t,a)=>()=>(a||t((a={exports:{}}).exports,a),a.exports);var rt=(t,a,e,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let n of tt(a))!ot.call(t,n)&&n!==e&&V(t,n,{get:()=>a[n],enumerable:!(o=x(a,n))||o.enumerable});return t};var $=(t,a,e)=>(e=t!=null?Z(et(t)):{},rt(a||!t||!t.__esModule?V(e,"default",{value:t,enumerable:!0}):e,t));var N=nt((kt,B)=>{B.exports=Vue});var Dt=$(N());function l(t,a,...e){uni.__log__?uni.__log__(t,a,...e):console[t].apply(console,[...e,a])}var J=(t,a)=>{let e=t.__vccOpts||t;for(let[o,n]of a)e[o]=n;return e};function h(t){return typeof t=="undefined"||t==null||t==""}var S=new Promise(()=>{});function R(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function W(t){try{let a=JSON.parse(t);if(typeof a=="object")return a}catch(a){}return!1}var Et={zT:2,appId:plus.runtime.appid,appV:parseInt(plus.runtime.version.split(".").join("")),isAndroid:plus.os.name=="Android"};function Q(t,a){getApp().globalData.s.commit("setPubValue",{name:t,value:a})}function q(t,a="none",e="center"){uni.showToast({title:t,duration:2e3,icon:a,position:e})}function w(t,a,e,o="Confirm"){at(t,a,e,"",o,!1)}function at(t,a,e,o,n="Confirm",r=!0,s="Cancel",d=!1,_){uni.showModal({title:t,content:a,showCancel:r,cancelText:s,confirmText:n,editable:d,placeholderText:_,success(b){b.confirm?typeof e=="function"&&e(b):b.cancel&&typeof o=="function"&&o()}})}var U=0;function st(t){return lt(it(ut(t)))}function it(t){return pt(ft(ct(t),t.length*8))}function lt(t){try{}catch(r){U=0}for(var a=U?"0123456789ABCDEF":"0123456789abcdef",e="",o,n=0;n<t.length;n++)o=t.charCodeAt(n),e+=a.charAt(o>>>4&15)+a.charAt(o&15);return e}function ut(t){for(var a="",e=-1,o,n;++e<t.length;)o=t.charCodeAt(e),n=e+1<t.length?t.charCodeAt(e+1):0,55296<=o&&o<=56319&&56320<=n&&n<=57343&&(o=65536+((o&1023)<<10)+(n&1023),e++),o<=127?a+=String.fromCharCode(o):o<=2047?a+=String.fromCharCode(192|o>>>6&31,128|o&63):o<=65535?a+=String.fromCharCode(224|o>>>12&15,128|o>>>6&63,128|o&63):o<=2097151&&(a+=String.fromCharCode(240|o>>>18&7,128|o>>>12&63,128|o>>>6&63,128|o&63));return a}function ct(t){for(var a=Array(t.length>>2),e=0;e<a.length;e++)a[e]=0;for(var e=0;e<t.length*8;e+=8)a[e>>5]|=(t.charCodeAt(e/8)&255)<<e%32;return a}function pt(t){for(var a="",e=0;e<t.length*32;e+=8)a+=String.fromCharCode(t[e>>5]>>>e%32&255);return a}function ft(t,a){t[a>>5]|=128<<a%32,t[(a+64>>>9<<4)+14]=a;for(var e=1732584193,o=-271733879,n=-1732584194,r=271733878,s=0;s<t.length;s+=16){var d=e,_=o,b=n,k=r;e=c(e,o,n,r,t[s+0],7,-680876936),r=c(r,e,o,n,t[s+1],12,-389564586),n=c(n,r,e,o,t[s+2],17,606105819),o=c(o,n,r,e,t[s+3],22,-1044525330),e=c(e,o,n,r,t[s+4],7,-176418897),r=c(r,e,o,n,t[s+5],12,1200080426),n=c(n,r,e,o,t[s+6],17,-1473231341),o=c(o,n,r,e,t[s+7],22,-45705983),e=c(e,o,n,r,t[s+8],7,1770035416),r=c(r,e,o,n,t[s+9],12,-1958414417),n=c(n,r,e,o,t[s+10],17,-42063),o=c(o,n,r,e,t[s+11],22,-1990404162),e=c(e,o,n,r,t[s+12],7,1804603682),r=c(r,e,o,n,t[s+13],12,-40341101),n=c(n,r,e,o,t[s+14],17,-1502002290),o=c(o,n,r,e,t[s+15],22,1236535329),e=p(e,o,n,r,t[s+1],5,-165796510),r=p(r,e,o,n,t[s+6],9,-1069501632),n=p(n,r,e,o,t[s+11],14,643717713),o=p(o,n,r,e,t[s+0],20,-373897302),e=p(e,o,n,r,t[s+5],5,-701558691),r=p(r,e,o,n,t[s+10],9,38016083),n=p(n,r,e,o,t[s+15],14,-660478335),o=p(o,n,r,e,t[s+4],20,-405537848),e=p(e,o,n,r,t[s+9],5,568446438),r=p(r,e,o,n,t[s+14],9,-1019803690),n=p(n,r,e,o,t[s+3],14,-187363961),o=p(o,n,r,e,t[s+8],20,1163531501),e=p(e,o,n,r,t[s+13],5,-1444681467),r=p(r,e,o,n,t[s+2],9,-51403784),n=p(n,r,e,o,t[s+7],14,1735328473),o=p(o,n,r,e,t[s+12],20,-1926607734),e=f(e,o,n,r,t[s+5],4,-378558),r=f(r,e,o,n,t[s+8],11,-2022574463),n=f(n,r,e,o,t[s+11],16,1839030562),o=f(o,n,r,e,t[s+14],23,-35309556),e=f(e,o,n,r,t[s+1],4,-1530992060),r=f(r,e,o,n,t[s+4],11,1272893353),n=f(n,r,e,o,t[s+7],16,-155497632),o=f(o,n,r,e,t[s+10],23,-1094730640),e=f(e,o,n,r,t[s+13],4,681279174),r=f(r,e,o,n,t[s+0],11,-358537222),n=f(n,r,e,o,t[s+3],16,-722521979),o=f(o,n,r,e,t[s+6],23,76029189),e=f(e,o,n,r,t[s+9],4,-640364487),r=f(r,e,o,n,t[s+12],11,-421815835),n=f(n,r,e,o,t[s+15],16,530742520),o=f(o,n,r,e,t[s+2],23,-995338651),e=g(e,o,n,r,t[s+0],6,-198630844),r=g(r,e,o,n,t[s+7],10,1126891415),n=g(n,r,e,o,t[s+14],15,-1416354905),o=g(o,n,r,e,t[s+5],21,-57434055),e=g(e,o,n,r,t[s+12],6,1700485571),r=g(r,e,o,n,t[s+3],10,-1894986606),n=g(n,r,e,o,t[s+10],15,-1051523),o=g(o,n,r,e,t[s+1],21,-2054922799),e=g(e,o,n,r,t[s+8],6,1873313359),r=g(r,e,o,n,t[s+15],10,-30611744),n=g(n,r,e,o,t[s+6],15,-1560198380),o=g(o,n,r,e,t[s+13],21,1309151649),e=g(e,o,n,r,t[s+4],6,-145523070),r=g(r,e,o,n,t[s+11],10,-1120210379),n=g(n,r,e,o,t[s+2],15,718787259),o=g(o,n,r,e,t[s+9],21,-343485551),e=C(e,d),o=C(o,_),n=C(n,b),r=C(r,k)}return Array(e,o,n,r)}function O(t,a,e,o,n,r){return C(gt(C(C(a,t),C(o,r)),n),e)}function c(t,a,e,o,n,r,s){return O(a&e|~a&o,t,a,n,r,s)}function p(t,a,e,o,n,r,s){return O(a&o|e&~o,t,a,n,r,s)}function f(t,a,e,o,n,r,s){return O(a^e^o,t,a,n,r,s)}function g(t,a,e,o,n,r,s){return O(e^(a|~o),t,a,n,r,s)}function C(t,a){var e=(t&65535)+(a&65535),o=(t>>16)+(a>>16)+(e>>16);return o<<16|e&65535}function gt(t,a){return t<<a|t>>>32-a}var I={md5:function(t){return st(t)}};function mt(t,a){let e=getApp().globalData.s.state.AES.encrypt(a,t);return`${getApp().globalData.apiUaPrefix}${e}`}function z(t){return I.md5(`${getApp().globalData.channel}${t}${getApp().globalData.apiEncValue}`).substring(0,16)}var j={setToken(t){h(t)||Q("pubToken",t)},isLogin(){let t=getApp().globalData.s.state;return!h(t.pubToken)&&t.pubUser.uid},request(t,a,e,o,n=!1){return new Promise((r,s)=>{var d,_,b;let k=!1;if(e)if(e=="refresh")k=!0;else{let m={mask:!0};typeof e=="string"&&(m.title=e),uni.showLoading(m)}let A=!1;try{A=getApp().globalData.s.state.pubToken}catch(m){l("error","at common/api.js:31","request token catch "+JSON.stringify(m))}h((d=getApp().globalData)==null?void 0:d.ua)&&(L(7,(_=getApp().globalData)==null?void 0:_.ua,typeof((b=getApp().globalData)==null?void 0:b.ua),a,t,A),getApp().initUaInfo());let E=getApp().globalData.ua,D,G=dt(a),y={"content-type":"application/json"},K=getApp().globalData.apiHost,v;A&&getApp().globalData.uid!==0?(y.Authorization=`Bearer ${A}`,v=z(getApp().globalData.uid)):v=z(0),y.ua=mt(E,v),D=getApp().globalData.s.state.AES.encrypt(v,JSON.stringify(G)),uni.request({url:K+t,method:"POST",header:y,data:D,dataType:"json",timeout:1e4,complete(m){if(e&&uni.hideLoading(),l("log","at common/api.js:63",`request ${t} obj ${JSON.stringify(a)}`,m.statusCode),m.header&&m.header["x-report-log"]&&L(m.header["x-report-log"],y.ua,E,D,t,A),m.statusCode==200){let Y=m.data,u=getApp().globalData.s.state.AES.decrypt(v,Y);if(u=W(u),l("log","at common/api.js:71","res:",u),!u){o&&s(u),L(1,y.ua,E,D,t,A);return}if(u.data&&typeof u.data.callback=="object"&&(j.handleCallback(u.data.callback),n))return S;if(u.ok===99)return getApp().loginOut("API ok 99"),S;if(u.ok==-98)return o&&s(u),S;if(h(u.msg)||q(u.msg),u.ok>0){r(u);return}o&&s(u)}else{if(m.statusCode==401)return getApp().loginOut("API status code 401"),S;if(k&&uni.stopPullDownRefresh(),o)s(m);else return S}},fail(m){}})})},handleCallback(t){},accessLogExtra(t,a,e){}};function dt(t){try{h(t)&&(t={}),t.times=new Date().getTime();let a=Object.keys(t).sort(),e={};for(let n=0,r=a.length;n<r;n++)e[a[n]]=t[a[n]];let o=H(e).substr(1);return e.sign=I.md5(`${I.md5(o)}${getApp().globalData.apiSignValue}`),e}catch(a){return t}}function H(t,a){if(t==null||typeof t=="number"&&isNaN(t))return"";try{let e="",o=typeof t;if(o=="string"||o=="number")e+="&"+a+"="+R(t);else if(o=="boolean")e+="&"+a+"="+(t?1:0);else for(let n in t){let r=a==null?n:a+bt(n);e+=H(t[n],r)}return e}catch(e){return""}}function bt(t){return`${encodeURIComponent("[")}${t}${encodeURIComponent("]")}`}function L(t,a,e,o,n,r){let s={type:t,ua:a,origin_ua:e,params:o,api:n,token:r},d=!1;try{d=getApp().globalData.s.state.pubToken}catch(b){l("error","at common/api.js:182","request token catch "+JSON.stringify(b))}let _={"content-type":"application/json",ua:getApp().globalData.ua};d&&(_.Authorization=`Bearer ${d}`),uni.request({url:`${getApp().globalData.apiHost}/log/report`,method:"POST",header:_,data:s,dataType:"json",timeout:1e4})}var T={DEFAULT:1e4,FAIL:0,SUCCESS:1,DISCONNECT:6,RECONNECT:7},M={MAX_ONCE:0,MIN_ONCE:1,JUST_ONCE:2};var i=$(N());function ht(t,a,e){getApp().globalData.pluginMqtt.connect(t,o=>{if(h(o)||h(o.res))return;let n=o.res,r=n.type,s=n.data;switch(r){case 100:a(T.SUCCESS);break;case 101:a(T.RECONNECT);break;case 102:a(T.DISCONNECT);break;case 200:a(T.FAIL);break;default:e(r,s);break}})}function X(){getApp().globalData.pluginMqtt.disConnect()}function _t(t,a,e){getApp().globalData.pluginMqtt.subscribeToTopic({topic:t,level:a},o=>{l("error","at comPlugin/mqtt.js:40","App error mqtt subscribe ",o),e(o)})}function Ct(t,a){getApp().globalData.pluginMqtt.unsubscribeTopic({topic:t},e=>{l("error","at comPlugin/mqtt.js:49","App error mqtt unsubscribe "+e),a(e)})}function At(t,a,e,o){l("log","at comPlugin/mqtt.js:55","\u8FDC\u7A0B\u6307\u4EE4\u53D1\u9001\uFF1A",t,a),getApp().globalData.pluginMqtt.sendMsg({topic:t,level:e,msg:a},n=>{l("error","at comPlugin/mqtt.js:61","App error mqtt publish ",n),o(n)})}function St(){let t=!1;return t=getApp().globalData.pluginMqtt.checkStatusSync().status,t}var yt={"center-between":{"":{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},"input-view":{"":{marginTop:"20rpx",width:200,height:44,lineHeight:44,color:"#333333",borderWidth:1,borderStyle:"solid",borderColor:"#FF4477"}}},vt={data(){return{sW:getApp().globalData.window.width,topic:"52/box"}},methods:{clickConnect(){let t={secret:getApp().globalData.wv};j.request("/menu/init",t,!0,!0).then(a=>{let e={client_id:"a_66661_4277",wss_client_id:"aw_66661_4277",mqtt_host:"wss.267girl.com",mqtt_port_tcp:9002,mqtt_port_wss:9003,password:"589c62432be02818f106f08e44c003c1",username:"66661"},o={client_id:e.client_id,mqtt_host:e.mqtt_host,mqtt_port_tcp:e.mqtt_port_tcp,password:e.password,username:e.username};ht(o,n=>{l("error","at pagesPub/mqtt-sub.nvue:67","connect callback ",n),n==1?w("Tips","\u8FDE\u63A5\u6210\u529F"):w("Tips","\u8FDE\u63A5 \u5931\u8D25")},n=>{l("error","at pagesPub/mqtt-sub.nvue:74","mqtt action",n)})},a=>{})},clickSub(){if(h(this.topic)){w("Tips","\u8BF7\u8F93\u5165\u8BA2\u9605 id");return}l("error","at pagesPub/mqtt-sub.nvue:83","-------> topic = "+this.topic),_t(this.topic,M.MAX_ONCE,t=>{l("error","at pagesPub/mqtt-sub.nvue:85","mqtt \u8BA2\u9605\u6267\u884C\u7ED3\u675F ",t)})},clickUnsub(){Ct(this.topic,t=>{l("error","at pagesPub/mqtt-sub.nvue:90","mqtt Unsubscribe \u6267\u884C\u7ED3\u675F",t)})},clickSendMessage(){At(this.topic,"lzd - test topic message",M.MAX_ONCE,t=>{l("error","at pagesPub/mqtt-sub.nvue:95","mqtt send message ",t)})},clickDisconnect(){X(),q("Success")},clickStatus(){let t=St();w("status","status:"+t)}},onLoad(t){},onUnload(){X()}};function wt(t,a,e,o,n,r){let s=(0,i.resolveComponent)("button");return(0,i.openBlock)(),(0,i.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,i.createElementVNode)("view",{style:{flex:"1"}},[(0,i.createVNode)(s,{onClick:r.clickConnect},{default:(0,i.withCtx)(()=>[(0,i.createTextVNode)("MQTT \u8FDE\u63A5")]),_:1},8,["onClick"]),(0,i.createElementVNode)("u-input",{modelValue:n.topic,onInput:a[0]||(a[0]=d=>n.topic=d.detail.value),class:"input-view",placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605 id",style:(0,i.normalizeStyle)({width:`${n.sW}px`})},null,44,["modelValue"]),(0,i.createVNode)(s,{onClick:r.clickStatus,style:{"margin-top":"20rpx"}},{default:(0,i.withCtx)(()=>[(0,i.createTextVNode)("\u67E5\u770B\u8FDE\u63A5\u72B6\u6001")]),_:1},8,["onClick"]),(0,i.createVNode)(s,{onClick:r.clickSub,style:{"margin-top":"20rpx"}},{default:(0,i.withCtx)(()=>[(0,i.createTextVNode)("\u5F00\u59CB\u8BA2\u9605")]),_:1},8,["onClick"]),(0,i.createVNode)(s,{onClick:r.clickUnsub,style:{"margin-top":"20rpx"}},{default:(0,i.withCtx)(()=>[(0,i.createTextVNode)("\u53D6\u6D88\u8BA2\u9605")]),_:1},8,["onClick"]),(0,i.createVNode)(s,{onClick:r.clickSendMessage,style:{"margin-top":"20rpx"}},{default:(0,i.withCtx)(()=>[(0,i.createTextVNode)("\u53D1\u9001\u6D88\u606F")]),_:1},8,["onClick"]),(0,i.createVNode)(s,{onClick:r.clickDisconnect,style:{"margin-top":"20rpx"}},{default:(0,i.withCtx)(()=>[(0,i.createTextVNode)("\u65AD\u5F00\u8FDE\u63A5")]),_:1},8,["onClick"])])])}var P=J(vt,[["render",wt],["styles",[yt]]]);var F=plus.webview.currentWebview();if(F){let t=parseInt(F.id),a="pagesPub/mqtt-sub",e={};try{e=JSON.parse(F.__query__)}catch(n){}P.mpType="page";let o=Vue.createPageApp(P,{$store:getApp({allowDefault:!0}).$store,__pageId:t,__pagePath:a,__pageQuery:e});o.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...P.styles||[]])),o.mount("#root")}})();
